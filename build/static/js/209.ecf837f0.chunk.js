/*! For license information please see 209.ecf837f0.chunk.js.LICENSE.txt */
(self.webpackChunkstudkz_pwa=self.webpackChunkstudkz_pwa||[]).push([[209],{8446:function(t,e,n){"use strict";var r=n(5637),i=n(826),o=n(9388),a=n(9971),s=n(9386);function u(t){return t&&"object"===typeof t&&"default"in t?t:{default:t}}var c,h=u(r),l=((c={})["already-activated"]="You are trying to activate AppCheck for FirebaseApp {$appName}, while it is already activated. AppCheck can only be activated once.",c["use-before-activation"]="AppCheck is being used before activate() is called for FirebaseApp {$appName}. Please make sure you call activate() before instantiating other Firebase services.",c["fetch-network-error"]="Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",c["fetch-parse-error"]="Fetch client could not parse response. Original error: {$originalErrorMessage}.",c["fetch-status-error"]="Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",c["storage-open"]="Error thrown when opening storage. Original error: {$originalErrorMessage}.",c["storage-get"]="Error thrown when reading from storage. Original error: {$originalErrorMessage}.",c["storage-set"]="Error thrown when writing to storage. Original error: {$originalErrorMessage}.",c["recaptcha-error"]="ReCAPTCHA error.",c),f=new a.ErrorFactory("appCheck","AppCheck",l),d=new Map,p={activated:!1,tokenObservers:[]},v={enabled:!1};function g(t){return d.get(t)||p}function y(t,e){d.set(t,e)}function m(){return v}var _="https://content-firebaseappcheck.googleapis.com/v1beta",b=3e4,w=96e4,I=function(){function t(t,e,n,r,i){if(this.operation=t,this.retryPolicy=e,this.getWaitDuration=n,this.lowerBound=r,this.upperBound=i,this.pending=null,this.nextErrorWaitInterval=r,r>i)throw new Error("Proactive refresh lower bound greater than upper bound!")}return t.prototype.start=function(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch((function(){}))},t.prototype.stop=function(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)},t.prototype.isRunning=function(){return!!this.pending},t.prototype.process=function(t){return o.__awaiter(this,void 0,void 0,(function(){var e;return o.__generator(this,(function(n){switch(n.label){case 0:this.stop(),n.label=1;case 1:return n.trys.push([1,6,,7]),this.pending=new a.Deferred,[4,(r=this.getNextRun(t),new Promise((function(t){setTimeout(t,r)})))];case 2:return n.sent(),this.pending.resolve(),[4,this.pending.promise];case 3:return n.sent(),this.pending=new a.Deferred,[4,this.operation()];case 4:return n.sent(),this.pending.resolve(),[4,this.pending.promise];case 5:return n.sent(),this.process(!0).catch((function(){})),[3,7];case 6:return e=n.sent(),this.retryPolicy(e)?this.process(!1).catch((function(){})):this.stop(),[3,7];case 7:return[2]}var r}))}))},t.prototype.getNextRun=function(t){if(t)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();var e=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),e},t}();function T(){return self.grecaptcha}function E(t){if(!g(t).activated)throw f.create("use-before-activation",{appName:t.name})}function S(t){return a.base64.encodeString(JSON.stringify(t),!1)}function C(t,e){var n=t.url,r=t.body;return o.__awaiter(this,void 0,void 0,(function(){var t,i,a,s,u,c,h,l,d,p;return o.__generator(this,(function(o){switch(o.label){case 0:t={"Content-Type":"application/json"},(i=e.getImmediate({optional:!0}))&&(t["X-Firebase-Client"]=i.getPlatformInfoString()),a={method:"POST",body:JSON.stringify(r),headers:t},o.label=1;case 1:return o.trys.push([1,3,,4]),[4,fetch(n,a)];case 2:return s=o.sent(),[3,4];case 3:throw u=o.sent(),f.create("fetch-network-error",{originalErrorMessage:u.message});case 4:if(200!==s.status)throw f.create("fetch-status-error",{httpStatus:s.status});o.label=5;case 5:return o.trys.push([5,7,,8]),[4,s.json()];case 6:return c=o.sent(),[3,8];case 7:throw h=o.sent(),f.create("fetch-parse-error",{originalErrorMessage:h.message});case 8:if(!(l=c.ttl.match(/^([\d.]+)(s)$/))||!l[2]||isNaN(Number(l[1])))throw f.create("fetch-parse-error",{originalErrorMessage:"ttl field (timeToLive) is not in standard Protobuf Duration format: "+c.ttl});return d=1e3*Number(l[1]),p=Date.now(),[2,{token:c.attestationToken,expireTimeMillis:p+d,issuedAtTimeMillis:p}]}}))}))}function k(t,e){var n=t.options,r=n.projectId,i=n.appId,o=n.apiKey;return{url:_+"/projects/"+r+"/apps/"+i+":exchangeRecaptchaToken?key="+o,body:{recaptcha_token:e}}}function A(t,e){var n=t.options,r=n.projectId,i=n.appId,o=n.apiKey;return{url:_+"/projects/"+r+"/apps/"+i+":exchangeDebugToken?key="+o,body:{debug_token:e}}}var N="firebase-app-check-store",P="debug-token",R=null;function D(){return R||(R=new Promise((function(t,e){try{var n=indexedDB.open("firebase-app-check-database",1);n.onsuccess=function(e){t(e.target.result)},n.onerror=function(t){var n;e(f.create("storage-open",{originalErrorMessage:null===(n=t.target.error)||void 0===n?void 0:n.message}))},n.onupgradeneeded=function(t){var e=t.target.result;if(0===t.oldVersion)e.createObjectStore(N,{keyPath:"compositeKey"})}}catch(r){e(f.create("storage-open",{originalErrorMessage:r.message}))}})),R)}function x(t){return L(M(t))}function O(t,e){return o.__awaiter(this,void 0,void 0,(function(){var n,r,i,a;return o.__generator(this,(function(o){switch(o.label){case 0:return[4,D()];case 1:return n=o.sent(),r=n.transaction(N,"readwrite"),i=r.objectStore(N),a=i.put({compositeKey:t,value:e}),[2,new Promise((function(t,e){a.onsuccess=function(e){t()},r.onerror=function(t){var n;e(f.create("storage-set",{originalErrorMessage:null===(n=t.target.error)||void 0===n?void 0:n.message}))}}))]}}))}))}function L(t){return o.__awaiter(this,void 0,void 0,(function(){var e,n,r,i;return o.__generator(this,(function(o){switch(o.label){case 0:return[4,D()];case 1:return e=o.sent(),n=e.transaction(N,"readonly"),r=n.objectStore(N),i=r.get(t),[2,new Promise((function(t,e){i.onsuccess=function(e){var n=e.target.result;t(n?n.value:void 0)},n.onerror=function(t){var n;e(f.create("storage-get",{originalErrorMessage:null===(n=t.target.error)||void 0===n?void 0:n.message}))}}))]}}))}))}function M(t){return t.options.appId+"-"+t.name}var F=new s.Logger("@firebase/app-check");function U(t,e){return a.isIndexedDBAvailable()?function(t,e){return O(M(t),e)}(t,e).catch((function(t){F.warn("Failed to write token to indexeddb. Error: "+t)})):Promise.resolve()}function j(){return o.__awaiter(this,void 0,void 0,(function(){var t,e;return o.__generator(this,(function(n){switch(n.label){case 0:t=void 0,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,L(P)];case 2:return t=n.sent(),[3,4];case 3:return n.sent(),[3,4];case 4:return t?[2,t]:(e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})),(r=e,O(P,r)).catch((function(t){return F.warn("Failed to persist debug token to indexeddb. Error: "+t)})),console.log("AppCheck debug token: "+e+". You will need to whitelist it in the Firebase console for it to work"),[2,e])}var r}))}))}function q(){return o.__awaiter(this,void 0,void 0,(function(){var t;return o.__generator(this,(function(e){if((t=m()).enabled&&t.token)return[2,t.token.promise];throw Error("\n            Can't get debug token in production mode.\n        ")}))}))}var V={error:"UNKNOWN_ERROR"};function B(t,e,n){return void 0===n&&(n=!1),o.__awaiter(this,void 0,void 0,(function(){var r,i,a,s,u,c,h,l,f,d;return o.__generator(this,(function(p){switch(p.label){case 0:return E(t),r=g(t),i=r.token,a=void 0,i?[3,2]:[4,r.cachedTokenPromise];case 1:(s=p.sent())&&G(s)&&(i=s,y(t,o.__assign(o.__assign({},r),{token:i})),H(t,{token:i.token})),p.label=2;case 2:return!n&&i&&G(i)?[2,{token:i.token}]:m().enabled?(c=C,h=A,l=[t],[4,q()]):[3,6];case 3:return[4,c.apply(void 0,[h.apply(void 0,l.concat([p.sent()])),e])];case 4:return u=p.sent(),[4,U(t,u)];case 5:return p.sent(),y(t,o.__assign(o.__assign({},r),{token:u})),[2,{token:u.token}];case 6:return p.trys.push([6,8,,9]),[4,r.provider.getToken()];case 7:return i=p.sent(),[3,9];case 8:return f=p.sent(),F.error(f),a=f,[3,9];case 9:return i?[3,10]:(d=function(t){return{token:S(V),error:t}}(a),[3,12]);case 10:return d={token:i.token},y(t,o.__assign(o.__assign({},r),{token:i})),[4,U(t,i)];case 11:p.sent(),p.label=12;case 12:return H(t,d),[2,d]}}))}))}function K(t,e,n,r,i){var a=g(t),s={next:r,error:i,type:n},u=o.__assign(o.__assign({},a),{tokenObservers:o.__spreadArray(o.__spreadArray([],a.tokenObservers),[s])});if(!u.tokenRefresher){var c=function(t,e){var n=this;return new I((function(){return o.__awaiter(n,void 0,void 0,(function(){var n;return o.__generator(this,(function(r){switch(r.label){case 0:return g(t).token?[3,2]:[4,B(t,e)];case 1:return n=r.sent(),[3,4];case 2:return[4,B(t,e,!0)];case 3:n=r.sent(),r.label=4;case 4:if(n.error)throw n.error;return[2]}}))}))}),(function(){return!0}),(function(){var e=g(t);if(e.token){var n=e.token.issuedAtTimeMillis+.5*(e.token.expireTimeMillis-e.token.issuedAtTimeMillis)+3e5,r=e.token.expireTimeMillis-3e5;return n=Math.min(n,r),Math.max(0,n-Date.now())}return 0}),b,w)}(t,e);u.tokenRefresher=c}if(!u.tokenRefresher.isRunning()&&a.isTokenAutoRefreshEnabled&&u.tokenRefresher.start(),a.token&&G(a.token)){var h=a.token;Promise.resolve().then((function(){return r({token:h.token})})).catch((function(){}))}else null==a.token&&a.cachedTokenPromise.then((function(t){t&&G(t)&&r({token:t.token})})).catch((function(){}));y(t,u)}function W(t,e){var n=g(t),r=n.tokenObservers.filter((function(t){return t.next!==e}));0===r.length&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),y(t,o.__assign(o.__assign({},n),{tokenObservers:r}))}function H(t,e){for(var n=0,r=g(t).tokenObservers;n<r.length;n++){var i=r[n];try{"EXTERNAL"===i.type&&null!=e.error?i.error(e.error):i.next(e)}catch(o){}}}function G(t){return t.expireTimeMillis-Date.now()>0}var z="https://www.google.com/recaptcha/api.js";function Q(t,e){var n=g(t),r=new a.Deferred;y(t,o.__assign(o.__assign({},n),{reCAPTCHAState:{initialized:r}}));var i="fire_app_check_"+t.name,s=document.createElement("div");s.id=i,s.style.display="none",document.body.appendChild(s);var u=T();return u?u.ready((function(){X(t,e,u,i),r.resolve(u)})):function(t){var e=document.createElement("script");e.src=""+z,e.onload=t,document.head.appendChild(e)}((function(){var n=T();if(!n)throw new Error("no recaptcha");n.ready((function(){X(t,e,n,i),r.resolve(n)}))})),r.promise}function Y(t){return o.__awaiter(this,void 0,void 0,(function(){var e;return o.__generator(this,(function(n){switch(n.label){case 0:return E(t),[4,g(t).reCAPTCHAState.initialized.promise];case 1:return e=n.sent(),[2,new Promise((function(n,r){var i=g(t).reCAPTCHAState;e.ready((function(){n(e.execute(i.widgetId,{action:"fire_app_check"}))}))}))]}}))}))}function X(t,e,n,r){var i=n.render(r,{sitekey:e,size:"invisible"}),a=g(t);y(t,o.__assign(o.__assign({},a),{reCAPTCHAState:o.__assign(o.__assign({},a.reCAPTCHAState),{widgetId:i})}))}var $=function(){function t(t){this._siteKey=t}return t.prototype.getToken=function(){return o.__awaiter(this,void 0,void 0,(function(){var t;return o.__generator(this,(function(e){switch(e.label){case 0:if(!this._app||!this._platformLoggerProvider)throw f.create("use-before-activation",{appName:""});e.label=1;case 1:return e.trys.push([1,3,,4]),[4,Y(this._app)];case 2:return t=e.sent(),[3,4];case 3:throw e.sent(),f.create("recaptcha-error");case 4:return[2,C(k(this._app,t),this._platformLoggerProvider)]}}))}))},t.prototype.initialize=function(t,e){this._app=t,this._platformLoggerProvider=e,Q(t,this._siteKey).catch((function(){}))},t}(),J=function(){function t(t){this._customProviderOptions=t}return t.prototype.getToken=function(){return o.__awaiter(this,void 0,void 0,(function(){var t,e,n;return o.__generator(this,(function(r){switch(r.label){case 0:if(!this._app)throw f.create("use-before-activation",{appName:""});return[4,this._customProviderOptions.getToken()];case 1:return t=r.sent(),e=a.issuedAtTime(t.token),n=null!==e&&e<Date.now()&&e>0?1e3*e:Date.now(),[2,o.__assign(o.__assign({},t),{issuedAtTimeMillis:n})]}}))}))},t.prototype.initialize=function(t){this._app=t},t}();function Z(t,e,n,r){var i=g(t);if(i.activated)throw f.create("already-activated",{appName:t.name});var s=o.__assign(o.__assign({},i),{activated:!0});s.cachedTokenPromise=function(t){return o.__awaiter(this,void 0,void 0,(function(){var e,n;return o.__generator(this,(function(r){switch(r.label){case 0:if(!a.isIndexedDBAvailable())return[3,5];e=void 0,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,x(t)];case 2:return e=r.sent(),[3,4];case 3:return n=r.sent(),F.warn("Failed to read token from indexeddb. Error: "+n),[3,4];case 4:return[2,e];case 5:return[2,void 0]}}))}))}(t).then((function(e){return e&&G(e)&&y(t,o.__assign(o.__assign({},g(t)),{token:e})),e})),s.provider="string"===typeof e?new $(e):e instanceof $||e instanceof J?e:new J({getToken:e.getToken}),s.isTokenAutoRefreshEnabled=void 0===r?t.automaticDataCollectionEnabled:r,y(t,s),s.provider.initialize(t,n)}function tt(t,e){return{app:t,activate:function(n,r){return Z(t,n,e,r)},setTokenAutoRefreshEnabled:function(e){return function(t,e){var n=g(t);n.tokenRefresher&&(!0===e?n.tokenRefresher.start():n.tokenRefresher.stop()),y(t,o.__assign(o.__assign({},n),{isTokenAutoRefreshEnabled:e}))}(t,e)},getToken:function(n){return function(t,e,n){return o.__awaiter(this,void 0,void 0,(function(){var r;return o.__generator(this,(function(i){switch(i.label){case 0:return[4,B(t,e,n)];case 1:if((r=i.sent()).error)throw r.error;return[2,{token:r.token}]}}))}))}(t,e,n)},onTokenChanged:function(n,r,i){return function(t,e,n,r,i){var o=function(){},a=function(){};return o=null!=n.next?n.next.bind(n):n,null!=n.error?a=n.error.bind(n):r&&(a=r),K(t,e,"EXTERNAL",o,a),function(){return W(t,o)}}(t,e,n,r)},INTERNAL:{delete:function(){for(var e=0,n=g(t).tokenObservers;e<n.length;e++){var r=n[e];W(t,r.next)}return Promise.resolve()}}}}var et="app-check-internal";!function(t){t.INTERNAL.registerComponent(new i.Component("appCheck",(function(t){return tt(t.getProvider("app").getImmediate(),t.getProvider("platform-logger"))}),"PUBLIC").setServiceProps({ReCaptchaV3Provider:$,CustomProvider:J}).setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((function(t,e,n){t.getProvider(et).initialize()}))),t.INTERNAL.registerComponent(new i.Component(et,(function(t){return function(t,e){return{getToken:function(n){return B(t,e,n)},addTokenListener:function(n){return K(t,e,"INTERNAL",n)},removeTokenListener:function(e){return W(t,e)}}}(t.getProvider("app").getImmediate(),t.getProvider("platform-logger"))}),"PUBLIC").setInstantiationMode("EXPLICIT")),t.registerVersion("@firebase/app-check","0.3.2")}(h.default),function(){var t=a.getGlobal();if("string"===typeof t.FIREBASE_APPCHECK_DEBUG_TOKEN||!0===t.FIREBASE_APPCHECK_DEBUG_TOKEN){var e=m();e.enabled=!0;var n=new a.Deferred;e.token=n,"string"===typeof t.FIREBASE_APPCHECK_DEBUG_TOKEN?n.resolve(t.FIREBASE_APPCHECK_DEBUG_TOKEN):n.resolve(j())}}()},5637:function(t,e,n){"use strict";n.r(e),n.d(e,{firebase:function(){return b}});var r,i,o=n(9388),a=n(9971),s=n(826),u=n(9386),c=((r={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",r["bad-app-name"]="Illegal App name: '{$appName}",r["duplicate-app"]="Firebase App named '{$appName}' already exists",r["app-deleted"]="Firebase App named '{$appName}' already deleted",r["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",r["invalid-log-argument"]="First argument to `onLog` must be null or a function.",r),h=new a.ErrorFactory("app","Firebase",c),l="@firebase/app",f="[DEFAULT]",d=((i={})[l]="fire-core",i["@firebase/analytics"]="fire-analytics",i["@firebase/app-check"]="fire-app-check",i["@firebase/auth"]="fire-auth",i["@firebase/database"]="fire-rtdb",i["@firebase/functions"]="fire-fn",i["@firebase/installations"]="fire-iid",i["@firebase/messaging"]="fire-fcm",i["@firebase/performance"]="fire-perf",i["@firebase/remote-config"]="fire-rc",i["@firebase/storage"]="fire-gcs",i["@firebase/firestore"]="fire-fst",i["fire-js"]="fire-js",i["firebase-wrapper"]="fire-js-all",i),p=new u.Logger("@firebase/app"),v=function(){function t(t,e,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=(0,a.deepCopy)(t),this.container=new s.ComponentContainer(e.name),this._addComponent(new s.Component("app",(function(){return r}),"PUBLIC")),this.firebase_.INTERNAL.components.forEach((function(t){return r._addComponent(t)}))}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){var n;void 0===e&&(e=f),this.checkDestroyed_();var r=this.container.getProvider(t);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=f),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){p.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw h.create("app-deleted",{appName:this.name_})},t}();v.prototype.name&&v.prototype.options||v.prototype.delete||console.log("dc");var g=function t(){var e=function(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={}),"object"===typeof i&&null!==i||(i={name:i});var o=i;void 0===o.name&&(o.name=f);var s=o.name;if("string"!==typeof s||!s)throw h.create("bad-app-name",{appName:String(s)});if((0,a.contains)(e,s))throw h.create("duplicate-app",{appName:s});var u=new t(n,o,r);return e[s]=u,u},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=d[t])&&void 0!==r?r:t;n&&(i+="-"+n);var a=i.match(/\s|\//),u=e.match(/\s|\//);if(a||u){var c=['Unable to register library "'+i+'" with version "'+e+'":'];return a&&c.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),a&&u&&c.push("and"),u&&c.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void p.warn(c.join(" "))}o(new s.Component(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:u.setLogLevel,onLog:function(t,e){if(null!==t&&"function"!==typeof t)throw h.create("invalid-log-argument");(0,u.setUserLogHandler)(t,e)},apps:null,SDK_VERSION:"8.10.0",INTERNAL:{registerComponent:o,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){return"serverAuth"===e?null:e}}};function i(t){if(t=t||f,!(0,a.contains)(e,t))throw h.create("no-app",{appName:t});return e[t]}function o(o){var s=o.name;if(n.has(s))return p.debug("There were multiple attempts to register component "+s+"."),"PUBLIC"===o.type?r[s]:null;if(n.set(s,o),"PUBLIC"===o.type){var u=function(t){if(void 0===t&&(t=i()),"function"!==typeof t[s])throw h.create("invalid-app-argument",{appName:s});return t[s]()};void 0!==o.serviceProps&&(0,a.deepExtend)(u,o.serviceProps),r[s]=u,t.prototype[s]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._getService.bind(this,s).apply(this,o.multipleInstances?t:[])}}for(var c=0,l=Object.keys(e);c<l.length;c++){var f=l[c];e[f]._addComponent(o)}return"PUBLIC"===o.type?r[s]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r}(v);return e.INTERNAL=(0,o.__assign)((0,o.__assign)({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){(0,a.deepExtend)(e,t)},createSubscribe:a.createSubscribe,ErrorFactory:a.ErrorFactory,deepExtend:a.deepExtend}),e}(),y=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null===e||void 0===e?void 0:e.type)}(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();if((0,a.isBrowser)()&&void 0!==self.firebase){p.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var m=self.firebase.SDK_VERSION;m&&m.indexOf("LITE")>=0&&p.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var _=g.initializeApp;g.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return(0,a.isNode)()&&p.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),_.apply(void 0,t)};var b=g;!function(t,e){t.INTERNAL.registerComponent(new s.Component("platform-logger",(function(t){return new y(t)}),"PRIVATE")),t.registerVersion(l,"0.6.30",e),t.registerVersion("fire-js","")}(b),e.default=b},826:function(t,e,n){"use strict";n.r(e),n.d(e,{Component:function(){return o},ComponentContainer:function(){return u},Provider:function(){return s}});var r=n(9388),i=n(9971),o=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},t}(),a="[DEFAULT]",s=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return t.prototype.get=function(t){var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new i.Deferred;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:e});r&&n.resolve(r)}catch(o){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e,n=this.normalizeInstanceIdentifier(null===t||void 0===t?void 0:t.identifier),r=null!==(e=null===t||void 0===t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:a})}catch(f){}try{for(var i=(0,r.__values)(this.instancesDeferred.entries()),o=i.next();!o.done;o=i.next()){var s=(0,r.__read)(o.value,2),u=s[0],c=s[1],h=this.normalizeInstanceIdentifier(u);try{var l=this.getOrInitializeService({instanceIdentifier:h});c.resolve(l)}catch(f){}}}catch(d){e={error:d}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}}},t.prototype.clearInstance=function(t){void 0===t&&(t=a),this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all((0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})))),(0,r.__read)(t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()})))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.isInitialized=function(t){return void 0===t&&(t=a),this.instances.has(t)},t.prototype.getOptions=function(t){return void 0===t&&(t=a),this.instancesOptions.get(t)||{}},t.prototype.initialize=function(t){var e,n;void 0===t&&(t={});var i=t.options,o=void 0===i?{}:i,a=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(a))throw Error(this.name+"("+a+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var s=this.getOrInitializeService({instanceIdentifier:a,options:o});try{for(var u=(0,r.__values)(this.instancesDeferred.entries()),c=u.next();!c.done;c=u.next()){var h=(0,r.__read)(c.value,2),l=h[0],f=h[1];a===this.normalizeInstanceIdentifier(l)&&f.resolve(s)}}catch(d){e={error:d}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(e)throw e.error}}return s},t.prototype.onInit=function(t,e){var n,r=this.normalizeInstanceIdentifier(e),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(t),this.onInitCallbacks.set(r,i);var o=this.instances.get(r);return o&&t(o,r),function(){i.delete(t)}},t.prototype.invokeOnInitCallbacks=function(t,e){var n,i,o=this.onInitCallbacks.get(e);if(o)try{for(var a=(0,r.__values)(o),s=a.next();!s.done;s=a.next()){var u=s.value;try{u(t,e)}catch(c){}}}catch(h){n={error:h}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}},t.prototype.getOrInitializeService=function(t){var e,n=t.instanceIdentifier,r=t.options,i=void 0===r?{}:r,o=this.instances.get(n);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:(e=n,e===a?void 0:e),options:i}),this.instances.set(n,o),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(o,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,o)}catch(s){}return o||null},t.prototype.normalizeInstanceIdentifier=function(t){return void 0===t&&(t=a),this.component?this.component.multipleInstances?t:a:t},t.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},t}();var u=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new s(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}()},6895:function(t,e,n){"use strict";var r=n(5637),i=n(826),o=n(9971),a=n(9388),s=n(9386);t=n.hmd(t);var u="";function c(t){u=t}var h=function(){function t(t){this.domStorage_=t,this.prefix_="firebase:"}return t.prototype.set=function(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),(0,o.stringify)(e))},t.prototype.get=function(t){var e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:(0,o.jsonEval)(e)},t.prototype.remove=function(t){this.domStorage_.removeItem(this.prefixedName_(t))},t.prototype.prefixedName_=function(t){return this.prefix_+t},t.prototype.toString=function(){return this.domStorage_.toString()},t}(),l=function(){function t(){this.cache_={},this.isInMemoryStorage=!0}return t.prototype.set=function(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e},t.prototype.get=function(t){return(0,o.contains)(this.cache_,t)?this.cache_[t]:null},t.prototype.remove=function(t){delete this.cache_[t]},t}(),f=function(t){try{if("undefined"!==typeof window&&"undefined"!==typeof window[t]){var e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new h(e)}}catch(n){}return new l},d=f("localStorage"),p=f("sessionStorage"),v=new s.Logger("@firebase/database"),g=function(){var t=1;return function(){return t++}}(),y=function(t){var e=(0,o.stringToByteArray)(t),n=new o.Sha1;n.update(e);var r=n.digest();return o.base64.encodeByteArray(r)},m=function t(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];for(var r="",i=0;i<e.length;i++){var a=e[i];Array.isArray(a)||a&&"object"===typeof a&&"number"===typeof a.length?r+=t.apply(null,a):r+="object"===typeof a?(0,o.stringify)(a):a,r+=" "}return r},_=null,b=!0,w=function(t,e){(0,o.assert)(!e||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(v.logLevel=s.LogLevel.VERBOSE,_=v.log.bind(v),e&&p.set("logging_enabled",!0)):"function"===typeof t?_=t:(_=null,p.remove("logging_enabled"))},I=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!0===b&&(b=!1,null===_&&!0===p.get("logging_enabled")&&w(!0)),_){var n=m.apply(null,t);_(n)}},T=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];I.apply(void 0,(0,a.__spreadArray)([t],(0,a.__read)(e)))}},E=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE INTERNAL ERROR: "+m.apply(void 0,(0,a.__spreadArray)([],(0,a.__read)(t)));v.error(n)},S=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE FATAL ERROR: "+m.apply(void 0,(0,a.__spreadArray)([],(0,a.__read)(t)));throw v.error(n),new Error(n)},C=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE WARNING: "+m.apply(void 0,(0,a.__spreadArray)([],(0,a.__read)(t)));v.warn(n)},k=function(t){return"number"===typeof t&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},A="[MIN_NAME]",N="[MAX_NAME]",P=function(t,e){if(t===e)return 0;if(t===A||e===N)return-1;if(e===A||t===N)return 1;var n=q(t),r=q(e);return null!==n?null!==r?n-r===0?t.length-e.length:n-r:-1:null!==r?1:t<e?-1:1},R=function(t,e){return t===e?0:t<e?-1:1},D=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+(0,o.stringify)(e))},x=function t(e){if("object"!==typeof e||null===e)return(0,o.stringify)(e);var n=[];for(var r in e)n.push(r);n.sort();for(var i="{",a=0;a<n.length;a++)0!==a&&(i+=","),i+=(0,o.stringify)(n[a]),i+=":",i+=t(e[n[a]]);return i+="}"},O=function(t,e){var n=t.length;if(n<=e)return[t];for(var r=[],i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function L(t,e){for(var n in t)t.hasOwnProperty(n)&&e(n,t[n])}var M=function(t){(0,o.assert)(!k(t),"Invalid JSON number");var e,n,r,i,a,s=1023;0===t?(n=0,r=0,e=1/t===-1/0?1:0):(e=t<0,(t=Math.abs(t))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(t)/Math.LN2),s))+s,r=Math.round(t*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(t/Math.pow(2,-1074))));var u=[];for(a=52;a;a-=1)u.push(r%2?1:0),r=Math.floor(r/2);for(a=11;a;a-=1)u.push(n%2?1:0),n=Math.floor(n/2);u.push(e?1:0),u.reverse();var c=u.join(""),h="";for(a=0;a<64;a+=8){var l=parseInt(c.substr(a,8),2).toString(16);1===l.length&&(l="0"+l),h+=l}return h.toLowerCase()};var F=new RegExp("^-?(0*)\\d{1,10}$"),U=-2147483648,j=2147483647,q=function(t){if(F.test(t)){var e=Number(t);if(e>=U&&e<=j)return e}return null},V=function(t){try{t()}catch(e){setTimeout((function(){var t=e.stack||"";throw C("Exception was thrown by user callback.",t),e}),Math.floor(0))}},B=function(t,e){var n=setTimeout(t,e);return"object"===typeof n&&n.unref&&n.unref(),n},K=function(){function t(t,e){var n=this;this.appName_=t,this.appCheckProvider=e,this.appCheck=null===e||void 0===e?void 0:e.getImmediate({optional:!0}),this.appCheck||null===e||void 0===e||e.get().then((function(t){return n.appCheck=t}))}return t.prototype.getToken=function(t){var e=this;return this.appCheck?this.appCheck.getToken(t):new Promise((function(n,r){setTimeout((function(){e.appCheck?e.getToken(t).then(n,r):n(null)}),0)}))},t.prototype.addTokenChangeListener=function(t){var e;null===(e=this.appCheckProvider)||void 0===e||e.get().then((function(e){return e.addTokenListener(t)}))},t.prototype.notifyForInvalidToken=function(){C('Provided AppCheck credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly.')},t}(),W=function(){function t(t,e,n){var r=this;this.appName_=t,this.firebaseOptions_=e,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((function(t){return r.auth_=t}))}return t.prototype.getToken=function(t){var e=this;return this.auth_?this.auth_.getToken(t).catch((function(t){return t&&"auth/token-not-initialized"===t.code?(I("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)})):new Promise((function(n,r){setTimeout((function(){e.auth_?e.getToken(t).then(n,r):n(null)}),0)}))},t.prototype.addTokenChangeListener=function(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then((function(e){return e.addAuthTokenListener(t)}))},t.prototype.removeTokenChangeListener=function(t){this.authProvider_.get().then((function(e){return e.removeAuthTokenListener(t)}))},t.prototype.notifyForInvalidToken=function(){var t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',C(t)},t}(),H=function(){function t(t){this.accessToken=t}return t.prototype.getToken=function(t){return Promise.resolve({accessToken:this.accessToken})},t.prototype.addTokenChangeListener=function(t){t(this.accessToken)},t.prototype.removeTokenChangeListener=function(t){},t.prototype.notifyForInvalidToken=function(){},t.OWNER="owner",t}(),G="5",z=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Q="ac",Y="websocket",X="long_polling",$=function(){function t(t,e,n,r,i,o,a){void 0===i&&(i=!1),void 0===o&&(o=""),void 0===a&&(a=!1),this.secure=e,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=d.get("host:"+t)||this._host}return t.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},t.prototype.isCustomHost=function(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain},Object.defineProperty(t.prototype,"host",{get:function(){return this._host},set:function(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&d.set("host:"+this._host,this.internalHost))},enumerable:!1,configurable:!0}),t.prototype.toString=function(){var t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t},t.prototype.toURLString=function(){var t=this.secure?"https://":"http://",e=this.includeNamespaceInQueryParams?"?ns="+this.namespace:"";return""+t+this.host+"/"+e},t}();function J(t,e,n){var r;if((0,o.assert)("string"===typeof e,"typeof type must == string"),(0,o.assert)("object"===typeof n,"typeof params must == object"),e===Y)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else{if(e!==X)throw new Error("Unknown connection type: "+e);r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?"}(function(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams})(t)&&(n.ns=t.namespace);var i=[];return L(n,(function(t,e){i.push(t+"="+e)})),r+i.join("&")}var Z=function(){function t(){this.counters_={}}return t.prototype.incrementCounter=function(t,e){void 0===e&&(e=1),(0,o.contains)(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e},t.prototype.get=function(){return(0,o.deepCopy)(this.counters_)},t}(),tt={},et={};function nt(t){var e=t.toString();return tt[e]||(tt[e]=new Z),tt[e]}var rt=function(){function t(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return t.prototype.closeAfter=function(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},t.prototype.handleResponse=function(t,e){var n=this;this.pendingResponses[t]=e;for(var r=function(){var t=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var e=function(e){t[e]&&V((function(){n.onMessage_(t[e])}))},r=0;r<t.length;++r)e(r);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++},i=this;this.pendingResponses[this.currentResponseNum];){if("break"===r())break}},t}(),it="start",ot="close",at=function(){function t(t,e,n,r,i,o,a){var s=this;this.connId=t,this.repoInfo=e,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=T(t),this.stats_=nt(e),this.urlFn=function(t){return s.appCheckToken&&(t[Q]=s.appCheckToken),J(e,X,t)}}return t.prototype.open=function(t,e){var n=this;this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new rt(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null}),Math.floor(3e4)),function(t){if((0,o.isNodeSdk)()||"complete"===document.readyState)t();else{var e=!1,n=function n(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((function(){if(!n.isClosed_){n.scriptTagHolder=new st((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=(0,a.__read)(t,5),i=r[0],o=r[1],s=r[2];if(r[3],r[4],n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,i===it)n.id=o,n.password=s;else{if(i!==ot)throw new Error("Unrecognized command received: "+i);o?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(o,(function(){n.onClosed_()}))):n.onClosed_()}}),(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=(0,a.__read)(t,2),i=r[0],o=r[1];n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(i,o)}),(function(){n.onClosed_()}),n.urlFn);var t={};t[it]="t",t.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(t.cb=n.scriptTagHolder.uniqueCallbackIdentifier),t.v=G,n.transportSessionId&&(t.s=n.transportSessionId),n.lastSessionId&&(t.ls=n.lastSessionId),n.applicationId&&(t.p=n.applicationId),n.appCheckToken&&(t[Q]=n.appCheckToken),"undefined"!==typeof location&&location.hostname&&z.test(location.hostname)&&(t.r="f");var e=n.urlFn(t);n.log_("Connecting via long-poll to "+e),n.scriptTagHolder.addTag(e,(function(){}))}}))},t.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},t.forceAllow=function(){t.forceAllow_=!0},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){return!(0,o.isNodeSdk)()&&(!!t.forceAllow_||!t.forceDisallow_&&"undefined"!==typeof document&&null!=document.createElement&&!("object"===typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&!("object"===typeof Windows&&"object"===typeof Windows.UI))},t.prototype.markConnectionHealthy=function(){},t.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},t.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},t.prototype.send=function(t){var e=(0,o.stringify)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);for(var n=(0,o.base64Encode)(e),r=O(n,1840),i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++},t.prototype.addDisconnectPingFrame=function(t,e){if(!(0,o.isNodeSdk)()){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=t,n.pw=e,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},t.prototype.incrementIncomingBytes_=function(t){var e=(0,o.stringify)(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)},t}(),st=function(){function t(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,o.isNodeSdk)())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=g(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();var a="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length))a='<script>document.domain="'+document.domain+'";<\/script>';var s="<html><body>"+a+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(s),this.myIFrame.doc.close()}catch(u){I("frame writing exception"),u.stack&&I(u.stack),I(u)}}}return t.createIFrame_=function(){var t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||I("No IE domain setting required")}catch(n){var e=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+e+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t},t.prototype.close=function(){var t=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((function(){null!==t.myIFrame&&(document.body.removeChild(t.myIFrame),t.myIFrame=null)}),Math.floor(0)));var e=this.onDisconnect;e&&(this.onDisconnect=null,e())},t.prototype.startLongPoll=function(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););},t.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var t={};t.id=this.myID,t.pw=this.myPW,t.ser=this.currentSerial;for(var e=this.urlFn(t),n="",r=0;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return e+=n,this.addLongPollTag_(e,this.currentSerial),!0}return!1},t.prototype.enqueueSegment=function(t,e,n){this.pendingSegs.push({seg:t,ts:e,d:n}),this.alive&&this.newRequest_()},t.prototype.addLongPollTag_=function(t,e){var n=this;this.outstandingRequests.add(e);var r=function(){n.outstandingRequests.delete(e),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(t,(function(){clearTimeout(i),r()}))},t.prototype.addTag=function(t,e){var n=this;(0,o.isNodeSdk)()?this.doNodeLongPoll(t,e):setTimeout((function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=t,r.onload=r.onreadystatechange=function(){var t=r.readyState;t&&"loaded"!==t&&"complete"!==t||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),e())},r.onerror=function(){I("Long-poll script failed to load: "+t),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(i){}}),Math.floor(1))},t}(),ut=null;"undefined"!==typeof MozWebSocket?ut=MozWebSocket:"undefined"!==typeof WebSocket&&(ut=WebSocket);var ct=function(){function t(e,n,r,i,o,a,s){this.connId=e,this.applicationId=r,this.appCheckToken=i,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=T(this.connId),this.stats_=nt(n),this.connURL=t.connectionURL_(n,a,s,i),this.nodeAdmin=n.nodeAdmin}return t.connectionURL_=function(t,e,n,r){var i={};return i.v=G,!(0,o.isNodeSdk)()&&"undefined"!==typeof location&&location.hostname&&z.test(location.hostname)&&(i.r="f"),e&&(i.s=e),n&&(i.ls=n),r&&(i[Q]=r),J(t,Y,i)},t.prototype.open=function(t,e){var n=this;this.onDisconnect=e,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,d.set("previous_websocket_failure",!0);try{if((0,o.isNodeSdk)()){var r=this.nodeAdmin?"AdminNode":"Node",i={headers:{"User-Agent":"Firebase/5/"+u+"/"+process.platform+"/"+r,"X-Firebase-GMPID":this.applicationId||""}};this.authToken&&(i.headers.Authorization="Bearer "+this.authToken),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);var a={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0},s=0===this.connURL.indexOf("wss://")?a.HTTPS_PROXY||a.https_proxy:a.HTTP_PROXY||a.http_proxy;s&&(i.proxy={origin:s}),this.mySock=new ut(this.connURL,[],i)}else{i={headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}};this.mySock=new ut(this.connURL,[],i)}}catch(h){this.log_("Error instantiating WebSocket.");var c=h.message||h.data;return c&&this.log_(c),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(t){n.handleIncomingFrame(t)},this.mySock.onerror=function(t){n.log_("WebSocket error.  Closing connection.");var e=t.message||t.data;e&&n.log_(e),n.onClosed_()}},t.prototype.start=function(){},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){var e=!1;if("undefined"!==typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==ut&&!t.forceDisallow_},t.previouslyFailed=function(){return d.isInMemoryStorage||!0===d.get("previous_websocket_failure")},t.prototype.markConnectionHealthy=function(){d.remove("previous_websocket_failure")},t.prototype.appendFrame_=function(t){if(this.frames.push(t),this.frames.length===this.totalFrames){var e=this.frames.join("");this.frames=null;var n=(0,o.jsonEval)(e);this.onMessage(n)}},t.prototype.handleNewFrameCount_=function(t){this.totalFrames=t,this.frames=[]},t.prototype.extractFrameCount_=function(t){if((0,o.assert)(null===this.frames,"We already have a frame buffer"),t.length<=6){var e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t},t.prototype.handleIncomingFrame=function(t){if(null!==this.mySock){var e=t.data;if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(e);else{var n=this.extractFrameCount_(e);null!==n&&this.appendFrame_(n)}}},t.prototype.send=function(t){this.resetKeepAlive();var e=(0,o.stringify)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);var n=O(e,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])},t.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},t.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},t.prototype.resetKeepAlive=function(){var t=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((function(){t.mySock&&t.sendString_("0"),t.resetKeepAlive()}),Math.floor(45e3))},t.prototype.sendString_=function(t){try{this.mySock.send(t)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t}(),ht=function(){function t(t){this.initTransports_(t)}return Object.defineProperty(t,"ALL_TRANSPORTS",{get:function(){return[at,ct]},enumerable:!1,configurable:!0}),t.prototype.initTransports_=function(e){var n,r,i=ct&&ct.isAvailable(),o=i&&!ct.previouslyFailed();if(e.webSocketOnly&&(i||C("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),o=!0),o)this.transports_=[ct];else{var s=this.transports_=[];try{for(var u=(0,a.__values)(t.ALL_TRANSPORTS),c=u.next();!c.done;c=u.next()){var h=c.value;h&&h.isAvailable()&&s.push(h)}}catch(l){n={error:l}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}},t.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},t.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},t}(),lt=function(){function t(t,e,n,r,i,o,a,s,u,c){this.id=t,this.repoInfo_=e,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=s,this.onKill_=u,this.lastSessionId=c,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=T("c:"+this.id+":"),this.transportManager_=new ht(e),this.log_("Connection created"),this.start_()}return t.prototype.start_=function(){var t=this,e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((function(){t.conn_&&t.conn_.open(n,r)}),Math.floor(0));var i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=B((function(){t.healthyTimeout_=null,t.isHealthy_||(t.conn_&&t.conn_.bytesReceived>102400?(t.log_("Connection exceeded healthy timeout but has received "+t.conn_.bytesReceived+" bytes.  Marking connection healthy."),t.isHealthy_=!0,t.conn_.markConnectionHealthy()):t.conn_&&t.conn_.bytesSent>10240?t.log_("Connection exceeded healthy timeout but has sent "+t.conn_.bytesSent+" bytes.  Leaving connection alive."):(t.log_("Closing unhealthy connection after timeout."),t.close()))}),Math.floor(i)))},t.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},t.prototype.disconnReceiver_=function(t){var e=this;return function(n){t===e.conn_?e.onConnectionLost_(n):t===e.secondaryConn_?(e.log_("Secondary connection lost."),e.onSecondaryConnectionLost_()):e.log_("closing an old connection")}},t.prototype.connReceiver_=function(t){var e=this;return function(n){2!==e.state_&&(t===e.rx_?e.onPrimaryMessageReceived_(n):t===e.secondaryConn_?e.onSecondaryMessageReceived_(n):e.log_("message on old connection"))}},t.prototype.sendRequest=function(t){var e={t:"d",d:t};this.sendData_(e)},t.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},t.prototype.onSecondaryControl_=function(t){if("t"in t){var e=t.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},t.prototype.onSecondaryMessageReceived_=function(t){var e=D("t",t),n=D("d",t);if("c"===e)this.onSecondaryControl_(n);else{if("d"!==e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(n)}},t.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},t.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},t.prototype.onPrimaryMessageReceived_=function(t){var e=D("t",t),n=D("d",t);"c"===e?this.onControl_(n):"d"===e&&this.onDataMessage_(n)},t.prototype.onDataMessage_=function(t){this.onPrimaryResponse_(),this.onMessage_(t)},t.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},t.prototype.onControl_=function(t){var e=D("t",t);if("d"in t){var n=t.d;if("h"===e)this.onHandshake_(n);else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(n):"r"===e?this.onReset_(n):"e"===e?E("Server Error: "+n):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):E("Unknown control packet command: "+e)}},t.prototype.onHandshake_=function(t){var e=t.ts,n=t.v,r=t.h;this.sessionId=t.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),G!==n&&C("Protocol version mismatch detected"),this.tryStartUpgrade_())},t.prototype.tryStartUpgrade_=function(){var t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)},t.prototype.startUpgrade_=function(t){var e=this;this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),B((function(){e.secondaryConn_&&(e.log_("Timed out trying to upgrade."),e.secondaryConn_.close())}),Math.floor(6e4))},t.prototype.onReset_=function(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,1===this.state_?this.close():(this.closeConnections_(),this.start_())},t.prototype.onConnectionEstablished_=function(t,e){var n=this;this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):B((function(){n.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))},t.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},t.prototype.onSecondaryConnectionLost_=function(){var t=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==t&&this.rx_!==t||this.close()},t.prototype.onConnectionLost_=function(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(d.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},t.prototype.onConnectionShutdown_=function(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()},t.prototype.sendData_=function(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)},t.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},t.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},t}(),ft=function(){function t(){}return t.prototype.put=function(t,e,n,r){},t.prototype.merge=function(t,e,n,r){},t.prototype.refreshAuthToken=function(t){},t.prototype.refreshAppCheckToken=function(t){},t.prototype.onDisconnectPut=function(t,e,n){},t.prototype.onDisconnectMerge=function(t,e,n){},t.prototype.onDisconnectCancel=function(t,e){},t.prototype.reportStats=function(t){},t}(),dt=function(){function t(t){this.allowedEvents_=t,this.listeners_={},(0,o.assert)(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Array.isArray(this.listeners_[t]))for(var r=(0,a.__spreadArray)([],(0,a.__read)(this.listeners_[t])),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,e)},t.prototype.on=function(t,e,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:n});var r=this.getInitialEvent(t);r&&e.apply(n,r)},t.prototype.off=function(t,e,n){this.validateEventType_(t);for(var r=this.listeners_[t]||[],i=0;i<r.length;i++)if(r[i].callback===e&&(!n||n===r[i].context))return void r.splice(i,1)},t.prototype.validateEventType_=function(t){(0,o.assert)(this.allowedEvents_.find((function(e){return e===t})),"Unknown event: "+t)},t}(),pt=function(t){function e(){var e=t.call(this,["online"])||this;return e.online_=!0,"undefined"===typeof window||"undefined"===typeof window.addEventListener||(0,o.isMobileCordova)()||(window.addEventListener("online",(function(){e.online_||(e.online_=!0,e.trigger("online",!0))}),!1),window.addEventListener("offline",(function(){e.online_&&(e.online_=!1,e.trigger("online",!1))}),!1)),e}return(0,a.__extends)(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return(0,o.assert)("online"===t,"Unknown event type: "+t),[this.online_]},e.prototype.currentlyOnline=function(){return this.online_},e}(dt),vt=function(){function t(t,e){if(void 0===e){this.pieces_=t.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}return t.prototype.toString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"},t}();function gt(){return new vt("")}function yt(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function mt(t){return t.pieces_.length-t.pieceNum_}function _t(t){var e=t.pieceNum_;return e<t.pieces_.length&&e++,new vt(t.pieces_,e)}function bt(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function wt(t,e){return void 0===e&&(e=0),t.pieces_.slice(t.pieceNum_+e)}function It(t){if(t.pieceNum_>=t.pieces_.length)return null;for(var e=[],n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new vt(e,0)}function Tt(t,e){for(var n=[],r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof vt)for(r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{var i=e.split("/");for(r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new vt(n,0)}function Et(t){return t.pieceNum_>=t.pieces_.length}function St(t,e){var n=yt(t),r=yt(e);if(null===n)return e;if(n===r)return St(_t(t),_t(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function Ct(t,e){for(var n=wt(t,0),r=wt(e,0),i=0;i<n.length&&i<r.length;i++){var o=P(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1}function kt(t,e){if(mt(t)!==mt(e))return!1;for(var n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function At(t,e){var n=t.pieceNum_,r=e.pieceNum_;if(mt(t)>mt(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}var Nt=function(t,e){this.errorPrefix_=e,this.parts_=wt(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=(0,o.stringLength)(this.parts_[n]);Pt(this)};function Pt(t){if(t.byteLength_>768)throw new Error(t.errorPrefix_+"has a key path longer than 768 bytes ("+t.byteLength_+").");if(t.parts_.length>32)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Rt(t))}function Rt(t){return 0===t.parts_.length?"":"in property '"+t.parts_.join(".")+"'"}var Dt,xt,Ot=function(t){function e(){var e,n,r=t.call(this,["visible"])||this;return"undefined"!==typeof document&&"undefined"!==typeof document.addEventListener&&("undefined"!==typeof document.hidden?(n="visibilitychange",e="hidden"):"undefined"!==typeof document.mozHidden?(n="mozvisibilitychange",e="mozHidden"):"undefined"!==typeof document.msHidden?(n="msvisibilitychange",e="msHidden"):"undefined"!==typeof document.webkitHidden&&(n="webkitvisibilitychange",e="webkitHidden")),r.visible_=!0,n&&document.addEventListener(n,(function(){var t=!document[e];t!==r.visible_&&(r.visible_=t,r.trigger("visible",t))}),!1),r}return(0,a.__extends)(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return(0,o.assert)("visible"===t,"Unknown event type: "+t),[this.visible_]},e}(dt),Lt=1e3,Mt=function(t){function e(n,r,i,a,s,u,c,h){var l=t.call(this)||this;if(l.repoInfo_=n,l.applicationId_=r,l.onDataUpdate_=i,l.onConnectStatus_=a,l.onServerInfoUpdate_=s,l.authTokenProvider_=u,l.appCheckTokenProvider_=c,l.authOverride_=h,l.id=e.nextPersistentConnectionId_++,l.log_=T("p:"+l.id+":"),l.interruptReasons_={},l.listens=new Map,l.outstandingPuts_=[],l.outstandingGets_=[],l.outstandingPutCount_=0,l.outstandingGetCount_=0,l.onDisconnectRequestQueue_=[],l.connected_=!1,l.reconnectDelay_=Lt,l.maxReconnectDelay_=3e5,l.securityDebugCallback_=null,l.lastSessionId=null,l.establishConnectionTimer_=null,l.visible_=!1,l.requestCBHash_={},l.requestNumber_=0,l.realtime_=null,l.authToken_=null,l.appCheckToken_=null,l.forceTokenRefresh_=!1,l.invalidAuthTokenCount_=0,l.invalidAppCheckTokenCount_=0,l.firstConnection_=!0,l.lastConnectionAttemptTime_=null,l.lastConnectionEstablishedTime_=null,h&&!(0,o.isNodeSdk)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return Ot.getInstance().on("visible",l.onVisible_,l),-1===n.host.indexOf("fblocal")&&pt.getInstance().on("online",l.onOnline_,l),l}return(0,a.__extends)(e,t),e.prototype.sendRequest=function(t,e,n){var r=++this.requestNumber_,i={r:r,a:t,b:e};this.log_((0,o.stringify)(i)),(0,o.assert)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)},e.prototype.get=function(t){var e=this;this.initConnection_();var n=new o.Deferred,r={p:t._path.toString(),q:t._queryObject},i={action:"g",request:r,onComplete:function(t){var i=t.d;"ok"===t.s?(e.onDataUpdate_(r.p,i,!1,null),n.resolve(i)):n.reject(i)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;var a=this.outstandingGets_.length-1;return this.connected_||setTimeout((function(){var t=e.outstandingGets_[a];void 0!==t&&i===t&&(delete e.outstandingGets_[a],e.outstandingGetCount_--,0===e.outstandingGetCount_&&(e.outstandingGets_=[]),e.log_("get "+a+" timed out on connection"),n.reject(new Error("Client is offline.")))}),3e3),this.connected_&&this.sendGet_(a),n.promise},e.prototype.listen=function(t,e,n,r){this.initConnection_();var i=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+i),this.listens.has(a)||this.listens.set(a,new Map),(0,o.assert)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,o.assert)(!this.listens.get(a).has(i),"listen() called twice for same path/queryId.");var s={onComplete:r,hashFn:e,query:t,tag:n};this.listens.get(a).set(i,s),this.connected_&&this.sendListen_(s)},e.prototype.sendGet_=function(t){var e=this,n=this.outstandingGets_[t];this.sendRequest("g",n.request,(function(r){delete e.outstandingGets_[t],e.outstandingGetCount_--,0===e.outstandingGetCount_&&(e.outstandingGets_=[]),n.onComplete&&n.onComplete(r)}))},e.prototype.sendListen_=function(t){var n=this,r=t.query,i=r._path.toString(),o=r._queryIdentifier;this.log_("Listen on "+i+" for "+o);var a={p:i};t.tag&&(a.q=r._queryObject,a.t=t.tag),a.h=t.hashFn(),this.sendRequest("q",a,(function(a){var s=a.d,u=a.s;e.warnOnListenWarnings_(s,r),(n.listens.get(i)&&n.listens.get(i).get(o))===t&&(n.log_("listen response",a),"ok"!==u&&n.removeListen_(i,o),t.onComplete&&t.onComplete(u,s))}))},e.warnOnListenWarnings_=function(t,e){if(t&&"object"===typeof t&&(0,o.contains)(t,"w")){var n=(0,o.safeGet)(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+e._queryParams.getIndex().toString()+'"',i=e._path.toString();C("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+i+" to your security rules for better performance.")}}},e.prototype.refreshAuthToken=function(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(function(){})),this.reduceReconnectDelayIfAdminCredential_(t)},e.prototype.reduceReconnectDelayIfAdminCredential_=function(t){(t&&40===t.length||(0,o.isAdmin)(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},e.prototype.refreshAppCheckToken=function(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(function(){}))},e.prototype.tryAuth=function(){var t=this;if(this.connected_&&this.authToken_){var e=this.authToken_,n=(0,o.isValidFormat)(e)?"auth":"gauth",r={cred:e};null===this.authOverride_?r.noauth=!0:"object"===typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(n,r,(function(n){var r=n.s,i=n.d||"error";t.authToken_===e&&("ok"===r?t.invalidAuthTokenCount_=0:t.onAuthRevoked_(r,i))}))}},e.prototype.tryAppCheck=function(){var t=this;this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(function(e){var n=e.s,r=e.d||"error";"ok"===n?t.invalidAppCheckTokenCount_=0:t.onAppCheckRevoked_(n,r)}))},e.prototype.unlisten=function(t,e){var n=t._path.toString(),r=t._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),(0,o.assert)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,t._queryObject,e)},e.prototype.sendUnlisten_=function(t,e,n,r){this.log_("Unlisten on "+t+" for "+e);var i={p:t};r&&(i.q=n,i.t=r),this.sendRequest("n",i)},e.prototype.onDisconnectPut=function(t,e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:n})},e.prototype.onDisconnectMerge=function(t,e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:n})},e.prototype.onDisconnectCancel=function(t,e){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})},e.prototype.sendOnDisconnect_=function(t,e,n,r){var i={p:e,d:n};this.log_("onDisconnect "+t,i),this.sendRequest(t,i,(function(t){r&&setTimeout((function(){r(t.s,t.d)}),Math.floor(0))}))},e.prototype.put=function(t,e,n,r){this.putInternal("p",t,e,n,r)},e.prototype.merge=function(t,e,n,r){this.putInternal("m",t,e,n,r)},e.prototype.putInternal=function(t,e,n,r,i){this.initConnection_();var o={p:e,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:t,request:o,onComplete:r}),this.outstandingPutCount_++;var a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+e)},e.prototype.sendPut_=function(t){var e=this,n=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,i=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(n,r,(function(r){e.log_(n+" response",r),delete e.outstandingPuts_[t],e.outstandingPutCount_--,0===e.outstandingPutCount_&&(e.outstandingPuts_=[]),i&&i(r.s,r.d)}))},e.prototype.reportStats=function(t){var e=this;if(this.connected_){var n={c:t};this.log_("reportStats",n),this.sendRequest("s",n,(function(t){if("ok"!==t.s){var n=t.d;e.log_("reportStats","Error sending stats: "+n)}}))}},e.prototype.onDataMessage_=function(t){if("r"in t){this.log_("from server: "+(0,o.stringify)(t));var e=t.r,n=this.requestCBHash_[e];n&&(delete this.requestCBHash_[e],n(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}},e.prototype.onDataPush_=function(t,e){this.log_("handleServerMessage",t,e),"d"===t?this.onDataUpdate_(e.p,e.d,!1,e.t):"m"===t?this.onDataUpdate_(e.p,e.d,!0,e.t):"c"===t?this.onListenRevoked_(e.p,e.q):"ac"===t?this.onAuthRevoked_(e.s,e.d):"apc"===t?this.onAppCheckRevoked_(e.s,e.d):"sd"===t?this.onSecurityDebugPacket_(e):E("Unrecognized action received from server: "+(0,o.stringify)(t)+"\nAre you using the latest client?")},e.prototype.onReady_=function(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},e.prototype.scheduleConnect_=function(t){var e=this;(0,o.assert)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((function(){e.establishConnectionTimer_=null,e.establishConnection_()}),Math.floor(t))},e.prototype.initConnection_=function(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)},e.prototype.onVisible_=function(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Lt,this.realtime_||this.scheduleConnect_(0)),this.visible_=t},e.prototype.onOnline_=function(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Lt,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},e.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Lt),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();var t=(new Date).getTime()-this.lastConnectionAttemptTime_,e=Math.max(0,this.reconnectDelay_-t);e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},e.prototype.establishConnection_=function(){return(0,a.__awaiter)(this,void 0,void 0,(function(){var t,n,r,i,s,u,c,h,l,f,d,p,v,g,y=this;return(0,a.__generator)(this,(function(m){switch(m.label){case 0:if(!this.shouldReconnect_())return[3,4];this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null,t=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+e.nextConnectionId_++,s=this.lastSessionId,u=!1,c=null,h=function(){c?c.close():(u=!0,r())},l=function(t){(0,o.assert)(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(t)},this.realtime_={close:h,sendRequest:l},f=this.forceTokenRefresh_,this.forceTokenRefresh_=!1,m.label=1;case 1:return m.trys.push([1,3,,4]),[4,Promise.all([this.authTokenProvider_.getToken(f),this.appCheckTokenProvider_.getToken(f)])];case 2:return d=a.__read.apply(void 0,[m.sent(),2]),p=d[0],v=d[1],u?I("getToken() completed but was canceled"):(I("getToken() completed. Creating connection."),this.authToken_=p&&p.accessToken,this.appCheckToken_=v&&v.token,c=new lt(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,n,r,(function(t){C(t+" ("+y.repoInfo_.toString()+")"),y.interrupt("server_kill")}),s)),[3,4];case 3:return g=m.sent(),this.log_("Failed to get token: "+g),u||(this.repoInfo_.nodeAdmin&&C(g),h()),[3,4];case 4:return[2]}}))}))},e.prototype.interrupt=function(t){I("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},e.prototype.resume=function(t){I("Resuming connection for reason: "+t),delete this.interruptReasons_[t],(0,o.isEmpty)(this.interruptReasons_)&&(this.reconnectDelay_=Lt,this.realtime_||this.scheduleConnect_(0))},e.prototype.handleTimestamp_=function(t){var e=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:e})},e.prototype.cancelSentTransactions_=function(){for(var t=0;t<this.outstandingPuts_.length;t++){var e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},e.prototype.onListenRevoked_=function(t,e){var n;n=e?e.map((function(t){return x(t)})).join("$"):"default";var r=this.removeListen_(t,n);r&&r.onComplete&&r.onComplete("permission_denied")},e.prototype.removeListen_=function(t,e){var n,r=new vt(t).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(e),i.delete(e),0===i.size&&this.listens.delete(r)}else n=void 0;return n},e.prototype.onAuthRevoked_=function(t,e){I("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},e.prototype.onAppCheckRevoked_=function(t,e){I("App check token revoked: "+t+"/"+e),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())},e.prototype.onSecurityDebugPacket_=function(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))},e.prototype.restoreState_=function(){var t,e,n,r;this.tryAuth(),this.tryAppCheck();try{for(var i=(0,a.__values)(this.listens.values()),o=i.next();!o.done;o=i.next()){var s=o.value;try{for(var u=(n=void 0,(0,a.__values)(s.values())),c=u.next();!c.done;c=u.next()){var h=c.value;this.sendListen_(h)}}catch(d){n={error:d}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}}catch(p){t={error:p}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}for(var l=0;l<this.outstandingPuts_.length;l++)this.outstandingPuts_[l]&&this.sendPut_(l);for(;this.onDisconnectRequestQueue_.length;){var f=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(f.action,f.pathString,f.data,f.onComplete)}for(l=0;l<this.outstandingGets_.length;l++)this.outstandingGets_[l]&&this.sendGet_(l)},e.prototype.sendConnectStats_=function(){var t={},e="js";(0,o.isNodeSdk)()&&(e=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+e+"."+u.replace(/\./g,"-")]=1,(0,o.isMobileCordova)()?t["framework.cordova"]=1:(0,o.isReactNative)()&&(t["framework.reactnative"]=1),this.reportStats(t)},e.prototype.shouldReconnect_=function(){var t=pt.getInstance().currentlyOnline();return(0,o.isEmpty)(this.interruptReasons_)&&t},e.nextPersistentConnectionId_=0,e.nextConnectionId_=0,e}(ft),Ft=function(){function t(t,e){this.name=t,this.node=e}return t.Wrap=function(e,n){return new t(e,n)},t}(),Ut=function(){function t(){}return t.prototype.getCompare=function(){return this.compare.bind(this)},t.prototype.indexedValueChanged=function(t,e){var n=new Ft(A,t),r=new Ft(A,e);return 0!==this.compare(n,r)},t.prototype.minPost=function(){return Ft.MIN},t}(),jt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,a.__extends)(e,t),Object.defineProperty(e,"__EMPTY_NODE",{get:function(){return Dt},set:function(t){Dt=t},enumerable:!1,configurable:!0}),e.prototype.compare=function(t,e){return P(t.name,e.name)},e.prototype.isDefinedOn=function(t){throw(0,o.assertionError)("KeyIndex.isDefinedOn not expected to be called.")},e.prototype.indexedValueChanged=function(t,e){return!1},e.prototype.minPost=function(){return Ft.MIN},e.prototype.maxPost=function(){return new Ft(N,Dt)},e.prototype.makePost=function(t,e){return(0,o.assert)("string"===typeof t,"KeyIndex indexValue must always be a string."),new Ft(t,Dt)},e.prototype.toString=function(){return".key"},e}(Ut),qt=new jt,Vt=function(){function t(t,e,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!t.isEmpty();)if(o=e?n(t.key,e):1,r&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return t.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t},t.prototype.hasNext=function(){return this.nodeStack_.length>0},t.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}},t}(),Bt=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:Wt.EMPTY_NODE,this.right=null!=o?o:Wt.EMPTY_NODE}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.count=function(){return this.left.count()+1+this.right.count()},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},t.prototype.minKey=function(){return this.min_().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp_()},t.prototype.removeMin_=function(){if(this.left.isEmpty())return Wt.EMPTY_NODE;var t=this;return t.left.isRed_()||t.left.left.isRed_()||(t=t.moveRedLeft_()),(t=t.copy(null,null,null,t.left.removeMin_(),null)).fixUp_()},t.prototype.remove=function(t,e){var n,r;if(e(t,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===e(t,n.key)){if(n.right.isEmpty())return Wt.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.fixUp_()},t.prototype.isRed_=function(){return this.color},t.prototype.fixUp_=function(){var t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t},t.prototype.moveRedLeft_=function(){var t=this.colorFlip_();return t.right.left.isRed_()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight_())).rotateLeft_()).colorFlip_()),t},t.prototype.moveRedRight_=function(){var t=this.colorFlip_();return t.left.left.isRed_()&&(t=(t=t.rotateRight_()).colorFlip_()),t},t.prototype.rotateLeft_=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight_=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip_=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth_=function(){var t=this.check_();return Math.pow(2,t)<=this.count()+1},t.prototype.check_=function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)},t.RED=!0,t.BLACK=!1,t}(),Kt=function(){function t(){}return t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new Bt(t,e,null)},t.prototype.remove=function(t,e){return this},t.prototype.count=function(){return 0},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.check_=function(){return 0},t.prototype.isRed_=function(){return!1},t}(),Wt=function(){function t(e,n){void 0===n&&(n=t.EMPTY_NODE),this.comparator_=e,this.root_=n}return t.prototype.insert=function(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Bt.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Bt.BLACK,null,null))},t.prototype.get=function(t){for(var e,n=this.root_;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key)))return n.value;e<0?n=n.left:e>0&&(n=n.right)}return null},t.prototype.getPredecessorKey=function(t){for(var e,n=this.root_,r=null;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}e<0?n=n.left:e>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},t.prototype.isEmpty=function(){return this.root_.isEmpty()},t.prototype.count=function(){return this.root_.count()},t.prototype.minKey=function(){return this.root_.minKey()},t.prototype.maxKey=function(){return this.root_.maxKey()},t.prototype.inorderTraversal=function(t){return this.root_.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.root_.reverseTraversal(t)},t.prototype.getIterator=function(t){return new Vt(this.root_,null,this.comparator_,!1,t)},t.prototype.getIteratorFrom=function(t,e){return new Vt(this.root_,t,this.comparator_,!1,e)},t.prototype.getReverseIteratorFrom=function(t,e){return new Vt(this.root_,t,this.comparator_,!0,e)},t.prototype.getReverseIterator=function(t){return new Vt(this.root_,null,this.comparator_,!0,t)},t.EMPTY_NODE=new Kt,t}();function Ht(t,e){return P(t.name,e.name)}function Gt(t,e){return P(t,e)}var zt,Qt,Yt,Xt=function(t){return"number"===typeof t?"number:"+M(t):"string:"+t},$t=function(t){if(t.isLeafNode()){var e=t.val();(0,o.assert)("string"===typeof e||"number"===typeof e||"object"===typeof e&&(0,o.contains)(e,".sv"),"Priority must be a string or number.")}else(0,o.assert)(t===xt||t.isEmpty(),"priority of unexpected type.");(0,o.assert)(t===xt||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},Jt=function(){function t(e,n){void 0===n&&(n=t.__childrenNodeConstructor.EMPTY_NODE),this.value_=e,this.priorityNode_=n,this.lazyHash_=null,(0,o.assert)(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),$t(this.priorityNode_)}return Object.defineProperty(t,"__childrenNodeConstructor",{get:function(){return zt},set:function(t){zt=t},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!0},t.prototype.getPriority=function(){return this.priorityNode_},t.prototype.updatePriority=function(e){return new t(this.value_,e)},t.prototype.getImmediateChild=function(e){return".priority"===e?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.getChild=function(e){return Et(e)?this:".priority"===yt(e)?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.hasChild=function(){return!1},t.prototype.getPredecessorChildName=function(t,e){return null},t.prototype.updateImmediateChild=function(e,n){return".priority"===e?this.updatePriority(n):n.isEmpty()&&".priority"!==e?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)},t.prototype.updateChild=function(e,n){var r=yt(e);return null===r?n:n.isEmpty()&&".priority"!==r?this:((0,o.assert)(".priority"!==r||1===mt(e),".priority must be the last token in a path"),this.updateImmediateChild(r,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(_t(e),n)))},t.prototype.isEmpty=function(){return!1},t.prototype.numChildren=function(){return 0},t.prototype.forEachChild=function(t,e){return!1},t.prototype.val=function(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.priorityNode_.isEmpty()||(t+="priority:"+Xt(this.priorityNode_.val())+":");var e=typeof this.value_;t+=e+":",t+="number"===e?M(this.value_):this.value_,this.lazyHash_=y(t)}return this.lazyHash_},t.prototype.getValue=function(){return this.value_},t.prototype.compareTo=function(e){return e===t.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof t.__childrenNodeConstructor?-1:((0,o.assert)(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))},t.prototype.compareToLeafNode_=function(e){var n=typeof e.value_,r=typeof this.value_,i=t.VALUE_TYPE_ORDER.indexOf(n),a=t.VALUE_TYPE_ORDER.indexOf(r);return(0,o.assert)(i>=0,"Unknown leaf type: "+n),(0,o.assert)(a>=0,"Unknown leaf type: "+r),i===a?"object"===r?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:a-i},t.prototype.withIndex=function(){return this},t.prototype.isIndexed=function(){return!0},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode()){var e=t;return this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)}return!1},t.VALUE_TYPE_ORDER=["object","boolean","number","string"],t}();var Zt,te,ee=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,a.__extends)(e,t),e.prototype.compare=function(t,e){var n=t.node.getPriority(),r=e.node.getPriority(),i=n.compareTo(r);return 0===i?P(t.name,e.name):i},e.prototype.isDefinedOn=function(t){return!t.getPriority().isEmpty()},e.prototype.indexedValueChanged=function(t,e){return!t.getPriority().equals(e.getPriority())},e.prototype.minPost=function(){return Ft.MIN},e.prototype.maxPost=function(){return new Ft(N,new Jt("[PRIORITY-POST]",Yt))},e.prototype.makePost=function(t,e){var n=Qt(t);return new Ft(e,new Jt("[PRIORITY-POST]",n))},e.prototype.toString=function(){return".priority"},e}(Ut),ne=new ee,re=Math.log(2),ie=function(){function t(t){var e;this.count=(e=t+1,parseInt(Math.log(e)/re,10)),this.current_=this.count-1;var n,r=(n=this.count,parseInt(Array(n+1).join("1"),2));this.bits_=t+1&r}return t.prototype.nextBitIsOne=function(){var t=!(this.bits_&1<<this.current_);return this.current_--,t},t}(),oe=function(t,e,n,r){t.sort(e);var i=function e(r,i){var o,a,s=i-r;if(0===s)return null;if(1===s)return o=t[r],a=n?n(o):o,new Bt(a,o.node,Bt.BLACK,null,null);var u=parseInt(s/2,10)+r,c=e(r,u),h=e(u+1,i);return o=t[u],a=n?n(o):o,new Bt(a,o.node,Bt.BLACK,c,h)},o=function(e){for(var r=null,o=null,a=t.length,s=function(e,r){var o=a-e,s=a;a-=e;var c=i(o+1,s),h=t[o],l=n?n(h):h;u(new Bt(l,h.node,r,null,c))},u=function(t){r?(r.left=t,r=t):(o=t,r=t)},c=0;c<e.count;++c){var h=e.nextBitIsOne(),l=Math.pow(2,e.count-(c+1));h?s(l,Bt.BLACK):(s(l,Bt.BLACK),s(l,Bt.RED))}return o}(new ie(t.length));return new Wt(r||e,o)},ae={},se=function(){function t(t,e){this.indexes_=t,this.indexSet_=e}return Object.defineProperty(t,"Default",{get:function(){return(0,o.assert)(ae&&ne,"ChildrenNode.ts has not been loaded"),Zt=Zt||new t({".priority":ae},{".priority":ne})},enumerable:!1,configurable:!0}),t.prototype.get=function(t){var e=(0,o.safeGet)(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e instanceof Wt?e:null},t.prototype.hasIndex=function(t){return(0,o.contains)(this.indexSet_,t.toString())},t.prototype.addIndex=function(e,n){(0,o.assert)(e!==qt,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,i=[],s=!1,u=n.getIterator(Ft.Wrap),c=u.getNext();c;)s=s||e.isDefinedOn(c.node),i.push(c),c=u.getNext();r=s?oe(i,e.getCompare()):ae;var h=e.toString(),l=(0,a.__assign)({},this.indexSet_);l[h]=e;var f=(0,a.__assign)({},this.indexes_);return f[h]=r,new t(f,l)},t.prototype.addToIndexes=function(e,n){var r=this;return new t((0,o.map)(this.indexes_,(function(t,i){var a=(0,o.safeGet)(r.indexSet_,i);if((0,o.assert)(a,"Missing index implementation for "+i),t===ae){if(a.isDefinedOn(e.node)){for(var s=[],u=n.getIterator(Ft.Wrap),c=u.getNext();c;)c.name!==e.name&&s.push(c),c=u.getNext();return s.push(e),oe(s,a.getCompare())}return ae}var h=n.get(e.name),l=t;return h&&(l=l.remove(new Ft(e.name,h))),l.insert(e,e.node)})),this.indexSet_)},t.prototype.removeFromIndexes=function(e,n){return new t((0,o.map)(this.indexes_,(function(t){if(t===ae)return t;var r=n.get(e.name);return r?t.remove(new Ft(e.name,r)):t})),this.indexSet_)},t}(),ue=function(){function t(t,e,n){this.children_=t,this.priorityNode_=e,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&$t(this.priorityNode_),this.children_.isEmpty()&&(0,o.assert)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(t,"EMPTY_NODE",{get:function(){return te||(te=new t(new Wt(Gt),null,se.Default))},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!1},t.prototype.getPriority=function(){return this.priorityNode_||te},t.prototype.updatePriority=function(e){return this.children_.isEmpty()?this:new t(this.children_,e,this.indexMap_)},t.prototype.getImmediateChild=function(t){if(".priority"===t)return this.getPriority();var e=this.children_.get(t);return null===e?te:e},t.prototype.getChild=function(t){var e=yt(t);return null===e?this:this.getImmediateChild(e).getChild(_t(t))},t.prototype.hasChild=function(t){return null!==this.children_.get(t)},t.prototype.updateImmediateChild=function(e,n){if((0,o.assert)(n,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(n);var r=new Ft(e,n),i=void 0,a=void 0;n.isEmpty()?(i=this.children_.remove(e),a=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,n),a=this.indexMap_.addToIndexes(r,this.children_));var s=i.isEmpty()?te:this.priorityNode_;return new t(i,s,a)},t.prototype.updateChild=function(t,e){var n=yt(t);if(null===n)return e;(0,o.assert)(".priority"!==yt(t)||1===mt(t),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(_t(t),e);return this.updateImmediateChild(n,r)},t.prototype.isEmpty=function(){return this.children_.isEmpty()},t.prototype.numChildren=function(){return this.children_.count()},t.prototype.val=function(e){if(this.isEmpty())return null;var n={},r=0,i=0,o=!0;if(this.forEachChild(ne,(function(a,s){n[a]=s.val(e),r++,o&&t.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):o=!1})),!e&&o&&i<2*r){var a=[];for(var s in n)a[s]=n[s];return a}return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.getPriority().isEmpty()||(t+="priority:"+Xt(this.getPriority().val())+":"),this.forEachChild(ne,(function(e,n){var r=n.hash();""!==r&&(t+=":"+e+":"+r)})),this.lazyHash_=""===t?"":y(t)}return this.lazyHash_},t.prototype.getPredecessorChildName=function(t,e,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new Ft(t,e));return i?i.name:null}return this.children_.getPredecessorKey(t)},t.prototype.getFirstChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.minKey();return n&&n.name}return this.children_.minKey()},t.prototype.getFirstChild=function(t){var e=this.getFirstChildName(t);return e?new Ft(e,this.children_.get(e)):null},t.prototype.getLastChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.maxKey();return n&&n.name}return this.children_.maxKey()},t.prototype.getLastChild=function(t){var e=this.getLastChildName(t);return e?new Ft(e,this.children_.get(e)):null},t.prototype.forEachChild=function(t,e){var n=this.resolveIndex_(t);return n?n.inorderTraversal((function(t){return e(t.name,t.node)})):this.children_.inorderTraversal(e)},t.prototype.getIterator=function(t){return this.getIteratorFrom(t.minPost(),t)},t.prototype.getIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getIteratorFrom(t,(function(t){return t}));for(var r=this.children_.getIteratorFrom(t.name,Ft.Wrap),i=r.peek();null!=i&&e.compare(i,t)<0;)r.getNext(),i=r.peek();return r},t.prototype.getReverseIterator=function(t){return this.getReverseIteratorFrom(t.maxPost(),t)},t.prototype.getReverseIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getReverseIteratorFrom(t,(function(t){return t}));for(var r=this.children_.getReverseIteratorFrom(t.name,Ft.Wrap),i=r.peek();null!=i&&e.compare(i,t)>0;)r.getNext(),i=r.peek();return r},t.prototype.compareTo=function(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===ce?-1:0},t.prototype.withIndex=function(e){if(e===qt||this.indexMap_.hasIndex(e))return this;var n=this.indexMap_.addIndex(e,this.children_);return new t(this.children_,this.priorityNode_,n)},t.prototype.isIndexed=function(t){return t===qt||this.indexMap_.hasIndex(t)},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode())return!1;var e=t;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()===e.children_.count()){for(var n=this.getIterator(ne),r=e.getIterator(ne),i=n.getNext(),o=r.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1}return!1},t.prototype.resolveIndex_=function(t){return t===qt?null:this.indexMap_.get(t.toString())},t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t}(),ce=new(function(t){function e(){return t.call(this,new Wt(Gt),ue.EMPTY_NODE,se.Default)||this}return(0,a.__extends)(e,t),e.prototype.compareTo=function(t){return t===this?0:1},e.prototype.equals=function(t){return t===this},e.prototype.getPriority=function(){return this},e.prototype.getImmediateChild=function(t){return ue.EMPTY_NODE},e.prototype.isEmpty=function(){return!1},e}(ue));Object.defineProperties(Ft,{MIN:{value:new Ft(A,ue.EMPTY_NODE)},MAX:{value:new Ft(N,ce)}}),jt.__EMPTY_NODE=ue.EMPTY_NODE,Jt.__childrenNodeConstructor=ue,xt=ce,function(t){Yt=t}(ce);function he(t,e){if(void 0===e&&(e=null),null===t)return ue.EMPTY_NODE;if("object"===typeof t&&".priority"in t&&(e=t[".priority"]),(0,o.assert)(null===e||"string"===typeof e||"number"===typeof e||"object"===typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"===typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!==typeof t||".sv"in t)return new Jt(t,he(e));if(t instanceof Array){var n=ue.EMPTY_NODE;return L(t,(function(e,r){if((0,o.contains)(t,e)&&"."!==e.substring(0,1)){var i=he(r);!i.isLeafNode()&&i.isEmpty()||(n=n.updateImmediateChild(e,i))}})),n.updatePriority(he(e))}var r=[],i=!1;if(L(t,(function(t,e){if("."!==t.substring(0,1)){var n=he(e);n.isEmpty()||(i=i||!n.getPriority().isEmpty(),r.push(new Ft(t,n)))}})),0===r.length)return ue.EMPTY_NODE;var a=oe(r,Ht,(function(t){return t.name}),Gt);if(i){var s=oe(r,ne.getCompare());return new ue(a,he(e),new se({".priority":s},{".priority":ne}))}return new ue(a,he(e),se.Default)}!function(t){Qt=t}(he);var le=function(t){function e(e){var n=t.call(this)||this;return n.indexPath_=e,(0,o.assert)(!Et(e)&&".priority"!==yt(e),"Can't create PathIndex with empty path or .priority key"),n}return(0,a.__extends)(e,t),e.prototype.extractChild=function(t){return t.getChild(this.indexPath_)},e.prototype.isDefinedOn=function(t){return!t.getChild(this.indexPath_).isEmpty()},e.prototype.compare=function(t,e){var n=this.extractChild(t.node),r=this.extractChild(e.node),i=n.compareTo(r);return 0===i?P(t.name,e.name):i},e.prototype.makePost=function(t,e){var n=he(t),r=ue.EMPTY_NODE.updateChild(this.indexPath_,n);return new Ft(e,r)},e.prototype.maxPost=function(){var t=ue.EMPTY_NODE.updateChild(this.indexPath_,ce);return new Ft(N,t)},e.prototype.toString=function(){return wt(this.indexPath_,0).join("/")},e}(Ut),fe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,a.__extends)(e,t),e.prototype.compare=function(t,e){var n=t.node.compareTo(e.node);return 0===n?P(t.name,e.name):n},e.prototype.isDefinedOn=function(t){return!0},e.prototype.indexedValueChanged=function(t,e){return!t.equals(e)},e.prototype.minPost=function(){return Ft.MIN},e.prototype.maxPost=function(){return Ft.MAX},e.prototype.makePost=function(t,e){var n=he(t);return new Ft(e,n)},e.prototype.toString=function(){return".value"},e}(Ut),de=new fe,pe="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",ve=function(){var t=0,e=[];return function(n){var r,i=n===t;t=n;var a=new Array(8);for(r=7;r>=0;r--)a[r]=pe.charAt(n%64),n=Math.floor(n/64);(0,o.assert)(0===n,"Cannot push at time == 0");var s=a.join("");if(i){for(r=11;r>=0&&63===e[r];r--)e[r]=0;e[r]++}else for(r=0;r<12;r++)e[r]=Math.floor(64*Math.random());for(r=0;r<12;r++)s+=pe.charAt(e[r]);return(0,o.assert)(20===s.length,"nextPushId: Length should be 20."),s}}(),ge=function(t){if(t===""+j)return"-";var e=q(t);if(null!=e)return""+(e+1);for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t.charAt(r);if(n.length<786)return n.push("-"),n.join("");for(var i=n.length-1;i>=0&&"z"===n[i];)i--;if(-1===i)return N;var o=n[i],a=pe.charAt(pe.indexOf(o)+1);return n[i]=a,n.slice(0,i+1).join("")},ye=function(t){if(t===""+U)return A;var e=q(t);if(null!=e)return""+(e-1);for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t.charAt(r);return"-"===n[n.length-1]?1===n.length?""+j:(delete n[n.length-1],n.join("")):(n[n.length-1]=pe.charAt(pe.indexOf(n[n.length-1])-1),n.join("")+"z".repeat(786-n.length))};function me(t){return{type:"value",snapshotNode:t}}function _e(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function be(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function we(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}var Ie=function(){function t(t){this.index_=t}return t.prototype.updateChild=function(t,e,n,r,i,a){(0,o.assert)(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");var s=t.getImmediateChild(e);return s.getChild(r).equals(n.getChild(r))&&s.isEmpty()===n.isEmpty()?t:(null!=a&&(n.isEmpty()?t.hasChild(e)?a.trackChildChange(be(e,s)):(0,o.assert)(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):s.isEmpty()?a.trackChildChange(_e(e,n)):a.trackChildChange(we(e,n,s))),t.isLeafNode()&&n.isEmpty()?t:t.updateImmediateChild(e,n).withIndex(this.index_))},t.prototype.updateFullNode=function(t,e,n){return null!=n&&(t.isLeafNode()||t.forEachChild(ne,(function(t,r){e.hasChild(t)||n.trackChildChange(be(t,r))})),e.isLeafNode()||e.forEachChild(ne,(function(e,r){if(t.hasChild(e)){var i=t.getImmediateChild(e);i.equals(r)||n.trackChildChange(we(e,r,i))}else n.trackChildChange(_e(e,r))}))),e.withIndex(this.index_)},t.prototype.updatePriority=function(t,e){return t.isEmpty()?ue.EMPTY_NODE:t.updatePriority(e)},t.prototype.filtersNodes=function(){return!1},t.prototype.getIndexedFilter=function(){return this},t.prototype.getIndex=function(){return this.index_},t}(),Te=function(){function t(e){this.indexedFilter_=new Ie(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e)}return t.prototype.getStartPost=function(){return this.startPost_},t.prototype.getEndPost=function(){return this.endPost_},t.prototype.matches=function(t){return this.index_.compare(this.getStartPost(),t)<=0&&this.index_.compare(t,this.getEndPost())<=0},t.prototype.updateChild=function(t,e,n,r,i,o){return this.matches(new Ft(e,n))||(n=ue.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,n,r,i,o)},t.prototype.updateFullNode=function(t,e,n){e.isLeafNode()&&(e=ue.EMPTY_NODE);var r=e.withIndex(this.index_);r=r.updatePriority(ue.EMPTY_NODE);var i=this;return e.forEachChild(ne,(function(t,e){i.matches(new Ft(t,e))||(r=r.updateImmediateChild(t,ue.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.indexedFilter_},t.prototype.getIndex=function(){return this.index_},t.getStartPost_=function(t){if(t.hasStart()){var e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()},t.getEndPost_=function(t){if(t.hasEnd()){var e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()},t}(),Ee=function(){function t(t){this.rangedFilter_=new Te(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft()}return t.prototype.updateChild=function(t,e,n,r,i,o){return this.rangedFilter_.matches(new Ft(e,n))||(n=ue.EMPTY_NODE),t.getImmediateChild(e).equals(n)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,n,r,i,o):this.fullLimitUpdateChild_(t,e,n,i,o)},t.prototype.updateFullNode=function(t,e,n){var r;if(e.isLeafNode()||e.isEmpty())r=ue.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){r=ue.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var o=0;i.hasNext()&&o<this.limit_;){var a=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:this.index_.compare(a,this.rangedFilter_.getEndPost())<=0))break;r=r.updateImmediateChild(a.name,a.node),o++}}else{r=(r=e.withIndex(this.index_)).updatePriority(ue.EMPTY_NODE);var s=void 0,u=void 0,c=void 0;i=void 0;if(this.reverse_){i=r.getReverseIterator(this.index_),s=this.rangedFilter_.getEndPost(),u=this.rangedFilter_.getStartPost();var h=this.index_.getCompare();c=function(t,e){return h(e,t)}}else i=r.getIterator(this.index_),s=this.rangedFilter_.getStartPost(),u=this.rangedFilter_.getEndPost(),c=this.index_.getCompare();o=0;for(var l=!1;i.hasNext();){a=i.getNext();!l&&c(s,a)<=0&&(l=!0),l&&o<this.limit_&&c(a,u)<=0?o++:r=r.updateImmediateChild(a.name,ue.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},t.prototype.getIndex=function(){return this.index_},t.prototype.fullLimitUpdateChild_=function(t,e,n,r,i){var a;if(this.reverse_){var s=this.index_.getCompare();a=function(t,e){return s(e,t)}}else a=this.index_.getCompare();var u=t;(0,o.assert)(u.numChildren()===this.limit_,"");var c=new Ft(e,n),h=this.reverse_?u.getFirstChild(this.index_):u.getLastChild(this.index_),l=this.rangedFilter_.matches(c);if(u.hasChild(e)){for(var f=u.getImmediateChild(e),d=r.getChildAfterChild(this.index_,h,this.reverse_);null!=d&&(d.name===e||u.hasChild(d.name));)d=r.getChildAfterChild(this.index_,d,this.reverse_);var p=null==d?1:a(d,c);if(l&&!n.isEmpty()&&p>=0)return null!=i&&i.trackChildChange(we(e,n,f)),u.updateImmediateChild(e,n);null!=i&&i.trackChildChange(be(e,f));var v=u.updateImmediateChild(e,ue.EMPTY_NODE);return null!=d&&this.rangedFilter_.matches(d)?(null!=i&&i.trackChildChange(_e(d.name,d.node)),v.updateImmediateChild(d.name,d.node)):v}return n.isEmpty()?t:l&&a(h,c)>=0?(null!=i&&(i.trackChildChange(be(h.name,h.node)),i.trackChildChange(_e(e,n))),u.updateImmediateChild(e,n).updateImmediateChild(h.name,ue.EMPTY_NODE)):t},t}(),Se=function(){function t(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=ne}return t.prototype.hasStart=function(){return this.startSet_},t.prototype.hasStartAfter=function(){return this.startAfterSet_},t.prototype.hasEndBefore=function(){return this.endBeforeSet_},t.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_},t.prototype.getIndexStartValue=function(){return(0,o.assert)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},t.prototype.getIndexStartName=function(){return(0,o.assert)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:A},t.prototype.hasEnd=function(){return this.endSet_},t.prototype.getIndexEndValue=function(){return(0,o.assert)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},t.prototype.getIndexEndName=function(){return(0,o.assert)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:N},t.prototype.hasLimit=function(){return this.limitSet_},t.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},t.prototype.getLimit=function(){return(0,o.assert)(this.limitSet_,"Only valid if limit has been set"),this.limit_},t.prototype.getIndex=function(){return this.index_},t.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},t.prototype.isDefault=function(){return this.loadsAllData()&&this.index_===ne},t.prototype.copy=function(){var e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e},t}();function Ce(t,e,n){var r=t.copy();return r.startSet_=!0,void 0===e&&(e=null),r.indexStartValue_=e,null!=n?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function ke(t,e,n){var r=t.copy();return r.endSet_=!0,void 0===e&&(e=null),r.indexEndValue_=e,void 0!==n?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function Ae(t,e){var n=t.copy();return n.index_=e,n}function Ne(t){var e,n={};return t.isDefault()||(t.index_===ne?e="$priority":t.index_===de?e="$value":t.index_===qt?e="$key":((0,o.assert)(t.index_ instanceof le,"Unrecognized index type!"),e=t.index_.toString()),n.orderBy=(0,o.stringify)(e),t.startSet_&&(n.startAt=(0,o.stringify)(t.indexStartValue_),t.startNameSet_&&(n.startAt+=","+(0,o.stringify)(t.indexStartName_))),t.endSet_&&(n.endAt=(0,o.stringify)(t.indexEndValue_),t.endNameSet_&&(n.endAt+=","+(0,o.stringify)(t.indexEndName_))),t.limitSet_&&(t.isViewFromLeft()?n.limitToFirst=t.limit_:n.limitToLast=t.limit_)),n}function Pe(t){var e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_)),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_)),t.limitSet_){e.l=t.limit_;var n=t.viewFrom_;""===n&&(n=t.isViewFromLeft()?"l":"r"),e.vf=n}return t.index_!==ne&&(e.i=t.index_.toString()),e}var Re=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.repoInfo_=e,o.onDataUpdate_=n,o.authTokenProvider_=r,o.appCheckTokenProvider_=i,o.log_=T("p:rest:"),o.listens_={},o}return(0,a.__extends)(e,t),e.prototype.reportStats=function(t){throw new Error("Method not implemented.")},e.getListenId_=function(t,e){return void 0!==e?"tag$"+e:((0,o.assert)(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())},e.prototype.listen=function(t,n,r,i){var a=this,s=t._path.toString();this.log_("Listen called for "+s+" "+t._queryIdentifier);var u=e.getListenId_(t,r),c={};this.listens_[u]=c;var h=Ne(t._queryParams);this.restRequest_(s+".json",h,(function(t,e){var n=e;(404===t&&(n=null,t=null),null===t&&a.onDataUpdate_(s,n,!1,r),(0,o.safeGet)(a.listens_,u)===c)&&i(t?401===t?"permission_denied":"rest_error:"+t:"ok",null)}))},e.prototype.unlisten=function(t,n){var r=e.getListenId_(t,n);delete this.listens_[r]},e.prototype.get=function(t){var e=this,n=Ne(t._queryParams),r=t._path.toString(),i=new o.Deferred;return this.restRequest_(r+".json",n,(function(t,n){var o=n;404===t&&(o=null,t=null),null===t?(e.onDataUpdate_(r,o,!1,null),i.resolve(o)):i.reject(new Error(o))})),i.promise},e.prototype.refreshAuthToken=function(t){},e.prototype.restRequest_=function(t,e,n){var r=this;return void 0===e&&(e={}),e.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((function(i){var s=(0,a.__read)(i,2),u=s[0],c=s[1];u&&u.accessToken&&(e.auth=u.accessToken),c&&c.token&&(e.ac=c.token);var h=(r.repoInfo_.secure?"https://":"http://")+r.repoInfo_.host+t+"?ns="+r.repoInfo_.namespace+(0,o.querystring)(e);r.log_("Sending REST request for "+h);var l=new XMLHttpRequest;l.onreadystatechange=function(){if(n&&4===l.readyState){r.log_("REST Response for "+h+" received. status:",l.status,"response:",l.responseText);var t=null;if(l.status>=200&&l.status<300){try{t=(0,o.jsonEval)(l.responseText)}catch(e){C("Failed to parse JSON response for "+h+": "+l.responseText)}n(null,t)}else 401!==l.status&&404!==l.status&&C("Got unsuccessful REST response for "+h+" Status: "+l.status),n(l.status);n=null}},l.open("GET",h,!0),l.send()}))},e}(ft),De=function(){function t(){this.rootNode_=ue.EMPTY_NODE}return t.prototype.getNode=function(t){return this.rootNode_.getChild(t)},t.prototype.updateSnapshot=function(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)},t}();function xe(){return{value:null,children:new Map}}function Oe(t,e,n){if(Et(e))t.value=n,t.children.clear();else if(null!==t.value)t.value=t.value.updateChild(e,n);else{var r=yt(e);t.children.has(r)||t.children.set(r,xe()),Oe(t.children.get(r),e=_t(e),n)}}function Le(t,e){if(Et(e))return t.value=null,t.children.clear(),!0;if(null!==t.value){if(t.value.isLeafNode())return!1;var n=t.value;return t.value=null,n.forEachChild(ne,(function(e,n){Oe(t,new vt(e),n)})),Le(t,e)}if(t.children.size>0){var r=yt(e);if(e=_t(e),t.children.has(r))Le(t.children.get(r),e)&&t.children.delete(r);return 0===t.children.size}return!0}function Me(t,e,n){null!==t.value?n(e,t.value):function(t,e){t.children.forEach((function(t,n){e(n,t)}))}(t,(function(t,r){Me(r,new vt(e.toString()+"/"+t),n)}))}var Fe,Ue=function(){function t(t){this.collection_=t,this.last_=null}return t.prototype.get=function(){var t=this.collection_.get(),e=(0,a.__assign)({},t);return this.last_&&L(this.last_,(function(t,n){e[t]=e[t]-n})),this.last_=t,e},t}(),je=function(){function t(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new Ue(t);var n=1e4+2e4*Math.random();B(this.reportStats_.bind(this),Math.floor(n))}return t.prototype.reportStats_=function(){var t=this,e=this.statsListener_.get(),n={},r=!1;L(e,(function(e,i){i>0&&(0,o.contains)(t.statsToReport_,e)&&(n[e]=i,r=!0)})),r&&this.server_.reportStats(n),B(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},t}();function qe(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}!function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Fe||(Fe={}));var Ve,Be=function(){function t(t,e,n){this.path=t,this.affectedTree=e,this.revert=n,this.type=Fe.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}return t.prototype.operationForChild=function(e){if(Et(this.path)){if(null!=this.affectedTree.value)return(0,o.assert)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new vt(e));return new t(gt(),n,this.revert)}return(0,o.assert)(yt(this.path)===e,"operationForChild called for unrelated child."),new t(_t(this.path),this.affectedTree,this.revert)},t}(),Ke=function(){function t(t,e){this.source=t,this.path=e,this.type=Fe.LISTEN_COMPLETE}return t.prototype.operationForChild=function(e){return Et(this.path)?new t(this.source,gt()):new t(this.source,_t(this.path))},t}(),We=function(){function t(t,e,n){this.source=t,this.path=e,this.snap=n,this.type=Fe.OVERWRITE}return t.prototype.operationForChild=function(e){return Et(this.path)?new t(this.source,gt(),this.snap.getImmediateChild(e)):new t(this.source,_t(this.path),this.snap)},t}(),He=function(){function t(t,e,n){this.source=t,this.path=e,this.children=n,this.type=Fe.MERGE}return t.prototype.operationForChild=function(e){if(Et(this.path)){var n=this.children.subtree(new vt(e));return n.isEmpty()?null:n.value?new We(this.source,gt(),n.value):new t(this.source,gt(),n)}return(0,o.assert)(yt(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,_t(this.path),this.children)},t.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},t}(),Ge=function(){function t(t,e,n){this.node_=t,this.fullyInitialized_=e,this.filtered_=n}return t.prototype.isFullyInitialized=function(){return this.fullyInitialized_},t.prototype.isFiltered=function(){return this.filtered_},t.prototype.isCompleteForPath=function(t){if(Et(t))return this.isFullyInitialized()&&!this.filtered_;var e=yt(t);return this.isCompleteForChild(e)},t.prototype.isCompleteForChild=function(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)},t.prototype.getNode=function(){return this.node_},t}(),ze=function(t){this.query_=t,this.index_=this.query_._queryParams.getIndex()};function Qe(t,e,n,r,i,a){var s=r.filter((function(t){return t.type===n}));s.sort((function(e,n){return function(t,e,n){if(null==e.childName||null==n.childName)throw(0,o.assertionError)("Should only compare child_ events.");var r=new Ft(e.childName,e.snapshotNode),i=new Ft(n.childName,n.snapshotNode);return t.index_.compare(r,i)}(t,e,n)})),s.forEach((function(n){var r=function(t,e,n){return"value"===e.type||"child_removed"===e.type||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}(t,n,a);i.forEach((function(i){i.respondsTo(n.type)&&e.push(i.createEvent(r,t.query_))}))}))}function Ye(t,e){return{eventCache:t,serverCache:e}}function Xe(t,e,n,r){return Ye(new Ge(e,n,r),t.serverCache)}function $e(t,e,n,r){return Ye(t.eventCache,new Ge(e,n,r))}function Je(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Ze(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var tn=function(){function t(t,e){void 0===e&&(Ve||(Ve=new Wt(R)),e=Ve),this.value=t,this.children=e}return t.fromObject=function(e){var n=new t(null);return L(e,(function(t,e){n=n.set(new vt(t),e)})),n},t.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},t.prototype.findRootMostMatchingPathAndValue=function(t,e){if(null!=this.value&&e(this.value))return{path:gt(),value:this.value};if(Et(t))return null;var n=yt(t),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(_t(t),e);return null!=i?{path:Tt(new vt(n),i.path),value:i.value}:null}return null},t.prototype.findRootMostValueAndPath=function(t){return this.findRootMostMatchingPathAndValue(t,(function(){return!0}))},t.prototype.subtree=function(e){if(Et(e))return this;var n=yt(e),r=this.children.get(n);return null!==r?r.subtree(_t(e)):new t(null)},t.prototype.set=function(e,n){if(Et(e))return new t(n,this.children);var r=yt(e),i=(this.children.get(r)||new t(null)).set(_t(e),n),o=this.children.insert(r,i);return new t(this.value,o)},t.prototype.remove=function(e){if(Et(e))return this.children.isEmpty()?new t(null):new t(null,this.children);var n=yt(e),r=this.children.get(n);if(r){var i=r.remove(_t(e)),o=void 0;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&o.isEmpty()?new t(null):new t(this.value,o)}return this},t.prototype.get=function(t){if(Et(t))return this.value;var e=yt(t),n=this.children.get(e);return n?n.get(_t(t)):null},t.prototype.setTree=function(e,n){if(Et(e))return n;var r=yt(e),i=(this.children.get(r)||new t(null)).setTree(_t(e),n),o=void 0;return o=i.isEmpty()?this.children.remove(r):this.children.insert(r,i),new t(this.value,o)},t.prototype.fold=function(t){return this.fold_(gt(),t)},t.prototype.fold_=function(t,e){var n={};return this.children.inorderTraversal((function(r,i){n[r]=i.fold_(Tt(t,r),e)})),e(t,this.value,n)},t.prototype.findOnPath=function(t,e){return this.findOnPath_(t,gt(),e)},t.prototype.findOnPath_=function(t,e,n){var r=!!this.value&&n(e,this.value);if(r)return r;if(Et(t))return null;var i=yt(t),o=this.children.get(i);return o?o.findOnPath_(_t(t),Tt(e,i),n):null},t.prototype.foreachOnPath=function(t,e){return this.foreachOnPath_(t,gt(),e)},t.prototype.foreachOnPath_=function(e,n,r){if(Et(e))return this;this.value&&r(n,this.value);var i=yt(e),o=this.children.get(i);return o?o.foreachOnPath_(_t(e),Tt(n,i),r):new t(null)},t.prototype.foreach=function(t){this.foreach_(gt(),t)},t.prototype.foreach_=function(t,e){this.children.inorderTraversal((function(n,r){r.foreach_(Tt(t,n),e)})),this.value&&e(t,this.value)},t.prototype.foreachChild=function(t){this.children.inorderTraversal((function(e,n){n.value&&t(e,n.value)}))},t}(),en=function(){function t(t){this.writeTree_=t}return t.empty=function(){return new t(new tn(null))},t}();function nn(t,e,n){if(Et(e))return new en(new tn(n));var r=t.writeTree_.findRootMostValueAndPath(e);if(null!=r){var i=r.path,o=r.value,a=St(i,e);return o=o.updateChild(a,n),new en(t.writeTree_.set(i,o))}var s=new tn(n),u=t.writeTree_.setTree(e,s);return new en(u)}function rn(t,e,n){var r=t;return L(n,(function(t,n){r=nn(r,Tt(e,t),n)})),r}function on(t,e){if(Et(e))return en.empty();var n=t.writeTree_.setTree(e,new tn(null));return new en(n)}function an(t,e){return null!=sn(t,e)}function sn(t,e){var n=t.writeTree_.findRootMostValueAndPath(e);return null!=n?t.writeTree_.get(n.path).getChild(St(n.path,e)):null}function un(t){var e=[],n=t.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(ne,(function(t,n){e.push(new Ft(t,n))})):t.writeTree_.children.inorderTraversal((function(t,n){null!=n.value&&e.push(new Ft(t,n.value))})),e}function cn(t,e){if(Et(e))return t;var n=sn(t,e);return new en(null!=n?new tn(n):t.writeTree_.subtree(e))}function hn(t){return t.writeTree_.isEmpty()}function ln(t,e){return fn(gt(),t.writeTree_,e)}function fn(t,e,n){if(null!=e.value)return n.updateChild(t,e.value);var r=null;return e.children.inorderTraversal((function(e,i){".priority"===e?((0,o.assert)(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=fn(Tt(t,e),i,n)})),n.getChild(t).isEmpty()||null===r||(n=n.updateChild(Tt(t,".priority"),r)),n}function dn(t,e){return Cn(e,t)}function pn(t,e){var n=t.allWrites.findIndex((function(t){return t.writeId===e}));(0,o.assert)(n>=0,"removeWrite called with nonexistent writeId.");var r=t.allWrites[n];t.allWrites.splice(n,1);for(var i=r.visible,a=!1,s=t.allWrites.length-1;i&&s>=0;){var u=t.allWrites[s];u.visible&&(s>=n&&vn(u,r.path)?i=!1:At(r.path,u.path)&&(a=!0)),s--}if(i){if(a)return function(t){t.visibleWrites=yn(t.allWrites,gn,gt()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}(t),!0;r.snap?t.visibleWrites=on(t.visibleWrites,r.path):L(r.children,(function(e){t.visibleWrites=on(t.visibleWrites,Tt(r.path,e))}));return!0}return!1}function vn(t,e){if(t.snap)return At(t.path,e);for(var n in t.children)if(t.children.hasOwnProperty(n)&&At(Tt(t.path,n),e))return!0;return!1}function gn(t){return t.visible}function yn(t,e,n){for(var r=en.empty(),i=0;i<t.length;++i){var a=t[i];if(e(a)){var s=a.path,u=void 0;if(a.snap)At(n,s)?r=nn(r,u=St(n,s),a.snap):At(s,n)&&(u=St(s,n),r=nn(r,gt(),a.snap.getChild(u)));else{if(!a.children)throw(0,o.assertionError)("WriteRecord should have .snap or .children");if(At(n,s))r=rn(r,u=St(n,s),a.children);else if(At(s,n))if(Et(u=St(s,n)))r=rn(r,gt(),a.children);else{var c=(0,o.safeGet)(a.children,yt(u));if(c){var h=c.getChild(_t(u));r=nn(r,gt(),h)}}}}}return r}function mn(t,e,n,r,i){if(r||i){var o=cn(t.visibleWrites,e);if(!i&&hn(o))return n;if(i||null!=n||an(o,gt())){return ln(yn(t.allWrites,(function(t){return(t.visible||i)&&(!r||!~r.indexOf(t.writeId))&&(At(t.path,e)||At(e,t.path))}),e),n||ue.EMPTY_NODE)}return null}var a=sn(t.visibleWrites,e);if(null!=a)return a;var s=cn(t.visibleWrites,e);return hn(s)?n:null!=n||an(s,gt())?ln(s,n||ue.EMPTY_NODE):null}function _n(t,e,n,r){return mn(t.writeTree,t.treePath,e,n,r)}function bn(t,e){return function(t,e,n){var r=ue.EMPTY_NODE,i=sn(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(ne,(function(t,e){r=r.updateImmediateChild(t,e)})),r;if(n){var o=cn(t.visibleWrites,e);return n.forEachChild(ne,(function(t,e){var n=ln(cn(o,new vt(t)),e);r=r.updateImmediateChild(t,n)})),un(o).forEach((function(t){r=r.updateImmediateChild(t.name,t.node)})),r}return un(cn(t.visibleWrites,e)).forEach((function(t){r=r.updateImmediateChild(t.name,t.node)})),r}(t.writeTree,t.treePath,e)}function wn(t,e,n,r){return function(t,e,n,r,i){(0,o.assert)(r||i,"Either existingEventSnap or existingServerSnap must exist");var a=Tt(e,n);if(an(t.visibleWrites,a))return null;var s=cn(t.visibleWrites,a);return hn(s)?i.getChild(n):ln(s,i.getChild(n))}(t.writeTree,t.treePath,e,n,r)}function In(t,e){return function(t,e){return sn(t.visibleWrites,e)}(t.writeTree,Tt(t.treePath,e))}function Tn(t,e,n,r,i,o){return function(t,e,n,r,i,o,a){var s,u=cn(t.visibleWrites,e),c=sn(u,gt());if(null!=c)s=c;else{if(null==n)return[];s=ln(u,n)}if((s=s.withIndex(a)).isEmpty()||s.isLeafNode())return[];for(var h=[],l=a.getCompare(),f=o?s.getReverseIteratorFrom(r,a):s.getIteratorFrom(r,a),d=f.getNext();d&&h.length<i;)0!==l(d,r)&&h.push(d),d=f.getNext();return h}(t.writeTree,t.treePath,e,n,r,i,o)}function En(t,e,n){return function(t,e,n,r){var i=Tt(e,n),o=sn(t.visibleWrites,i);return null!=o?o:r.isCompleteForChild(n)?ln(cn(t.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(t.writeTree,t.treePath,e,n)}function Sn(t,e){return Cn(Tt(t.treePath,e),t.writeTree)}function Cn(t,e){return{treePath:t,writeTree:e}}var kn=function(){function t(){this.changeMap=new Map}return t.prototype.trackChildChange=function(t){var e=t.type,n=t.childName;(0,o.assert)("child_added"===e||"child_changed"===e||"child_removed"===e,"Only child changes supported for tracking"),(0,o.assert)(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if("child_added"===e&&"child_removed"===i)this.changeMap.set(n,we(n,t.snapshotNode,r.snapshotNode));else if("child_removed"===e&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===e&&"child_changed"===i)this.changeMap.set(n,be(n,r.oldSnap));else if("child_changed"===e&&"child_added"===i)this.changeMap.set(n,_e(n,t.snapshotNode));else{if("child_changed"!==e||"child_changed"!==i)throw(0,o.assertionError)("Illegal combination of changes: "+t+" occurred after "+r);this.changeMap.set(n,we(n,t.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,t)},t.prototype.getChanges=function(){return Array.from(this.changeMap.values())},t}(),An=new(function(){function t(){}return t.prototype.getCompleteChild=function(t){return null},t.prototype.getChildAfterChild=function(t,e,n){return null},t}()),Nn=function(){function t(t,e,n){void 0===n&&(n=null),this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=n}return t.prototype.getCompleteChild=function(t){var e=this.viewCache_.eventCache;if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);var n=null!=this.optCompleteServerCache_?new Ge(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return En(this.writes_,t,n)},t.prototype.getChildAfterChild=function(t,e,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Ze(this.viewCache_),i=Tn(this.writes_,r,e,1,n,t);return 0===i.length?null:i[0]},t}();function Pn(t,e,n,r,i){var a,s,u=new kn;if(n.type===Fe.OVERWRITE){var c=n;c.source.fromUser?a=xn(t,e,c.path,c.snap,r,i,u):((0,o.assert)(c.source.fromServer,"Unknown source."),s=c.source.tagged||e.serverCache.isFiltered()&&!Et(c.path),a=Dn(t,e,c.path,c.snap,r,i,s,u))}else if(n.type===Fe.MERGE){var h=n;h.source.fromUser?a=function(t,e,n,r,i,o,a){var s=e;return r.foreach((function(r,u){var c=Tt(n,r);On(e,yt(c))&&(s=xn(t,s,c,u,i,o,a))})),r.foreach((function(r,u){var c=Tt(n,r);On(e,yt(c))||(s=xn(t,s,c,u,i,o,a))})),s}(t,e,h.path,h.children,r,i,u):((0,o.assert)(h.source.fromServer,"Unknown source."),s=h.source.tagged||e.serverCache.isFiltered(),a=Mn(t,e,h.path,h.children,r,i,s,u))}else if(n.type===Fe.ACK_USER_WRITE){var l=n;a=l.revert?function(t,e,n,r,i,a){var s;if(null!=In(r,n))return e;var u=new Nn(r,e,i),c=e.eventCache.getNode(),h=void 0;if(Et(n)||".priority"===yt(n)){var l=void 0;if(e.serverCache.isFullyInitialized())l=_n(r,Ze(e));else{var f=e.serverCache.getNode();(0,o.assert)(f instanceof ue,"serverChildren would be complete if leaf node"),l=bn(r,f)}h=t.filter.updateFullNode(c,l,a)}else{var d=yt(n),p=En(r,d,e.serverCache);null==p&&e.serverCache.isCompleteForChild(d)&&(p=c.getImmediateChild(d)),(h=null!=p?t.filter.updateChild(c,d,p,_t(n),u,a):e.eventCache.getNode().hasChild(d)?t.filter.updateChild(c,d,ue.EMPTY_NODE,_t(n),u,a):c).isEmpty()&&e.serverCache.isFullyInitialized()&&(s=_n(r,Ze(e))).isLeafNode()&&(h=t.filter.updateFullNode(h,s,a))}return s=e.serverCache.isFullyInitialized()||null!=In(r,gt()),Xe(e,h,s,t.filter.filtersNodes())}(t,e,l.path,r,i,u):function(t,e,n,r,i,o,a){if(null!=In(i,n))return e;var s=e.serverCache.isFiltered(),u=e.serverCache;if(null!=r.value){if(Et(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return Dn(t,e,n,u.getNode().getChild(n),i,o,s,a);if(Et(n)){var c=new tn(null);return u.getNode().forEachChild(qt,(function(t,e){c=c.set(new vt(t),e)})),Mn(t,e,n,c,i,o,s,a)}return e}var h=new tn(null);return r.foreach((function(t,e){var r=Tt(n,t);u.isCompleteForPath(r)&&(h=h.set(t,u.getNode().getChild(r)))})),Mn(t,e,n,h,i,o,s,a)}(t,e,l.path,l.affectedTree,r,i,u)}else{if(n.type!==Fe.LISTEN_COMPLETE)throw(0,o.assertionError)("Unknown operation type: "+n.type);a=function(t,e,n,r,i){var o=e.serverCache,a=$e(e,o.getNode(),o.isFullyInitialized()||Et(n),o.isFiltered());return Rn(t,a,n,r,An,i)}(t,e,n.path,r,u)}var f=u.getChanges();return function(t,e,n){var r=e.eventCache;if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=Je(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(me(Je(e)))}}(e,a,f),{viewCache:a,changes:f}}function Rn(t,e,n,r,i,a){var s=e.eventCache;if(null!=In(r,n))return e;var u=void 0,c=void 0;if(Et(n))if((0,o.assert)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){var h=Ze(e),l=bn(r,h instanceof ue?h:ue.EMPTY_NODE);u=t.filter.updateFullNode(e.eventCache.getNode(),l,a)}else{var f=_n(r,Ze(e));u=t.filter.updateFullNode(e.eventCache.getNode(),f,a)}else{var d=yt(n);if(".priority"===d){(0,o.assert)(1===mt(n),"Can't have a priority with additional path components");var p=s.getNode(),v=wn(r,n,p,c=e.serverCache.getNode());u=null!=v?t.filter.updatePriority(p,v):s.getNode()}else{var g=_t(n),y=void 0;if(s.isCompleteForChild(d)){c=e.serverCache.getNode();var m=wn(r,n,s.getNode(),c);y=null!=m?s.getNode().getImmediateChild(d).updateChild(g,m):s.getNode().getImmediateChild(d)}else y=En(r,d,e.serverCache);u=null!=y?t.filter.updateChild(s.getNode(),d,y,g,i,a):s.getNode()}}return Xe(e,u,s.isFullyInitialized()||Et(n),t.filter.filtersNodes())}function Dn(t,e,n,r,i,o,a,s){var u,c=e.serverCache,h=a?t.filter:t.filter.getIndexedFilter();if(Et(n))u=h.updateFullNode(c.getNode(),r,null);else if(h.filtersNodes()&&!c.isFiltered()){var l=c.getNode().updateChild(n,r);u=h.updateFullNode(c.getNode(),l,null)}else{var f=yt(n);if(!c.isCompleteForPath(n)&&mt(n)>1)return e;var d=_t(n),p=c.getNode().getImmediateChild(f).updateChild(d,r);u=".priority"===f?h.updatePriority(c.getNode(),p):h.updateChild(c.getNode(),f,p,d,An,null)}var v=$e(e,u,c.isFullyInitialized()||Et(n),h.filtersNodes());return Rn(t,v,n,i,new Nn(i,v,o),s)}function xn(t,e,n,r,i,o,a){var s,u,c=e.eventCache,h=new Nn(i,e,o);if(Et(n))u=t.filter.updateFullNode(e.eventCache.getNode(),r,a),s=Xe(e,u,!0,t.filter.filtersNodes());else{var l=yt(n);if(".priority"===l)u=t.filter.updatePriority(e.eventCache.getNode(),r),s=Xe(e,u,c.isFullyInitialized(),c.isFiltered());else{var f=_t(n),d=c.getNode().getImmediateChild(l),p=void 0;if(Et(f))p=r;else{var v=h.getCompleteChild(l);p=null!=v?".priority"===bt(f)&&v.getChild(It(f)).isEmpty()?v:v.updateChild(f,r):ue.EMPTY_NODE}if(d.equals(p))s=e;else s=Xe(e,t.filter.updateChild(c.getNode(),l,p,f,h,a),c.isFullyInitialized(),t.filter.filtersNodes())}}return s}function On(t,e){return t.eventCache.isCompleteForChild(e)}function Ln(t,e,n){return n.foreach((function(t,n){e=e.updateChild(t,n)})),e}function Mn(t,e,n,r,i,o,a,s){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;var u,c=e;u=Et(n)?r:new tn(null).setTree(n,r);var h=e.serverCache.getNode();return u.children.inorderTraversal((function(n,r){if(h.hasChild(n)){var u=Ln(0,e.serverCache.getNode().getImmediateChild(n),r);c=Dn(t,c,new vt(n),u,i,o,a,s)}})),u.children.inorderTraversal((function(n,r){var u=!e.serverCache.isCompleteForChild(n)&&void 0===r.value;if(!h.hasChild(n)&&!u){var l=Ln(0,e.serverCache.getNode().getImmediateChild(n),r);c=Dn(t,c,new vt(n),l,i,o,a,s)}})),c}var Fn,Un=function(){function t(t,e){this.query_=t,this.eventRegistrations_=[];var n,r=this.query_._queryParams,i=new Ie(r.getIndex()),o=(n=r).loadsAllData()?new Ie(n.getIndex()):n.hasLimit()?new Ee(n):new Te(n);this.processor_=function(t){return{filter:t}}(o);var a=e.serverCache,s=e.eventCache,u=i.updateFullNode(ue.EMPTY_NODE,a.getNode(),null),c=o.updateFullNode(ue.EMPTY_NODE,s.getNode(),null),h=new Ge(u,a.isFullyInitialized(),i.filtersNodes()),l=new Ge(c,s.isFullyInitialized(),o.filtersNodes());this.viewCache_=Ye(l,h),this.eventGenerator_=new ze(this.query_)}return Object.defineProperty(t.prototype,"query",{get:function(){return this.query_},enumerable:!1,configurable:!0}),t}();function jn(t,e){var n=Ze(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!Et(e)&&!n.getImmediateChild(yt(e)).isEmpty())?n.getChild(e):null}function qn(t){return 0===t.eventRegistrations_.length}function Vn(t,e,n){var r=[];if(n){(0,o.assert)(null==e,"A cancel should cancel all event registrations.");var i=t.query._path;t.eventRegistrations_.forEach((function(t){var e=t.createCancelEvent(n,i);e&&r.push(e)}))}if(e){for(var a=[],s=0;s<t.eventRegistrations_.length;++s){var u=t.eventRegistrations_[s];if(u.matches(e)){if(e.hasAnyCallback()){a=a.concat(t.eventRegistrations_.slice(s+1));break}}else a.push(u)}t.eventRegistrations_=a}else t.eventRegistrations_=[];return r}function Bn(t,e,n,r){e.type===Fe.MERGE&&null!==e.source.queryId&&((0,o.assert)(Ze(t.viewCache_),"We should always have a full cache before handling merges"),(0,o.assert)(Je(t.viewCache_),"Missing event cache, even though we have a server cache"));var i,a,s=t.viewCache_,u=Pn(t.processor_,s,e,n,r);return i=t.processor_,a=u.viewCache,(0,o.assert)(a.eventCache.getNode().isIndexed(i.filter.getIndex()),"Event snap not indexed"),(0,o.assert)(a.serverCache.getNode().isIndexed(i.filter.getIndex()),"Server snap not indexed"),(0,o.assert)(u.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=u.viewCache,Kn(t,u.changes,u.viewCache.eventCache.getNode(),null)}function Kn(t,e,n,r){var i=r?[r]:t.eventRegistrations_;return function(t,e,n,r){var i=[],o=[];return e.forEach((function(e){var n;"child_changed"===e.type&&t.index_.indexedValueChanged(e.oldSnap,e.snapshotNode)&&o.push((n=e.childName,{type:"child_moved",snapshotNode:e.snapshotNode,childName:n}))})),Qe(t,i,"child_removed",e,r,n),Qe(t,i,"child_added",e,r,n),Qe(t,i,"child_moved",o,r,n),Qe(t,i,"child_changed",e,r,n),Qe(t,i,"value",e,r,n),i}(t.eventGenerator_,e,n,i)}var Wn,Hn=function(){this.views=new Map};function Gn(t,e,n,r){var i,s,u=e.source.queryId;if(null!==u){var c=t.views.get(u);return(0,o.assert)(null!=c,"SyncTree gave us an op for an invalid query."),Bn(c,e,n,r)}var h=[];try{for(var l=(0,a.__values)(t.views.values()),f=l.next();!f.done;f=l.next()){c=f.value;h=h.concat(Bn(c,e,n,r))}}catch(d){i={error:d}}finally{try{f&&!f.done&&(s=l.return)&&s.call(l)}finally{if(i)throw i.error}}return h}function zn(t,e,n,r,i){var o=e._queryIdentifier,a=t.views.get(o);if(!a){var s=_n(n,i?r:null),u=!1;s?u=!0:r instanceof ue?(s=bn(n,r),u=!1):(s=ue.EMPTY_NODE,u=!1);var c=Ye(new Ge(s,u,!1),new Ge(r,i,!1));return new Un(e,c)}return a}function Qn(t,e,n,r,i,o){var a=zn(t,e,r,i,o);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,a),function(t,e){t.eventRegistrations_.push(e)}(a,n),function(t,e){var n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(ne,(function(t,e){r.push(_e(t,e))})),n.isFullyInitialized()&&r.push(me(n.getNode())),Kn(t,r,n.getNode(),e)}(a,n)}function Yn(t,e,n,r){var i,s,u=e._queryIdentifier,c=[],h=[],l=tr(t);if("default"===u)try{for(var f=(0,a.__values)(t.views.entries()),d=f.next();!d.done;d=f.next()){var p=(0,a.__read)(d.value,2),v=p[0],g=p[1];h=h.concat(Vn(g,n,r)),qn(g)&&(t.views.delete(v),g.query._queryParams.loadsAllData()||c.push(g.query))}}catch(y){i={error:y}}finally{try{d&&!d.done&&(s=f.return)&&s.call(f)}finally{if(i)throw i.error}}else(g=t.views.get(u))&&(h=h.concat(Vn(g,n,r)),qn(g)&&(t.views.delete(u),g.query._queryParams.loadsAllData()||c.push(g.query)));return l&&!tr(t)&&c.push(new((0,o.assert)(Fn,"Reference.ts has not been loaded"),Fn)(e._repo,e._path)),{removed:c,events:h}}function Xn(t){var e,n,r=[];try{for(var i=(0,a.__values)(t.views.values()),o=i.next();!o.done;o=i.next()){var s=o.value;s.query._queryParams.loadsAllData()||r.push(s)}}catch(u){e={error:u}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function $n(t,e){var n,r,i=null;try{for(var o=(0,a.__values)(t.views.values()),s=o.next();!s.done;s=o.next()){var u=s.value;i=i||jn(u,e)}}catch(c){n={error:c}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i}function Jn(t,e){if(e._queryParams.loadsAllData())return er(t);var n=e._queryIdentifier;return t.views.get(n)}function Zn(t,e){return null!=Jn(t,e)}function tr(t){return null!=er(t)}function er(t){var e,n;try{for(var r=(0,a.__values)(t.views.values()),i=r.next();!i.done;i=r.next()){var o=i.value;if(o.query._queryParams.loadsAllData())return o}}catch(s){e={error:s}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return null}var nr=1,rr=function(t){this.listenProvider_=t,this.syncPointTree_=new tn(null),this.pendingWriteTree_={visibleWrites:en.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map};function ir(t,e,n,r,i){return function(t,e,n,r,i){(0,o.assert)(r>t.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=nn(t.visibleWrites,e,n)),t.lastWriteId=r}(t.pendingWriteTree_,e,n,r,i),i?fr(t,new We({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,n)):[]}function or(t,e,n,r){!function(t,e,n,r){(0,o.assert)(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=rn(t.visibleWrites,e,n),t.lastWriteId=r}(t.pendingWriteTree_,e,n,r);var i=tn.fromObject(n);return fr(t,new He({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,i))}function ar(t,e,n){void 0===n&&(n=!1);var r=function(t,e){for(var n=0;n<t.allWrites.length;n++){var r=t.allWrites[n];if(r.writeId===e)return r}return null}(t.pendingWriteTree_,e);if(pn(t.pendingWriteTree_,e)){var i=new tn(null);return null!=r.snap?i=i.set(gt(),!0):L(r.children,(function(t){i=i.set(new vt(t),!0)})),fr(t,new Be(r.path,i,n))}return[]}function sr(t,e,n){return fr(t,new We({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,n))}function ur(t,e,n,r){var i=e._path,o=t.syncPointTree_.get(i),a=[];if(o&&("default"===e._queryIdentifier||Zn(o,e))){var s=Yn(o,e,n,r);0===o.views.size&&(t.syncPointTree_=t.syncPointTree_.remove(i));var u=s.removed;a=s.events;var c=-1!==u.findIndex((function(t){return t._queryParams.loadsAllData()})),h=t.syncPointTree_.findOnPath(i,(function(t,e){return tr(e)}));if(c&&!h){var l=t.syncPointTree_.subtree(i);if(!l.isEmpty())for(var f=function(t){return t.fold((function(t,e,n){if(e&&tr(e))return[er(e)];var r=[];return e&&(r=Xn(e)),L(n,(function(t,e){r=r.concat(e)})),r}))}(l),d=0;d<f.length;++d){var p=f[d],v=p.query,g=vr(t,p);t.listenProvider_.startListening(wr(v),gr(t,v),g.hashFn,g.onComplete)}}if(!h&&u.length>0&&!r)if(c){t.listenProvider_.stopListening(wr(e),null)}else u.forEach((function(e){var n=t.queryToTagMap.get(yr(e));t.listenProvider_.stopListening(wr(e),n)}));!function(t,e){for(var n=0;n<e.length;++n){var r=e[n];if(!r._queryParams.loadsAllData()){var i=yr(r),o=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(o)}}}(t,u)}return a}function cr(t,e,n){var r=e._path,i=null,a=!1;t.syncPointTree_.foreachOnPath(r,(function(t,e){var n=St(t,r);i=i||$n(e,n),a=a||tr(e)}));var s,u=t.syncPointTree_.get(r);(u?(a=a||tr(u),i=i||$n(u,gt())):(u=new Hn,t.syncPointTree_=t.syncPointTree_.set(r,u)),null!=i)?s=!0:(s=!1,i=ue.EMPTY_NODE,t.syncPointTree_.subtree(r).foreachChild((function(t,e){var n=$n(e,gt());n&&(i=i.updateImmediateChild(t,n))})));var c=Zn(u,e);if(!c&&!e._queryParams.loadsAllData()){var h=yr(e);(0,o.assert)(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");var l=nr++;t.queryToTagMap.set(h,l),t.tagToQueryMap.set(l,h)}var f=Qn(u,e,n,dn(t.pendingWriteTree_,r),i,s);if(!c&&!a){var d=Jn(u,e);f=f.concat(function(t,e,n){var r=e._path,i=gr(t,e),a=vr(t,n),s=t.listenProvider_.startListening(wr(e),i,a.hashFn,a.onComplete),u=t.syncPointTree_.subtree(r);if(i)(0,o.assert)(!tr(u.value),"If we're adding a query, it shouldn't be shadowed");else for(var c=u.fold((function(t,e,n){if(!Et(t)&&e&&tr(e))return[er(e).query];var r=[];return e&&(r=r.concat(Xn(e).map((function(t){return t.query})))),L(n,(function(t,e){r=r.concat(e)})),r})),h=0;h<c.length;++h){var l=c[h];t.listenProvider_.stopListening(wr(l),gr(t,l))}return s}(t,e,d))}return f}function hr(t,e,n){var r=t.pendingWriteTree_,i=t.syncPointTree_.findOnPath(e,(function(t,n){var r=$n(n,St(t,e));if(r)return r}));return mn(r,e,i,n,!0)}function lr(t,e){var n=e._path,r=null;t.syncPointTree_.foreachOnPath(n,(function(t,e){var i=St(t,n);r=r||$n(e,i)}));var i=t.syncPointTree_.get(n);i?r=r||$n(i,gt()):(i=new Hn,t.syncPointTree_=t.syncPointTree_.set(n,i));var o=null!=r,a=o?new Ge(r,!0,!1):null;return function(t){return Je(t.viewCache_)}(zn(i,e,dn(t.pendingWriteTree_,e._path),o?a.getNode():ue.EMPTY_NODE,o))}function fr(t,e){return dr(e,t.syncPointTree_,null,dn(t.pendingWriteTree_,gt()))}function dr(t,e,n,r){if(Et(t.path))return pr(t,e,n,r);var i=e.get(gt());null==n&&null!=i&&(n=$n(i,gt()));var o=[],a=yt(t.path),s=t.operationForChild(a),u=e.children.get(a);if(u&&s){var c=n?n.getImmediateChild(a):null,h=Sn(r,a);o=o.concat(dr(s,u,c,h))}return i&&(o=o.concat(Gn(i,t,r,n))),o}function pr(t,e,n,r){var i=e.get(gt());null==n&&null!=i&&(n=$n(i,gt()));var o=[];return e.children.inorderTraversal((function(e,i){var a=n?n.getImmediateChild(e):null,s=Sn(r,e),u=t.operationForChild(e);u&&(o=o.concat(pr(u,i,a,s)))})),i&&(o=o.concat(Gn(i,t,r,n))),o}function vr(t,e){var n=e.query,r=gr(t,n);return{hashFn:function(){var t=function(t){return t.viewCache_.serverCache.getNode()}(e)||ue.EMPTY_NODE;return t.hash()},onComplete:function(e){if("ok"===e)return r?function(t,e,n){var r=mr(t,n);if(r){var i=_r(r),o=i.path,a=i.queryId,s=St(o,e);return br(t,o,new Ke(qe(a),s))}return[]}(t,n._path,r):function(t,e){return fr(t,new Ke({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(t,n._path);var i=function(t,e){var n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===t?n="Client doesn't have permission to access the desired data.":"unavailable"===t&&(n="The service is unavailable");var r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}(e,n);return ur(t,n,null,i)}}}function gr(t,e){var n=yr(e);return t.queryToTagMap.get(n)}function yr(t){return t._path.toString()+"$"+t._queryIdentifier}function mr(t,e){return t.tagToQueryMap.get(e)}function _r(t){var e=t.indexOf("$");return(0,o.assert)(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new vt(t.substr(0,e))}}function br(t,e,n){var r=t.syncPointTree_.get(e);return(0,o.assert)(r,"Missing sync point for query tag that we're tracking"),Gn(r,n,dn(t.pendingWriteTree_,e),null)}function wr(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new((0,o.assert)(Wn,"Reference.ts has not been loaded"),Wn)(t._repo,t._path):t}var Ir=function(){function t(t){this.node_=t}return t.prototype.getImmediateChild=function(e){return new t(this.node_.getImmediateChild(e))},t.prototype.node=function(){return this.node_},t}(),Tr=function(){function t(t,e){this.syncTree_=t,this.path_=e}return t.prototype.getImmediateChild=function(e){var n=Tt(this.path_,e);return new t(this.syncTree_,n)},t.prototype.node=function(){return hr(this.syncTree_,this.path_)},t}(),Er=function(t,e,n){return t&&"object"===typeof t?((0,o.assert)(".sv"in t,"Unexpected leaf node or priority contents"),"string"===typeof t[".sv"]?Sr(t[".sv"],e,n):"object"===typeof t[".sv"]?Cr(t[".sv"],e):void(0,o.assert)(!1,"Unexpected server value: "+JSON.stringify(t,null,2))):t},Sr=function(t,e,n){if("timestamp"===t)return n.timestamp;(0,o.assert)(!1,"Unexpected server value: "+t)},Cr=function(t,e,n){t.hasOwnProperty("increment")||(0,o.assert)(!1,"Unexpected server value: "+JSON.stringify(t,null,2));var r=t.increment;"number"!==typeof r&&(0,o.assert)(!1,"Unexpected increment value: "+r);var i=e.node();if((0,o.assert)(null!==i&&"undefined"!==typeof i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;var a=i.getValue();return"number"!==typeof a?r:a+r},kr=function(t,e,n,r){return Nr(e,new Tr(n,t),r)},Ar=function(t,e,n){return Nr(t,new Ir(e),n)};function Nr(t,e,n){var r,i=t.getPriority().val(),o=Er(i,e.getImmediateChild(".priority"),n);if(t.isLeafNode()){var a=t,s=Er(a.getValue(),e,n);return s!==a.getValue()||o!==a.getPriority().val()?new Jt(s,he(o)):t}var u=t;return r=u,o!==u.getPriority().val()&&(r=r.updatePriority(new Jt(o))),u.forEachChild(ne,(function(t,i){var o=Nr(i,e.getImmediateChild(t),n);o!==i&&(r=r.updateImmediateChild(t,o))})),r}var Pr=function(t,e,n){void 0===t&&(t=""),void 0===e&&(e=null),void 0===n&&(n={children:{},childCount:0}),this.name=t,this.parent=e,this.node=n};function Rr(t,e){for(var n=e instanceof vt?e:new vt(e),r=t,i=yt(n);null!==i;){var a=(0,o.safeGet)(r.node.children,i)||{children:{},childCount:0};r=new Pr(i,r,a),i=yt(n=_t(n))}return r}function Dr(t){return t.node.value}function xr(t,e){t.node.value=e,Ur(t)}function Or(t){return t.node.childCount>0}function Lr(t,e){L(t.node.children,(function(n,r){e(new Pr(n,t,r))}))}function Mr(t,e,n,r){n&&!r&&e(t),Lr(t,(function(t){Mr(t,e,!0,r)})),n&&r&&e(t)}function Fr(t){return new vt(null===t.parent?t.name:Fr(t.parent)+"/"+t.name)}function Ur(t){null!==t.parent&&function(t,e,n){var r=function(t){return void 0===Dr(t)&&!Or(t)}(n),i=(0,o.contains)(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,Ur(t)):r||i||(t.node.children[e]=n.node,t.node.childCount++,Ur(t))}(t.parent,t.name,t)}var jr=/[\[\].#$\/\u0000-\u001F\u007F]/,qr=/[\[\].#$\u0000-\u001F\u007F]/,Vr=10485760,Br=function(t){return"string"===typeof t&&0!==t.length&&!jr.test(t)},Kr=function(t){return"string"===typeof t&&0!==t.length&&!qr.test(t)},Wr=function(t){return null===t||"string"===typeof t||"number"===typeof t&&!k(t)||t&&"object"===typeof t&&(0,o.contains)(t,".sv")},Hr=function(t,e,n,r){r&&void 0===e||Gr((0,o.errorPrefix)(t,"value"),e,n)},Gr=function t(e,n,r){var i=r instanceof vt?new Nt(r,e):r;if(void 0===n)throw new Error(e+"contains undefined "+Rt(i));if("function"===typeof n)throw new Error(e+"contains a function "+Rt(i)+" with contents = "+n.toString());if(k(n))throw new Error(e+"contains "+n.toString()+" "+Rt(i));if("string"===typeof n&&n.length>Vr/3&&(0,o.stringLength)(n)>Vr)throw new Error(e+"contains a string greater than "+Vr+" utf8 bytes "+Rt(i)+" ('"+n.substring(0,50)+"...')");if(n&&"object"===typeof n){var a=!1,s=!1;if(L(n,(function(n,r){if(".value"===n)a=!0;else if(".priority"!==n&&".sv"!==n&&(s=!0,!Br(n)))throw new Error(e+" contains an invalid key ("+n+") "+Rt(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=(0,o.stringLength)(e),Pt(t)}(i,n),t(e,r,i),function(t){var e=t.parts_.pop();t.byteLength_-=(0,o.stringLength)(e),t.parts_.length>0&&(t.byteLength_-=1)}(i)})),a&&s)throw new Error(e+' contains ".value" child '+Rt(i)+" in addition to actual children.")}},zr=function(t,e,n,r){if(!r||void 0!==e){var i=(0,o.errorPrefix)(t,"values");if(!e||"object"!==typeof e||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");var a=[];L(e,(function(t,e){var r=new vt(t);if(Gr(i,e,Tt(n,r)),".priority"===bt(r)&&!Wr(e))throw new Error(i+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(r)})),function(t,e){var n,r;for(n=0;n<e.length;n++)for(var i=wt(r=e[n]),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!Br(i[o]))throw new Error(t+"contains an invalid key ("+i[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');e.sort(Ct);var a=null;for(n=0;n<e.length;n++){if(r=e[n],null!==a&&At(a,r))throw new Error(t+"contains a path "+a.toString()+" that is ancestor of another path "+r.toString());a=r}}(i,a)}},Qr=function(t,e,n){if(!n||void 0!==e){if(k(e))throw new Error((0,o.errorPrefix)(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Wr(e))throw new Error((0,o.errorPrefix)(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Yr=function(t,e,n){if(!n||void 0!==e)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error((0,o.errorPrefix)(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},Xr=function(t,e,n,r){if((!r||void 0!==n)&&!Br(n))throw new Error((0,o.errorPrefix)(t,e)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},$r=function(t,e,n,r){if((!r||void 0!==n)&&!Kr(n))throw new Error((0,o.errorPrefix)(t,e)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Jr=function(t,e){if(".info"===yt(e))throw new Error(t+" failed = Can't modify data under /.info/")},Zr=function(t,e){var n=e.path.toString();if("string"!==typeof e.repoInfo.host||0===e.repoInfo.host.length||!Br(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==n.length&&!function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Kr(t)}(n))throw new Error((0,o.errorPrefix)(t,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},ti=function(t,e,n,r){if((!r||void 0!==n)&&"boolean"!==typeof n)throw new Error((0,o.errorPrefix)(t,e)+"must be a boolean.")},ei=function(){this.eventLists_=[],this.recursionDepth_=0};function ni(t,e){for(var n=null,r=0;r<e.length;r++){var i=e[r],o=i.getPath();null===n||kt(o,n.path)||(t.eventLists_.push(n),n=null),null===n&&(n={events:[],path:o}),n.events.push(i)}n&&t.eventLists_.push(n)}function ri(t,e,n){ni(t,n),oi(t,(function(t){return kt(t,e)}))}function ii(t,e,n){ni(t,n),oi(t,(function(t){return At(t,e)||At(e,t)}))}function oi(t,e){t.recursionDepth_++;for(var n=!0,r=0;r<t.eventLists_.length;r++){var i=t.eventLists_[r];if(i)e(i.path)?(ai(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}n&&(t.eventLists_=[]),t.recursionDepth_--}function ai(t){for(var e=0;e<t.events.length;e++){var n=t.events[e];if(null!==n){t.events[e]=null;var r=n.getEventRunner();_&&I("event: "+n.toString()),V(r)}}}var si="repo_interrupt",ui=function(){function t(t,e,n,r){this.repoInfo_=t,this.forceRestClient_=e,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new ei,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=xe(),this.transactionQueueTree_=new Pr,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return t.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},t}();function ci(t,e,n){if(t.stats_=nt(t.repoInfo_),t.forceRestClient_||("object"===typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)t.server_=new Re(t.repoInfo_,(function(e,n,r,i){fi(t,e,n,r,i)}),t.authTokenProvider_,t.appCheckProvider_),setTimeout((function(){return di(t,!0)}),0);else{if("undefined"!==typeof n&&null!==n){if("object"!==typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,o.stringify)(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new Mt(t.repoInfo_,e,(function(e,n,r,i){fi(t,e,n,r,i)}),(function(e){di(t,e)}),(function(e){!function(t,e){L(e,(function(e,n){pi(t,e,n)}))}(t,e)}),t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener((function(e){t.server_.refreshAuthToken(e)})),t.appCheckProvider_.addTokenChangeListener((function(e){t.server_.refreshAppCheckToken(e.token)})),t.statsReporter_=function(t,e){var n=t.toString();return et[n]||(et[n]=e()),et[n]}(t.repoInfo_,(function(){return new je(t.stats_,t.server_)})),t.infoData_=new De,t.infoSyncTree_=new rr({startListening:function(e,n,r,i){var o=[],a=t.infoData_.getNode(e._path);return a.isEmpty()||(o=sr(t.infoSyncTree_,e._path,a),setTimeout((function(){i("ok")}),0)),o},stopListening:function(){}}),pi(t,"connected",!1),t.serverSyncTree_=new rr({startListening:function(e,n,r,i){return t.server_.listen(e,r,n,(function(n,r){var o=i(n,r);ii(t.eventQueue_,e._path,o)})),[]},stopListening:function(e,n){t.server_.unlisten(e,n)}})}function hi(t){var e=t.infoData_.getNode(new vt(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+e}function li(t){return(e=(e={timestamp:hi(t)})||{}).timestamp=e.timestamp||(new Date).getTime(),e;var e}function fi(t,e,n,r,i){t.dataUpdateCount++;var a=new vt(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;var s=[];if(i)if(r){var u=(0,o.map)(n,(function(t){return he(t)}));s=function(t,e,n,r){var i=mr(t,r);if(i){var o=_r(i),a=o.path,s=o.queryId,u=St(a,e),c=tn.fromObject(n);return br(t,a,new He(qe(s),u,c))}return[]}(t.serverSyncTree_,a,u,i)}else{var c=he(n);s=function(t,e,n,r){var i=mr(t,r);if(null!=i){var o=_r(i),a=o.path,s=o.queryId,u=St(a,e);return br(t,a,new We(qe(s),u,n))}return[]}(t.serverSyncTree_,a,c,i)}else if(r){var h=(0,o.map)(n,(function(t){return he(t)}));s=function(t,e,n){var r=tn.fromObject(n);return fr(t,new He({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,r))}(t.serverSyncTree_,a,h)}else{var l=he(n);s=sr(t.serverSyncTree_,a,l)}var f=a;s.length>0&&(f=Si(t,a)),ii(t.eventQueue_,f,s)}function di(t,e){pi(t,"connected",e),!1===e&&function(t){wi(t,"onDisconnectEvents");var e=li(t),n=xe();Me(t.onDisconnect_,gt(),(function(r,i){var o=kr(r,i,t.serverSyncTree_,e);Oe(n,r,o)}));var r=[];Me(n,gt(),(function(e,n){r=r.concat(sr(t.serverSyncTree_,e,n));var i=Pi(t,e);Si(t,i)})),t.onDisconnect_=xe(),ii(t.eventQueue_,gt(),r)}(t)}function pi(t,e,n){var r=new vt("/.info/"+e),i=he(n);t.infoData_.updateSnapshot(r,i);var o=sr(t.infoSyncTree_,r,i);ii(t.eventQueue_,r,o)}function vi(t){return t.nextWriteId_++}function gi(t,e,n,r,i){wi(t,"set",{path:e.toString(),value:n,priority:r});var o=li(t),a=he(n,r),s=hr(t.serverSyncTree_,e),u=Ar(a,s,o),c=vi(t),h=ir(t.serverSyncTree_,e,u,c,!0);ni(t.eventQueue_,h),t.server_.put(e.toString(),a.val(!0),(function(n,r){var o="ok"===n;o||C("set at "+e+" failed: "+n);var a=ar(t.serverSyncTree_,c,!o);ii(t.eventQueue_,e,a),Ii(t,i,n,r)}));var l=Pi(t,e);Si(t,l),ii(t.eventQueue_,l,[])}function yi(t,e,n){t.server_.onDisconnectCancel(e.toString(),(function(r,i){"ok"===r&&Le(t.onDisconnect_,e),Ii(t,n,r,i)}))}function mi(t,e,n,r){var i=he(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(function(n,o){"ok"===n&&Oe(t.onDisconnect_,e,i),Ii(t,r,n,o)}))}function _i(t,e,n){var r;r=".info"===yt(e._path)?ur(t.infoSyncTree_,e,n):ur(t.serverSyncTree_,e,n),ri(t.eventQueue_,e._path,r)}function bi(t){t.persistentConnection_&&t.persistentConnection_.interrupt(si)}function wi(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r="";t.persistentConnection_&&(r=t.persistentConnection_.id+":"),I.apply(void 0,(0,a.__spreadArray)([r],(0,a.__read)(e)))}function Ii(t,e,n,r){e&&V((function(){if("ok"===n)e(null);else{var t=(n||"error").toUpperCase(),i=t;r&&(i+=": "+r);var o=new Error(i);o.code=t,e(o)}}))}function Ti(t,e,n){return hr(t.serverSyncTree_,e,n)||ue.EMPTY_NODE}function Ei(t,e){if(void 0===e&&(e=t.transactionQueueTree_),e||Ni(t,e),Dr(e)){var n=ki(t,e);(0,o.assert)(n.length>0,"Sending zero length transaction queue"),n.every((function(t){return 0===t.status}))&&function(t,e,n){for(var r=n.map((function(t){return t.currentWriteId})),i=Ti(t,e,r),a=i,s=i.hash(),u=0;u<n.length;u++){var c=n[u];(0,o.assert)(0===c.status,"tryToSendTransactionQueue_: items in queue should all be run."),c.status=1,c.retryCount++;var h=St(e,c.path);a=a.updateChild(h,c.currentOutputSnapshotRaw)}var l=a.val(!0),f=e;t.server_.put(f.toString(),l,(function(r){wi(t,"transaction put response",{path:f.toString(),status:r});var i=[];if("ok"===r){for(var o=[],a=function(e){n[e].status=2,i=i.concat(ar(t.serverSyncTree_,n[e].currentWriteId)),n[e].onComplete&&o.push((function(){return n[e].onComplete(null,!0,n[e].currentOutputSnapshotResolved)})),n[e].unwatcher()},s=0;s<n.length;s++)a(s);Ni(t,Rr(t.transactionQueueTree_,e)),Ei(t,t.transactionQueueTree_),ii(t.eventQueue_,e,i);for(s=0;s<o.length;s++)V(o[s])}else{if("datastale"===r)for(s=0;s<n.length;s++)3===n[s].status?n[s].status=4:n[s].status=0;else{C("transaction at "+f.toString()+" failed: "+r);for(s=0;s<n.length;s++)n[s].status=4,n[s].abortReason=r}Si(t,e)}}),s)}(t,Fr(e),n)}else Or(e)&&Lr(e,(function(e){Ei(t,e)}))}function Si(t,e){var n=Ci(t,e),r=Fr(n);return function(t,e,n){if(0===e.length)return;for(var r=[],i=[],a=e.filter((function(t){return 0===t.status})).map((function(t){return t.currentWriteId})),s=function(s){var u,c,h=e[s],l=St(n,h.path),f=!1;if((0,o.assert)(null!==l,"rerunTransactionsUnderNode_: relativePath should not be null."),4===h.status)f=!0,u=h.abortReason,i=i.concat(ar(t.serverSyncTree_,h.currentWriteId,!0));else if(0===h.status)if(h.retryCount>=25)f=!0,u="maxretry",i=i.concat(ar(t.serverSyncTree_,h.currentWriteId,!0));else{var d=Ti(t,h.path,a);h.currentInputSnapshot=d;var p=e[s].update(d.val());if(void 0!==p){Gr("transaction failed: Data returned ",p,h.path);var v=he(p);"object"===typeof p&&null!=p&&(0,o.contains)(p,".priority")||(v=v.updatePriority(d.getPriority()));var g=h.currentWriteId,y=li(t),m=Ar(v,d,y);h.currentOutputSnapshotRaw=v,h.currentOutputSnapshotResolved=m,h.currentWriteId=vi(t),a.splice(a.indexOf(g),1),i=(i=i.concat(ir(t.serverSyncTree_,h.path,m,h.currentWriteId,h.applyLocally))).concat(ar(t.serverSyncTree_,g,!0))}else f=!0,u="nodata",i=i.concat(ar(t.serverSyncTree_,h.currentWriteId,!0))}ii(t.eventQueue_,n,i),i=[],f&&(e[s].status=2,c=e[s].unwatcher,setTimeout(c,Math.floor(0)),e[s].onComplete&&("nodata"===u?r.push((function(){return e[s].onComplete(null,!1,e[s].currentInputSnapshot)})):r.push((function(){return e[s].onComplete(new Error(u),!1,null)}))))},u=0;u<e.length;u++)s(u);Ni(t,t.transactionQueueTree_);for(u=0;u<r.length;u++)V(r[u]);Ei(t,t.transactionQueueTree_)}(t,ki(t,n),r),r}function Ci(t,e){var n,r=t.transactionQueueTree_;for(n=yt(e);null!==n&&void 0===Dr(r);)r=Rr(r,n),n=yt(e=_t(e));return r}function ki(t,e){var n=[];return Ai(t,e,n),n.sort((function(t,e){return t.order-e.order})),n}function Ai(t,e,n){var r=Dr(e);if(r)for(var i=0;i<r.length;i++)n.push(r[i]);Lr(e,(function(e){Ai(t,e,n)}))}function Ni(t,e){var n=Dr(e);if(n){for(var r=0,i=0;i<n.length;i++)2!==n[i].status&&(n[r]=n[i],r++);n.length=r,xr(e,n.length>0?n:void 0)}Lr(e,(function(e){Ni(t,e)}))}function Pi(t,e){var n=Fr(Ci(t,e)),r=Rr(t.transactionQueueTree_,e);return function(t,e,n){for(var r=n?t:t.parent;null!==r;){if(e(r))return!0;r=r.parent}}(r,(function(e){Ri(t,e)})),Ri(t,r),Mr(r,(function(e){Ri(t,e)})),n}function Ri(t,e){var n=Dr(e);if(n){for(var r=[],i=[],a=-1,s=0;s<n.length;s++)3===n[s].status||(1===n[s].status?((0,o.assert)(a===s-1,"All SENT items should be at beginning of queue."),a=s,n[s].status=3,n[s].abortReason="set"):((0,o.assert)(0===n[s].status,"Unexpected transaction status in abort"),n[s].unwatcher(),i=i.concat(ar(t.serverSyncTree_,n[s].currentWriteId,!0)),n[s].onComplete&&r.push(n[s].onComplete.bind(null,new Error("set"),!1,null))));-1===a?xr(e,void 0):n.length=a+1,ii(t.eventQueue_,Fr(e),i);for(s=0;s<r.length;s++)V(r[s])}}var Di=function(t,e){var n=xi(t),r=n.namespace;"firebase.com"===n.domain&&S(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||S("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!==typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&C("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");var i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new $(n.host,n.secure,r,e,i,"",r!==n.subdomain),path:new vt(n.pathString)}},xi=function(t){var e="",n="",r="",i="",o="",s=!0,u="https",c=443;if("string"===typeof t){var h=t.indexOf("//");h>=0&&(u=t.substring(0,h-1),t=t.substring(h+2));var l=t.indexOf("/");-1===l&&(l=t.length);var f=t.indexOf("?");-1===f&&(f=t.length),e=t.substring(0,Math.min(l,f)),l<f&&(i=function(t){for(var e="",n=t.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(o){}e+="/"+i}return e}(t.substring(l,f)));var d=function(t){var e,n,r={};"?"===t.charAt(0)&&(t=t.substring(1));try{for(var i=(0,a.__values)(t.split("&")),o=i.next();!o.done;o=i.next()){var s=o.value;if(0!==s.length){var u=s.split("=");2===u.length?r[decodeURIComponent(u[0])]=decodeURIComponent(u[1]):C("Invalid query segment '"+s+"' in query '"+t+"'")}}}catch(c){e={error:c}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}(t.substring(Math.min(t.length,f)));(h=e.indexOf(":"))>=0?(s="https"===u||"wss"===u,c=parseInt(e.substring(h+1),10)):h=e.length;var p=e.slice(0,h);if("localhost"===p.toLowerCase())n="localhost";else if(p.split(".").length<=2)n=p;else{var v=e.indexOf(".");r=e.substring(0,v).toLowerCase(),n=e.substring(v+1),o=r}"ns"in d&&(o=d.ns)}return{host:e,port:c,domain:n,subdomain:r,secure:s,scheme:u,pathString:i,namespace:o}},Oi=function(){function t(t,e,n,r){this.eventType=t,this.eventRegistration=e,this.snapshot=n,this.prevName=r}return t.prototype.getPath=function(){var t=this.snapshot.ref;return"value"===this.eventType?t._path:t.parent._path},t.prototype.getEventType=function(){return this.eventType},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+(0,o.stringify)(this.snapshot.exportVal())},t}(),Li=function(){function t(t,e,n){this.eventRegistration=t,this.error=e,this.path=n}return t.prototype.getPath=function(){return this.path},t.prototype.getEventType=function(){return"cancel"},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.path.toString()+":cancel"},t}(),Mi=function(){function t(t,e){this.snapshotCallback=t,this.cancelCallback=e}return t.prototype.onValue=function(t,e){this.snapshotCallback.call(null,t,e)},t.prototype.onCancel=function(t){return(0,o.assert)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,t)},Object.defineProperty(t.prototype,"hasCancelCallback",{get:function(){return!!this.cancelCallback},enumerable:!1,configurable:!0}),t.prototype.matches=function(t){return this.snapshotCallback===t.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===t.snapshotCallback.userCallback&&this.snapshotCallback.context===t.snapshotCallback.context},t}(),Fi=function(){function t(t,e){this._repo=t,this._path=e}return t.prototype.cancel=function(){var t=new o.Deferred;return yi(this._repo,this._path,t.wrapCallback((function(){}))),t.promise},t.prototype.remove=function(){Jr("OnDisconnect.remove",this._path);var t=new o.Deferred;return mi(this._repo,this._path,null,t.wrapCallback((function(){}))),t.promise},t.prototype.set=function(t){Jr("OnDisconnect.set",this._path),Hr("OnDisconnect.set",t,this._path,!1);var e=new o.Deferred;return mi(this._repo,this._path,t,e.wrapCallback((function(){}))),e.promise},t.prototype.setWithPriority=function(t,e){Jr("OnDisconnect.setWithPriority",this._path),Hr("OnDisconnect.setWithPriority",t,this._path,!1),Qr("OnDisconnect.setWithPriority",e,!1);var n=new o.Deferred;return function(t,e,n,r,i){var o=he(n,r);t.server_.onDisconnectPut(e.toString(),o.val(!0),(function(n,r){"ok"===n&&Oe(t.onDisconnect_,e,o),Ii(0,i,n,r)}))}(this._repo,this._path,t,e,n.wrapCallback((function(){}))),n.promise},t.prototype.update=function(t){Jr("OnDisconnect.update",this._path),zr("OnDisconnect.update",t,this._path,!1);var e=new o.Deferred;return function(t,e,n,r){if((0,o.isEmpty)(n))return I("onDisconnect().update() called with empty data.  Don't do anything."),void Ii(0,r,"ok",void 0);t.server_.onDisconnectMerge(e.toString(),n,(function(i,o){"ok"===i&&L(n,(function(n,r){var i=he(r);Oe(t.onDisconnect_,Tt(e,n),i)})),Ii(0,r,i,o)}))}(this._repo,this._path,t,e.wrapCallback((function(){}))),e.promise},t}(),Ui=function(){function t(t,e,n,r){this._repo=t,this._path=e,this._queryParams=n,this._orderByCalled=r}return Object.defineProperty(t.prototype,"key",{get:function(){return Et(this._path)?null:bt(this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Bi(this._repo,this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_queryIdentifier",{get:function(){var t=Pe(this._queryParams),e=x(t);return"{}"===e?"default":e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_queryObject",{get:function(){return Pe(this._queryParams)},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){if(!((e=(0,o.getModularInstance)(e))instanceof t))return!1;var n=this._repo===e._repo,r=kt(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i},t.prototype.toJSON=function(){return this.toString()},t.prototype.toString=function(){return this._repo.toString()+function(t){for(var e="",n=t.pieceNum_;n<t.pieces_.length;n++)""!==t.pieces_[n]&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}(this._path)},t}();function ji(t,e){if(!0===t._orderByCalled)throw new Error(e+": You can't combine multiple orderBy calls.")}function qi(t){var e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===qt){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==A)throw new Error(r);if("string"!==typeof e)throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==N)throw new Error(r);if("string"!==typeof n)throw new Error(i)}}else if(t.getIndex()===ne){if(null!=e&&!Wr(e)||null!=n&&!Wr(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,o.assert)(t.getIndex()instanceof le||t.getIndex()===de,"unknown index type."),null!=e&&"object"===typeof e||null!=n&&"object"===typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Vi(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var Bi=function(t){function e(e,n){return t.call(this,e,n,new Se,!1)||this}return(0,a.__extends)(e,t),Object.defineProperty(e.prototype,"parent",{get:function(){var t=It(this._path);return null===t?null:new e(this._repo,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){for(var t=this;null!==t.parent;)t=t.parent;return t},enumerable:!1,configurable:!0}),e}(Ui),Ki=function(){function t(t,e,n){this._node=t,this.ref=e,this._index=n}return Object.defineProperty(t.prototype,"priority",{get:function(){return this._node.getPriority().val()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this.ref.key},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._node.numChildren()},enumerable:!1,configurable:!0}),t.prototype.child=function(e){var n=new vt(e),r=Gi(this.ref,e);return new t(this._node.getChild(n),r,ne)},t.prototype.exists=function(){return!this._node.isEmpty()},t.prototype.exportVal=function(){return this._node.val(!0)},t.prototype.forEach=function(e){var n=this;return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(function(r,i){return e(new t(i,Gi(n.ref,r),ne))}))},t.prototype.hasChild=function(t){var e=new vt(t);return!this._node.getChild(e).isEmpty()},t.prototype.hasChildren=function(){return!this._node.isLeafNode()&&!this._node.isEmpty()},t.prototype.toJSON=function(){return this.exportVal()},t.prototype.val=function(){return this._node.val()},t}();function Wi(t,e){return(t=(0,o.getModularInstance)(t))._checkNotDeleted("ref"),void 0!==e?Gi(t._root,e):t._root}function Hi(t,e){(t=(0,o.getModularInstance)(t))._checkNotDeleted("refFromURL");var n=Di(e,t._repo.repoInfo_.nodeAdmin);Zr("refFromURL",n);var r=n.repoInfo;return t._repo.repoInfo_.isCustomHost()||r.host===t._repo.repoInfo_.host||S("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),Wi(t,n.path.toString())}function Gi(t,e){var n,r,i,a;return null===yt((t=(0,o.getModularInstance)(t))._path)?(n="child",r="path",a=!1,(i=e)&&(i=i.replace(/^\/*\.info(\/|$)/,"/")),$r(n,r,i,a)):$r("child","path",e,!1),new Bi(t._repo,Tt(t._path,e))}function zi(t,e){t=(0,o.getModularInstance)(t),Jr("push",t._path),Hr("push",e,t._path,!0);var n,r=hi(t._repo),i=ve(r),a=Gi(t,i),s=Gi(t,i);return n=null!=e?Yi(s,e).then((function(){return s})):Promise.resolve(s),a.then=n.then.bind(n),a.catch=n.then.bind(n,void 0),a}function Qi(t){return Jr("remove",t._path),Yi(t,null)}function Yi(t,e){t=(0,o.getModularInstance)(t),Jr("set",t._path),Hr("set",e,t._path,!1);var n=new o.Deferred;return gi(t._repo,t._path,e,null,n.wrapCallback((function(){}))),n.promise}function Xi(t,e){t=(0,o.getModularInstance)(t),Jr("setPriority",t._path),Qr("setPriority",e,!1);var n=new o.Deferred;return gi(t._repo,Tt(t._path,".priority"),e,null,n.wrapCallback((function(){}))),n.promise}function $i(t,e,n){if(Jr("setWithPriority",t._path),Hr("setWithPriority",e,t._path,!1),Qr("setWithPriority",n,!1),".length"===t.key||".keys"===t.key)throw"setWithPriority failed: "+t.key+" is a read-only object.";var r=new o.Deferred;return gi(t._repo,t._path,e,n,r.wrapCallback((function(){}))),r.promise}function Ji(t,e){zr("update",e,t._path,!1);var n=new o.Deferred;return function(t,e,n,r){wi(t,"update",{path:e.toString(),value:n});var i=!0,o=li(t),a={};if(L(n,(function(n,r){i=!1,a[n]=kr(Tt(e,n),he(r),t.serverSyncTree_,o)})),i)I("update() called with empty data.  Don't do anything."),Ii(0,r,"ok",void 0);else{var s=vi(t),u=or(t.serverSyncTree_,e,a,s);ni(t.eventQueue_,u),t.server_.merge(e.toString(),n,(function(n,i){var o="ok"===n;o||C("update at "+e+" failed: "+n);var a=ar(t.serverSyncTree_,s,!o),u=a.length>0?Si(t,e):e;ii(t.eventQueue_,u,a),Ii(0,r,n,i)})),L(n,(function(n){var r=Pi(t,Tt(e,n));Si(t,r)})),ii(t.eventQueue_,e,[])}}(t._repo,t._path,e,n.wrapCallback((function(){}))),n.promise}function Zi(t){return function(t,e){var n=lr(t.serverSyncTree_,e);return null!=n?Promise.resolve(n):t.server_.get(e).then((function(n){var r=he(n).withIndex(e._queryParams.getIndex()),i=sr(t.serverSyncTree_,e._path,r);return ri(t.eventQueue_,e._path,i),Promise.resolve(r)}),(function(n){return wi(t,"get for query "+(0,o.stringify)(e)+" failed: "+n),Promise.reject(new Error(n))}))}((t=(0,o.getModularInstance)(t))._repo,t).then((function(e){return new Ki(e,new Bi(t._repo,t._path),t._queryParams.getIndex())}))}var to=function(){function t(t){this.callbackContext=t}return t.prototype.respondsTo=function(t){return"value"===t},t.prototype.createEvent=function(t,e){var n=e._queryParams.getIndex();return new Oi("value",this,new Ki(t.snapshotNode,new Bi(e._repo,e._path),n))},t.prototype.getEventRunner=function(t){var e=this;return"cancel"===t.getEventType()?function(){return e.callbackContext.onCancel(t.error)}:function(){return e.callbackContext.onValue(t.snapshot,null)}},t.prototype.createCancelEvent=function(t,e){return this.callbackContext.hasCancelCallback?new Li(this,t,e):null},t.prototype.matches=function(e){return e instanceof t&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))},t.prototype.hasAnyCallback=function(){return null!==this.callbackContext},t}(),eo=function(){function t(t,e){this.eventType=t,this.callbackContext=e}return t.prototype.respondsTo=function(t){var e="children_added"===t?"child_added":t;return e="children_removed"===e?"child_removed":e,this.eventType===e},t.prototype.createCancelEvent=function(t,e){return this.callbackContext.hasCancelCallback?new Li(this,t,e):null},t.prototype.createEvent=function(t,e){(0,o.assert)(null!=t.childName,"Child events should have a childName.");var n=Gi(new Bi(e._repo,e._path),t.childName),r=e._queryParams.getIndex();return new Oi(t.type,this,new Ki(t.snapshotNode,n,r),t.prevName)},t.prototype.getEventRunner=function(t){var e=this;return"cancel"===t.getEventType()?function(){return e.callbackContext.onCancel(t.error)}:function(){return e.callbackContext.onValue(t.snapshot,t.prevName)}},t.prototype.matches=function(e){return e instanceof t&&(this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)))},t.prototype.hasAnyCallback=function(){return!!this.callbackContext},t}();function no(t,e,n,r,i){var o;if("object"===typeof r&&(o=void 0,i=r),"function"===typeof r&&(o=r),i&&i.onlyOnce){var a=n,s=function(e,n){_i(t._repo,t,c),a(e,n)};s.userCallback=n.userCallback,s.context=n.context,n=s}var u=new Mi(n,o||void 0),c="value"===e?new to(u):new eo(e,u);return function(t,e,n){var r;r=".info"===yt(e._path)?cr(t.infoSyncTree_,e,n):cr(t.serverSyncTree_,e,n),ri(t.eventQueue_,e._path,r)}(t._repo,t,c),function(){return _i(t._repo,t,c)}}function ro(t,e,n,r){return no(t,"value",e,n,r)}function io(t,e,n,r){return no(t,"child_added",e,n,r)}function oo(t,e,n,r){return no(t,"child_changed",e,n,r)}function ao(t,e,n,r){return no(t,"child_moved",e,n,r)}function so(t,e,n,r){return no(t,"child_removed",e,n,r)}function uo(t,e,n){var r=null,i=n?new Mi(n):null;"value"===e?r=new to(i):e&&(r=new eo(e,i)),_i(t._repo,t,r)}var co=function(){},ho=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return(0,a.__extends)(e,t),e.prototype._apply=function(t){Hr("endAt",this._value,t._path,!0);var e=ke(t._queryParams,this._value,this._key);if(Vi(e),qi(e),t._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Ui(t._repo,t._path,e,t._orderByCalled)},e}(co);function lo(t,e){return Xr("endAt","key",e,!0),new ho(t,e)}var fo=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return(0,a.__extends)(e,t),e.prototype._apply=function(t){Hr("endBefore",this._value,t._path,!1);var e=function(t,e,n){var r;return t.index_===qt?("string"===typeof e&&(e=ye(e)),r=ke(t,e,n)):r=ke(t,e,null==n?A:ye(n)),r.endBeforeSet_=!0,r}(t._queryParams,this._value,this._key);if(Vi(e),qi(e),t._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Ui(t._repo,t._path,e,t._orderByCalled)},e}(co);function po(t,e){return Xr("endBefore","key",e,!0),new fo(t,e)}var vo=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return(0,a.__extends)(e,t),e.prototype._apply=function(t){Hr("startAt",this._value,t._path,!0);var e=Ce(t._queryParams,this._value,this._key);if(Vi(e),qi(e),t._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Ui(t._repo,t._path,e,t._orderByCalled)},e}(co);function go(t,e){return void 0===t&&(t=null),Xr("startAt","key",e,!0),new vo(t,e)}var yo=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return(0,a.__extends)(e,t),e.prototype._apply=function(t){Hr("startAfter",this._value,t._path,!1);var e=function(t,e,n){var r;t.index_===qt?("string"===typeof e&&(e=ge(e)),r=Ce(t,e,n)):r=Ce(t,e,null==n?N:ge(n));return r.startAfterSet_=!0,r}(t._queryParams,this._value,this._key);if(Vi(e),qi(e),t._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Ui(t._repo,t._path,e,t._orderByCalled)},e}(co);function mo(t,e){return Xr("startAfter","key",e,!0),new yo(t,e)}var _o=function(t){function e(e){var n=t.call(this)||this;return n._limit=e,n}return(0,a.__extends)(e,t),e.prototype._apply=function(t){if(t._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Ui(t._repo,t._path,function(t,e){var n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}(t._queryParams,this._limit),t._orderByCalled)},e}(co);function bo(t){if("number"!==typeof t||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new _o(t)}var wo=function(t){function e(e){var n=t.call(this)||this;return n._limit=e,n}return(0,a.__extends)(e,t),e.prototype._apply=function(t){if(t._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Ui(t._repo,t._path,function(t,e){var n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}(t._queryParams,this._limit),t._orderByCalled)},e}(co);function Io(t){if("number"!==typeof t||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new wo(t)}var To=function(t){function e(e){var n=t.call(this)||this;return n._path=e,n}return(0,a.__extends)(e,t),e.prototype._apply=function(t){ji(t,"orderByChild");var e=new vt(this._path);if(Et(e))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");var n=new le(e),r=Ae(t._queryParams,n);return qi(r),new Ui(t._repo,t._path,r,!0)},e}(co);function Eo(t){if("$key"===t)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===t)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===t)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return $r("orderByChild","path",t,!1),new To(t)}var So=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,a.__extends)(e,t),e.prototype._apply=function(t){ji(t,"orderByKey");var e=Ae(t._queryParams,qt);return qi(e),new Ui(t._repo,t._path,e,!0)},e}(co);function Co(){return new So}var ko=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,a.__extends)(e,t),e.prototype._apply=function(t){ji(t,"orderByPriority");var e=Ae(t._queryParams,ne);return qi(e),new Ui(t._repo,t._path,e,!0)},e}(co);function Ao(){return new ko}var No=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,a.__extends)(e,t),e.prototype._apply=function(t){ji(t,"orderByValue");var e=Ae(t._queryParams,de);return qi(e),new Ui(t._repo,t._path,e,!0)},e}(co);function Po(){return new No}var Ro=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return(0,a.__extends)(e,t),e.prototype._apply=function(t){if(Hr("equalTo",this._value,t._path,!1),t._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(t._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new ho(this._value,this._key)._apply(new vo(this._value,this._key)._apply(t))},e}(co);function Do(t,e){return Xr("equalTo","key",e,!0),new Ro(t,e)}function xo(t){for(var e,n,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var s=(0,o.getModularInstance)(t);try{for(var u=(0,a.__values)(r),c=u.next();!c.done;c=u.next()){var h=c.value;s=h._apply(s)}}catch(l){e={error:l}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(e)throw e.error}}return s}!function(t){(0,o.assert)(!Fn,"__referenceConstructor has already been defined"),Fn=t}(Bi),function(t){(0,o.assert)(!Wn,"__referenceConstructor has already been defined"),Wn=t}(Bi);var Oo={},Lo=!1;function Mo(t,e,n,r,i){var o=r||t.options.databaseURL;void 0===o&&(t.options.projectId||S("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),I("Using default host for project ",t.options.projectId),o=t.options.projectId+"-default-rtdb.firebaseio.com");var a,s=Di(o,i),u=s.repoInfo,c=void 0;"undefined"!==typeof process&&(c={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.FIREBASE_DATABASE_EMULATOR_HOST),c?(a=!0,o="http://"+c+"?ns="+u.namespace,u=(s=Di(o,i)).repoInfo):a=!s.repoInfo.secure;var h=i&&a?new H(H.OWNER):new W(t.name,t.options,e);Zr("Invalid Firebase Database URL",s),Et(s.path)||S("Database URL must point to the root of a Firebase Database (not including a child path).");var l=function(t,e,n,r){var i=Oo[e.name];i||(i={},Oo[e.name]=i);var o=i[t.toURLString()];o&&S("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return o=new ui(t,Lo,n,r),i[t.toURLString()]=o,o}(u,t,h,new K(t.name,n));return new Fo(l,t)}var Fo=function(){function t(t,e){this._repoInternal=t,this.app=e,this.type="database",this._instanceStarted=!1}return Object.defineProperty(t.prototype,"_repo",{get:function(){return this._instanceStarted||(ci(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_root",{get:function(){return this._rootInternal||(this._rootInternal=new Bi(this._repo,gt())),this._rootInternal},enumerable:!1,configurable:!0}),t.prototype._delete=function(){return null!==this._rootInternal&&(!function(t,e){var n=Oo[e];n&&n[t.key]===t||S("Database "+e+"("+t.repoInfo_+") has already been deleted."),bi(t),delete n[t.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()},t.prototype._checkNotDeleted=function(t){null===this._rootInternal&&S("Cannot call "+t+" on a deleted database.")},t}();function Uo(t,e,n,r){void 0===r&&(r={}),(t=(0,o.getModularInstance)(t))._checkNotDeleted("useEmulator"),t._instanceStarted&&S("Cannot call useEmulator() after instance has already been initialized.");var i=t._repoInternal,a=void 0;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&S('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),a=new H(H.OWNER);else if(r.mockUserToken){var s="string"===typeof r.mockUserToken?r.mockUserToken:(0,o.createMockUserToken)(r.mockUserToken,t.app.options.projectId);a=new H(s)}!function(t,e,n,r){t.repoInfo_=new $(e+":"+n,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams),r&&(t.authTokenProvider_=r)}(i,e,n,a)}function jo(t){(t=(0,o.getModularInstance)(t))._checkNotDeleted("goOffline"),bi(t._repo)}function qo(t){var e;(t=(0,o.getModularInstance)(t))._checkNotDeleted("goOnline"),(e=t._repo).persistentConnection_&&e.persistentConnection_.resume(si)}var Vo={".sv":"timestamp"};var Bo=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}();function Ko(t,e,n){var r;if(t=(0,o.getModularInstance)(t),Jr("Reference.transaction",t._path),".length"===t.key||".keys"===t.key)throw"Reference.transaction failed: "+t.key+" is a read-only object.";var i=null===(r=null===n||void 0===n?void 0:n.applyLocally)||void 0===r||r,a=new o.Deferred,s=ro(t,(function(){}));return function(t,e,n,r,i,a){wi(t,"transaction on "+e);var s={path:e,update:n,onComplete:r,status:null,order:g(),applyLocally:a,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},u=Ti(t,e,void 0);s.currentInputSnapshot=u;var c=s.update(u.val());if(void 0===c)s.unwatcher(),s.currentOutputSnapshotRaw=null,s.currentOutputSnapshotResolved=null,s.onComplete&&s.onComplete(null,!1,s.currentInputSnapshot);else{Gr("transaction failed: Data returned ",c,s.path),s.status=0;var h=Rr(t.transactionQueueTree_,e),l=Dr(h)||[];l.push(s),xr(h,l);var f=void 0;"object"===typeof c&&null!==c&&(0,o.contains)(c,".priority")?(f=(0,o.safeGet)(c,".priority"),(0,o.assert)(Wr(f),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):f=(hr(t.serverSyncTree_,e)||ue.EMPTY_NODE).getPriority().val();var d=li(t),p=he(c,f),v=Ar(p,u,d);s.currentOutputSnapshotRaw=p,s.currentOutputSnapshotResolved=v,s.currentWriteId=vi(t);var y=ir(t.serverSyncTree_,e,v,s.currentWriteId,s.applyLocally);ii(t.eventQueue_,e,y),Ei(t,t.transactionQueueTree_)}}(t._repo,t._path,e,(function(e,n,r){var i=null;e?a.reject(e):(i=new Ki(r,new Bi(t._repo,t._path),ne),a.resolve(new Bo(n,i)))}),s,i),a.promise}var Wo=function(){function t(t){this._delegate=t}return t.prototype.cancel=function(t){(0,o.validateArgCount)("OnDisconnect.cancel",0,1,arguments.length),(0,o.validateCallback)("OnDisconnect.cancel","onComplete",t,!0);var e=this._delegate.cancel();return t&&e.then((function(){return t(null)}),(function(e){return t(e)})),e},t.prototype.remove=function(t){(0,o.validateArgCount)("OnDisconnect.remove",0,1,arguments.length),(0,o.validateCallback)("OnDisconnect.remove","onComplete",t,!0);var e=this._delegate.remove();return t&&e.then((function(){return t(null)}),(function(e){return t(e)})),e},t.prototype.set=function(t,e){(0,o.validateArgCount)("OnDisconnect.set",1,2,arguments.length),(0,o.validateCallback)("OnDisconnect.set","onComplete",e,!0);var n=this._delegate.set(t);return e&&n.then((function(){return e(null)}),(function(t){return e(t)})),n},t.prototype.setWithPriority=function(t,e,n){(0,o.validateArgCount)("OnDisconnect.setWithPriority",2,3,arguments.length),(0,o.validateCallback)("OnDisconnect.setWithPriority","onComplete",n,!0);var r=this._delegate.setWithPriority(t,e);return n&&r.then((function(){return n(null)}),(function(t){return n(t)})),r},t.prototype.update=function(t,e){if((0,o.validateArgCount)("OnDisconnect.update",1,2,arguments.length),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,C("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}(0,o.validateCallback)("OnDisconnect.update","onComplete",e,!0);var i=this._delegate.update(t);return e&&i.then((function(){return e(null)}),(function(t){return e(t)})),i},t}(),Ho=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return(0,o.validateArgCount)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}(),Go=function(){function t(t,e){this._database=t,this._delegate=e}return t.prototype.val=function(){return(0,o.validateArgCount)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()},t.prototype.exportVal=function(){return(0,o.validateArgCount)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()},t.prototype.toJSON=function(){return(0,o.validateArgCount)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()},t.prototype.exists=function(){return(0,o.validateArgCount)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()},t.prototype.child=function(e){return(0,o.validateArgCount)("DataSnapshot.child",0,1,arguments.length),e=String(e),$r("DataSnapshot.child","path",e,!1),new t(this._database,this._delegate.child(e))},t.prototype.hasChild=function(t){return(0,o.validateArgCount)("DataSnapshot.hasChild",1,1,arguments.length),$r("DataSnapshot.hasChild","path",t,!1),this._delegate.hasChild(t)},t.prototype.getPriority=function(){return(0,o.validateArgCount)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority},t.prototype.forEach=function(e){var n=this;return(0,o.validateArgCount)("DataSnapshot.forEach",1,1,arguments.length),(0,o.validateCallback)("DataSnapshot.forEach","action",e,!1),this._delegate.forEach((function(r){return e(new t(n._database,r))}))},t.prototype.hasChildren=function(){return(0,o.validateArgCount)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()},Object.defineProperty(t.prototype,"key",{get:function(){return this._delegate.key},enumerable:!1,configurable:!0}),t.prototype.numChildren=function(){return(0,o.validateArgCount)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size},t.prototype.getRef=function(){return(0,o.validateArgCount)("DataSnapshot.ref",0,0,arguments.length),new Qo(this._database,this._delegate.ref)},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),t}(),zo=function(){function t(t,e){this.database=t,this._delegate=e}return t.prototype.on=function(e,n,r,i){var a,s=this;(0,o.validateArgCount)("Query.on",2,4,arguments.length),(0,o.validateCallback)("Query.on","callback",n,!1);var u=t.getCancelAndContextArgs_("Query.on",r,i),c=function(t,e){n.call(u.context,new Go(s.database,t),e)};c.userCallback=n,c.context=u.context;var h=null===(a=u.cancel)||void 0===a?void 0:a.bind(u.context);switch(e){case"value":return ro(this._delegate,c,h),n;case"child_added":return io(this._delegate,c,h),n;case"child_removed":return so(this._delegate,c,h),n;case"child_changed":return oo(this._delegate,c,h),n;case"child_moved":return ao(this._delegate,c,h),n;default:throw new Error((0,o.errorPrefix)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},t.prototype.off=function(t,e,n){if((0,o.validateArgCount)("Query.off",0,3,arguments.length),Yr("Query.off",t,!0),(0,o.validateCallback)("Query.off","callback",e,!0),(0,o.validateContextObject)("Query.off","context",n,!0),e){var r=function(){};r.userCallback=e,r.context=n,uo(this._delegate,t,r)}else uo(this._delegate,t)},t.prototype.get=function(){var t=this;return Zi(this._delegate).then((function(e){return new Go(t.database,e)}))},t.prototype.once=function(e,n,r,i){var a=this;(0,o.validateArgCount)("Query.once",1,4,arguments.length),(0,o.validateCallback)("Query.once","callback",n,!0);var s=t.getCancelAndContextArgs_("Query.once",r,i),u=new o.Deferred,c=function(t,e){var r=new Go(a.database,t);n&&n.call(s.context,r,e),u.resolve(r)};c.userCallback=n,c.context=s.context;var h=function(t){s.cancel&&s.cancel.call(s.context,t),u.reject(t)};switch(e){case"value":ro(this._delegate,c,h,{onlyOnce:!0});break;case"child_added":io(this._delegate,c,h,{onlyOnce:!0});break;case"child_removed":so(this._delegate,c,h,{onlyOnce:!0});break;case"child_changed":oo(this._delegate,c,h,{onlyOnce:!0});break;case"child_moved":ao(this._delegate,c,h,{onlyOnce:!0});break;default:throw new Error((0,o.errorPrefix)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return u.promise},t.prototype.limitToFirst=function(e){return(0,o.validateArgCount)("Query.limitToFirst",1,1,arguments.length),new t(this.database,xo(this._delegate,bo(e)))},t.prototype.limitToLast=function(e){return(0,o.validateArgCount)("Query.limitToLast",1,1,arguments.length),new t(this.database,xo(this._delegate,Io(e)))},t.prototype.orderByChild=function(e){return(0,o.validateArgCount)("Query.orderByChild",1,1,arguments.length),new t(this.database,xo(this._delegate,Eo(e)))},t.prototype.orderByKey=function(){return(0,o.validateArgCount)("Query.orderByKey",0,0,arguments.length),new t(this.database,xo(this._delegate,Co()))},t.prototype.orderByPriority=function(){return(0,o.validateArgCount)("Query.orderByPriority",0,0,arguments.length),new t(this.database,xo(this._delegate,Ao()))},t.prototype.orderByValue=function(){return(0,o.validateArgCount)("Query.orderByValue",0,0,arguments.length),new t(this.database,xo(this._delegate,Po()))},t.prototype.startAt=function(e,n){return void 0===e&&(e=null),(0,o.validateArgCount)("Query.startAt",0,2,arguments.length),new t(this.database,xo(this._delegate,go(e,n)))},t.prototype.startAfter=function(e,n){return void 0===e&&(e=null),(0,o.validateArgCount)("Query.startAfter",0,2,arguments.length),new t(this.database,xo(this._delegate,mo(e,n)))},t.prototype.endAt=function(e,n){return void 0===e&&(e=null),(0,o.validateArgCount)("Query.endAt",0,2,arguments.length),new t(this.database,xo(this._delegate,lo(e,n)))},t.prototype.endBefore=function(e,n){return void 0===e&&(e=null),(0,o.validateArgCount)("Query.endBefore",0,2,arguments.length),new t(this.database,xo(this._delegate,po(e,n)))},t.prototype.equalTo=function(e,n){return(0,o.validateArgCount)("Query.equalTo",1,2,arguments.length),new t(this.database,xo(this._delegate,Do(e,n)))},t.prototype.toString=function(){return(0,o.validateArgCount)("Query.toString",0,0,arguments.length),this._delegate.toString()},t.prototype.toJSON=function(){return(0,o.validateArgCount)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()},t.prototype.isEqual=function(e){if((0,o.validateArgCount)("Query.isEqual",1,1,arguments.length),!(e instanceof t)){var n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)},t.getCancelAndContextArgs_=function(t,e,n){var r={cancel:void 0,context:void 0};if(e&&n)r.cancel=e,(0,o.validateCallback)(t,"cancel",r.cancel,!0),r.context=n,(0,o.validateContextObject)(t,"context",r.context,!0);else if(e)if("object"===typeof e&&null!==e)r.context=e;else{if("function"!==typeof e)throw new Error((0,o.errorPrefix)(t,"cancelOrContext")+" must either be a cancel callback or a context object.");r.cancel=e}return r},Object.defineProperty(t.prototype,"ref",{get:function(){return new Qo(this.database,new Bi(this._delegate._repo,this._delegate._path))},enumerable:!1,configurable:!0}),t}(),Qo=function(t){function e(e,n){var r=t.call(this,e,new Ui(n._repo,n._path,new Se,!1))||this;return r.database=e,r._delegate=n,r}return(0,a.__extends)(e,t),e.prototype.getKey=function(){return(0,o.validateArgCount)("Reference.key",0,0,arguments.length),this._delegate.key},e.prototype.child=function(t){return(0,o.validateArgCount)("Reference.child",1,1,arguments.length),"number"===typeof t&&(t=String(t)),new e(this.database,Gi(this._delegate,t))},e.prototype.getParent=function(){(0,o.validateArgCount)("Reference.parent",0,0,arguments.length);var t=this._delegate.parent;return t?new e(this.database,t):null},e.prototype.getRoot=function(){return(0,o.validateArgCount)("Reference.root",0,0,arguments.length),new e(this.database,this._delegate.root)},e.prototype.set=function(t,e){(0,o.validateArgCount)("Reference.set",1,2,arguments.length),(0,o.validateCallback)("Reference.set","onComplete",e,!0);var n=Yi(this._delegate,t);return e&&n.then((function(){return e(null)}),(function(t){return e(t)})),n},e.prototype.update=function(t,e){if((0,o.validateArgCount)("Reference.update",1,2,arguments.length),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,C("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Jr("Reference.update",this._delegate._path),(0,o.validateCallback)("Reference.update","onComplete",e,!0);var i=Ji(this._delegate,t);return e&&i.then((function(){return e(null)}),(function(t){return e(t)})),i},e.prototype.setWithPriority=function(t,e,n){(0,o.validateArgCount)("Reference.setWithPriority",2,3,arguments.length),(0,o.validateCallback)("Reference.setWithPriority","onComplete",n,!0);var r=$i(this._delegate,t,e);return n&&r.then((function(){return n(null)}),(function(t){return n(t)})),r},e.prototype.remove=function(t){(0,o.validateArgCount)("Reference.remove",0,1,arguments.length),(0,o.validateCallback)("Reference.remove","onComplete",t,!0);var e=Qi(this._delegate);return t&&e.then((function(){return t(null)}),(function(e){return t(e)})),e},e.prototype.transaction=function(t,e,n){var r=this;(0,o.validateArgCount)("Reference.transaction",1,3,arguments.length),(0,o.validateCallback)("Reference.transaction","transactionUpdate",t,!1),(0,o.validateCallback)("Reference.transaction","onComplete",e,!0),ti("Reference.transaction","applyLocally",n,!0);var i=Ko(this._delegate,t,{applyLocally:n}).then((function(t){return new Ho(t.committed,new Go(r.database,t.snapshot))}));return e&&i.then((function(t){return e(null,t.committed,t.snapshot)}),(function(t){return e(t,!1,null)})),i},e.prototype.setPriority=function(t,e){(0,o.validateArgCount)("Reference.setPriority",1,2,arguments.length),(0,o.validateCallback)("Reference.setPriority","onComplete",e,!0);var n=Xi(this._delegate,t);return e&&n.then((function(){return e(null)}),(function(t){return e(t)})),n},e.prototype.push=function(t,n){var r=this;(0,o.validateArgCount)("Reference.push",0,2,arguments.length),(0,o.validateCallback)("Reference.push","onComplete",n,!0);var i=zi(this._delegate,t),a=i.then((function(t){return new e(r.database,t)}));n&&a.then((function(){return n(null)}),(function(t){return n(t)}));var s=new e(this.database,i);return s.then=a.then.bind(a),s.catch=a.catch.bind(a,void 0),s},e.prototype.onDisconnect=function(){return Jr("Reference.onDisconnect",this._delegate._path),new Wo(new Fi(this._delegate._repo,this._delegate._path))},Object.defineProperty(e.prototype,"key",{get:function(){return this.getKey()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this.getParent()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this.getRoot()},enumerable:!1,configurable:!0}),e}(zo),Yo=function(){function t(t,e){var n=this;this._delegate=t,this.app=e,this.INTERNAL={delete:function(){return n._delegate._delete()}}}return t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),Uo(this._delegate,t,e,n)},t.prototype.ref=function(t){if((0,o.validateArgCount)("database.ref",0,1,arguments.length),t instanceof Qo){var e=Hi(this._delegate,t.toString());return new Qo(this,e)}e=Wi(this._delegate,t);return new Qo(this,e)},t.prototype.refFromURL=function(t){var e="database.refFromURL";(0,o.validateArgCount)(e,1,1,arguments.length);var n=Hi(this._delegate,t);return new Qo(this,n)},t.prototype.goOffline=function(){return(0,o.validateArgCount)("database.goOffline",0,0,arguments.length),jo(this._delegate)},t.prototype.goOnline=function(){return(0,o.validateArgCount)("database.goOnline",0,0,arguments.length),qo(this._delegate)},t.ServerValue={TIMESTAMP:Vo,increment:function(t){return function(t){return{".sv":{increment:t}}}(t)}},t}();var Xo=Object.freeze({__proto__:null,forceLongPolling:function(){ct.forceDisallow(),at.forceAllow()},forceWebSockets:function(){at.forceDisallow()},isWebSocketsAvailable:function(){return ct.isAvailable()},setSecurityDebugCallback:function(t,e){t._delegate._repo.persistentConnection_.securityDebugCallback_=e},stats:function(t,e){!function(t,e){if(void 0===e&&(e=!1),"undefined"!==typeof console){var n;e?(t.statsListener_||(t.statsListener_=new Ue(t.stats_)),n=t.statsListener_.get()):n=t.stats_.get();var r=Object.keys(n).reduce((function(t,e){return Math.max(e.length,t)}),0);L(n,(function(t,e){for(var n=t,i=t.length;i<r+2;i++)n+=" ";console.log(n+e)}))}}(t._delegate._repo,e)},statsIncrementCounter:function(t,e){!function(t,e){var n,r;t.stats_.incrementCounter(e),n=t.statsReporter_,r=e,n.statsToReport_[r]=!0}(t._delegate._repo,e)},dataUpdateCount:function(t){return t._delegate._repo.dataUpdateCount},interceptServerData:function(t,e){return function(t,e){t.interceptServerDataCallback_=e}(t._delegate._repo,e)},initStandalone:function(t){var e=t.app,n=t.url,r=t.version,o=t.customAuthImpl,a=t.namespace,s=t.nodeAdmin,u=void 0!==s&&s;c(r);var h=new i.Provider("auth-internal",new i.ComponentContainer("database-standalone"));return h.setComponent(new i.Component("auth-internal",(function(){return o}),"PRIVATE")),{instance:new Yo(Mo(e,h,void 0,n,u),e),namespace:a}}}),$o=Mt;Mt.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},Mt.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};var Jo=lt,Zo=$,ta=Object.freeze({__proto__:null,DataConnection:$o,RealTimeConnection:Jo,hijackHash:function(t){var e=Mt.prototype.put;return Mt.prototype.put=function(n,r,i,o){void 0!==o&&(o=t()),e.call(this,n,r,i,o)},function(){Mt.prototype.put=e}},ConnectionTarget:Zo,queryIdentifier:function(t){return t._delegate._queryIdentifier},forceRestClient:function(t){!function(t){Lo=t}(t)}}),ea=Yo.ServerValue;!function(e){c(e.SDK_VERSION);var n=e.INTERNAL.registerComponent(new i.Component("database",(function(t,e){var n=e.instanceIdentifier,r=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal"),o=t.getProvider("app-check-internal");return new Yo(Mo(r,i,o,n),r)}),"PUBLIC").setServiceProps({Reference:Qo,Query:zo,Database:Yo,DataSnapshot:Go,enableLogging:w,INTERNAL:Xo,ServerValue:ea,TEST_ACCESS:ta}).setMultipleInstances(!0));e.registerVersion("@firebase/database","0.11.0"),(0,o.isNodeSdk)()&&(t.exports=n)}(r.default)},9386:function(t,e,n){"use strict";function r(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}var i;n.r(e),n.d(e,{LogLevel:function(){return o},Logger:function(){return l},setLogLevel:function(){return f},setUserLogHandler:function(){return d}});var o,a=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(o||(o={}));var s={debug:o.DEBUG,verbose:o.VERBOSE,info:o.INFO,warn:o.WARN,error:o.ERROR,silent:o.SILENT},u=o.INFO,c=((i={})[o.DEBUG]="log",i[o.VERBOSE]="log",i[o.INFO]="info",i[o.WARN]="warn",i[o.ERROR]="error",i),h=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var o=(new Date).toISOString(),a=c[e];if(!a)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[a].apply(console,r(["["+o+"]  "+t.name+":"],n))}},l=function(){function t(t){this.name=t,this._logLevel=u,this._logHandler=h,this._userLogHandler=null,a.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in o))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"===typeof t?s[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!==typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.DEBUG],t)),this._logHandler.apply(this,r([this,o.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.VERBOSE],t)),this._logHandler.apply(this,r([this,o.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.INFO],t)),this._logHandler.apply(this,r([this,o.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.WARN],t)),this._logHandler.apply(this,r([this,o.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.ERROR],t)),this._logHandler.apply(this,r([this,o.ERROR],t))},t}();function f(t){a.forEach((function(e){e.setLogLevel(t)}))}function d(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=s[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],a=2;a<arguments.length;a++)i[a-2]=arguments[a];var s=i.map((function(t){if(null==t)return null;if("string"===typeof t)return t;if("number"===typeof t||"boolean"===typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(e){return null}})).filter((function(t){return t})).join(" ");n>=(null!==r&&void 0!==r?r:e.logLevel)&&t({level:o[n].toLowerCase(),message:s,args:i,type:e.name})}},r=0,i=a;r<i.length;r++){n(i[r])}}},9971:function(t,e,n){"use strict";n.r(e),n.d(e,{CONSTANTS:function(){return i},Deferred:function(){return p},ErrorFactory:function(){return D},FirebaseError:function(){return R},MAX_VALUE_MILLIS:function(){return ct},RANDOM_FACTOR:function(){return ht},Sha1:function(){return $},areCookiesEnabled:function(){return N},assert:function(){return o},assertionError:function(){return a},async:function(){return tt},base64:function(){return u},base64Decode:function(){return l},base64Encode:function(){return c},base64urlEncodeWithoutPadding:function(){return h},calculateBackoffMillis:function(){return lt},contains:function(){return B},createMockUserToken:function(){return v},createSubscribe:function(){return J},decode:function(){return F},deepCopy:function(){return f},deepEqual:function(){return G},deepExtend:function(){return d},errorPrefix:function(){return rt},extractQuerystring:function(){return X},getGlobal:function(){return P},getModularInstance:function(){return dt},getUA:function(){return g},isAdmin:function(){return V},isBrowser:function(){return _},isBrowserExtension:function(){return b},isElectron:function(){return I},isEmpty:function(){return W},isIE:function(){return T},isIndexedDBAvailable:function(){return k},isMobileCordova:function(){return y},isNode:function(){return m},isNodeSdk:function(){return S},isReactNative:function(){return w},isSafari:function(){return C},isUWP:function(){return E},isValidFormat:function(){return q},isValidTimestamp:function(){return U},issuedAtTime:function(){return j},jsonEval:function(){return L},map:function(){return H},ordinal:function(){return ft},querystring:function(){return Q},querystringDecode:function(){return Y},safeGet:function(){return K},stringLength:function(){return ut},stringToByteArray:function(){return st},stringify:function(){return M},validateArgCount:function(){return nt},validateCallback:function(){return ot},validateContextObject:function(){return at},validateIndexedDBOpenable:function(){return A},validateNamespace:function(){return it}});var r=n(9388),i={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},o=function(t,e){if(!t)throw a(e)},a=function(t){return new Error("Firebase Database ("+i.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)},s=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296===(64512&i)&&r+1<t.length&&56320===(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},u={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],a=i+1<t.length,s=a?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,h=o>>2,l=(3&o)<<4|s>>4,f=(15&s)<<2|c>>6,d=63&c;u||(d=64,a||(f=64)),r.push(n[h],n[l],n[f],n[d])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(s(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var a=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(s=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(a>>10)),e[r++]=String.fromCharCode(56320+(1023&a))}else{o=t[n++];var s=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0,s=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==a||null==s||null==u)throw Error();var c=o<<2|a>>4;if(r.push(c),64!==s){var h=a<<4&240|s>>2;if(r.push(h),64!==u){var l=s<<6&192|u;r.push(l)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},c=function(t){var e=s(t);return u.encodeByteArray(e,!0)},h=function(t){return c(t).replace(/\./g,"")},l=function(t){try{return u.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function f(t){return d(void 0,t)}function d(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=d(t[n],e[n]));return t}var p=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"===typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();function v(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=e||"demo-project",i=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var a=(0,r.__assign)({iss:"https://securetoken.google.com/"+n,aud:n,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},t);return[h(JSON.stringify({alg:"none",type:"JWT"})),h(JSON.stringify(a)),""].join(".")}function g(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function y(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(g())}function m(){try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(t){return!1}}function _(){return"object"===typeof self&&self.self===self}function b(){var t="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof t&&void 0!==t.id}function w(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function I(){return g().indexOf("Electron/")>=0}function T(){var t=g();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function E(){return g().indexOf("MSAppHost/")>=0}function S(){return!0===i.NODE_CLIENT||!0===i.NODE_ADMIN}function C(){return!m()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function k(){return"indexedDB"in self&&null!=indexedDB}function A(){return new Promise((function(t,e){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var t;e((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(o){e(o)}}))}function N(){return!(!navigator||!navigator.cookieEnabled)}function P(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}var R=function(t){function e(n,r,i){var o=t.call(this,r)||this;return o.code=n,o.customData=i,o.name="FirebaseError",Object.setPrototypeOf(o,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,D.prototype.create),o}return(0,r.__extends)(e,t),e}(Error),D=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],a=o?x(o,r):"Error",s=this.serviceName+": "+a+" ("+i+").",u=new R(i,s,r);return u},t}();function x(t,e){return t.replace(O,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}var O=/\{\$([^}]+)}/g;function L(t){return JSON.parse(t)}function M(t){return JSON.stringify(t)}var F=function(t){var e={},n={},r={},i="";try{var o=t.split(".");e=L(l(o[0])||""),n=L(l(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(a){}return{header:e,claims:n,data:r,signature:i}},U=function(t){var e=F(t).claims,n=Math.floor((new Date).getTime()/1e3),r=0,i=0;return"object"===typeof e&&(e.hasOwnProperty("nbf")?r=e.nbf:e.hasOwnProperty("iat")&&(r=e.iat),i=e.hasOwnProperty("exp")?e.exp:r+86400),!!n&&!!r&&!!i&&n>=r&&n<=i},j=function(t){var e=F(t).claims;return"object"===typeof e&&e.hasOwnProperty("iat")?e.iat:null},q=function(t){var e=F(t).claims;return!!e&&"object"===typeof e&&e.hasOwnProperty("iat")},V=function(t){var e=F(t).claims;return"object"===typeof e&&!0===e.admin};function B(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function K(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0}function W(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function H(t,e,n){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r}function G(t,e){if(t===e)return!0;for(var n=Object.keys(t),r=Object.keys(e),i=0,o=n;i<o.length;i++){var a=o[i];if(!r.includes(a))return!1;var s=t[a],u=e[a];if(z(s)&&z(u)){if(!G(s,u))return!1}else if(s!==u)return!1}for(var c=0,h=r;c<h.length;c++){a=h[c];if(!n.includes(a))return!1}return!0}function z(t){return null!==t&&"object"===typeof t}function Q(t){for(var e=[],n=function(t,n){Array.isArray(n)?n.forEach((function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))})):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))},r=0,i=Object.entries(t);r<i.length;r++){var o=i[r];n(o[0],o[1])}return e.length?"&"+e.join("&"):""}function Y(t){var e={};return t.replace(/^\?/,"").split("&").forEach((function(t){if(t){var n=t.split("="),r=n[0],i=n[1];e[decodeURIComponent(r)]=decodeURIComponent(i)}})),e}function X(t){var e=t.indexOf("?");if(!e)return"";var n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}var $=function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"===typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,a,s=this.chain_[0],u=this.chain_[1],c=this.chain_[2],h=this.chain_[3],l=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(o=h^u&(c^h),a=1518500249):(o=u^c^h,a=1859775393):r<60?(o=u&c|h&(u|c),a=2400959708):(o=u^c^h,a=3395469782);i=(s<<5|s>>>27)+o+l+a+n[r]&4294967295;l=h,h=c,c=4294967295&(u<<30|u>>>2),u=s,s=i}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0===o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"===typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t},t}();function J(t,e){var n=new Z(t,e);return n.subscribe.bind(n)}var Z=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!==typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"===typeof t[i])return!0}return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n}).next&&(r.next=et),void 0===r.error&&(r.error=et),void 0===r.complete&&(r.complete=et);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(r){"undefined"!==typeof console&&console.error&&console.error(r)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function tt(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Promise.resolve(!0).then((function(){t.apply(void 0,n)})).catch((function(t){e&&e(t)}))}}function et(){}var nt=function(t,e,n,r){var i;if(r<e?i="at least "+e:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(t+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")};function rt(t,e){return t+" failed: "+e+" argument "}function it(t,e,n){if((!n||e)&&"string"!==typeof e)throw new Error(rt(t,"namespace")+"must be a valid firebase namespace.")}function ot(t,e,n,r){if((!r||n)&&"function"!==typeof n)throw new Error(rt(t,e)+"must be a valid function.")}function at(t,e,n,r){if((!r||n)&&("object"!==typeof n||null===n))throw new Error(rt(t,e)+"must be a valid context object.")}var st=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);if(i>=55296&&i<=56319){var a=i-55296;r++,o(r<t.length,"Surrogate pair missing trail surrogate."),i=65536+(a<<10)+(t.charCodeAt(r)-56320)}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},ut=function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e},ct=144e5,ht=.5;function lt(t,e,n){void 0===e&&(e=1e3),void 0===n&&(n=2);var r=e*Math.pow(n,t),i=Math.round(ht*r*(Math.random()-.5)*2);return Math.min(ct,r+i)}function ft(t){return Number.isFinite(t)?t+function(t){t=Math.abs(t);var e=t%100;if(e>=10&&e<=20)return"th";var n=t%10;if(1===n)return"st";if(2===n)return"nd";if(3===n)return"rd";return"th"}(t):""+t}function dt(t){return t&&t._delegate?t._delegate:t}},3091:function(t,e,n){"use strict";var r=n(4836);e.Z=void 0;!function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==typeof t&&"function"!==typeof t)return{default:t};var n=a(e);if(n&&n.has(t))return n.get(t);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if("default"!==o&&Object.prototype.hasOwnProperty.call(t,o)){var s=i?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=t[o]}r.default=t,n&&n.set(t,r)}(n(2791));var i=r(n(5649)),o=n(184);function a(t){if("function"!==typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(a=function(t){return t?n:e})(t)}var s=(0,i.default)((0,o.jsx)("path",{d:"M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z"}),"Apple");e.Z=s},5352:function(t,e,n){"use strict";n.d(e,{Z:function(){return r.default}});var r=n(5637);(function(){var t,e="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)};var i=function(t){t=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof n.g&&n.g,t];for(var e=0;e<t.length;++e){var r=t[e];if(r&&r.Math==Math)return r}return globalThis}(this);function o(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}function a(t){var e="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):{next:o(t)}}!function(t,n){if(n){var r=i;t=t.split(".");for(var o=0;o<t.length-1;o++){var a=t[o];a in r||(r[a]={}),r=r[a]}(n=n(o=r[t=t[t.length-1]]))!=o&&null!=n&&e(r,t,{configurable:!0,writable:!0,value:n})}}("Promise",(function(t){function e(t){this.b=0,this.c=void 0,this.a=[];var e=this.f();try{t(e.resolve,e.reject)}catch(n){e.reject(n)}}function n(){this.a=null}function r(t){return t instanceof e?t:new e((function(e){e(t)}))}if(t)return t;n.prototype.b=function(t){if(null==this.a){this.a=[];var e=this;this.c((function(){e.g()}))}this.a.push(t)};var o=i.setTimeout;n.prototype.c=function(t){o(t,0)},n.prototype.g=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(v){this.f(v)}}}this.a=null},n.prototype.f=function(t){this.c((function(){throw t}))},e.prototype.f=function(){function t(t){return function(r){n||(n=!0,t.call(e,r))}}var e=this,n=!1;return{resolve:t(this.m),reject:t(this.g)}},e.prototype.m=function(t){if(t===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.s(t);else{t:switch(typeof t){case"object":var n=null!=t;break t;case"function":n=!0;break t;default:n=!1}n?this.v(t):this.h(t)}},e.prototype.v=function(t){var e=void 0;try{e=t.then}catch(n){return void this.g(n)}"function"==typeof e?this.u(e,t):this.h(t)},e.prototype.g=function(t){this.i(2,t)},e.prototype.h=function(t){this.i(1,t)},e.prototype.i=function(t,e){if(0!=this.b)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.b);this.b=t,this.c=e,this.l()},e.prototype.l=function(){if(null!=this.a){for(var t=0;t<this.a.length;++t)s.b(this.a[t]);this.a=null}};var s=new n;return e.prototype.s=function(t){var e=this.f();t.Ra(e.resolve,e.reject)},e.prototype.u=function(t,e){var n=this.f();try{t.call(e,n.resolve,n.reject)}catch(v){n.reject(v)}},e.prototype.then=function(t,n){function r(t,e){return"function"==typeof t?function(e){try{i(t(e))}catch(Mn){o(Mn)}}:e}var i,o,a=new e((function(t,e){i=t,o=e}));return this.Ra(r(t,i),r(n,o)),a},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.Ra=function(t,e){function n(){switch(r.b){case 1:t(r.c);break;case 2:e(r.c);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?s.b(n):this.a.push(n)},e.resolve=r,e.reject=function(t){return new e((function(e,n){n(t)}))},e.race=function(t){return new e((function(e,n){for(var i=a(t),o=i.next();!o.done;o=i.next())r(o.value).Ra(e,n)}))},e.all=function(t){var n=a(t),i=n.next();return i.done?r([]):new e((function(t,e){function o(e){return function(n){a[e]=n,0==--s&&t(a)}}var a=[],s=0;do{a.push(void 0),s++,r(i.value).Ra(o(a.length-1),e),i=n.next()}while(!i.done)}))},e}));var s=s||{},u=this||self,c=/^[\w+/_-]+[=]{0,2}$/,h=null;function l(t){return(t=t.querySelector&&t.querySelector("script[nonce]"))&&(t=t.nonce||t.getAttribute("nonce"))&&c.test(t)?t:""}function f(){}function d(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function p(t){var e=d(t);return"array"==e||"object"==e&&"number"==typeof t.length}function g(t){return"function"==d(t)}function y(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function m(t){return Object.prototype.hasOwnProperty.call(t,_)&&t[_]||(t[_]=++b)}var _="closure_uid_"+(1e9*Math.random()>>>0),b=0;function w(t,e,n){return t.call.apply(t.bind,arguments)}function I(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function T(t,e,n){return(T=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?w:I).apply(null,arguments)}function E(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var S=Date.now;function C(t,e){function n(){}n.prototype=e.prototype,t.bb=e.prototype,t.prototype=new n,t.prototype.constructor=t}function k(t){return t}function A(t,e,n){this.code=R+t,this.message=e||D[t]||"",this.a=n||null}function N(t){var e=t&&t.code;return e?new A(e.substring(R.length),t.message,t.serverResponse):null}C(A,Error),A.prototype.w=function(){var t={code:this.code,message:this.message};return this.a&&(t.serverResponse=this.a),t},A.prototype.toJSON=function(){return this.w()};var P,R="auth/",D={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},x={ld:{Ua:"https://staging-identitytoolkit.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"b"},sd:{Ua:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://securetoken.googleapis.com/v1/token",Xa:"https://identitytoolkit.googleapis.com/v2/",id:"p"},ud:{Ua:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"s"},vd:{Ua:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",$a:"https://test-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://test-identitytoolkit.sandbox.googleapis.com/v2/",id:"t"}};function O(t){for(var e in x)if(x[e].id===t)return{firebaseEndpoint:(t=x[e]).Ua,secureTokenEndpoint:t.$a,identityPlatformEndpoint:t.Xa};return null}function L(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(e){return!1}}function M(t){if(Error.captureStackTrace)Error.captureStackTrace(this,M);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function F(t,e){for(var n="",r=(t=t.split("%s")).length-1,i=0;i<r;i++)n+=t[i]+(i<e.length?e[i]:"%s");M.call(this,n+t[r])}function U(t,e){throw new F("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function j(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function q(t,e){t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}function V(){this.b=this.a=null}P=O("__EID__")?"__EID__":void 0,C(M,Error),M.prototype.name="CustomError",C(F,M),F.prototype.name="AssertionError",j.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var B=new j((function(){return new W}),(function(t){t.reset()}));function K(){var t=we,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function W(){this.next=this.b=this.a=null}V.prototype.add=function(t,e){var n=B.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},W.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},W.prototype.reset=function(){this.next=this.b=this.a=null};var H=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"===typeof t)return"string"!==typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"===typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};var z=Array.prototype.filter?function(t,e){return Array.prototype.filter.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=[],i=0,o="string"===typeof t?t.split(""):t,a=0;a<n;a++)if(a in o){var s=o[a];e.call(void 0,s,a,t)&&(r[i++]=s)}return r},Q=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=Array(n),i="string"===typeof t?t.split(""):t,o=0;o<n;o++)o in i&&(r[o]=e.call(void 0,i[o],o,t));return r},Y=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,r="string"===typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t))return!0;return!1};function X(t,e){return 0<=H(t,e)}function $(t,e){var n;return(n=0<=(e=H(t,e)))&&Array.prototype.splice.call(t,e,1),n}function J(t,e){!function(t,e){for(var n="string"===typeof t?t.split(""):t,r=t.length-1;0<=r;--r)r in n&&e.call(void 0,n[r],r,t)}(t,(function(n,r){e.call(void 0,n,r,t)&&1==Array.prototype.splice.call(t,r,1).length&&0}))}function Z(t){return Array.prototype.concat.apply([],arguments)}function tt(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}var et,nt=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]},rt=/&/g,it=/</g,ot=/>/g,at=/"/g,st=/'/g,ut=/\x00/g,ct=/[\x00&<>"']/;function ht(t,e){return-1!=t.indexOf(e)}function lt(t,e){return t<e?-1:t>e?1:0}t:{var ft=u.navigator;if(ft){var dt=ft.userAgent;if(dt){et=dt;break t}}et=""}function pt(t){return ht(et,t)}function vt(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function gt(t){for(var e in t)return!1;return!0}function yt(t){var e,n={};for(e in t)n[e]=t[e];return n}var mt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function _t(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<mt.length;o++)n=mt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function bt(t,e){t:{try{var n=t&&t.ownerDocument,r=n&&(n.defaultView||n.parentWindow);if((r=r||u).Element&&r.Location){var i=r;break t}}catch(a){}i=null}if(i&&"undefined"!=typeof i[e]&&(!t||!(t instanceof i[e])&&(t instanceof i.Location||t instanceof i.Element))){if(y(t))try{var o=t.constructor.displayName||t.constructor.name||Object.prototype.toString.call(t)}catch(a){o="<object could not be stringified>"}else o=void 0===t?"undefined":null===t?"null":typeof t;U("Argument is not a %s (or a non-Element, non-Location mock); got: %s",e,o)}}function wt(t,e){this.a=t===St&&e||"",this.b=Et}function It(t){return t instanceof wt&&t.constructor===wt&&t.b===Et?t.a:(U("expected object of type Const, got '"+t+"'"),"type_error:Const")}wt.prototype.ta=!0,wt.prototype.sa=function(){return this.a},wt.prototype.toString=function(){return"Const{"+this.a+"}"};var Tt,Et={},St={};function Ct(){if(void 0===Tt){var t=null,e=u.trustedTypes;if(e&&e.createPolicy){try{t=e.createPolicy("goog#html",{createHTML:k,createScript:k,createScriptURL:k})}catch(n){u.console&&u.console.error(n.message)}Tt=t}else Tt=t}return Tt}function kt(t,e){this.a=e===Dt?t:""}function At(t){return t instanceof kt&&t.constructor===kt?t.a:(U("expected object of type TrustedResourceUrl, got '"+t+"' of type "+d(t)),"type_error:TrustedResourceUrl")}function Nt(t,e){var n=It(t);if(!Rt.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return function(t){var e=Ct();return t=e?e.createScriptURL(t):t,new kt(t,Dt)}(t=n.replace(Pt,(function(t,r){if(!Object.prototype.hasOwnProperty.call(e,r))throw Error('Found marker, "'+r+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(e));return(t=e[r])instanceof wt?It(t):encodeURIComponent(String(t))})))}kt.prototype.ta=!0,kt.prototype.sa=function(){return this.a.toString()},kt.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var Pt=/%{(\w+)}/g,Rt=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,Dt={};function xt(t,e){this.a=e===qt?t:""}function Ot(t){return t instanceof xt&&t.constructor===xt?t.a:(U("expected object of type SafeUrl, got '"+t+"' of type "+d(t)),"type_error:SafeUrl")}xt.prototype.ta=!0,xt.prototype.sa=function(){return this.a.toString()},xt.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var Lt=/^(?:audio\/(?:3gpp2|3gpp|aac|L16|midi|mp3|mp4|mpeg|oga|ogg|opus|x-m4a|x-matroska|x-wav|wav|webm)|font\/\w+|image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp|x-icon)|text\/csv|video\/(?:mpeg|mp4|ogg|webm|quicktime|x-matroska))(?:;\w+=(?:\w+|"[\w;,= ]+"))*$/i,Mt=/^data:(.*);base64,[a-z0-9+\/]+=*$/i,Ft=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function Ut(t){if(t instanceof xt)return t;if(t="object"==typeof t&&t.ta?t.sa():String(t),Ft.test(t))t=new xt(t,qt);else{var e=(t=(t=String(t)).replace(/(%0A|%0D)/g,"")).match(Mt);t=e&&Lt.test(e[1])?new xt(t,qt):null}return t}function jt(t){return t instanceof xt?t:(t="object"==typeof t&&t.ta?t.sa():String(t),Ft.test(t)||(t="about:invalid#zClosurez"),new xt(t,qt))}var qt={},Vt=new xt("about:invalid#zClosurez",qt);function Bt(t,e,n){this.a=n===Kt?t:""}Bt.prototype.ta=!0,Bt.prototype.sa=function(){return this.a.toString()},Bt.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Kt={};function Wt(t,e,n,r){return t=t instanceof xt?t:jt(t),e=e||u,n=n instanceof wt?It(n):n||"",e.open(Ot(t),n,r,void 0)}function Ht(t,e){for(var n=t.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function Gt(t){return ct.test(t)&&(-1!=t.indexOf("&")&&(t=t.replace(rt,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(it,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(ot,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(at,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(st,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(ut,"&#0;"))),t}function zt(t){return zt[" "](t),t}zt[" "]=f;var Qt,Yt=pt("Opera"),Xt=pt("Trident")||pt("MSIE"),$t=pt("Edge"),Jt=$t||Xt,Zt=pt("Gecko")&&!(ht(et.toLowerCase(),"webkit")&&!pt("Edge"))&&!(pt("Trident")||pt("MSIE"))&&!pt("Edge"),te=ht(et.toLowerCase(),"webkit")&&!pt("Edge");function ee(){var t=u.document;return t?t.documentMode:void 0}t:{var ne="",re=function(){var t=et;return Zt?/rv:([^\);]+)(\)|;)/.exec(t):$t?/Edge\/([\d\.]+)/.exec(t):Xt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):te?/WebKit\/(\S+)/.exec(t):Yt?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(re&&(ne=re?re[1]:""),Xt){var ie=ee();if(null!=ie&&ie>parseFloat(ne)){Qt=String(ie);break t}}Qt=ne}var oe,ae={};function se(t){return function(t,e){var n=ae;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,(function(){for(var e=0,n=nt(String(Qt)).split("."),r=nt(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=lt(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||lt(0==a[2].length,0==s[2].length)||lt(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e}))}if(u.document&&Xt){var ue=ee();oe=ue||(parseInt(Qt,10)||void 0)}else oe=void 0;var ce=oe;try{new self.OffscreenCanvas(0,0).getContext("2d")}catch(pa){}var he=!Xt||9<=Number(ce);function le(t){var e=document;return"string"===typeof t?e.getElementById(t):t}function fe(t,e){vt(e,(function(e,n){e&&"object"==typeof e&&e.ta&&(e=e.sa()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:ve.hasOwnProperty(n)?t.setAttribute(ve[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e}))}var de,pe,ve={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function ge(t,e,n){function r(n){n&&e.appendChild("string"===typeof n?t.createTextNode(n):n)}for(var i=2;i<n.length;i++){var o=n[i];if(!p(o)||y(o)&&0<o.nodeType)r(o);else{t:{if(o&&"number"==typeof o.length){if(y(o)){var a="function"==typeof o.item||"string"==typeof o.item;break t}if(g(o)){a="function"==typeof o.item;break t}}a=!1}G(a?tt(o):o,r)}}}function ye(t,e){return e=String(e),"application/xhtml+xml"===t.contentType&&(e=e.toLowerCase()),t.createElement(e)}function me(t){u.setTimeout((function(){throw t}),0)}function _e(t,e){pe||function(){if(u.Promise&&u.Promise.resolve){var t=u.Promise.resolve(void 0);pe=function(){t.then(Ie)}}else pe=function(){var t=Ie;!g(u.setImmediate)||u.Window&&u.Window.prototype&&!pt("Edge")&&u.Window.prototype.setImmediate==u.setImmediate?(de||(de=function(){var t=u.MessageChannel;if("undefined"===typeof t&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!pt("Presto")&&(t=function(){var t=ye(document,"IFRAME");t.style.display="none",document.documentElement.appendChild(t);var e=t.contentWindow;(t=e.document).open(),t.close();var n="callImmediate"+Math.random(),r="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=T((function(t){"*"!=r&&t.origin!=r||t.data!=n||this.port1.onmessage()}),this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,r)}}}),"undefined"!==typeof t&&!pt("Trident")&&!pt("MSIE")){var e=new t,n={},r=n;return e.port1.onmessage=function(){if(void 0!==n.next){var t=(n=n.next).Hb;n.Hb=null,t()}},function(t){r.next={Hb:t},r=r.next,e.port2.postMessage(0)}}return function(t){u.setTimeout(t,0)}}()),de(t)):u.setImmediate(t)}}(),be||(pe(),be=!0),we.add(t,e)}var be=!1,we=new V;function Ie(){for(var t;t=K();){try{t.a.call(t.b)}catch(e){me(e)}q(B,t)}be=!1}function Te(t,e){if(this.a=Ee,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=f)try{var n=this;t.call(e,(function(t){Fe(n,Se,t)}),(function(t){if(!(t instanceof We))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(Vd){}Fe(n,Ce,t)}))}catch(r){Fe(this,Ce,r)}}var Ee=0,Se=2,Ce=3;function ke(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}ke.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var Ae=new j((function(){return new ke}),(function(t){t.reset()}));function Ne(t,e,n){var r=Ae.get();return r.g=t,r.b=e,r.f=n,r}function Pe(t){if(t instanceof Te)return t;var e=new Te(f);return Fe(e,Se,t),e}function Re(t){return new Te((function(e,n){n(t)}))}function De(t,e,n){Ue(t,e,n,null)||_e(E(e,t))}function xe(t){return new Te((function(e){var n=t.length,r=[];if(n)for(var i=function(t,i,o){n--,r[t]=i?{Qb:!0,value:o}:{Qb:!1,reason:o},0==n&&e(r)},o=0;o<t.length;o++)De(t[o],E(i,o,!0),E(i,o,!1));else e(r)}))}function Oe(t,e){if(t.a==Ee)if(t.c){var n=t.c;if(n.b){for(var r=0,i=null,o=null,a=n.b;a&&(a.c||(r++,a.a==t&&(i=a),!(i&&1<r)));a=a.next)i||(o=a);i&&(n.a==Ee&&1==r?Oe(n,e):(o?((r=o).next==n.f&&(n.f=r),r.next=r.next.next):qe(n),Ve(n,i,Ce,e)))}t.c=null}else Fe(t,Ce,e)}function Le(t,e){t.b||t.a!=Se&&t.a!=Ce||je(t),t.f?t.f.next=e:t.b=e,t.f=e}function Me(t,e,n,r){var i=Ne(null,null,null);return i.a=new Te((function(t,o){i.g=e?function(n){try{var i=e.call(r,n);t(i)}catch(v){o(v)}}:t,i.b=n?function(e){try{var i=n.call(r,e);void 0===i&&e instanceof We?o(e):t(i)}catch(v){o(v)}}:o})),i.a.c=t,Le(t,i),i.a}function Fe(t,e,n){t.a==Ee&&(t===n&&(e=Ce,n=new TypeError("Promise cannot resolve to itself")),t.a=1,Ue(n,t.$c,t.ad,t)||(t.i=n,t.a=e,t.c=null,je(t),e!=Ce||n instanceof We||function(t,e){t.g=!0,_e((function(){t.g&&Ke.call(null,e)}))}(t,n)))}function Ue(t,e,n,r){if(t instanceof Te)return Le(t,Ne(e||f,n||null,r)),!0;if(L(t))return t.then(e,n,r),!0;if(y(t))try{var i=t.then;if(g(i))return function(t,e,n,r,i){function o(t){s||(s=!0,r.call(i,t))}function a(t){s||(s=!0,n.call(i,t))}var s=!1;try{e.call(t,a,o)}catch(u){o(u)}}(t,i,e,n,r),!0}catch(o){return n.call(r,o),!0}return!1}function je(t){t.h||(t.h=!0,_e(t.gc,t))}function qe(t){var e=null;return t.b&&(e=t.b,t.b=e.next,e.next=null),t.b||(t.f=null),e}function Ve(t,e,n,r){if(n==Ce&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,Be(e,n,r);else try{e.c?e.g.call(e.f):Be(e,n,r)}catch(Vd){Ke.call(null,Vd)}q(Ae,e)}function Be(t,e,n){e==Se?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}Te.prototype.then=function(t,e,n){return Me(this,g(t)?t:null,g(e)?e:null,n)},Te.prototype.$goog_Thenable=!0,(t=Te.prototype).oa=function(t,e){return(t=Ne(t,t,e)).c=!0,Le(this,t),this},t.o=function(t,e){return Me(this,null,t,e)},t.cancel=function(t){if(this.a==Ee){var e=new We(t);_e((function(){Oe(this,e)}),this)}},t.$c=function(t){this.a=Ee,Fe(this,Se,t)},t.ad=function(t){this.a=Ee,Fe(this,Ce,t)},t.gc=function(){for(var t;t=qe(this);)Ve(this,t,this.a,this.i);this.h=!1};var Ke=me;function We(t){M.call(this,t)}function He(){0!=Ge&&(ze[m(this)]=this),this.ya=this.ya,this.pa=this.pa}C(We,M),We.prototype.name="cancel";var Ge=0,ze={};function Qe(t){if(!t.ya&&(t.ya=!0,t.Da(),0!=Ge)){var e=m(t);if(0!=Ge&&t.pa&&0<t.pa.length)throw Error(t+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete ze[e]}}He.prototype.ya=!1,He.prototype.Da=function(){if(this.pa)for(;this.pa.length;)this.pa.shift()()};var Ye=Object.freeze||function(t){return t},Xe=!Xt||9<=Number(ce),$e=Xt&&!se("9"),Je=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{u.addEventListener("test",f,e),u.removeEventListener("test",f,e)}catch(n){}return t}();function Ze(t,e){this.type=t,this.b=this.target=e,this.defaultPrevented=!1}function tn(t,e){if(Ze.call(this,t?t.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.b=e,e=t.relatedTarget){if(Zt){t:{try{zt(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"===typeof t.pointerType?t.pointerType:en[t.pointerType]||"",this.a=t,t.defaultPrevented&&this.preventDefault()}}Ze.prototype.preventDefault=function(){this.defaultPrevented=!0},C(tn,Ze);var en=Ye({2:"touch",3:"pen",4:"mouse"});tn.prototype.preventDefault=function(){tn.bb.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,$e)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}},tn.prototype.g=function(){return this.a};var nn="closure_listenable_"+(1e6*Math.random()|0),rn=0;function on(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.Wa=i,this.key=++rn,this.wa=this.Qa=!1}function an(t){t.wa=!0,t.listener=null,t.proxy=null,t.src=null,t.Wa=null}function sn(t){this.src=t,this.a={},this.b=0}function un(t,e){var n=e.type;n in t.a&&$(t.a[n],e)&&(an(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function cn(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.wa&&o.listener==e&&o.capture==!!n&&o.Wa==r)return i}return-1}sn.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=cn(t,e,r,i);return-1<a?(e=t[a],n||(e.Qa=!1)):((e=new on(e,this.src,o,!!r,i)).Qa=n,t.push(e)),e};var hn="closure_lm_"+(1e6*Math.random()|0),ln={};function fn(t,e,n,r,i){if(r&&r.once)pn(t,e,n,r,i);else if(Array.isArray(e))for(var o=0;o<e.length;o++)fn(t,e[o],n,r,i);else n=Tn(n),t&&t[nn]?Sn(t,e,n,y(r)?!!r.capture:!!r,i):dn(t,e,n,!1,r,i)}function dn(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=y(i)?!!i.capture:!!i,s=wn(t);if(s||(t[hn]=s=new sn(t)),!(n=s.add(e,n,r,a,o)).proxy){if(r=function(){var t=bn,e=Xe?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Je||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(yn(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}0}}function pn(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)pn(t,e[o],n,r,i);else n=Tn(n),t&&t[nn]?Cn(t,e,n,y(r)?!!r.capture:!!r,i):dn(t,e,n,!0,r,i)}function vn(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)vn(t,e[o],n,r,i);else r=y(r)?!!r.capture:!!r,n=Tn(n),t&&t[nn]?(t=t.v,(e=String(e).toString())in t.a&&(-1<(n=cn(o=t.a[e],n,r,i))&&(an(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--)))):t&&(t=wn(t))&&(e=t.a[e.toString()],t=-1,e&&(t=cn(e,n,r,i)),(n=-1<t?e[t]:null)&&gn(n))}function gn(t){if("number"!==typeof t&&t&&!t.wa){var e=t.src;if(e&&e[nn])un(e.v,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(yn(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=wn(e))?(un(n,t),0==n.b&&(n.src=null,e[hn]=null)):an(t)}}}function yn(t){return t in ln?ln[t]:ln[t]="on"+t}function mn(t,e,n,r){var i=!0;if((t=wn(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.wa&&(o=_n(o,r),i=i&&!1!==o)}return i}function _n(t,e){var n=t.listener,r=t.Wa||t.src;return t.Qa&&gn(t),n.call(r,e)}function bn(t,e){if(t.wa)return!0;if(!Xe){if(!e)t:{e=["window","event"];for(var n=u,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}if(e=new tn(r=e,this),n=!0,!(0>r.keyCode||void 0!=r.returnValue)){t:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(a){i=!0}(i||void 0==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=e.b;i;i=i.parentNode)r.push(i);for(t=t.type,i=r.length-1;0<=i;i--){e.b=r[i];var o=mn(r[i],t,!0,e);n=n&&o}for(i=0;i<r.length;i++)e.b=r[i],o=mn(r[i],t,!1,e),n=n&&o}return n}return _n(t,new tn(e,this))}function wn(t){return(t=t[hn])instanceof sn?t:null}var In="__closure_events_fn_"+(1e9*Math.random()>>>0);function Tn(t){return g(t)?t:(t[In]||(t[In]=function(e){return t.handleEvent(e)}),t[In])}function En(){He.call(this),this.v=new sn(this),this.bc=this,this.hb=null}function Sn(t,e,n,r,i){t.v.add(String(e),n,!1,r,i)}function Cn(t,e,n,r,i){t.v.add(String(e),n,!0,r,i)}function kn(t,e,n,r){if(!(e=t.v.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.wa&&a.capture==n){var s=a.listener,u=a.Wa||a.src;a.Qa&&un(t.v,a),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}function An(t,e,n){if(g(t))n&&(t=T(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=T(t.handleEvent,t)}return 2147483647<Number(e)?-1:u.setTimeout(t,e||0)}function Nn(t){var e=null;return new Te((function(n,r){-1==(e=An((function(){n(void 0)}),t))&&r(Error("Failed to schedule timer."))})).o((function(t){throw u.clearTimeout(e),t}))}function Pn(t){if(t.X&&"function"==typeof t.X)return t.X();if("string"===typeof t)return t.split("");if(p(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}function Rn(t){if(t.Y&&"function"==typeof t.Y)return t.Y();if(!t.X||"function"!=typeof t.X){if(p(t)||"string"===typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}for(var r in e=[],n=0,t)e[n++]=r;return e}}function Dn(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Dn)for(n=t.Y(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function xn(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];On(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)On(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function On(t,e){return Object.prototype.hasOwnProperty.call(t,e)}C(En,He),En.prototype[nn]=!0,En.prototype.addEventListener=function(t,e,n,r){fn(this,t,e,n,r)},En.prototype.removeEventListener=function(t,e,n,r){vn(this,t,e,n,r)},En.prototype.dispatchEvent=function(t){var e,n=this.hb;if(n)for(e=[];n;n=n.hb)e.push(n);n=this.bc;var r=t.type||t;if("string"===typeof t)t=new Ze(t,n);else if(t instanceof Ze)t.target=t.target||n;else{var i=t;_t(t=new Ze(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var a=t.b=e[o];i=kn(a,r,!0,t)&&i}if(i=kn(a=t.b=n,r,!0,t)&&i,i=kn(a,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=kn(a=t.b=e[o],r,!1,t)&&i;return i},En.prototype.Da=function(){if(En.bb.Da.call(this),this.v){var t,e=this.v;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)an(n[r]);delete e.a[t],e.b--}}this.hb=null},(t=Dn.prototype).X=function(){xn(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},t.Y=function(){return xn(this),this.a.concat()},t.clear=function(){this.b={},this.c=this.a.length=0},t.get=function(t,e){return On(this.b,t)?this.b[t]:e},t.set=function(t,e){On(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},t.forEach=function(t,e){for(var n=this.Y(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ln=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Fn(t,e){var n;this.a=this.l=this.c="",this.g=null,this.h=this.f="",this.i=!1,t instanceof Fn?(this.i=void 0!==e?e:t.i,Un(this,t.c),this.l=t.l,this.a=t.a,jn(this,t.g),this.f=t.f,qn(this,or(t.b)),this.h=t.h):t&&(n=String(t).match(Ln))?(this.i=!!e,Un(this,n[1]||"",!0),this.l=Hn(n[2]||""),this.a=Hn(n[3]||"",!0),jn(this,n[4]),this.f=Hn(n[5]||"",!0),qn(this,n[6]||"",!0),this.h=Hn(n[7]||"")):(this.i=!!e,this.b=new Zn(null,this.i))}function Un(t,e,n){t.c=n?Hn(e,!0):e,t.c&&(t.c=t.c.replace(/:$/,""))}function jn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.g=e}else t.g=null}function qn(t,e,n){e instanceof Zn?(t.b=e,function(t,e){e&&!t.f&&(tr(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(nr(this,e),ir(this,n,t))}),t)),t.f=e}(t.b,t.i)):(n||(e=Gn(e,$n)),t.b=new Zn(e,t.i))}function Vn(t,e,n){t.b.set(e,n)}function Bn(t,e){return t.b.get(e)}function Kn(t){return t instanceof Fn?new Fn(t):new Fn(t,void 0)}function Wn(t,e,n,r){var i=new Fn(null,void 0);return t&&Un(i,t),e&&(i.a=e),n&&jn(i,n),r&&(i.f=r),i}function Hn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Gn(t,e,n){return"string"===typeof t?(t=encodeURI(t).replace(e,zn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function zn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Fn.prototype.toString=function(){var t=[],e=this.c;e&&t.push(Gn(e,Qn,!0),":");var n=this.a;return(n||"file"==e)&&(t.push("//"),(e=this.l)&&t.push(Gn(e,Qn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.g)&&t.push(":",String(n))),(n=this.f)&&(this.a&&"/"!=n.charAt(0)&&t.push("/"),t.push(Gn(n,"/"==n.charAt(0)?Xn:Yn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.h)&&t.push("#",Gn(n,Jn)),t.join("")},Fn.prototype.resolve=function(t){var e=new Fn(this),n=!!t.c;n?Un(e,t.c):n=!!t.l,n?e.l=t.l:n=!!t.a,n?e.a=t.a:n=null!=t.g;var r=t.f;if(n)jn(e,t.g);else if(n=!!t.f){if("/"!=r.charAt(0))if(this.a&&!this.f)r="/"+r;else{var i=e.f.lastIndexOf("/");-1!=i&&(r=e.f.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(ht(i,"./")||ht(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?e.f=r:n=""!==t.b.toString(),n?qn(e,or(t.b)):n=!!t.h,n&&(e.h=t.h),e};var Qn=/[#\/\?@]/g,Yn=/[#\?:]/g,Xn=/[#\?]/g,$n=/[#\?@]/g,Jn=/#/g;function Zn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function tr(t){t.a||(t.a=new Dn,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function er(t){var e=Rn(t);if("undefined"==typeof e)throw Error("Keys are undefined");var n=new Zn(null,void 0);t=Pn(t);for(var r=0;r<e.length;r++){var i=e[r],o=t[r];Array.isArray(o)?ir(n,i,o):n.add(i,o)}return n}function nr(t,e){tr(t),e=ar(t,e),On(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,On((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&xn(t)))}function rr(t,e){return tr(t),e=ar(t,e),On(t.a.b,e)}function ir(t,e,n){nr(t,e),0<n.length&&(t.c=null,t.a.set(ar(t,e),tt(n)),t.b+=n.length)}function or(t){var e=new Zn;return e.c=t.c,t.a&&(e.a=new Dn(t.a),e.b=t.b),e}function ar(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function sr(t){var e=[];return cr(new ur,t,e),e.join("")}function ur(){}function cr(t,e,n){if(null==e)n.push("null");else{if("object"==typeof e){if(Array.isArray(e)){var r=e;e=r.length,n.push("[");for(var i="",o=0;o<e;o++)n.push(i),cr(t,r[o],n),i=",";return void n.push("]")}if(!(e instanceof String||e instanceof Number||e instanceof Boolean)){for(r in n.push("{"),i="",e)Object.prototype.hasOwnProperty.call(e,r)&&("function"!=typeof(o=e[r])&&(n.push(i),fr(r,n),n.push(":"),cr(t,o,n),i=","));return void n.push("}")}e=e.valueOf()}switch(typeof e){case"string":fr(e,n);break;case"number":n.push(isFinite(e)&&!isNaN(e)?String(e):"null");break;case"boolean":n.push(String(e));break;case"function":n.push("null");break;default:throw Error("Unknown type: "+typeof e)}}}(t=Zn.prototype).add=function(t,e){tr(this),this.c=null,t=ar(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},t.clear=function(){this.a=this.c=null,this.b=0},t.forEach=function(t,e){tr(this),this.a.forEach((function(n,r){G(n,(function(n){t.call(e,n,r,this)}),this)}),this)},t.Y=function(){tr(this);for(var t=this.a.X(),e=this.a.Y(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},t.X=function(t){tr(this);var e=[];if("string"===typeof t)rr(this,t)&&(e=Z(e,this.a.get(ar(this,t))));else{t=this.a.X();for(var n=0;n<t.length;n++)e=Z(e,t[n])}return e},t.set=function(t,e){return tr(this),this.c=null,rr(this,t=ar(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},t.get=function(t,e){return t&&0<(t=this.X(t)).length?String(t[0]):e},t.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.Y(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.X(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")};var hr={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},lr=/\uffff/.test("\uffff")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function fr(t,e){e.push('"',t.replace(lr,(function(t){var e=hr[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),hr[t]=e),e})),'"')}function dr(){var t=xr();return Xt&&!!ce&&11==ce||/Edge\/\d+/.test(t)}function pr(){return u.window&&u.window.location.href||self&&self.location&&self.location.href||""}function vr(t,e){e=e||u.window;var n="about:blank";t&&(n=Ot(Ut(t)||Vt)),e.location.href=n}function gr(t,e){var n,r=[];for(n in t)n in e?typeof t[n]!=typeof e[n]?r.push(n):"object"==typeof t[n]&&null!=t[n]&&null!=e[n]?0<gr(t[n],e[n]).length&&r.push(n):t[n]!==e[n]&&r.push(n):r.push(n);for(n in e)n in t||r.push(n);return r}function yr(t){return!!((t=(t||xr()).toLowerCase()).match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function mr(t){t=t||u.window;try{t.close()}catch(e){}}function _r(t,e,n){var r=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-e)/2;for(a in e={width:e,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=xr().toLowerCase(),r&&(e.target=r,ht(n,"crios/")&&(e.target="_blank")),Pr(xr())==Ar&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),r=window,e=n instanceof xt?n:Ut("undefined"!=typeof n.href?n.href:String(n))||Vt,n=t.target||n.target,i=[],t)switch(a){case"width":case"height":case"top":case"left":i.push(a+"="+t[a]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(a+"="+(t[a]?1:0))}var a=i.join(",");if((pt("iPhone")&&!pt("iPod")&&!pt("iPad")||pt("iPad")||pt("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(bt(a=ye(document,"A"),"HTMLAnchorElement"),e=e instanceof xt?e:jt(e),a.href=Ot(e),a.setAttribute("target",n),t.noreferrer&&a.setAttribute("rel","noreferrer"),(t=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,r,1),a.dispatchEvent(t),a={}):t.noreferrer?(a=Wt("",r,n,a),t=Ot(e),a&&(Jt&&ht(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),a.opener=null,t='<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+Gt(t)+'">',t=new Bt(t=(r=Ct())?r.createHTML(t):t,null,Kt),r=a.document)&&(r.write(function(t){return t instanceof Bt&&t.constructor===Bt?t.a:(U("expected object of type SafeHtml, got '"+t+"' of type "+d(t)),"type_error:SafeHtml")}(t)),r.close())):(a=Wt(e,r,n,a))&&t.noopener&&(a.opener=null),a)try{a.focus()}catch(s){}return a}var br=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,wr=/^[^@]+@[^@]+$/;function Ir(){var t=null;return new Te((function(e){"complete"==u.document.readyState?e():(t=function(){e()},pn(window,"load",t))})).o((function(e){throw vn(window,"load",t),e}))}function Tr(t){return t=t||xr(),!("file:"!==Ur()&&"ionic:"!==Ur()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function Er(){var t=u.window;try{return!(!t||t==t.top)}catch(e){return!1}}function Sr(){return"undefined"!==typeof u.WorkerGlobalScope&&"function"===typeof u.importScripts}function Cr(){return r.default.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":r.default.INTERNAL.hasOwnProperty("node")?"Node":Sr()?"Worker":"Browser"}function kr(){var t=Cr();return"ReactNative"===t||"Node"===t}var Ar="Firefox",Nr="Chrome";function Pr(t){var e=t.toLowerCase();return ht(e,"opera/")||ht(e,"opr/")||ht(e,"opios/")?"Opera":ht(e,"iemobile")?"IEMobile":ht(e,"msie")||ht(e,"trident/")?"IE":ht(e,"edge/")?"Edge":ht(e,"firefox/")?Ar:ht(e,"silk/")?"Silk":ht(e,"blackberry")?"Blackberry":ht(e,"webos")?"Webos":!ht(e,"safari/")||ht(e,"chrome/")||ht(e,"crios/")||ht(e,"android")?!ht(e,"chrome/")&&!ht(e,"crios/")||ht(e,"edge/")?ht(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":Nr:"Safari"}var Rr={md:"FirebaseCore-web",od:"FirebaseUI-web"};function Dr(t,e){e=e||[];var n,r=[],i={};for(n in Rr)i[Rr[n]]=!0;for(n=0;n<e.length;n++)"undefined"!==typeof i[e[n]]&&(delete i[e[n]],r.push(e[n]));return r.sort(),(e=r).length||(e=["FirebaseCore-web"]),"Browser"===(r=Cr())?r=Pr(i=xr()):"Worker"===r&&(r=Pr(i=xr())+"-"+r),r+"/JsCore/"+t+"/"+e.join(",")}function xr(){return u.navigator&&u.navigator.userAgent||""}function Or(t,e){t=t.split("."),e=e||u;for(var n=0;n<t.length&&"object"==typeof e&&null!=e;n++)e=e[t[n]];return n!=t.length&&(e=void 0),e}function Lr(){try{var t=u.localStorage,e=Kr();if(t)return t.setItem(e,"1"),t.removeItem(e),!dr()||!!u.indexedDB}catch(n){return Sr()&&!!u.indexedDB}return!1}function Mr(){return(Fr()||"chrome-extension:"===Ur()||Tr())&&!kr()&&Lr()&&!Sr()}function Fr(){return"http:"===Ur()||"https:"===Ur()}function Ur(){return u.location&&u.location.protocol||null}function jr(t){return!yr(t=t||xr())&&Pr(t)!=Ar}function qr(t){return"undefined"===typeof t?null:sr(t)}function Vr(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n}function Br(t){if(null!==t)return JSON.parse(t)}function Kr(t){return t||Math.floor(1e9*Math.random()).toString()}function Wr(t){return"Safari"!=Pr(t=t||xr())&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function Hr(){var t=u.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null}function Gr(t,e){if(t>e)throw Error("Short delay should be less than long delay!");this.a=t,this.c=e,t=xr(),e=Cr(),this.b=yr(t)||"ReactNative"===e}function zr(){var t=u.document;return!t||"undefined"===typeof t.visibilityState||"visible"==t.visibilityState}function Qr(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(n){}return null}function Yr(){return!(!Or("fireauth.oauthhelper",u)&&!Or("fireauth.iframe",u))}Gr.prototype.get=function(){var t=u.navigator;return!t||"boolean"!==typeof t.onLine||!Fr()&&"chrome-extension:"!==Ur()&&"undefined"===typeof t.connection||t.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var Xr,$r={};function Jr(t){$r[t]||($r[t]=!0,"undefined"!==typeof console&&"function"===typeof console.warn&&console.warn(t))}try{var Zr={};Object.defineProperty(Zr,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(Zr,"abcd",{configurable:!0,enumerable:!0,value:2}),Xr=2==Zr.abcd}catch(pa){Xr=!1}function ti(t,e,n){Xr?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function ei(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&ti(t,n,e[n])}function ni(t){var e={};return ei(e,t),e}function ri(t){var e=t;if("object"==typeof t&&null!=t)for(var n in e="length"in t?[]:{},t)ti(e,n,ri(t[n]));return e}function ii(t){var e=t&&(t[ci]?"phone":null);if(!(e&&t&&t[ui]))throw new A("internal-error","Internal assert: invalid MultiFactorInfo object");ti(this,"uid",t[ui]),ti(this,"displayName",t[ai]||null);var n=null;t[si]&&(n=new Date(t[si]).toUTCString()),ti(this,"enrollmentTime",n),ti(this,"factorId",e)}function oi(t){try{var e=new hi(t)}catch(n){e=null}return e}ii.prototype.w=function(){return{uid:this.uid,displayName:this.displayName,factorId:this.factorId,enrollmentTime:this.enrollmentTime}};var ai="displayName",si="enrolledAt",ui="mfaEnrollmentId",ci="phoneInfo";function hi(t){ii.call(this,t),ti(this,"phoneNumber",t[ci])}function li(t){var e={},n=t[vi],r=t[yi],i=t[mi];if(t=oi(t[gi]),!i||i!=di&&i!=pi&&!n||i==pi&&!r||i==fi&&!t)throw Error("Invalid checkActionCode response!");i==pi?(e[bi]=n||null,e[Ii]=n||null,e[_i]=r):(e[bi]=r||null,e[Ii]=r||null,e[_i]=n||null),e[wi]=t||null,ti(this,Ei,i),ti(this,Ti,ri(e))}C(hi,ii),hi.prototype.w=function(){var t=hi.bb.w.call(this);return t.phoneNumber=this.phoneNumber,t};var fi="REVERT_SECOND_FACTOR_ADDITION",di="EMAIL_SIGNIN",pi="VERIFY_AND_CHANGE_EMAIL",vi="email",gi="mfaInfo",yi="newEmail",mi="requestType",_i="email",bi="fromEmail",wi="multiFactorInfo",Ii="previousEmail",Ti="data",Ei="operation";function Si(t){var e=Bn(t=Kn(t),Ci)||null,n=Bn(t,ki)||null,r=Bn(t,Pi)||null;if(r=r&&Di[r]||null,!e||!n||!r)throw new A("argument-error",Ci+", "+ki+"and "+Pi+" are required in a valid action code URL.");ei(this,{apiKey:e,operation:r,code:n,continueUrl:Bn(t,Ai)||null,languageCode:Bn(t,Ni)||null,tenantId:Bn(t,Ri)||null})}var Ci="apiKey",ki="oobCode",Ai="continueUrl",Ni="languageCode",Pi="mode",Ri="tenantId",Di={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",revertSecondFactorAddition:fi,signIn:di,verifyAndChangeEmail:pi,verifyEmail:"VERIFY_EMAIL"};function xi(t){try{return new Si(t)}catch(e){return null}}function Oi(t){var e=t[ji];if("undefined"===typeof e)throw new A("missing-continue-uri");if("string"!==typeof e||"string"===typeof e&&!e.length)throw new A("invalid-continue-uri");this.h=e,this.b=this.a=null,this.g=!1;var n=t[Li];if(n&&"object"===typeof n){e=n[Bi];var r=n[qi];if(n=n[Vi],"string"===typeof e&&e.length){if(this.a=e,"undefined"!==typeof r&&"boolean"!==typeof r)throw new A("argument-error",qi+" property must be a boolean when specified.");if(this.g=!!r,"undefined"!==typeof n&&("string"!==typeof n||"string"===typeof n&&!n.length))throw new A("argument-error",Vi+" property must be a non empty string when specified.");this.b=n||null}else{if("undefined"!==typeof e)throw new A("argument-error",Bi+" property must be a non empty string when specified.");if("undefined"!==typeof r||"undefined"!==typeof n)throw new A("missing-android-pkg-name")}}else if("undefined"!==typeof n)throw new A("argument-error",Li+" property must be a non null object when specified.");if(this.f=null,(e=t[Ui])&&"object"===typeof e){if("string"===typeof(e=e[Ki])&&e.length)this.f=e;else if("undefined"!==typeof e)throw new A("argument-error",Ki+" property must be a non empty string when specified.")}else if("undefined"!==typeof e)throw new A("argument-error",Ui+" property must be a non null object when specified.");if("undefined"!==typeof(e=t[Fi])&&"boolean"!==typeof e)throw new A("argument-error",Fi+" property must be a boolean when specified.");if(this.c=!!e,"undefined"!==typeof(t=t[Mi])&&("string"!==typeof t||"string"===typeof t&&!t.length))throw new A("argument-error",Mi+" property must be a non empty string when specified.");this.i=t||null}var Li="android",Mi="dynamicLinkDomain",Fi="handleCodeInApp",Ui="iOS",ji="url",qi="installApp",Vi="minimumVersion",Bi="packageName",Ki="bundleId";function Wi(t){var e={};for(var n in e.continueUrl=t.h,e.canHandleCodeInApp=t.c,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.b,e.androidInstallApp=t.g),e.iOSBundleId=t.f,e.dynamicLinkDomain=t.i,e)null===e[n]&&delete e[n];return e}var Hi=null;function Gi(t){var e=[];return function(t,e){function n(e){for(;r<t.length;){var n=t.charAt(r++),i=Hi[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}!function(){if(!Hi){Hi={};for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),e=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++)for(var r=t.concat(e[n].split("")),i=0;i<r.length;i++){var o=r[i];void 0===Hi[o]&&(Hi[o]=i)}}}();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;e(i<<2|o>>4),64!=a&&(e(o<<4&240|a>>2),64!=s&&e(a<<6&192|s))}}(t,(function(t){e.push(t)})),e}function zi(t){var e=Yi(t);if(!(e&&e.sub&&e.iss&&e.aud&&e.exp))throw Error("Invalid JWT");this.h=t,this.a=e.exp,this.i=e.sub,t=Date.now()/1e3,this.g=e.iat||(t>this.a?this.a:t),this.b=e.provider_id||e.firebase&&e.firebase.sign_in_provider||null,this.f=e.firebase&&e.firebase.tenant||null,this.c=!!e.is_anonymous||"anonymous"==this.b}function Qi(t){try{return new zi(t)}catch(e){return null}}function Yi(t){if(!t)return null;if(3!=(t=t.split(".")).length)return null;for(var e=(4-(t=t[1]).length%4)%4,n=0;n<e;n++)t+=".";try{var r=Gi(t);for(t=[],n=e=0;e<r.length;){var i=r[e++];if(128>i)t[n++]=String.fromCharCode(i);else if(191<i&&224>i){var o=r[e++];t[n++]=String.fromCharCode((31&i)<<6|63&o)}else if(239<i&&365>i){o=r[e++];var a=r[e++],s=((7&i)<<18|(63&o)<<12|(63&a)<<6|63&r[e++])-65536;t[n++]=String.fromCharCode(55296+(s>>10)),t[n++]=String.fromCharCode(56320+(1023&s))}else o=r[e++],a=r[e++],t[n++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}return JSON.parse(t.join(""))}catch(v){}return null}zi.prototype.T=function(){return this.f},zi.prototype.l=function(){return this.c},zi.prototype.toString=function(){return this.h};var Xi="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),$i=["client_id","response_type","scope","redirect_uri","state"],Ji={nd:{Ja:"locale",va:700,ua:600,fa:"facebook.com",Ya:$i},pd:{Ja:null,va:500,ua:750,fa:"github.com",Ya:$i},qd:{Ja:"hl",va:515,ua:680,fa:"google.com",Ya:$i},wd:{Ja:"lang",va:485,ua:705,fa:"twitter.com",Ya:Xi},kd:{Ja:"locale",va:640,ua:600,fa:"apple.com",Ya:[]}};function Zi(t){for(var e in Ji)if(Ji[e].fa==t)return Ji[e];return null}function to(t){var e={};e["facebook.com"]=oo,e["google.com"]=so,e["github.com"]=ao,e["twitter.com"]=uo;var n=t&&t[no];try{if(n)return e[n]?new e[n](t):new io(t);if("undefined"!==typeof t[eo])return new ro(t)}catch(r){}return null}var eo="idToken",no="providerId";function ro(t){var e=t[no];if(!e&&t[eo]){var n=Qi(t[eo]);n&&n.b&&(e=n.b)}if(!e)throw Error("Invalid additional user info!");"anonymous"!=e&&"custom"!=e||(e=null),n=!1,"undefined"!==typeof t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),ti(this,"providerId",e),ti(this,"isNewUser",n)}function io(t){ro.call(this,t),ti(this,"profile",ri((t=Br(t.rawUserInfo||"{}"))||{}))}function oo(t){if(io.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function ao(t){if(io.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");ti(this,"username",this.profile&&this.profile.login||null)}function so(t){if(io.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function uo(t){if(io.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");ti(this,"username",t.screenName||null)}function co(t){var e=Kn(t),n=Bn(e,"link"),r=Bn(Kn(n),"link");return e=Bn(e,"deep_link_id"),Bn(Kn(e),"link")||e||r||n||t}function ho(t,e){if(!t&&!e)throw new A("internal-error","Internal assert: no raw session string available");if(t&&e)throw new A("internal-error","Internal assert: unable to determine the session type");this.a=t||null,this.b=e||null,this.type=this.a?lo:fo}C(io,ro),C(oo,io),C(ao,io),C(so,io),C(uo,io);var lo="enroll",fo="signin";function po(){}function vo(t,e){return t.then((function(t){if(t[is]){var n=Qi(t[is]);if(!n||e!=n.i)throw new A("user-mismatch");return t}throw new A("user-mismatch")})).o((function(t){throw t&&t.code&&t.code==R+"user-not-found"?new A("user-mismatch"):t}))}function go(t,e){if(!e)throw new A("internal-error","failed to construct a credential");this.a=e,ti(this,"providerId",t),ti(this,"signInMethod",t)}function yo(t){return{pendingToken:t.a,requestUri:"http://localhost"}}function mo(t){if(t&&t.providerId&&t.signInMethod&&0==t.providerId.indexOf("saml.")&&t.pendingToken)try{return new go(t.providerId,t.pendingToken)}catch(e){}return null}function _o(t,e,n){if(this.a=null,e.idToken||e.accessToken)e.idToken&&ti(this,"idToken",e.idToken),e.accessToken&&ti(this,"accessToken",e.accessToken),e.nonce&&!e.pendingToken&&ti(this,"nonce",e.nonce),e.pendingToken&&(this.a=e.pendingToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new A("internal-error","failed to construct a credential");ti(this,"accessToken",e.oauthToken),ti(this,"secret",e.oauthTokenSecret)}ti(this,"providerId",t),ti(this,"signInMethod",n)}function bo(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,t.nonce&&!t.a&&(e.nonce=t.nonce),e={postBody:er(e).toString(),requestUri:"http://localhost"},t.a&&(delete e.postBody,e.pendingToken=t.a),e}function wo(t){if(t&&t.providerId&&t.signInMethod){var e={idToken:t.oauthIdToken,accessToken:t.oauthTokenSecret?null:t.oauthAccessToken,oauthTokenSecret:t.oauthTokenSecret,oauthToken:t.oauthTokenSecret&&t.oauthAccessToken,nonce:t.nonce,pendingToken:t.pendingToken};try{return new _o(t.providerId,e,t.signInMethod)}catch(n){}}return null}function Io(t,e){this.Qc=e||[],ei(this,{providerId:t,isOAuthProvider:!0}),this.Jb={},this.qb=(Zi(t)||{}).Ja||null,this.pb=null}function To(t){if("string"!==typeof t||0!=t.indexOf("saml."))throw new A("argument-error",'SAML provider IDs must be prefixed with "saml."');Io.call(this,t,[])}function Eo(t){Io.call(this,t,$i),this.a=[]}function So(){Eo.call(this,"facebook.com")}function Co(t){if(!t)throw new A("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return y(t)&&(e=t.accessToken),(new So).credential({accessToken:e})}function ko(){Eo.call(this,"github.com")}function Ao(t){if(!t)throw new A("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return y(t)&&(e=t.accessToken),(new ko).credential({accessToken:e})}function No(){Eo.call(this,"google.com"),this.Ca("profile")}function Po(t,e){var n=t;return y(t)&&(n=t.idToken,e=t.accessToken),(new No).credential({idToken:n,accessToken:e})}function Ro(){Io.call(this,"twitter.com",Xi)}function Do(t,e){var n=t;if(y(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new A("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new _o("twitter.com",n,"twitter.com")}function xo(t,e,n){this.a=t,this.f=e,ti(this,"providerId","password"),ti(this,"signInMethod",n===Lo.EMAIL_LINK_SIGN_IN_METHOD?Lo.EMAIL_LINK_SIGN_IN_METHOD:Lo.EMAIL_PASSWORD_SIGN_IN_METHOD)}function Oo(t){return t&&t.email&&t.password?new xo(t.email,t.password,t.signInMethod):null}function Lo(){ei(this,{providerId:"password",isOAuthProvider:!1})}function Mo(t,e){if(!(e=Fo(e)))throw new A("argument-error","Invalid email link!");return new xo(t,e.code,Lo.EMAIL_LINK_SIGN_IN_METHOD)}function Fo(t){return(t=xi(t=co(t)))&&t.operation===di?t:null}function Uo(t){if(!(t.fb&&t.eb||t.La&&t.ea))throw new A("internal-error");this.a=t,ti(this,"providerId","phone"),this.fa="phone",ti(this,"signInMethod","phone")}function jo(t){if(t&&"phone"===t.providerId&&(t.verificationId&&t.verificationCode||t.temporaryProof&&t.phoneNumber)){var e={};return G(["verificationId","verificationCode","temporaryProof","phoneNumber"],(function(n){t[n]&&(e[n]=t[n])})),new Uo(e)}return null}function qo(t){return t.a.La&&t.a.ea?{temporaryProof:t.a.La,phoneNumber:t.a.ea}:{sessionInfo:t.a.fb,code:t.a.eb}}function Vo(t){try{this.a=t||r.default.auth()}catch(e){throw new A("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}ei(this,{providerId:"phone",isOAuthProvider:!1})}function Bo(t,e){if(!t)throw new A("missing-verification-id");if(!e)throw new A("missing-verification-code");return new Uo({fb:t,eb:e})}function Ko(t){if(t.temporaryProof&&t.phoneNumber)return new Uo({La:t.temporaryProof,ea:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,r=t&&t.oauthTokenSecret,i=t&&t.nonce,o=t&&t.oauthIdToken,a=t&&t.pendingToken;try{switch(e){case"google.com":return Po(o,n);case"facebook.com":return Co(n);case"github.com":return Ao(n);case"twitter.com":return Do(n,r);default:return n||r||o||a?a?0==e.indexOf("saml.")?new go(e,a):new _o(e,{pendingToken:a,idToken:t.oauthIdToken,accessToken:t.oauthAccessToken},e):new Eo(e).credential({idToken:o,accessToken:n,rawNonce:i}):null}}catch(s){return null}}function Wo(t){if(!t.isOAuthProvider)throw new A("invalid-oauth-provider")}function Ho(t,e,n,r,i,o,a){if(this.c=t,this.b=e||null,this.g=n||null,this.f=r||null,this.i=o||null,this.h=a||null,this.a=i||null,!this.g&&!this.a)throw new A("invalid-auth-event");if(this.g&&this.a)throw new A("invalid-auth-event");if(this.g&&!this.f)throw new A("invalid-auth-event")}function Go(t){return(t=t||{}).type?new Ho(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&N(t.error),t.postBody,t.tenantId):null}function zo(){this.b=null,this.a=[]}ho.prototype.Ha=function(){return this.a?Pe(this.a):Pe(this.b)},ho.prototype.w=function(){return this.type==lo?{multiFactorSession:{idToken:this.a}}:{multiFactorSession:{pendingCredential:this.b}}},po.prototype.ka=function(){},po.prototype.b=function(){},po.prototype.c=function(){},po.prototype.w=function(){},go.prototype.ka=function(t){return Cs(t,yo(this))},go.prototype.b=function(t,e){var n=yo(this);return n.idToken=e,ks(t,n)},go.prototype.c=function(t,e){return vo(As(t,yo(this)),e)},go.prototype.w=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},_o.prototype.ka=function(t){return Cs(t,bo(this))},_o.prototype.b=function(t,e){var n=bo(this);return n.idToken=e,ks(t,n)},_o.prototype.c=function(t,e){return vo(As(t,bo(this)),e)},_o.prototype.w=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),this.nonce&&(t.nonce=this.nonce),this.a&&(t.pendingToken=this.a),t},Io.prototype.Ka=function(t){return this.Jb=yt(t),this},C(To,Io),C(Eo,Io),Eo.prototype.Ca=function(t){return X(this.a,t)||this.a.push(t),this},Eo.prototype.Rb=function(){return tt(this.a)},Eo.prototype.credential=function(t,e){var n;if(!(n=y(t)?{idToken:t.idToken||null,accessToken:t.accessToken||null,nonce:t.rawNonce||null}:{idToken:t||null,accessToken:e||null}).idToken&&!n.accessToken)throw new A("argument-error","credential failed: must provide the ID token and/or the access token.");return new _o(this.providerId,n,this.providerId)},C(So,Eo),ti(So,"PROVIDER_ID","facebook.com"),ti(So,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),C(ko,Eo),ti(ko,"PROVIDER_ID","github.com"),ti(ko,"GITHUB_SIGN_IN_METHOD","github.com"),C(No,Eo),ti(No,"PROVIDER_ID","google.com"),ti(No,"GOOGLE_SIGN_IN_METHOD","google.com"),C(Ro,Io),ti(Ro,"PROVIDER_ID","twitter.com"),ti(Ro,"TWITTER_SIGN_IN_METHOD","twitter.com"),xo.prototype.ka=function(t){return this.signInMethod==Lo.EMAIL_LINK_SIGN_IN_METHOD?cu(t,Ms,{email:this.a,oobCode:this.f}):cu(t,iu,{email:this.a,password:this.f})},xo.prototype.b=function(t,e){return this.signInMethod==Lo.EMAIL_LINK_SIGN_IN_METHOD?cu(t,Fs,{idToken:e,email:this.a,oobCode:this.f}):cu(t,Xs,{idToken:e,email:this.a,password:this.f})},xo.prototype.c=function(t,e){return vo(this.ka(t),e)},xo.prototype.w=function(){return{email:this.a,password:this.f,signInMethod:this.signInMethod}},ei(Lo,{PROVIDER_ID:"password"}),ei(Lo,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),ei(Lo,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),Uo.prototype.ka=function(t){return t.gb(qo(this))},Uo.prototype.b=function(t,e){var n=qo(this);return n.idToken=e,cu(t,au,n)},Uo.prototype.c=function(t,e){var n=qo(this);return n.operation="REAUTH",vo(t=cu(t,su,n),e)},Uo.prototype.w=function(){var t={providerId:"phone"};return this.a.fb&&(t.verificationId=this.a.fb),this.a.eb&&(t.verificationCode=this.a.eb),this.a.La&&(t.temporaryProof=this.a.La),this.a.ea&&(t.phoneNumber=this.a.ea),t},Vo.prototype.gb=function(t,e){var n=this.a.a;return Pe(e.verify()).then((function(r){if("string"!==typeof r)throw new A("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");if("recaptcha"===e.type){var i,o=y(t)?t.session:null,a=y(t)?t.phoneNumber:t;return i=o&&o.type==lo?o.Ha().then((function(t){return function(t,e){return cu(t,Js,e).then((function(t){return t.phoneSessionInfo.sessionInfo}))}(n,{idToken:t,phoneEnrollmentInfo:{phoneNumber:a,recaptchaToken:r}})})):o&&o.type==fo?o.Ha().then((function(e){return function(t,e){return cu(t,Zs,e).then((function(t){return t.phoneResponseInfo.sessionInfo}))}(n,{mfaPendingCredential:e,mfaEnrollmentId:t.multiFactorHint&&t.multiFactorHint.uid||t.multiFactorUid,phoneSignInInfo:{recaptchaToken:r}})})):function(t,e){return cu(t,Qs,e)}(n,{phoneNumber:a,recaptchaToken:r}),i.then((function(t){return"function"===typeof e.reset&&e.reset(),t}),(function(t){throw"function"===typeof e.reset&&e.reset(),t}))}throw new A("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}))},ei(Vo,{PROVIDER_ID:"phone"}),ei(Vo,{PHONE_SIGN_IN_METHOD:"phone"}),Ho.prototype.getUid=function(){var t=[];return t.push(this.c),this.b&&t.push(this.b),this.f&&t.push(this.f),this.h&&t.push(this.h),t.join("-")},Ho.prototype.T=function(){return this.h},Ho.prototype.w=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.w()}};var Qo,Yo=null;function Xo(t){var e="unauthorized-domain",n=void 0,r=Kn(t);t=r.a,"chrome-extension"==(r=r.c)?n=Ht("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==r||"https"==r?n=Ht("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",A.call(this,e,n)}function $o(t,e,n){A.call(this,t,n),(t=e||{}).Kb&&ti(this,"email",t.Kb),t.ea&&ti(this,"phoneNumber",t.ea),t.credential&&ti(this,"credential",t.credential),t.$b&&ti(this,"tenantId",t.$b)}function Jo(t){if(t.code){var e=t.code||"";0==e.indexOf(R)&&(e=e.substring(R.length));var n={credential:Ko(t),$b:t.tenantId};if(t.email)n.Kb=t.email;else if(t.phoneNumber)n.ea=t.phoneNumber;else if(!n.credential)return new A(e,t.message||void 0);return new $o(e,n,t.message)}return null}function Zo(){}function ta(t){return t.c||(t.c=t.b())}function ea(){}function na(t){if(!t.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var r=e[n];try{return new ActiveXObject(r),t.f=r}catch(Vd){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.f}function ra(){}function ia(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=T(this.qc,this),this.a.onerror=T(this.Tb,this),this.a.onprogress=T(this.rc,this),this.a.ontimeout=T(this.vc,this)}function oa(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function aa(t,e,n){this.reset(t,e,n,void 0,void 0)}C(Xo,A),C($o,A),$o.prototype.w=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber),this.tenantId&&(t.tenantId=this.tenantId);var e=this.credential&&this.credential.w();return e&&_t(t,e),t},$o.prototype.toJSON=function(){return this.w()},Zo.prototype.c=null,C(ea,Zo),ea.prototype.a=function(){var t=na(this);return t?new ActiveXObject(t):new XMLHttpRequest},ea.prototype.b=function(){var t={};return na(this)&&(t[0]=!0,t[1]=!0),t},Qo=new ea,C(ra,Zo),ra.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new ia;throw Error("Unsupported browser")},ra.prototype.b=function(){return{}},(t=ia.prototype).open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},t.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},t.abort=function(){this.a.abort()},t.setRequestHeader=function(){},t.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},t.qc=function(){this.status=200,this.response=this.responseText=this.a.responseText,oa(this,4)},t.Tb=function(){this.status=500,this.response=this.responseText="",oa(this,4)},t.vc=function(){this.Tb()},t.rc=function(){this.status=200,oa(this,1)},t.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},aa.prototype.a=null;function sa(t){this.f=t,this.b=this.c=this.a=null}function ua(t,e){this.name=t,this.value=e}aa.prototype.reset=function(t,e,n,r,i){"number"==typeof i||0,r||S(),delete this.a},ua.prototype.toString=function(){return this.name};var ca=new ua("SEVERE",1e3),ha=new ua("WARNING",900),la=new ua("CONFIG",700),fa=new ua("FINE",500);function da(t){return t.c?t.c:t.a?da(t.a):(U("Root logger has no level set."),null)}sa.prototype.log=function(t,e,n){if(t.value>=da(this).value)for(g(e)&&(e=e()),t=new aa(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var pa,va={},ga=null;function ya(t){var e;if(ga||(ga=new sa(""),va[""]=ga,ga.c=la),!(e=va[t])){e=new sa(t);var n=t.lastIndexOf("."),r=t.substr(n+1);(n=ya(t.substr(0,n))).b||(n.b={}),n.b[r]=e,e.a=n,va[t]=e}return e}function ma(t,e){t&&t.log(fa,e,void 0)}function _a(t){this.f=t}function ba(t){En.call(this),this.u=t,this.h=void 0,this.readyState=wa,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.l=new Headers,this.b=null,this.s="GET",this.f="",this.a=!1,this.i=ya("goog.net.FetchXmlHttp"),this.m=this.c=this.g=null}C(_a,Zo),_a.prototype.a=function(){return new ba(this.f)},_a.prototype.b=(pa={},function(){return pa}),C(ba,En);var wa=0;function Ia(t){t.c.read().then(t.pc.bind(t)).catch(t.Va.bind(t))}function Ta(t){t.readyState=4,t.g=null,t.c=null,t.m=null,Ea(t)}function Ea(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function Sa(t){En.call(this),this.headers=new Dn,this.D=t||null,this.c=!1,this.C=this.a=null,this.h=this.P=this.l="",this.f=this.N=this.i=this.J=!1,this.g=0,this.s=null,this.m=Ca,this.u=this.S=!1}(t=ba.prototype).open=function(t,e){if(this.readyState!=wa)throw this.abort(),Error("Error reopening a connection");this.s=t,this.f=e,this.readyState=1,Ea(this)},t.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.l,method:this.s,credentials:this.h,cache:void 0};t&&(e.body=t),this.u.fetch(new Request(this.f,e)).then(this.uc.bind(this),this.Va.bind(this))},t.abort=function(){this.response=this.responseText="",this.l=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,Ta(this)),this.readyState=wa},t.uc=function(t){this.a&&(this.g=t,this.b||(this.status=this.g.status,this.statusText=this.g.statusText,this.b=t.headers,this.readyState=2,Ea(this)),this.a&&(this.readyState=3,Ea(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.sc.bind(this),this.Va.bind(this)):"undefined"!==typeof u.ReadableStream&&"body"in t?(this.response=this.responseText="",this.c=t.body.getReader(),this.m=new TextDecoder,Ia(this)):t.text().then(this.tc.bind(this),this.Va.bind(this)))))},t.pc=function(t){if(this.a){var e=this.m.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.response=this.responseText+=e),t.done?Ta(this):Ea(this),3==this.readyState&&Ia(this)}},t.tc=function(t){this.a&&(this.response=this.responseText=t,Ta(this))},t.sc=function(t){this.a&&(this.response=t,Ta(this))},t.Va=function(t){var e=this.i;e&&e.log(ha,"Failed to fetch url "+this.f,t instanceof Error?t:Error(t)),this.a&&Ta(this)},t.setRequestHeader=function(t,e){this.l.append(t,e)},t.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||"":((t=this.i)&&t.log(ha,"Attempting to get response header but no headers have been received for url: "+this.f,void 0),"")},t.getAllResponseHeaders=function(){if(!this.b){var t=this.i;return t&&t.log(ha,"Attempting to get all response headers but no headers have been received for url: "+this.f,void 0),""}t=[];for(var e=this.b.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(ba.prototype,"withCredentials",{get:function(){return"include"===this.h},set:function(t){this.h=t?"include":"same-origin"}}),C(Sa,En);var Ca="";Sa.prototype.b=ya("goog.net.XhrIo");var ka=/^https?$/i,Aa=["POST","PUT"];function Na(t,e,n,r,i){if(t.a)throw Error("[goog.net.XhrIo] Object is active with another request="+t.l+"; newUri="+e);n=n?n.toUpperCase():"GET",t.l=e,t.h="",t.P=n,t.J=!1,t.c=!0,t.a=t.D?t.D.a():Qo.a(),t.C=t.D?ta(t.D):ta(Qo),t.a.onreadystatechange=T(t.Wb,t);try{ma(t.b,Ua(t,"Opening Xhr")),t.N=!0,t.a.open(n,String(e),!0),t.N=!1}catch(a){return ma(t.b,Ua(t,"Error opening Xhr: "+a.message)),void Ra(t,a)}e=r||"";var o=new Dn(t.headers);i&&function(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(p(t)||"string"===typeof t)G(t,e,void 0);else for(var n=Rn(t),r=Pn(t),i=r.length,o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}(i,(function(t,e){o.set(e,t)})),i=function(t){t:{for(var e=Pa,n=t.length,r="string"===typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"===typeof t?t.charAt(e):t[e]}(o.Y()),r=u.FormData&&e instanceof u.FormData,!X(Aa,n)||i||r||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach((function(t,e){this.a.setRequestHeader(e,t)}),t),t.m&&(t.a.responseType=t.m),"withCredentials"in t.a&&t.a.withCredentials!==t.S&&(t.a.withCredentials=t.S);try{La(t),0<t.g&&(t.u=function(t){return Xt&&se(9)&&"number"===typeof t.timeout&&void 0!==t.ontimeout}(t.a),ma(t.b,Ua(t,"Will abort after "+t.g+"ms if incomplete, xhr2 "+t.u)),t.u?(t.a.timeout=t.g,t.a.ontimeout=T(t.Ma,t)):t.s=An(t.Ma,t.g,t)),ma(t.b,Ua(t,"Sending request")),t.i=!0,t.a.send(e),t.i=!1}catch(a){ma(t.b,Ua(t,"Send error: "+a.message)),Ra(t,a)}}function Pa(t){return"content-type"==t.toLowerCase()}function Ra(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.h=e,Da(t),Oa(t)}function Da(t){t.J||(t.J=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function xa(t){if(t.c&&"undefined"!=typeof s)if(t.C[1]&&4==Ma(t)&&2==Fa(t))ma(t.b,Ua(t,"Local request error detected and ignored"));else if(t.i&&4==Ma(t))An(t.Wb,0,t);else if(t.dispatchEvent("readystatechange"),4==Ma(t)){ma(t.b,Ua(t,"Request complete")),t.c=!1;try{var e,n=Fa(t);t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.l).match(Ln)[1]||null;if(!o&&u.self&&u.self.location){var a=u.self.location.protocol;o=a.substr(0,a.length-1)}i=!ka.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var c=2<Ma(t)?t.a.statusText:""}catch(h){ma(t.b,"Can not get status: "+h.message),c=""}t.h=c+" ["+Fa(t)+"]",Da(t)}}finally{Oa(t)}}}function Oa(t,e){if(t.a){La(t);var n=t.a,r=t.C[0]?f:null;t.a=null,t.C=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(Vd){(t=t.b)&&t.log(ca,"Problem encountered resetting onreadystatechange: "+Vd.message,void 0)}}}function La(t){t.a&&t.u&&(t.a.ontimeout=null),t.s&&(u.clearTimeout(t.s),t.s=null)}function Ma(t){return t.a?t.a.readyState:0}function Fa(t){try{return 2<Ma(t)?t.a.status:-1}catch(e){return-1}}function Ua(t,e){return e+" ["+t.P+" "+t.l+" "+Fa(t)+"]"}function ja(t){var e=Xa;this.g=[],this.u=e,this.s=t||null,this.f=this.a=!1,this.c=void 0,this.v=this.C=this.i=!1,this.h=0,this.b=null,this.l=0}function qa(t,e,n){t.a=!0,t.c=n,t.f=!e,Wa(t)}function Va(t){if(t.a){if(!t.v)throw new Ha(t);t.v=!1}}function Ba(t,e,n,r){t.g.push([e,n,r]),t.a&&Wa(t)}function Ka(t){return Y(t.g,(function(t){return g(t[1])}))}function Wa(t){if(t.h&&t.a&&Ka(t)){var e=t.h,n=Qa[e];n&&(u.clearTimeout(n.a),delete Qa[e]),t.h=0}t.b&&(t.b.l--,delete t.b),e=t.c;for(var r=n=!1;t.g.length&&!t.i;){var i=t.g.shift(),o=i[0],a=i[1];if(i=i[2],o=t.f?a:o)try{var s=o.call(i||t.s,e);void 0!==s&&(t.f=t.f&&(s==e||s instanceof Error),t.c=e=s),(L(e)||"function"===typeof u.Promise&&e instanceof u.Promise)&&(r=!0,t.i=!0)}catch(c){e=c,t.f=!0,Ka(t)||(n=!0)}}t.c=e,r&&(s=T(t.m,t,!0),r=T(t.m,t,!1),e instanceof ja?(Ba(e,s,r),e.C=!0):e.then(s,r)),n&&(e=new za(e),Qa[e.a]=e,t.h=e.a)}function Ha(){M.call(this)}function Ga(){M.call(this)}function za(t){this.a=u.setTimeout(T(this.c,this),0),this.b=t}(t=Sa.prototype).Ma=function(){"undefined"!=typeof s&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",ma(this.b,Ua(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},t.abort=function(){this.a&&this.c&&(ma(this.b,Ua(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Oa(this))},t.Da=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),Oa(this,!0)),Sa.bb.Da.call(this)},t.Wb=function(){this.ya||(this.N||this.i||this.f?xa(this):this.Jc())},t.Jc=function(){xa(this)},t.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case Ca:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var t=this.b;return t&&t.log(ca,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(e){return ma(this.b,"Can not get response: "+e.message),null}},ja.prototype.cancel=function(t){if(this.a)this.c instanceof ja&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):(e.l--,0>=e.l&&e.cancel())}this.u?this.u.call(this.s,this):this.v=!0,this.a||(t=new Ga(this),Va(this),qa(this,!1,t))}},ja.prototype.m=function(t,e){this.i=!1,qa(this,t,e)},ja.prototype.then=function(t,e,n){var r,i,o=new Te((function(t,e){r=t,i=e}));return Ba(this,r,(function(t){t instanceof Ga?o.cancel():i(t)})),o.then(t,e,n)},ja.prototype.$goog_Thenable=!0,C(Ha,M),Ha.prototype.message="Deferred has already fired",Ha.prototype.name="AlreadyCalledError",C(Ga,M),Ga.prototype.message="Deferred was canceled",Ga.prototype.name="CanceledError",za.prototype.c=function(){throw delete Qa[this.a],this.b};var Qa={};function Ya(t){var e={},n=e.document||document,r=At(t).toString(),i=ye(document,"SCRIPT"),o={Xb:i,Ma:void 0},a=new ja(o),s=null,c=null!=e.timeout?e.timeout:5e3;return 0<c&&(s=window.setTimeout((function(){$a(i,!0);var t=new ts(Za,"Timeout reached for loading script "+r);Va(a),qa(a,!1,t)}),c),o.Ma=s),i.onload=i.onreadystatechange=function(){i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||($a(i,e.xd||!1,s),Va(a),qa(a,!0,null))},i.onerror=function(){$a(i,!0,s);var t=new ts(Ja,"Error while loading script "+r);Va(a),qa(a,!1,t)},_t(o=e.attributes||{},{type:"text/javascript",charset:"UTF-8"}),fe(i,o),function(t,e){bt(t,"HTMLScriptElement"),t.src=At(e),(e=t.ownerDocument&&t.ownerDocument.defaultView)&&e!=u?e=l(e.document):(null===h&&(h=l(u.document)),e=h),e&&t.setAttribute("nonce",e)}(i,t),function(t){var e;return(e=(t||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:t.documentElement}(n).appendChild(i),a}function Xa(){if(this&&this.Xb){var t=this.Xb;t&&"SCRIPT"==t.tagName&&$a(t,!0,this.Ma)}}function $a(t,e,n){null!=n&&u.clearTimeout(n),t.onload=f,t.onerror=f,t.onreadystatechange=f,e&&window.setTimeout((function(){t&&t.parentNode&&t.parentNode.removeChild(t)}),0)}var Ja=0,Za=1;function ts(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),M.call(this,n),this.code=t}function es(t){this.f=t}function ns(t,e,n){if(this.c=t,t=e||{},this.l=t.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.m=t.secureTokenTimeout||os,this.g=yt(t.secureTokenHeaders||as),this.h=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.i=t.identityPlatformEndpoint||"https://identitytoolkit.googleapis.com/v2/",this.v=t.firebaseTimeout||ss,this.a=yt(t.firebaseHeaders||us),n&&(this.a["X-Client-Version"]=n,this.g["X-Client-Version"]=n),n="Node"==Cr(),!(n=u.XMLHttpRequest||n&&r.default.INTERNAL.node&&r.default.INTERNAL.node.XMLHttpRequest)&&!Sr())throw new A("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,Sr()?this.f=new _a(self):kr()?this.f=new es(n):this.f=new ra,this.b=null}C(ts,M),C(es,Zo),es.prototype.a=function(){return new this.f},es.prototype.b=function(){return{}};var rs,is="idToken",os=new Gr(3e4,6e4),as={"Content-Type":"application/x-www-form-urlencoded"},ss=new Gr(3e4,6e4),us={"Content-Type":"application/json"};function cs(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function hs(t,e){e&&(t.l=ls("https://securetoken.googleapis.com/v1/token",e),t.h=ls("https://www.googleapis.com/identitytoolkit/v3/relyingparty/",e),t.i=ls("https://identitytoolkit.googleapis.com/v2/",e))}function ls(t,e){return t=Kn(t),e=Kn(e.url),t.f=t.a+t.f,Un(t,e.c),t.a=e.a,jn(t,e.g),t.toString()}function fs(t,e){e?(t.a["X-Client-Version"]=e,t.g["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.g["X-Client-Version"])}function ds(t,e,n,r,i,o,a){(function(){var t=xr();return!((t=Pr(t)!=Nr?null:(t=t.match(/\sChrome\/(\d+)/i))&&2==t.length?parseInt(t[1],10):null)&&30>t)&&(!Xt||!ce||9<ce)})()||Sr()?t=T(t.u,t):(rs||(rs=new Te((function(t,e){!function(t,e){if(((window.gapi||{}).client||{}).request)t();else{u[vs]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))},function(t,e){Ba(t,null,e,void 0)}(Ya(Nt(ps,{onload:vs})),(function(){e(Error("CORS_UNSUPPORTED"))}))}}(t,e)}))),t=T(t.s,t)),t(e,n,r,i,o,a)}ns.prototype.T=function(){return this.b},ns.prototype.u=function(t,e,n,r,i,o){if(Sr()&&("undefined"===typeof u.fetch||"undefined"===typeof u.Headers||"undefined"===typeof u.Request))throw new A("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var a=new Sa(this.f);if(o){a.g=Math.max(0,o);var s=setTimeout((function(){a.dispatchEvent("timeout")}),o)}Sn(a,"complete",(function(){s&&clearTimeout(s);var t=null;try{t=JSON.parse(function(t){try{return t.a?t.a.responseText:""}catch(e){return ma(t.b,"Can not get responseText: "+e.message),""}}(this))||null}catch(v){t=null}e&&e(t)})),Cn(a,"ready",(function(){s&&clearTimeout(s),Qe(this)})),Cn(a,"timeout",(function(){s&&clearTimeout(s),Qe(this),e&&e(null)})),Na(a,t,n,r,i)};var ps=new wt(St,"https://apis.google.com/js/client.js?onload=%{onload}"),vs="__fcb"+Math.floor(1e6*Math.random()).toString();function gs(t,e,n,r,i,o,a){var s=Kn(e+n);Vn(s,"key",t.c),a&&Vn(s,"cb",Date.now().toString());var u="GET"==r;if(u)for(var c in i)i.hasOwnProperty(c)&&Vn(s,c,i[c]);return new Te((function(e,n){ds(t,s.toString(),(function(t){t?t.error?n(lu(t,o||{})):e(t):n(new A("network-request-failed"))}),r,u?void 0:sr(Vr(i)),t.a,t.v.get())}))}function ys(t){if("string"!==typeof(t=t.email)||!wr.test(t))throw new A("invalid-email")}function ms(t){"email"in t&&ys(t)}function _s(t){if(!t[is]){if(t.mfaPendingCredential)throw new A("multi-factor-auth-required",null,yt(t));throw new A("internal-error")}}function bs(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new A("internal-error")}else{if(!t.sessionInfo)throw new A("missing-verification-id");if(!t.code)throw new A("missing-verification-code")}}ns.prototype.s=function(t,e,n,r,i){var o=this;rs.then((function(){window.gapi.client.setApiKey(o.c);var a=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:r,headers:i,authType:"none",callback:function(t){window.gapi.auth.setToken(a),e&&e(t)}})})).o((function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})}))},ns.prototype.Ab=function(){return cu(this,$s,{})},ns.prototype.Cb=function(t,e){return cu(this,Ys,{idToken:t,email:e})},ns.prototype.Db=function(t,e){return cu(this,Xs,{idToken:t,password:e})};var ws={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function Is(t){if(!t.phoneVerificationInfo)throw new A("internal-error");if(!t.phoneVerificationInfo.sessionInfo)throw new A("missing-verification-id");if(!t.phoneVerificationInfo.code)throw new A("missing-verification-code")}function Ts(t){if(!t.requestUri||!t.sessionId&&!t.postBody&&!t.pendingToken)throw new A("internal-error")}function Es(t,e){return e.oauthIdToken&&e.providerId&&0==e.providerId.indexOf("oidc.")&&!e.pendingToken&&(t.sessionId?e.nonce=t.sessionId:t.postBody&&(rr(t=new Zn(t.postBody),"nonce")&&(e.nonce=t.get("nonce")))),e}function Ss(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=Jo(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=Jo(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=Jo(t)):t.errorMessage&&(e=hu(t.errorMessage)),e)throw e;_s(t)}function Cs(t,e){return e.returnIdpCredential=!0,cu(t,tu,e)}function ks(t,e){return e.returnIdpCredential=!0,cu(t,nu,e)}function As(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,cu(t,eu,e)}function Ns(t){if(!t.oobCode)throw new A("invalid-action-code")}(t=ns.prototype).Eb=function(t,e){var n={idToken:t},r=[];return vt(ws,(function(t,i){var o=e[i];null===o?r.push(t):i in e&&(n[i]=o)})),r.length&&(n.deleteAttribute=r),cu(this,Ys,n)},t.wb=function(t,e){return _t(t={requestType:"PASSWORD_RESET",email:t},e),cu(this,Ws,t)},t.xb=function(t,e){return _t(t={requestType:"EMAIL_SIGNIN",email:t},e),cu(this,Vs,t)},t.vb=function(t,e){return _t(t={requestType:"VERIFY_EMAIL",idToken:t},e),cu(this,Bs,t)},t.Fb=function(t,e,n){return _t(t={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:t,newEmail:e},n),cu(this,Ks,t)},t.gb=function(t){return cu(this,ou,t)},t.ob=function(t,e){return cu(this,zs,{oobCode:t,newPassword:e})},t.Sa=function(t){return cu(this,Rs,{oobCode:t})},t.kb=function(t){return cu(this,Ps,{oobCode:t})};var Ps={endpoint:"setAccountInfo",A:Ns,Z:"email",B:!0},Rs={endpoint:"resetPassword",A:Ns,G:function(t){var e=t.requestType;if(!e||!t.email&&"EMAIL_SIGNIN"!=e&&"VERIFY_AND_CHANGE_EMAIL"!=e)throw new A("internal-error")},B:!0},Ds={endpoint:"signupNewUser",A:function(t){if(ys(t),!t.password)throw new A("weak-password")},G:_s,V:!0,B:!0},xs={endpoint:"createAuthUri",B:!0},Os={endpoint:"deleteAccount",O:["idToken"]},Ls={endpoint:"setAccountInfo",O:["idToken","deleteProvider"],A:function(t){if(!Array.isArray(t.deleteProvider))throw new A("internal-error")}},Ms={endpoint:"emailLinkSignin",O:["email","oobCode"],A:ys,G:_s,V:!0,B:!0},Fs={endpoint:"emailLinkSignin",O:["idToken","email","oobCode"],A:ys,G:_s,V:!0},Us={endpoint:"accounts/mfaEnrollment:finalize",O:["idToken","phoneVerificationInfo"],A:Is,G:_s,B:!0,Na:!0},js={endpoint:"accounts/mfaSignIn:finalize",O:["mfaPendingCredential","phoneVerificationInfo"],A:Is,G:_s,B:!0,Na:!0},qs={endpoint:"getAccountInfo"},Vs={endpoint:"getOobConfirmationCode",O:["requestType"],A:function(t){if("EMAIL_SIGNIN"!=t.requestType)throw new A("internal-error");ys(t)},Z:"email",B:!0},Bs={endpoint:"getOobConfirmationCode",O:["idToken","requestType"],A:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new A("internal-error")},Z:"email",B:!0},Ks={endpoint:"getOobConfirmationCode",O:["idToken","newEmail","requestType"],A:function(t){if("VERIFY_AND_CHANGE_EMAIL"!=t.requestType)throw new A("internal-error")},Z:"email",B:!0},Ws={endpoint:"getOobConfirmationCode",O:["requestType"],A:function(t){if("PASSWORD_RESET"!=t.requestType)throw new A("internal-error");ys(t)},Z:"email",B:!0},Hs={mb:!0,endpoint:"getProjectConfig",Vb:"GET"},Gs={mb:!0,endpoint:"getRecaptchaParam",Vb:"GET",G:function(t){if(!t.recaptchaSiteKey)throw new A("internal-error")}},zs={endpoint:"resetPassword",A:Ns,Z:"email",B:!0},Qs={endpoint:"sendVerificationCode",O:["phoneNumber","recaptchaToken"],Z:"sessionInfo",B:!0},Ys={endpoint:"setAccountInfo",O:["idToken"],A:ms,V:!0},Xs={endpoint:"setAccountInfo",O:["idToken"],A:function(t){if(ms(t),!t.password)throw new A("weak-password")},G:_s,V:!0},$s={endpoint:"signupNewUser",G:_s,V:!0,B:!0},Js={endpoint:"accounts/mfaEnrollment:start",O:["idToken","phoneEnrollmentInfo"],A:function(t){if(!t.phoneEnrollmentInfo)throw new A("internal-error");if(!t.phoneEnrollmentInfo.phoneNumber)throw new A("missing-phone-number");if(!t.phoneEnrollmentInfo.recaptchaToken)throw new A("missing-app-credential")},G:function(t){if(!t.phoneSessionInfo||!t.phoneSessionInfo.sessionInfo)throw new A("internal-error")},B:!0,Na:!0},Zs={endpoint:"accounts/mfaSignIn:start",O:["mfaPendingCredential","mfaEnrollmentId","phoneSignInInfo"],A:function(t){if(!t.phoneSignInInfo||!t.phoneSignInInfo.recaptchaToken)throw new A("missing-app-credential")},G:function(t){if(!t.phoneResponseInfo||!t.phoneResponseInfo.sessionInfo)throw new A("internal-error")},B:!0,Na:!0},tu={endpoint:"verifyAssertion",A:Ts,Za:Es,G:Ss,V:!0,B:!0},eu={endpoint:"verifyAssertion",A:Ts,Za:Es,G:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new A("user-not-found");if(t.errorMessage)throw hu(t.errorMessage);_s(t)},V:!0,B:!0},nu={endpoint:"verifyAssertion",A:function(t){if(Ts(t),!t.idToken)throw new A("internal-error")},Za:Es,G:Ss,V:!0},ru={endpoint:"verifyCustomToken",A:function(t){if(!t.token)throw new A("invalid-custom-token")},G:_s,V:!0,B:!0},iu={endpoint:"verifyPassword",A:function(t){if(ys(t),!t.password)throw new A("wrong-password")},G:_s,V:!0,B:!0},ou={endpoint:"verifyPhoneNumber",A:bs,G:_s,B:!0},au={endpoint:"verifyPhoneNumber",A:function(t){if(!t.idToken)throw new A("internal-error");bs(t)},G:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",Jo(t);_s(t)}},su={Ib:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",A:bs,G:_s,B:!0},uu={endpoint:"accounts/mfaEnrollment:withdraw",O:["idToken","mfaEnrollmentId"],G:function(t){if(!!t[is]^!!t.refreshToken)throw new A("internal-error")},B:!0,Na:!0};function cu(t,e,n){if(!function(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var r=t[e[n]];if(void 0===r||null===r||""===r)return!1}return!0}(n,e.O))return Re(new A("internal-error"));var r,i=!!e.Na,o=e.Vb||"POST";return Pe(n).then(e.A).then((function(){return e.V&&(n.returnSecureToken=!0),e.B&&t.b&&"undefined"===typeof n.tenantId&&(n.tenantId=t.b),gs(t,i?t.i:t.h,e.endpoint,o,n,e.Ib,e.mb||!1)})).then((function(t){return r=t,e.Za?e.Za(n,r):r})).then(e.G).then((function(){if(!e.Z)return r;if(!(e.Z in r))throw new A("internal-error");return r[e.Z]}))}function hu(t){return lu({error:{errors:[{message:t}],code:400,message:t}})}function lu(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new A(r[n]):null)return n;for(var i in n=t.error&&t.error.message||"",_t(r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",TENANT_ID_MISMATCH:"tenant-id-mismatch",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",EMAIL_CHANGE_NEEDS_VERIFICATION:"email-change-needs-verification",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",UNSUPPORTED_FIRST_FACTOR:"unsupported-first-factor",UNVERIFIED_EMAIL:"unverified-email"},e||{}),e=(e=n.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<e.length?e[1]:void 0,r)if(0===n.indexOf(i))return new A(r[i],e);return!e&&t&&(e=qr(t)),new A("internal-error",e)}function fu(t){this.b=t,this.a=null,this.sb=function(t){return(gu||(gu=new Te((function(t,e){function n(){Hr(),Or("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){Hr(),e(Error("Network Error"))},timeout:pu.get()})}if(Or("gapi.iframes.Iframe"))t();else if(Or("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();u[r]=function(){Or("gapi.load")?n():e(Error("Network Error"))},Pe(Ya(r=Nt(du,{onload:r}))).o((function(){e(Error("Network Error"))}))}})).o((function(t){throw gu=null,t})))).then((function(){return new Te((function(e,n){Or("gapi.iframes.getContext")().open({where:document.body,url:t.b,messageHandlersFilter:Or("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},(function(r){function i(){clearTimeout(o),e()}t.a=r,t.a.restyle({setHideOnLeave:!1});var o=setTimeout((function(){n(Error("Network Error"))}),vu.get());r.ping(i).then(i,(function(){n(Error("Network Error"))}))}))}))}))}(this)}var du=new wt(St,"https://apis.google.com/js/api.js?onload=%{onload}"),pu=new Gr(3e4,6e4),vu=new Gr(5e3,15e3),gu=null;function yu(t,e,n,r){this.l=t,this.h=e,this.i=n,this.g=r,this.f=null,this.g?t=Wn((t=Kn(this.g.url)).c,t.a,t.g,"/emulator/auth/iframe"):t=Wn("https",this.l,null,"/__/auth/iframe"),this.a=t,Vn(this.a,"apiKey",this.h),Vn(this.a,"appName",this.i),this.b=null,this.c=[]}function mu(t,e,n,r,i,o){this.u=t,this.s=e,this.c=n,this.m=r,this.v=o,this.i=this.g=this.l=null,this.a=i,this.h=this.f=null}function _u(t){try{return r.default.app(t).auth().Ga()}catch(e){return[]}}function bu(t,e,n,r,i,o){this.s=t,this.g=e,this.b=n,this.f=o,this.c=r||null,this.i=i||null,this.l=this.u=this.C=null,this.h=[],this.m=this.a=null}function wu(t){var e=pr();return function(t){return cu(t,Hs,{}).then((function(t){return t.authorizedDomains||[]}))}(t).then((function(t){t:{var n=Kn(e),r=n.c;n=n.a;for(var i=0;i<t.length;i++){var o=t[i],a=n,s=r;if(0==o.indexOf("chrome-extension://")?a=Kn(o).a==a&&"chrome-extension"==s:"http"!=s&&"https"!=s?a=!1:br.test(o)?a=a==o:(o=o.split(".").join("\\."),a=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)),a){t=!0;break t}}t=!1}if(!t)throw new Xo(pr())}))}function Iu(t){return t.m||(t.m=Ir().then((function(){if(!t.u){var e=t.c,n=t.i,r=_u(t.b),i=new yu(t.s,t.g,t.b,t.f);i.f=e,i.b=n,i.c=tt(r||[]),t.u=i.toString()}t.v=new fu(t.u),function(t){if(!t.v)throw Error("IfcHandler must be initialized!");!function(t,e){t.sb.then((function(){t.a.register("authEvent",e,Or("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}(t.v,(function(e){var n={};if(e&&e.authEvent){var r=!1;for(e=Go(e.authEvent),n=0;n<t.h.length;n++)r=t.h[n](e)||r;return(n={}).status=r?"ACK":"ERROR",Pe(n)}return n.status="ERROR",Pe(n)}))}(t)}))),t.m}function Tu(t){return t.l||(t.C=t.c?Dr(t.c,_u(t.b)):null,t.l=new ns(t.g,O(t.i),t.C),t.f&&hs(t.l,t.f)),t.l}function Eu(t,e,n,r,i,o,a,s,u,c,h,l){return(t=new mu(t,e,n,r,i,l)).l=o,t.g=a,t.i=s,t.b=yt(u||null),t.f=c,t.zb(h).toString()}function Su(t){if(this.a=t||r.default.INTERNAL.reactNative&&r.default.INTERNAL.reactNative.AsyncStorage,!this.a)throw new A("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function Cu(t){this.b=t,this.a={},this.f=T(this.c,this)}yu.prototype.toString=function(){return this.f?Vn(this.a,"v",this.f):nr(this.a.b,"v"),this.b?Vn(this.a,"eid",this.b):nr(this.a.b,"eid"),this.c.length?Vn(this.a,"fw",this.c.join(",")):nr(this.a.b,"fw"),this.a.toString()},mu.prototype.zb=function(t){return this.h=t,this},mu.prototype.toString=function(){if(this.v){var t=Kn(this.v.url);t=Wn(t.c,t.a,t.g,"/emulator/auth/handler")}else t=Wn("https",this.u,null,"/__/auth/handler");if(Vn(t,"apiKey",this.s),Vn(t,"appName",this.c),Vn(t,"authType",this.m),this.a.isOAuthProvider){var e=this.a;try{var n=r.default.app(this.c).auth().la()}catch(u){n=null}for(var i in e.pb=n,Vn(t,"providerId",this.a.providerId),e=Vr((n=this.a).Jb))e[i]=e[i].toString();i=n.Qc,e=yt(e);for(var o=0;o<i.length;o++){var a=i[o];a in e&&delete e[a]}n.qb&&n.pb&&!e[n.qb]&&(e[n.qb]=n.pb),gt(e)||Vn(t,"customParameters",qr(e))}if("function"===typeof this.a.Rb&&((n=this.a.Rb()).length&&Vn(t,"scopes",n.join(","))),this.l?Vn(t,"redirectUrl",this.l):nr(t.b,"redirectUrl"),this.g?Vn(t,"eventId",this.g):nr(t.b,"eventId"),this.i?Vn(t,"v",this.i):nr(t.b,"v"),this.b)for(var s in this.b)this.b.hasOwnProperty(s)&&!Bn(t,s)&&Vn(t,s,this.b[s]);return this.h?Vn(t,"tid",this.h):nr(t.b,"tid"),this.f?Vn(t,"eid",this.f):nr(t.b,"eid"),(s=_u(this.c)).length&&Vn(t,"fw",s.join(",")),t.toString()},(t=bu.prototype).Pb=function(t,e,n){var r=new A("popup-closed-by-user"),i=new A("web-storage-unsupported"),o=this,a=!1;return this.ma().then((function(){(function(t){var e={type:"webStorageSupport"};return Iu(t).then((function(){return function(t,e){return t.sb.then((function(){return new Te((function(n){t.a.send(e.type,e,n,Or("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}))}(t.v,e)})).then((function(t){if(t&&t.length&&"undefined"!==typeof t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()}))})(o).then((function(n){n||(t&&mr(t),e(i),a=!0)}))})).o((function(){})).then((function(){if(!a)return function(t){return new Te((function(e){return function n(){Nn(2e3).then((function(){if(t&&!t.closed)return n();e()}))}()}))}(t)})).then((function(){if(!a)return Nn(n).then((function(){e(r)}))}))},t.Yb=function(){var t=xr();return!jr(t)&&!Wr(t)},t.Ub=function(){return!1},t.Nb=function(t,e,n,r,i,o,a,s){if(!t)return Re(new A("popup-blocked"));if(a&&!jr())return this.ma().o((function(e){mr(t),i(e)})),r(),Pe();this.a||(this.a=wu(Tu(this)));var u=this;return this.a.then((function(){var e=u.ma().o((function(e){throw mr(t),i(e),e}));return r(),e})).then((function(){(Wo(n),a)||vr(Eu(u.s,u.g,u.b,e,n,null,o,u.c,void 0,u.i,s,u.f),t)})).o((function(t){throw"auth/network-request-failed"==t.code&&(u.a=null),t}))},t.Ob=function(t,e,n,r){this.a||(this.a=wu(Tu(this)));var i=this;return this.a.then((function(){Wo(e),vr(Eu(i.s,i.g,i.b,t,e,pr(),n,i.c,void 0,i.i,r,i.f))})).o((function(t){throw"auth/network-request-failed"==t.code&&(i.a=null),t}))},t.ma=function(){var t=this;return Iu(this).then((function(){return t.v.sb})).o((function(){throw t.a=null,new A("network-request-failed")}))},t.ac=function(){return!0},t.Ea=function(t){this.h.push(t)},t.Ta=function(t){J(this.h,(function(e){return e==t}))},(t=Su.prototype).get=function(t){return Pe(this.a.getItem(t)).then((function(t){return t&&Br(t)}))},t.set=function(t,e){return Pe(this.a.setItem(t,qr(e)))},t.U=function(t){return Pe(this.a.removeItem(t))},t.ca=function(){},t.ia=function(){};var ku,Au=[];function Nu(t,e,n){gt(t.a)&&t.b.addEventListener("message",t.f),"undefined"===typeof t.a[e]&&(t.a[e]=[]),t.a[e].push(n)}function Pu(t){this.a=t}function Ru(t){this.c=t,this.b=!1,this.a=[]}function Du(t,e,n,r){var i,o,a,s,u=n||{},c=null;if(t.b)return Re(Error("connection_unavailable"));var h=r?800:50,l="undefined"!==typeof MessageChannel?new MessageChannel:null;return new Te((function(n,r){l?(i=Math.floor(Math.random()*Math.pow(10,20)).toString(),l.port1.start(),a=setTimeout((function(){r(Error("unsupported_event"))}),h),o=function(t){t.data.eventId===i&&("ack"===t.data.status?(clearTimeout(a),s=setTimeout((function(){r(Error("timeout"))}),3e3)):"done"===t.data.status?(clearTimeout(s),"undefined"!==typeof t.data.response?n(t.data.response):r(Error("unknown_error"))):(clearTimeout(a),clearTimeout(s),r(Error("invalid_response"))))},c={messageChannel:l,onMessage:o},t.a.push(c),l.port1.addEventListener("message",o),t.c.postMessage({eventType:e,eventId:i,data:u},[l.port2])):r(Error("connection_unavailable"))})).then((function(e){return xu(t,c),e})).o((function(e){throw xu(t,c),e}))}function xu(t,e){if(e){var n=e.messageChannel,r=e.onMessage;n&&(n.port1.removeEventListener("message",r),n.port1.close()),J(t.a,(function(t){return t==e}))}}function Ou(){if(!Uu())throw new A("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.m=u.indexedDB,this.type="indexedDB",this.g=this.v=this.f=this.l=null,this.s=!1,this.h=null;var t=this;Sr()&&self?(this.v=function(){var t=Sr()?self:null;if(G(Au,(function(n){n.b==t&&(e=n)})),!e){var e=new Cu(t);Au.push(e)}return e}(),Nu(this.v,"keyChanged",(function(e,n){return Ku(t).then((function(e){return 0<e.length&&G(t.a,(function(t){t(e)})),{keyProcessed:X(e,n.key)}}))})),Nu(this.v,"ping",(function(){return Pe(["keyChanged"])}))):function(){var t=u.navigator;return t&&t.serviceWorker?Pe().then((function(){return t.serviceWorker.ready})).then((function(t){return t.active||null})).o((function(){return null})):Pe(null)}().then((function(e){(t.h=e)&&(t.g=new Ru(new Pu(e)),Du(t.g,"ping",null,!0).then((function(e){e[0].fulfilled&&X(e[0].value,"keyChanged")&&(t.s=!0)})).o((function(){})))}))}function Lu(t){return new Te((function(e,n){var r=t.m.open("firebaseLocalStorageDb",1);r.onerror=function(t){try{t.preventDefault()}catch(e){}n(Error(t.target.error))},r.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(e){n(e)}},r.onsuccess=function(r){(r=r.target.result).objectStoreNames.contains("firebaseLocalStorage")?e(r):function(t){return new Te((function(e,n){var r=t.m.deleteDatabase("firebaseLocalStorageDb");r.onsuccess=function(){e()},r.onerror=function(t){n(Error(t.target.error))}}))}(t).then((function(){return Lu(t)})).then((function(t){e(t)})).o((function(t){n(t)}))}}))}function Mu(t){return t.i||(t.i=Lu(t)),t.i}function Fu(t,e){var n=0;return new Te((function r(i,o){Mu(t).then(e).then(i).o((function(e){if(!(3<++n))return Mu(t).then((function(e){return e.close(),t.i=void 0,r(i,o)})).o((function(t){o(t)}));o(e)}))}))}function Uu(){try{return!!u.indexedDB}catch(pa){return!1}}function ju(t){return t.objectStore("firebaseLocalStorage")}function qu(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly")}function Vu(t){return new Te((function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(t.target.error)}}))}function Bu(t,e){return t.g&&t.h&&function(){var t=u.navigator;return t&&t.serviceWorker&&t.serviceWorker.controller||null}()===t.h?Du(t.g,"keyChanged",{key:e},t.s).then((function(){})).o((function(){})):Pe()}function Ku(t){return Mu(t).then((function(t){var e=ju(qu(t,!1));return e.getAll?Vu(e.getAll()):new Te((function(t,n){var r=[],i=e.openCursor();i.onsuccess=function(e){(e=e.target.result)?(r.push(e.value),e.continue()):t(r)},i.onerror=function(t){n(t.target.error)}}))})).then((function(e){var n={},r=[];if(0==t.b){for(r=0;r<e.length;r++)n[e[r].fbase_key]=e[r].value;r=gr(t.c,n),t.c=n}return r}))}function Wu(t){t.l&&t.l.cancel("STOP_EVENT"),t.f&&(clearTimeout(t.f),t.f=null)}function Hu(t){var e=this,n=null;this.a=[],this.type="indexedDB",this.c=t,this.b=Pe().then((function(){if(Uu()){var t=Kr(),r="__sak"+t;return ku||(ku=new Ou),(n=ku).set(r,t).then((function(){return n.get(r)})).then((function(e){if(e!==t)throw Error("indexedDB not supported!");return n.U(r)})).then((function(){return n})).o((function(){return e.c}))}return e.c})).then((function(t){return e.type=t.type,t.ca((function(t){G(e.a,(function(e){e(t)}))})),t}))}function Gu(){this.a={},this.type="inMemory"}function zu(){if(!function(){var t="Node"==Cr();if(t=Qu()||t&&r.default.INTERNAL.node&&r.default.INTERNAL.node.localStorage,!t)return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(e){return!1}}()){if("Node"==Cr())throw new A("internal-error","The LocalStorage compatibility library was not found.");throw new A("web-storage-unsupported")}this.a=Qu()||r.default.INTERNAL.node.localStorage,this.type="localStorage"}function Qu(){try{var t=u.localStorage,e=Kr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(n){return null}}function Yu(){this.type="nullStorage"}function Xu(){if(!function(){var t="Node"==Cr();if(t=$u()||t&&r.default.INTERNAL.node&&r.default.INTERNAL.node.sessionStorage,!t)return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(e){return!1}}()){if("Node"==Cr())throw new A("internal-error","The SessionStorage compatibility library was not found.");throw new A("web-storage-unsupported")}this.a=$u()||r.default.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function $u(){try{var t=u.sessionStorage,e=Kr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(n){return null}}function Ju(){var t={};t.Browser=ec,t.Node=nc,t.ReactNative=rc,t.Worker=ic,this.a=t[Cr()]}Cu.prototype.c=function(t){var e=t.data.eventType,n=t.data.eventId,r=this.a[e];if(r&&0<r.length){t.ports[0].postMessage({status:"ack",eventId:n,eventType:e,response:null});var i=[];G(r,(function(e){i.push(Pe().then((function(){return e(t.origin,t.data.data)})))})),xe(i).then((function(r){var i=[];G(r,(function(t){i.push({fulfilled:t.Qb,value:t.value,reason:t.reason?t.reason.message:void 0})})),G(i,(function(t){for(var e in t)"undefined"===typeof t[e]&&delete t[e]})),t.ports[0].postMessage({status:"done",eventId:n,eventType:e,response:i})}))}},Pu.prototype.postMessage=function(t,e){this.a.postMessage(t,e)},Ru.prototype.close=function(){for(;0<this.a.length;)xu(this,this.a[0]);this.b=!0},(t=Ou.prototype).set=function(t,e){var n=this,r=!1;return Fu(this,(function(e){return Vu((e=ju(qu(e,!0))).get(t))})).then((function(i){return Fu(n,(function(o){if(o=ju(qu(o,!0)),i)return i.value=e,Vu(o.put(i));n.b++,r=!0;var a={};return a.fbase_key=t,a.value=e,Vu(o.add(a))}))})).then((function(){return n.c[t]=e,Bu(n,t)})).oa((function(){r&&n.b--}))},t.get=function(t){return Fu(this,(function(e){return Vu(ju(qu(e,!1)).get(t))})).then((function(t){return t&&t.value}))},t.U=function(t){var e=this,n=!1;return Fu(this,(function(r){return n=!0,e.b++,Vu(ju(qu(r,!0)).delete(t))})).then((function(){return delete e.c[t],Bu(e,t)})).oa((function(){n&&e.b--}))},t.ca=function(t){0==this.a.length&&function(t){function e(){t.f=setTimeout((function(){t.l=Ku(t).then((function(e){0<e.length&&G(t.a,(function(t){t(e)}))})).then((function(){e()})).o((function(t){"STOP_EVENT"!=t.message&&e()}))}),800)}Wu(t),e()}(this),this.a.push(t)},t.ia=function(t){J(this.a,(function(e){return e==t})),0==this.a.length&&Wu(this)},(t=Hu.prototype).get=function(t){return this.b.then((function(e){return e.get(t)}))},t.set=function(t,e){return this.b.then((function(n){return n.set(t,e)}))},t.U=function(t){return this.b.then((function(e){return e.U(t)}))},t.ca=function(t){this.a.push(t)},t.ia=function(t){J(this.a,(function(e){return e==t}))},(t=Gu.prototype).get=function(t){return Pe(this.a[t])},t.set=function(t,e){return this.a[t]=e,Pe()},t.U=function(t){return delete this.a[t],Pe()},t.ca=function(){},t.ia=function(){},(t=zu.prototype).get=function(t){var e=this;return Pe().then((function(){return Br(e.a.getItem(t))}))},t.set=function(t,e){var n=this;return Pe().then((function(){var r=qr(e);null===r?n.U(t):n.a.setItem(t,r)}))},t.U=function(t){var e=this;return Pe().then((function(){e.a.removeItem(t)}))},t.ca=function(t){u.window&&fn(u.window,"storage",t)},t.ia=function(t){u.window&&vn(u.window,"storage",t)},(t=Yu.prototype).get=function(){return Pe(null)},t.set=function(){return Pe()},t.U=function(){return Pe()},t.ca=function(){},t.ia=function(){},(t=Xu.prototype).get=function(t){var e=this;return Pe().then((function(){return Br(e.a.getItem(t))}))},t.set=function(t,e){var n=this;return Pe().then((function(){var r=qr(e);null===r?n.U(t):n.a.setItem(t,r)}))},t.U=function(t){var e=this;return Pe().then((function(){e.a.removeItem(t)}))},t.ca=function(){},t.ia=function(){};var Zu,tc,ec={F:zu,cb:Xu},nc={F:zu,cb:Xu},rc={F:Su,cb:Yu},ic={F:zu,cb:Yu},oc={rd:"local",NONE:"none",td:"session"};function ac(){var t=!(Wr(xr())||!Er()),e=jr(),n=Lr();this.m=t,this.h=e,this.l=n,this.a={},Zu||(Zu=new Ju),t=Zu;try{this.g=!dr()&&Yr()||!u.indexedDB?new t.a.F:new Hu(Sr()?new Gu:new t.a.F)}catch(r){this.g=new Gu,this.h=!0}try{this.i=new t.a.cb}catch(r){this.i=new Gu}this.v=new Gu,this.f=T(this.Zb,this),this.b={}}function sc(){return tc||(tc=new ac),tc}function uc(t,e){switch(e){case"session":return t.i;case"none":return t.v;default:return t.g}}function cc(t,e){return"firebase:"+t.name+(e?":"+e:"")}function hc(t,e,n){return n=cc(e,n),"local"==e.F&&(t.b[n]=null),uc(t,e.F).U(n)}function lc(t){t.c&&(clearInterval(t.c),t.c=null)}function fc(t){this.a=t,this.b=sc()}(t=ac.prototype).get=function(t,e){return uc(this,t.F).get(cc(t,e))},t.set=function(t,e,n){var r=cc(t,n),i=this,o=uc(this,t.F);return o.set(r,e).then((function(){return o.get(r)})).then((function(e){"local"==t.F&&(i.b[r]=e)}))},t.addListener=function(t,e,n){t=cc(t,e),this.l&&(this.b[t]=u.localStorage.getItem(t)),gt(this.a)&&(uc(this,"local").ca(this.f),this.h||(dr()||!Yr())&&u.indexedDB||!this.l||function(t){lc(t),t.c=setInterval((function(){for(var e in t.a){var n=u.localStorage.getItem(e),r=t.b[e];n!=r&&(t.b[e]=n,n=new tn({type:"storage",key:e,target:window,oldValue:r,newValue:n,a:!0}),t.Zb(n))}}),1e3)}(this)),this.a[t]||(this.a[t]=[]),this.a[t].push(n)},t.removeListener=function(t,e,n){t=cc(t,e),this.a[t]&&(J(this.a[t],(function(t){return t==n})),0==this.a[t].length&&delete this.a[t]),gt(this.a)&&(uc(this,"local").ia(this.f),lc(this))},t.Zb=function(t){if(t&&t.g){var e=t.a.key;if(null==e)for(var n in this.a){var r=this.b[n];"undefined"===typeof r&&(r=null);var i=u.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.nb(n))}else if(0==e.indexOf("firebase:")&&this.a[e]){if("undefined"!==typeof t.a.a?uc(this,"local").ia(this.f):lc(this),this.m)if(n=u.localStorage.getItem(e),(r=t.a.newValue)!==n)null!==r?u.localStorage.setItem(e,r):u.localStorage.removeItem(e);else if(this.b[e]===r&&"undefined"===typeof t.a.a)return;var o=this;n=function(){"undefined"===typeof t.a.a&&o.b[e]===u.localStorage.getItem(e)||(o.b[e]=u.localStorage.getItem(e),o.nb(e))},Xt&&ce&&10==ce&&u.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(n,10):n()}}else G(t,T(this.nb,this))},t.nb=function(t){this.a[t]&&G(this.a[t],(function(t){t()}))};var dc,pc={name:"authEvent",F:"local"};function vc(){this.a=sc()}function gc(t,e){this.b=yc,this.f=u.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=e,this.l=u.Int32Array?new Int32Array(64):Array(64),void 0===dc&&(dc=u.Int32Array?new Int32Array(Ec):Ec),this.reset()}C(gc,(function(){this.b=-1}));for(var yc=64,mc=yc-1,_c=[],bc=0;bc<mc;bc++)_c[bc]=0;var wc=Z(128,_c);function Ic(t){for(var e=t.f,n=t.l,r=0,i=0;i<e.length;)n[r++]=e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3],i=4*r;for(e=16;64>e;e++){i=0|n[e-15],r=0|n[e-2];var o=(0|n[e-16])+((i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,a=(0|n[e-7])+((r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[e]=o+a|0}r=0|t.a[0],i=0|t.a[1];var s=0|t.a[2],u=0|t.a[3],c=0|t.a[4],h=0|t.a[5],l=0|t.a[6];for(o=0|t.a[7],e=0;64>e;e++){var f=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&s^i&s)|0;a=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((a=(a=c&h^~c&l)+(0|dc[e])|0)+(0|n[e])|0)|0,o=l,l=h,h=c,c=u+a|0,u=s,s=i,i=r,r=a+f|0}t.a[0]=t.a[0]+r|0,t.a[1]=t.a[1]+i|0,t.a[2]=t.a[2]+s|0,t.a[3]=t.a[3]+u|0,t.a[4]=t.a[4]+c|0,t.a[5]=t.a[5]+h|0,t.a[6]=t.a[6]+l|0,t.a[7]=t.a[7]+o|0}function Tc(t,e,n){void 0===n&&(n=e.length);var r=0,i=t.c;if("string"===typeof e)for(;r<n;)t.f[i++]=e.charCodeAt(r++),i==t.b&&(Ic(t),i=0);else{if(!p(e))throw Error("message must be string or array");for(;r<n;){var o=e[r++];if(!("number"==typeof o&&0<=o&&255>=o&&o==(0|o)))throw Error("message must be a byte array");t.f[i++]=o,i==t.b&&(Ic(t),i=0)}}t.c=i,t.g+=n}gc.prototype.reset=function(){this.g=this.c=0,this.a=u.Int32Array?new Int32Array(this.h):tt(this.h)};var Ec=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function Sc(){gc.call(this,8,Cc)}C(Sc,gc);var Cc=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function kc(t,e,n,r,i,o){this.v=t,this.i=e,this.l=n,this.m=r||null,this.u=i||null,this.s=o,this.h=e+":"+n,this.C=new vc,this.g=new fc(this.h),this.f=null,this.b=[],this.a=this.c=null}function Ac(t){return new A("invalid-cordova-configuration",t)}function Nc(t){var e=new Sc;Tc(e,t),t=[];var n=8*e.g;56>e.c?Tc(e,wc,56-e.c):Tc(e,wc,e.b-(e.c-56));for(var r=63;56<=r;r--)e.f[r]=255&n,n/=256;for(Ic(e),r=n=0;r<e.i;r++)for(var i=24;0<=i;i-=8)t[n++]=e.a[r]>>i&255;return function(t){return Q(t,(function(t){return 1<(t=t.toString(16)).length?t:"0"+t})).join("")}(t)}function Pc(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(r){}}function Rc(t){return t.f||(t.f=t.ma().then((function(){return new Te((function(e){t.Ea((function n(r){return e(r),t.Ta(n),!1})),function(t){function e(e){r=!0,i&&i.cancel(),Dc(t).then((function(r){var i=n;if(r&&e&&e.url){var o=null;-1!=(i=co(e.url)).indexOf("/__/auth/callback")&&(o=(o="object"===typeof(o=Br(Bn(o=Kn(i),"firebaseError")||null))?N(o):null)?new Ho(r.c,r.b,null,null,o,null,r.T()):new Ho(r.c,r.b,i,r.f,null,null,r.T())),i=o||n}Pc(t,i)}))}var n=new Ho("unknown",null,null,null,new A("no-auth-event")),r=!1,i=Nn(500).then((function(){return Dc(t).then((function(){r||Pc(t,n)}))})),o=u.handleOpenURL;u.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(Or("BuildInfo.packageName",u).toLowerCase()+"://")&&e({url:t}),"function"===typeof o)try{o(t)}catch(n){console.error(n)}},Yo||(Yo=new zo),function(t){var e=Yo;e.a.push(t),e.b||(e.b=function(t){for(var n=0;n<e.a.length;n++)e.a[n](t)},"function"===typeof(t=Or("universalLinks.subscribe",u))&&t(null,e.b))}(e)}(t)}))}))),t.f}function Dc(t){var e=null;return function(t){return t.b.get(pc,t.a).then((function(t){return Go(t)}))}(t.g).then((function(n){return e=n,hc((n=t.g).b,pc,n.a)})).then((function(){return e}))}function xc(t){this.a=t,this.b=sc()}(t=kc.prototype).ma=function(){return this.Ia?this.Ia:this.Ia=(Tr(void 0)?Ir().then((function(){return new Te((function(t,e){var n=u.document,r=setTimeout((function(){e(Error("Cordova framework is not ready."))}),1e3);n.addEventListener("deviceready",(function(){clearTimeout(r),t()}),!1)}))})):Re(Error("Cordova must run in an Android or iOS file scheme."))).then((function(){if("function"!==typeof Or("universalLinks.subscribe",u))throw Ac("cordova-universal-links-plugin-fix is not installed");if("undefined"===typeof Or("BuildInfo.packageName",u))throw Ac("cordova-plugin-buildinfo is not installed");if("function"!==typeof Or("cordova.plugins.browsertab.openUrl",u))throw Ac("cordova-plugin-browsertab is not installed");if("function"!==typeof Or("cordova.InAppBrowser.open",u))throw Ac("cordova-plugin-inappbrowser is not installed")}),(function(){throw new A("cordova-not-ready")}))},t.Pb=function(t,e){return e(new A("operation-not-supported-in-this-environment")),Pe()},t.Nb=function(){return Re(new A("operation-not-supported-in-this-environment"))},t.ac=function(){return!1},t.Yb=function(){return!0},t.Ub=function(){return!0},t.Ob=function(t,e,n,r){if(this.c)return Re(new A("redirect-operation-pending"));var i=this,o=u.document,a=null,s=null,c=null,h=null;return this.c=Pe().then((function(){return Wo(e),Rc(i)})).then((function(){return function(t,e,n,r,i){var o=function(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}(),a=new Ho(e,r,null,o,new A("no-auth-event"),null,i),s=Or("BuildInfo.packageName",u);if("string"!==typeof s)throw new A("invalid-cordova-configuration");var c=Or("BuildInfo.displayName",u),h={};if(xr().toLowerCase().match(/iphone|ipad|ipod/))h.ibi=s;else{if(!xr().toLowerCase().match(/android/))return Re(new A("operation-not-supported-in-this-environment"));h.apn=s}c&&(h.appDisplayName=c),o=Nc(o),h.sessionId=o;var l=Eu(t.v,t.i,t.l,e,n,null,r,t.m,h,t.u,i,t.s);return t.ma().then((function(){var e=t.h;return t.C.a.set(pc,a.w(),e)})).then((function(){var e=Or("cordova.plugins.browsertab.isAvailable",u);if("function"!==typeof e)throw new A("invalid-cordova-configuration");var n=null;e((function(e){if(e){if("function"!==typeof(n=Or("cordova.plugins.browsertab.openUrl",u)))throw new A("invalid-cordova-configuration");n(l)}else{if("function"!==typeof(n=Or("cordova.InAppBrowser.open",u)))throw new A("invalid-cordova-configuration");e=xr(),t.a=n(l,e.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}}))}))}(i,t,e,n,r)})).then((function(){return new Te((function(t,e){s=function(){var e=Or("cordova.plugins.browsertab.close",u);return t(),"function"===typeof e&&e(),i.a&&"function"===typeof i.a.close&&(i.a.close(),i.a=null),!1},i.Ea(s),c=function(){a||(a=Nn(2e3).then((function(){e(new A("redirect-cancelled-by-user"))})))},h=function(){zr()&&c()},o.addEventListener("resume",c,!1),xr().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",h,!1)})).o((function(t){return Dc(i).then((function(){throw t}))}))})).oa((function(){c&&o.removeEventListener("resume",c,!1),h&&o.removeEventListener("visibilitychange",h,!1),a&&a.cancel(),s&&i.Ta(s),i.c=null}))},t.Ea=function(t){this.b.push(t),Rc(this).o((function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new Ho("unknown",null,null,null,new A("no-auth-event")),t(e))}))},t.Ta=function(t){J(this.b,(function(e){return e==t}))};var Oc={name:"pendingRedirect",F:"session"};function Lc(t){return hc(t.b,Oc,t.a)}function Mc(t,e,n,r){this.i={},this.u=0,this.D=t,this.v=e,this.m=n,this.J=r,this.h=[],this.f=!1,this.l=T(this.s,this),this.b=new $c,this.C=new nh,this.g=new xc(Yc(this.v,this.m)),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.C,this.c.linkViaPopup=this.C,this.c.reauthViaPopup=this.C,this.a=Fc(this.D,this.v,this.m,P,this.J)}function Fc(t,e,n,i,o){var a=r.default.SDK_VERSION||null;return Tr()?new kc(t,e,n,a,i,o):new bu(t,e,n,a,i,o)}function Uc(t){t.f||(t.f=!0,t.a.Ea(t.l));var e=t.a;return t.a.ma().o((function(n){throw t.a==e&&t.reset(),n}))}function jc(t){t.a.Yb()&&Uc(t).o((function(e){var n=new Ho("unknown",null,null,null,new A("operation-not-supported-in-this-environment"));Hc(e)&&t.s(n)})),t.a.Ub()||Jc(t.b)}function qc(t,e){X(t.h,e)||t.h.push(e),t.f||function(t){return t.b.get(Oc,t.a).then((function(t){return"pending"==t}))}(t.g).then((function(e){e?Lc(t.g).then((function(){Uc(t).o((function(e){var n=new Ho("unknown",null,null,null,new A("operation-not-supported-in-this-environment"));Hc(e)&&t.s(n)}))})):jc(t)})).o((function(){jc(t)}))}function Vc(t,e){J(t.h,(function(t){return t==e}))}Mc.prototype.reset=function(){this.f=!1,this.a.Ta(this.l),this.a=Fc(this.D,this.v,this.m,null,this.J),this.i={}},Mc.prototype.s=function(t){if(!t)throw new A("invalid-auth-event");if(6e5<=Date.now()-this.u&&(this.i={},this.u=0),t&&t.getUid()&&this.i.hasOwnProperty(t.getUid()))return!1;for(var e=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.Gb(t.c,t.b)){(e=this.c[t.c])&&(e.h(t,r),t&&(t.f||t.b)&&(this.i[t.getUid()]=!0,this.u=Date.now())),e=!0;break}}return Jc(this.b),e};var Bc=new Gr(2e3,1e4),Kc=new Gr(3e4,6e4);function Wc(t,e,n,r,i,o,a){return t.a.Nb(e,n,r,(function(){t.f||(t.f=!0,t.a.Ea(t.l))}),(function(){t.reset()}),i,o,a)}function Hc(t){return!(!t||"auth/cordova-not-ready"!=t.code)}function Gc(t,e,n,r,i){var o;return function(t){return t.b.set(Oc,"pending",t.a)}(t.g).then((function(){return t.a.Ob(e,n,r,i).o((function(e){if(Hc(e))throw new A("operation-not-supported-in-this-environment");return o=e,Lc(t.g).then((function(){throw o}))})).then((function(){return t.a.ac()?new Te((function(){})):Lc(t.g).then((function(){return t.ra()})).then((function(){})).o((function(){}))}))}))}function zc(t,e,n,r,i){return t.a.Pb(r,(function(t){e.na(n,null,t,i)}),Bc.get())}Mc.prototype.ra=function(){return this.b.ra()};var Qc={};function Yc(t,e,n){return t=t+":"+e,n&&(t=t+":"+n.url),t}function Xc(t,e,n,r){var i=Yc(e,n,r);return Qc[i]||(Qc[i]=new Mc(t,e,n,r)),Qc[i]}function $c(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function Jc(t){t.g||(t.g=!0,eh(t,!1,null,null))}function Zc(t){t.g&&!t.i&&eh(t,!1,null,null)}function th(t,e){if(t.b=function(){return Pe(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function eh(t,e,n,r){e?r?function(t,e){if(t.b=function(){return Re(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}(t,r):th(t,n):th(t,{user:null}),t.f=[],t.c=[]}function nh(){}function rh(){this.jb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.jb},set:function(t){this.jb=t},enumerable:!1})}function ih(t,e){this.a=e,ti(this,"verificationId",t)}function oh(t,e,n,r){return new Vo(t).gb(e,n).then((function(t){return new ih(t,r)}))}function ah(t){var e=Yi(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new A("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");ei(this,{token:t,expirationTime:Qr(1e3*e.exp),authTime:Qr(1e3*e.auth_time),issuedAtTime:Qr(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,signInSecondFactor:e.firebase&&e.firebase.sign_in_second_factor?e.firebase.sign_in_second_factor:null,claims:e})}function sh(t,e,n){var r=e&&e[ch];if(!r)throw new A("argument-error","Internal assert: Invalid MultiFactorResolver");this.a=t,this.f=yt(e),this.g=n,this.c=new ho(null,r),this.b=[];var i=this;G(e[uh]||[],(function(t){(t=oi(t))&&i.b.push(t)})),ti(this,"auth",this.a),ti(this,"session",this.c),ti(this,"hints",this.b)}$c.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},$c.prototype.h=function(t,e){if(t){this.reset(),this.g=!0;var n=t.c,r=t.b,i=t.a&&"auth/web-storage-unsupported"==t.a.code,o=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;this.i=!(!i&&!o),"unknown"!=n||i||o?t.a?(eh(this,!0,null,t.a),Pe()):e.Fa(n,r)?function(t,e,n){n=n.Fa(e.c,e.b);var r=e.g,i=e.f,o=e.i,a=e.T(),s=!!e.c.match(/Redirect$/);n(r,i,a,o).then((function(e){eh(t,s,e,null)})).o((function(e){eh(t,s,null,e)}))}(this,t,e):Re(new A("invalid-auth-event")):(eh(this,!1,null,null),Pe())}else Re(new A("invalid-auth-event"))},$c.prototype.ra=function(){var t=this;return new Te((function(e,n){t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),function(t){var e=new A("timeout");t.a&&t.a.cancel(),t.a=Nn(Kc.get()).then((function(){t.b||(t.g=!0,eh(t,!0,null,e))}))}(t))}))},nh.prototype.h=function(t,e){if(t){var n=t.c,r=t.b;t.a?(e.na(t.c,null,t.a,t.b),Pe()):e.Fa(n,r)?function(t,e){var n=t.b,r=t.c;e.Fa(r,n)(t.g,t.f,t.T(),t.i).then((function(t){e.na(r,t,null,n)})).o((function(t){e.na(r,null,t,n)}))}(t,e):Re(new A("invalid-auth-event"))}else Re(new A("invalid-auth-event"))},ih.prototype.confirm=function(t){return t=Bo(this.verificationId,t),this.a(t)};var uh="mfaInfo",ch="mfaPendingCredential";function hh(t,e,n,r){A.call(this,"multi-factor-auth-required",r,e),this.b=new sh(t,e,n),ti(this,"resolver",this.b)}function lh(t,e,n){if(t&&y(t.serverResponse)&&"auth/multi-factor-auth-required"===t.code)try{return new hh(e,t.serverResponse,n,t.message)}catch(r){}return null}function fh(){}function dh(t){ti(this,"factorId",t.fa),this.a=t}function ph(t){if(dh.call(this,t),this.a.fa!=Vo.PROVIDER_ID)throw new A("argument-error","firebase.auth.PhoneMultiFactorAssertion requires a valid firebase.auth.PhoneAuthCredential")}function vh(t,e){for(var n in Ze.call(this,t),e)this[n]=e[n]}function gh(t,e){this.a=t,this.b=[],this.c=T(this.yc,this),fn(this.a,"userReloaded",this.c);var n=[];e&&e.multiFactor&&e.multiFactor.enrolledFactors&&G(e.multiFactor.enrolledFactors,(function(t){var e=null,r={};if(t){t.uid&&(r[ui]=t.uid),t.displayName&&(r[ai]=t.displayName),t.enrollmentTime&&(r[si]=new Date(t.enrollmentTime).toISOString()),t.phoneNumber&&(r[ci]=t.phoneNumber);try{e=new hi(r)}catch(i){}t=e}else t=null;t&&n.push(t)})),yh(this,n)}function yh(t,e){t.b=e,ti(t,"enrolledFactors",e)}function mh(t,e,n){if(this.h=t,this.i=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function _h(t,e){t.stop(),t.b=Nn(function(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}(t,e)).then((function(){return function(){var t=u.document,e=null;return zr()||!t?Pe():new Te((function(n){e=function(){zr()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)})).o((function(n){throw t.removeEventListener("visibilitychange",e,!1),n}))}()})).then((function(){return t.h()})).then((function(){_h(t,!0)})).o((function(e){t.i(e)&&_h(t,!1)}))}function bh(t){this.f=t,this.b=this.a=null,this.c=Date.now()}function wh(t,e){"undefined"===typeof e&&(t.b?e=(e=t.b).a-e.g:e=0),t.c=Date.now()+1e3*e}function Ih(t,e){t.b=Qi(e[is]||""),t.a=e.refreshToken,wh(t,"undefined"!==typeof(e=e.expiresIn)?Number(e):void 0)}function Th(t,e){return function(t,e){return new Te((function(n,r){"refresh_token"==e.grant_type&&e.refresh_token||"authorization_code"==e.grant_type&&e.code?ds(t,t.l+"?key="+encodeURIComponent(t.c),(function(t){t?t.error?r(lu(t)):t.access_token&&t.refresh_token?n(t):r(new A("internal-error")):r(new A("network-request-failed"))}),"POST",er(e).toString(),t.g,t.m.get()):r(new A("internal-error"))}))}(t.f,e).then((function(e){return t.b=Qi(e.access_token),t.a=e.refresh_token,wh(t,e.expires_in),{accessToken:t.b.toString(),refreshToken:t.a}})).o((function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e}))}function Eh(t,e){this.a=t||null,this.b=e||null,ei(this,{lastSignInTime:Qr(e||null),creationTime:Qr(t||null)})}function Sh(t,e,n,r,i,o){ei(this,{uid:t,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:e})}function Ch(t,e,n){this.N=[],this.l=t.apiKey,this.m=t.appName,this.s=t.authDomain||null;var i=r.default.SDK_VERSION?Dr(r.default.SDK_VERSION):null;this.a=new ns(this.l,O(P),i),(this.u=t.emulatorConfig||null)&&hs(this.a,this.u),this.h=new bh(this.a),Lh(this,e[is]),Ih(this.h,e),ti(this,"refreshToken",this.h.a),Uh(this,n||{}),En.call(this),this.P=!1,this.s&&Mr()&&(this.b=Xc(this.s,this.l,this.m,this.u)),this.W=[],this.i=null,this.D=function(t){return new mh((function(){return t.I(!0)}),(function(t){return!(!t||"auth/network-request-failed"!=t.code)}),(function(){var e=t.h.c-Date.now()-3e5;return 0<e?e:0}))}(this),this.ba=T(this.ib,this);var o=this;this.za=null,this.Pa=function(t){o.xa(t.h)},this.qa=null,this.Ba=function(t){kh(o,t.c)},this.$=null,this.aa=[],this.Oa=function(t){Ph(o,t.f)},this.ja=null,this.S=new gh(this,n),ti(this,"multiFactor",this.S)}function kh(t,e){t.u=e,hs(t.a,e),t.b&&(e=t.b,t.b=Xc(t.s,t.l,t.m,t.u),t.P&&(Vc(e,t),qc(t.b,t)))}function Ah(t,e){t.qa&&vn(t.qa,"languageCodeChanged",t.Pa),(t.qa=e)&&fn(e,"languageCodeChanged",t.Pa)}function Nh(t,e){t.$&&vn(t.$,"emulatorConfigChanged",t.Ba),(t.$=e)&&fn(e,"emulatorConfigChanged",t.Ba)}function Ph(t,e){t.aa=e,fs(t.a,r.default.SDK_VERSION?Dr(r.default.SDK_VERSION,t.aa):null)}function Rh(t,e){t.ja&&vn(t.ja,"frameworkChanged",t.Oa),(t.ja=e)&&fn(e,"frameworkChanged",t.Oa)}function Dh(t){try{return r.default.app(t.m).auth()}catch(e){throw new A("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.m+"'!")}}function xh(t){t.J||t.D.b||(t.D.start(),vn(t,"tokenChanged",t.ba),fn(t,"tokenChanged",t.ba))}function Oh(t){vn(t,"tokenChanged",t.ba),t.D.stop()}function Lh(t,e){t.Aa=e,ti(t,"_lat",e)}function Mh(t){for(var e=[],n=0;n<t.W.length;n++)e.push(t.W[n](t));return xe(e).then((function(){return t}))}function Fh(t){t.b&&!t.P&&(t.P=!0,qc(t.b,t))}function Uh(t,e){ei(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,tenantId:e.tenantId||null,metadata:new Eh(e.createdAt,e.lastLoginAt),providerData:[]}),t.a.b=t.tenantId}function jh(){}function qh(t){return Pe().then((function(){if(t.J)throw new A("app-deleted")}))}function Vh(t){return Q(t.providerData,(function(t){return t.providerId}))}function Bh(t,e){e&&(Kh(t,e.providerId),t.providerData.push(e))}function Kh(t,e){J(t.providerData,(function(t){return t.providerId==e}))}function Wh(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&ti(t,e,n)}function Hh(t,e){t!=e&&(ei(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,tenantId:e.tenantId,providerData:[]}),e.metadata?ti(t,"metadata",function(t){return new Eh(t.a,t.b)}(e.metadata)):ti(t,"metadata",new Eh),G(e.providerData,(function(e){Bh(t,e)})),function(t,e){t.b=e.b,t.a=e.a,t.c=e.c}(t.h,e.h),ti(t,"refreshToken",t.h.a),yh(t.S,e.S.b))}function Gh(t){return t.I().then((function(e){var n=t.isAnonymous;return function(t,e){return cu(t.a,qs,{idToken:e}).then(T(t.Kc,t))}(t,e).then((function(){return n||Wh(t,"isAnonymous",!1),e}))}))}function zh(t,e){e[is]&&t.Aa!=e[is]&&(Ih(t.h,e),t.dispatchEvent(new vh("tokenChanged")),Lh(t,e[is]),Wh(t,"refreshToken",t.h.a))}function Qh(t,e){return Gh(t).then((function(){if(X(Vh(t),e))return Mh(t).then((function(){throw new A("provider-already-linked")}))}))}function Yh(t,e,n){return ni({user:t,credential:Ko(e),additionalUserInfo:e=to(e),operationType:n})}function Xh(t,e){return zh(t,e),t.reload().then((function(){return t}))}function $h(t,e,n,i,o){if(!Mr())return Re(new A("operation-not-supported-in-this-environment"));if(t.i&&!o)return Re(t.i);var a=Zi(n.providerId),s=Kr(t.uid+":::"),u=null;(!jr()||Er())&&t.s&&n.isOAuthProvider&&(u=Eu(t.s,t.l,t.m,e,n,null,s,r.default.SDK_VERSION||null,null,null,t.tenantId,t.u));var c=_r(u,a&&a.va,a&&a.ua);return i=i().then((function(){if(Zh(t),!o)return t.I().then((function(){}))})).then((function(){return Wc(t.b,c,e,n,s,!!u,t.tenantId)})).then((function(){return new Te((function(n,r){t.na(e,null,new A("cancelled-popup-request"),t.g||null),t.f=n,t.C=r,t.g=s,t.c=zc(t.b,t,e,c,s)}))})).then((function(t){return c&&mr(c),t?ni(t):null})).o((function(t){throw c&&mr(c),t})),tl(t,i,o)}function Jh(t,e,n,r,i){if(!Mr())return Re(new A("operation-not-supported-in-this-environment"));if(t.i&&!i)return Re(t.i);var o=null,a=Kr(t.uid+":::");return r=r().then((function(){if(Zh(t),!i)return t.I().then((function(){}))})).then((function(){return t.ga=a,Mh(t)})).then((function(e){return t.ha&&(e=(e=t.ha).b.set(rl,t.w(),e.a)),e})).then((function(){return Gc(t.b,e,n,a,t.tenantId)})).o((function(e){if(o=e,t.ha)return il(t.ha);throw o})).then((function(){if(o)throw o})),tl(t,r,i)}function Zh(t){if(!t.b||!t.P){if(t.b&&!t.P)throw new A("internal-error");throw new A("auth-domain-config-required")}}function tl(t,e,n){var r=function(t,e,n){return t.i&&!n?(e.cancel(),Re(t.i)):e.o((function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(t.i||t.dispatchEvent(new vh("userInvalidated")),t.i=e),e}))}(t,e,n);return t.N.push(r),r.oa((function(){$(t.N,r)})),r.o((function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=lh(e.w(),Dh(t),T(t.jc,t))),n||e}))}function el(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName,emulatorConfig:t.emulatorConfig},n={};if(!t.stsTokenManager||!t.stsTokenManager.accessToken)return null;n[is]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null;var r=t.stsTokenManager.expirationTime;r&&(n.expiresIn=(r-Date.now())/1e3);var i=new Ch(e,n,t);return t.providerData&&G(t.providerData,(function(t){t&&Bh(i,ni(t))})),t.redirectEventId&&(i.ga=t.redirectEventId),i}function nl(t){this.a=t,this.b=sc()}sh.prototype.Rc=function(t){var e=this;return t.tb(this.a.a,this.c).then((function(t){var n=yt(e.f);return delete n[uh],delete n[ch],_t(n,t),e.g(n)}))},C(hh,A),fh.prototype.tb=function(t,e,n){return e.type==lo?function(t,e,n,r){return n.Ha().then((function(n){return n={idToken:n},"undefined"!==typeof r&&(n.displayName=r),_t(n,{phoneVerificationInfo:qo(t.a)}),cu(e,Us,n)}))}(this,t,e,n):function(t,e,n){return n.Ha().then((function(n){return _t(n={mfaPendingCredential:n},{phoneVerificationInfo:qo(t.a)}),cu(e,js,n)}))}(this,t,e)},C(dh,fh),C(ph,dh),C(vh,Ze),(t=gh.prototype).yc=function(t){yh(this,function(t){var e=[];return G(t.mfaInfo||[],(function(t){(t=oi(t))&&e.push(t)})),e}(t.hd))},t.Sb=function(){return this.a.I().then((function(t){return new ho(t,null)}))},t.fc=function(t,e){var n=this,r=this.a.a;return this.Sb().then((function(n){return t.tb(r,n,e)})).then((function(t){return zh(n.a,t),n.a.reload()}))},t.bd=function(t){var e=this,n="string"===typeof t?t:t.uid,r=this.a.a;return this.a.I().then((function(t){return cu(r,uu,{idToken:t,mfaEnrollmentId:n})})).then((function(t){var r=z(e.b,(function(t){return t.uid!=n}));return yh(e,r),zh(e.a,t),e.a.reload().o((function(t){if("auth/user-token-expired"!=t.code)throw t}))}))},t.w=function(){return{multiFactor:{enrolledFactors:Q(this.b,(function(t){return t.w()}))}}},mh.prototype.start=function(){this.a=this.c,_h(this,!0)},mh.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},bh.prototype.w=function(){return{apiKey:this.f.c,refreshToken:this.a,accessToken:this.b&&this.b.toString(),expirationTime:this.c}},bh.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?Re(new A("user-token-expired")):t||!this.b||Date.now()>this.c-3e4?this.a?Th(this,{grant_type:"refresh_token",refresh_token:this.a}):Pe(null):Pe({accessToken:this.b.toString(),refreshToken:this.a})},Eh.prototype.w=function(){return{lastLoginAt:this.b,createdAt:this.a}},C(Ch,En),Ch.prototype.xa=function(t){this.za=t,cs(this.a,t)},Ch.prototype.la=function(){return this.za},Ch.prototype.Ga=function(){return tt(this.aa)},Ch.prototype.ib=function(){this.D.b&&(this.D.stop(),this.D.start())},ti(Ch.prototype,"providerId","firebase"),(t=Ch.prototype).reload=function(){var t=this;return tl(this,qh(this).then((function(){return Gh(t).then((function(){return Mh(t)})).then(jh)})))},t.oc=function(t){return this.I(t).then((function(t){return new ah(t)}))},t.I=function(t){var e=this;return tl(this,qh(this).then((function(){return e.h.getToken(t)})).then((function(t){if(!t)throw new A("internal-error");return t.accessToken!=e.Aa&&(Lh(e,t.accessToken),e.dispatchEvent(new vh("tokenChanged"))),Wh(e,"refreshToken",t.refreshToken),t.accessToken})))},t.Kc=function(t){if(!(t=t.users)||!t.length)throw new A("internal-error");Uh(this,{uid:(t=t[0]).localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt,tenantId:t.tenantId});for(var e=function(t){return(t=t.providerUserInfo)&&t.length?Q(t,(function(t){return new Sh(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)})):[]}(t),n=0;n<e.length;n++)Bh(this,e[n]);Wh(this,"isAnonymous",!(this.email&&t.passwordHash)&&!(this.providerData&&this.providerData.length)),this.dispatchEvent(new vh("userReloaded",{hd:t}))},t.Lc=function(t){return Jr("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.ub(t)},t.ub=function(t){var e=this,n=null;return tl(this,t.c(this.a,this.uid).then((function(t){return zh(e,t),n=Yh(e,t,"reauthenticate"),e.i=null,e.reload()})).then((function(){return n})),!0)},t.Cc=function(t){return Jr("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.rb(t)},t.rb=function(t){var e=this,n=null;return tl(this,Qh(this,t.providerId).then((function(){return e.I()})).then((function(n){return t.b(e.a,n)})).then((function(t){return n=Yh(e,t,"link"),Xh(e,t)})).then((function(){return n})))},t.Dc=function(t,e){var n=this;return tl(this,Qh(this,"phone").then((function(){return oh(Dh(n),t,e,T(n.rb,n))})))},t.Mc=function(t,e){var n=this;return tl(this,Pe().then((function(){return oh(Dh(n),t,e,T(n.ub,n))})),!0)},t.Cb=function(t){var e=this;return tl(this,this.I().then((function(n){return e.a.Cb(n,t)})).then((function(t){return zh(e,t),e.reload()})))},t.ed=function(t){var e=this;return tl(this,this.I().then((function(n){return t.b(e.a,n)})).then((function(t){return zh(e,t),e.reload()})))},t.Db=function(t){var e=this;return tl(this,this.I().then((function(n){return e.a.Db(n,t)})).then((function(t){return zh(e,t),e.reload()})))},t.Eb=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return qh(this);var e=this;return tl(this,this.I().then((function(n){return e.a.Eb(n,{displayName:t.displayName,photoUrl:t.photoURL})})).then((function(t){return zh(e,t),Wh(e,"displayName",t.displayName||null),Wh(e,"photoURL",t.photoUrl||null),G(e.providerData,(function(t){"password"===t.providerId&&(ti(t,"displayName",e.displayName),ti(t,"photoURL",e.photoURL))})),Mh(e)})).then(jh))},t.cd=function(t){var e=this;return tl(this,Gh(this).then((function(n){return X(Vh(e),t)?function(t,e,n){return cu(t,Ls,{idToken:e,deleteProvider:n})}(e.a,n,[t]).then((function(t){var n={};return G(t.providerUserInfo||[],(function(t){n[t.providerId]=!0})),G(Vh(e),(function(t){n[t]||Kh(e,t)})),n[Vo.PROVIDER_ID]||ti(e,"phoneNumber",null),Mh(e)})):Mh(e).then((function(){throw new A("no-such-provider")}))})))},t.delete=function(){var t=this;return tl(this,this.I().then((function(e){return cu(t.a,Os,{idToken:e})})).then((function(){t.dispatchEvent(new vh("userDeleted"))}))).then((function(){for(var e=0;e<t.N.length;e++)t.N[e].cancel("app-deleted");Ah(t,null),Nh(t,null),Rh(t,null),t.N=[],t.J=!0,Oh(t),ti(t,"refreshToken",null),t.b&&Vc(t.b,t)}))},t.Gb=function(t,e){return!!("linkViaPopup"==t&&(this.g||null)==e&&this.f||"reauthViaPopup"==t&&(this.g||null)==e&&this.f||"linkViaRedirect"==t&&(this.ga||null)==e||"reauthViaRedirect"==t&&(this.ga||null)==e)},t.na=function(t,e,n,r){"linkViaPopup"!=t&&"reauthViaPopup"!=t||r!=(this.g||null)||(n&&this.C?this.C(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},t.Fa=function(t,e){return"linkViaPopup"==t&&e==(this.g||null)?T(this.Lb,this):"reauthViaPopup"==t&&e==(this.g||null)?T(this.Mb,this):"linkViaRedirect"==t&&(this.ga||null)==e?T(this.Lb,this):"reauthViaRedirect"==t&&(this.ga||null)==e?T(this.Mb,this):null},t.Ec=function(t){var e=this;return $h(this,"linkViaPopup",t,(function(){return Qh(e,t.providerId).then((function(){return Mh(e)}))}),!1)},t.Nc=function(t){return $h(this,"reauthViaPopup",t,(function(){return Pe()}),!0)},t.Fc=function(t){var e=this;return Jh(this,"linkViaRedirect",t,(function(){return Qh(e,t.providerId)}),!1)},t.Oc=function(t){return Jh(this,"reauthViaRedirect",t,(function(){return Pe()}),!0)},t.Lb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return tl(this,this.I().then((function(n){return ks(i.a,{requestUri:t,postBody:r,sessionId:e,idToken:n})})).then((function(t){return o=Yh(i,t,"link"),Xh(i,t)})).then((function(){return o})))},t.Mb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return tl(this,Pe().then((function(){return vo(As(i.a,{requestUri:t,sessionId:e,postBody:r,tenantId:n}),i.uid)})).then((function(t){return o=Yh(i,t,"reauthenticate"),zh(i,t),i.i=null,i.reload()})).then((function(){return o})),!0)},t.vb=function(t){var e=this,n=null;return tl(this,this.I().then((function(e){return n=e,"undefined"===typeof t||gt(t)?{}:Wi(new Oi(t))})).then((function(t){return e.a.vb(n,t)})).then((function(t){if(e.email!=t)return e.reload()})).then((function(){})))},t.Fb=function(t,e){var n=this,r=null;return tl(this,this.I().then((function(t){return r=t,"undefined"===typeof e||gt(e)?{}:Wi(new Oi(e))})).then((function(e){return n.a.Fb(r,t,e)})).then((function(t){if(n.email!=t)return n.reload()})).then((function(){})))},t.jc=function(t){var e=null,n=this;return tl(this,t=vo(Pe(t),n.uid).then((function(t){return e=Yh(n,t,"reauthenticate"),zh(n,t),n.i=null,n.reload()})).then((function(){return e})),!0)},t.toJSON=function(){return this.w()},t.w=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.s,stsTokenManager:this.h.w(),redirectEventId:this.ga||null};return this.metadata&&_t(t,this.metadata.w()),G(this.providerData,(function(e){t.providerData.push(function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}(e))})),_t(t,this.S.w()),t};var rl={name:"redirectUser",F:"session"};function il(t){return hc(t.b,rl,t.a)}function ol(t){this.a=t,this.b=sc(),this.c=null,this.f=function(t){var e=ul("local"),n=ul("session"),r=ul("none");return function(t,e,n){var r=cc(e,n),i=uc(t,e.F);return t.get(e,n).then((function(o){var a=null;try{a=Br(u.localStorage.getItem(r))}catch(s){}if(a&&!o)return u.localStorage.removeItem(r),t.set(e,a,n);a&&o&&"localStorage"!=i.type&&u.localStorage.removeItem(r)}))}(t.b,e,t.a).then((function(){return t.b.get(n,t.a)})).then((function(i){return i?n:t.b.get(r,t.a).then((function(n){return n?r:t.b.get(e,t.a).then((function(n){return n?e:t.b.get(sl,t.a).then((function(t){return t?ul(t):e}))}))}))})).then((function(e){return t.c=e,al(t,e.F)})).o((function(){t.c||(t.c=e)}))}(this),this.b.addListener(ul("local"),this.a,T(this.g,this))}function al(t,e){var n,r=[];for(n in oc)oc[n]!==e&&r.push(hc(t.b,ul(oc[n]),t.a));return r.push(hc(t.b,sl,t.a)),function(t){return new Te((function(e,n){var r=t.length,i=[];if(r)for(var o=function(t,n){r--,i[t]=n,0==r&&e(i)},a=function(t){n(t)},s=0;s<t.length;s++)De(t[s],E(o,s),a);else e(i)}))}(r)}ol.prototype.g=function(){var t=this,e=ul("local");fl(this,(function(){return Pe().then((function(){return t.c&&"local"!=t.c.F?t.b.get(e,t.a):null})).then((function(n){if(n)return al(t,"local").then((function(){t.c=e}))}))}))};var sl={name:"persistence",F:"session"};function ul(t){return{name:"authUser",F:t}}function cl(t,e){return fl(t,(function(){return t.b.set(t.c,e.w(),t.a)}))}function hl(t){return fl(t,(function(){return hc(t.b,t.c,t.a)}))}function ll(t,e,n){return fl(t,(function(){return t.b.get(t.c,t.a).then((function(t){return t&&e&&(t.authDomain=e),t&&n&&(t.emulatorConfig=n),el(t||{})}))}))}function fl(t,e){return t.f=t.f.then(e,e),t.f}function dl(t){if(this.l=!1,ti(this,"settings",new rh),ti(this,"app",t),!Il(this).options||!Il(this).options.apiKey)throw new A("invalid-api-key");t=r.default.SDK_VERSION?Dr(r.default.SDK_VERSION):null,this.a=new ns(Il(this).options&&Il(this).options.apiKey,O(P),t),this.P=[],this.s=[],this.N=[],this.Pa=r.default.INTERNAL.createSubscribe(T(this.zc,this)),this.W=void 0,this.ib=r.default.INTERNAL.createSubscribe(T(this.Ac,this)),bl(this,null),this.i=new ol(Il(this).options.apiKey+":"+Il(this).name),this.D=new nl(Il(this).options.apiKey+":"+Il(this).name),this.$=Cl(this,function(t){var e=Il(t).options.authDomain,n=function(t){var e=function(t,e){return t.b.get(rl,t.a).then((function(t){return t&&e&&(t.authDomain=e),el(t||{})}))}(t.D,Il(t).options.authDomain).then((function(e){return(t.m=e)&&(e.ha=t.D),il(t.D)}));return Cl(t,e)}(t).then((function(){return ll(t.i,e,t.R)})).then((function(e){return e?(e.ha=t.D,t.m&&(t.m.ga||null)==(e.ga||null)?e:e.reload().then((function(){return cl(t.i,e).then((function(){return e}))})).o((function(n){return"auth/network-request-failed"==n.code?e:hl(t.i)}))):null})).then((function(e){bl(t,e||null)}));return Cl(t,n)}(this)),this.h=Cl(this,function(t){return t.$.then((function(){return ml(t)})).o((function(){})).then((function(){if(!t.l)return t.ja()})).o((function(){})).then((function(){if(!t.l){t.ba=!0;var e=t.i;e.b.addListener(ul("local"),e.a,t.ja)}}))}(this)),this.ba=!1,this.ja=T(this.Zc,this),this.Ba=T(this.da,this),this.qa=T(this.mc,this),this.za=T(this.wc,this),this.Aa=T(this.xc,this),this.b=null,function(t){var e=Il(t).options.authDomain,n=Il(t).options.apiKey;e&&Mr()&&(t.Oa=t.$.then((function(){if(!t.l){if(t.b=Xc(e,n,Il(t).name,t.R),qc(t.b,t),Tl(t)&&Fh(Tl(t)),t.m){Fh(t.m);var r=t.m;r.xa(t.la()),Ah(r,t),Ph(r=t.m,t.J),Rh(r,t),kh(r=t.m,t.R),Nh(r,t),t.m=null}return t.b}})))}(this),this.INTERNAL={},this.INTERNAL.delete=T(this.delete,this),this.INTERNAL.logFramework=T(this.Gc,this),this.u=0,En.call(this),function(t){Object.defineProperty(t,"lc",{get:function(){return this.la()},set:function(t){this.xa(t)},enumerable:!1}),t.aa=null,Object.defineProperty(t,"ti",{get:function(){return this.T()},set:function(t){this.zb(t)},enumerable:!1}),t.S=null,Object.defineProperty(t,"emulatorConfig",{get:function(){if(this.R){var t=Kn(this.R.url);t=ni({protocol:t.c,host:t.a,port:t.g,options:ni({disableWarnings:this.R.ec})})}else t=null;return t},enumerable:!1})}(this),this.J=[],this.R=null}function pl(t){Ze.call(this,"languageCodeChanged"),this.h=t}function vl(t){Ze.call(this,"emulatorConfigChanged"),this.c=t}function gl(t){Ze.call(this,"frameworkChanged"),this.f=t}function yl(t){return t.Oa||Re(new A("auth-domain-config-required"))}function ml(t){if(!Mr())return Re(new A("operation-not-supported-in-this-environment"));var e=yl(t).then((function(){return t.b.ra()})).then((function(t){return t?ni(t):null}));return Cl(t,e)}function _l(t,e){var n={};return n.apiKey=Il(t).options.apiKey,n.authDomain=Il(t).options.authDomain,n.appName=Il(t).name,t.R&&(n.emulatorConfig=t.R),t.$.then((function(){return function(t,e,n,r){var i=new Ch(t,e);return n&&(i.ha=n),r&&Ph(i,r),i.reload().then((function(){return i}))}(n,e,t.D,t.Ga())})).then((function(e){return Tl(t)&&e.uid==Tl(t).uid?(Hh(Tl(t),e),t.da(e)):(bl(t,e),Fh(e),t.da(e))})).then((function(){Sl(t)}))}function bl(t,e){Tl(t)&&(function(t,e){J(t.W,(function(t){return t==e}))}(Tl(t),t.Ba),vn(Tl(t),"tokenChanged",t.qa),vn(Tl(t),"userDeleted",t.za),vn(Tl(t),"userInvalidated",t.Aa),Oh(Tl(t))),e&&(e.W.push(t.Ba),fn(e,"tokenChanged",t.qa),fn(e,"userDeleted",t.za),fn(e,"userInvalidated",t.Aa),0<t.u&&xh(e)),ti(t,"currentUser",e),e&&(e.xa(t.la()),Ah(e,t),Ph(e,t.J),Rh(e,t),kh(e,t.R),Nh(e,t))}function wl(t,e){var n=null,r=null;return Cl(t,e.then((function(e){return n=Ko(e),r=to(e),_l(t,e)}),(function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=lh(e.w(),t,T(t.kc,t))),n||e})).then((function(){return ni({user:Tl(t),credential:n,additionalUserInfo:r,operationType:"signIn"})})))}function Il(t){return t.app}function Tl(t){return t.currentUser}function El(t){return Tl(t)&&Tl(t)._lat||null}function Sl(t){if(t.ba){for(var e=0;e<t.s.length;e++)t.s[e]&&t.s[e](El(t));if(t.W!==t.getUid()&&t.N.length)for(t.W=t.getUid(),e=0;e<t.N.length;e++)t.N[e]&&t.N[e](El(t))}}function Cl(t,e){return t.P.push(e),e.oa((function(){$(t.P,e)})),e}function kl(){}function Al(){this.a={},this.b=1e12}ol.prototype.yb=function(t){var e=null,n=this;return function(t){var e=new A("invalid-persistence-type"),n=new A("unsupported-persistence-type");t:{for(r in oc)if(oc[r]==t){var r=!0;break t}r=!1}if(!r||"string"!==typeof t)throw e;switch(Cr()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;case"Worker":if("session"===t||!Uu()&&"none"!==t)throw n;break;default:if(!Lr()&&"none"!==t)throw n}}(t),fl(this,(function(){return t!=n.c.F?n.b.get(n.c,n.a).then((function(r){return e=r,al(n,t)})).then((function(){if(n.c=ul(t),e)return n.b.set(n.c,e,n.a)})):Pe()}))},C(dl,En),C(pl,Ze),C(vl,Ze),C(gl,Ze),(t=dl.prototype).yb=function(t){return Cl(this,t=this.i.yb(t))},t.xa=function(t){this.aa===t||this.l||(this.aa=t,cs(this.a,this.aa),this.dispatchEvent(new pl(this.la())))},t.la=function(){return this.aa},t.fd=function(){var t=u.navigator;this.xa(t&&(t.languages&&t.languages[0]||t.language||t.userLanguage)||null)},t.gd=function(t,e){if(!this.R){if(!/^https?:\/\//.test(t))throw new A("argument-error","Emulator URL must start with a valid scheme (http:// or https://).");(function(t){"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),u.document&&!t&&Ir().then((function(){var t=u.document.createElement("div");t.innerText="Running in emulator mode. Do not use with production credentials.",t.style.position="fixed",t.style.width="100%",t.style.backgroundColor="#ffffff",t.style.border=".1em solid #000000",t.style.color="#b50000",t.style.bottom="0px",t.style.left="0px",t.style.margin="0px",t.style.zIndex=1e4,t.style.textAlign="center",t.classList.add("firebase-emulator-warning"),u.document.body.appendChild(t)}))})(e=!!e&&!!e.disableWarnings),this.R={url:t,ec:e},this.settings.jb=!0,hs(this.a,this.R),this.dispatchEvent(new vl(this.R))}},t.Gc=function(t){this.J.push(t),fs(this.a,r.default.SDK_VERSION?Dr(r.default.SDK_VERSION,this.J):null),this.dispatchEvent(new gl(this.J))},t.Ga=function(){return tt(this.J)},t.zb=function(t){this.S===t||this.l||(this.S=t,this.a.b=this.S)},t.T=function(){return this.S},t.toJSON=function(){return{apiKey:Il(this).options.apiKey,authDomain:Il(this).options.authDomain,appName:Il(this).name,currentUser:Tl(this)&&Tl(this).w()}},t.Gb=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==e&&!!this.f;default:return!1}},t.na=function(t,e,n,r){"signInViaPopup"==t&&this.g==r&&(n&&this.C?this.C(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},t.Fa=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.g==e&&this.f?T(this.ic,this):null},t.ic=function(t,e,n,r){var i=this,o={requestUri:t,postBody:r,sessionId:e,tenantId:n};return this.c&&(this.c.cancel(),this.c=null),i.$.then((function(){return wl(i,Cs(i.a,o))}))},t.Xc=function(t){if(!Mr())return Re(new A("operation-not-supported-in-this-environment"));var e=this,n=Zi(t.providerId),i=Kr(),o=null;(!jr()||Er())&&Il(this).options.authDomain&&t.isOAuthProvider&&(o=Eu(Il(this).options.authDomain,Il(this).options.apiKey,Il(this).name,"signInViaPopup",t,null,i,r.default.SDK_VERSION||null,null,null,this.T(),this.R));var a=_r(o,n&&n.va,n&&n.ua);return Cl(this,n=yl(this).then((function(n){return Wc(n,a,"signInViaPopup",t,i,!!o,e.T())})).then((function(){return new Te((function(t,n){e.na("signInViaPopup",null,new A("cancelled-popup-request"),e.g),e.f=t,e.C=n,e.g=i,e.c=zc(e.b,e,"signInViaPopup",a,i)}))})).then((function(t){return a&&mr(a),t?ni(t):null})).o((function(t){throw a&&mr(a),t})))},t.Yc=function(t){if(!Mr())return Re(new A("operation-not-supported-in-this-environment"));var e=this,n=yl(this).then((function(){return function(t){return fl(t,(function(){return t.b.set(sl,t.c.F,t.a)}))}(e.i)})).then((function(){return Gc(e.b,"signInViaRedirect",t,void 0,e.T())}));return Cl(this,n)},t.ra=function(){var t=this;return ml(this).then((function(e){return t.b&&Zc(t.b.b),e})).o((function(e){throw t.b&&Zc(t.b.b),e}))},t.dd=function(t){if(!t)return Re(new A("null-user"));if(this.S!=t.tenantId)return Re(new A("tenant-id-mismatch"));var e=this,n={};n.apiKey=Il(this).options.apiKey,n.authDomain=Il(this).options.authDomain,n.appName=Il(this).name;var r=function(t,e,n,r){var i=t.h,o={};return o[is]=i.b&&i.b.toString(),o.refreshToken=i.a,e=new Ch(e||{apiKey:t.l,authDomain:t.s,appName:t.m},o),n&&(e.ha=n),r&&Ph(e,r),Hh(e,t),e}(t,n,e.D,e.Ga());return Cl(this,this.h.then((function(){if(Il(e).options.apiKey!=t.l)return r.reload()})).then((function(){return Tl(e)&&t.uid==Tl(e).uid?(Hh(Tl(e),t),e.da(t)):(bl(e,r),Fh(r),e.da(r))})).then((function(){Sl(e)})))},t.Bb=function(){var t=this;return Cl(this,this.h.then((function(){return t.b&&Zc(t.b.b),Tl(t)?(bl(t,null),hl(t.i).then((function(){Sl(t)}))):Pe()})))},t.Zc=function(){var t=this;return ll(this.i,Il(this).options.authDomain).then((function(e){if(!t.l){var n;if(n=Tl(t)&&e){n=Tl(t).uid;var r=e.uid;n=void 0!==n&&null!==n&&""!==n&&void 0!==r&&null!==r&&""!==r&&n==r}if(n)return Hh(Tl(t),e),Tl(t).I();(Tl(t)||e)&&(bl(t,e),e&&(Fh(e),e.ha=t.D),t.b&&qc(t.b,t),Sl(t))}}))},t.da=function(t){return cl(this.i,t)},t.mc=function(){Sl(this),this.da(Tl(this))},t.wc=function(){this.Bb()},t.xc=function(){this.Bb()},t.kc=function(t){var e=this;return this.h.then((function(){return wl(e,Pe(t))}))},t.zc=function(t){var e=this;this.addAuthTokenListener((function(){t.next(Tl(e))}))},t.Ac=function(t){var e=this;!function(t,e){t.N.push(e),Cl(t,t.h.then((function(){!t.l&&X(t.N,e)&&t.W!==t.getUid()&&(t.W=t.getUid(),e(El(t)))})))}(this,(function(){t.next(Tl(e))}))},t.Ic=function(t,e,n){var r=this;return this.ba&&Promise.resolve().then((function(){"function"===typeof t?t(Tl(r)):"function"===typeof t.next&&t.next(Tl(r))})),this.Pa(t,e,n)},t.Hc=function(t,e,n){var r=this;return this.ba&&Promise.resolve().then((function(){r.W=r.getUid(),"function"===typeof t?t(Tl(r)):"function"===typeof t.next&&t.next(Tl(r))})),this.ib(t,e,n)},t.nc=function(t){var e=this;return Cl(this,this.h.then((function(){return Tl(e)?Tl(e).I(t).then((function(t){return{accessToken:t}})):null})))},t.Tc=function(t){var e=this;return this.h.then((function(){return wl(e,cu(e.a,ru,{token:t}))})).then((function(t){var n=t.user;return Wh(n,"isAnonymous",!1),e.da(n),t}))},t.Uc=function(t,e){var n=this;return this.h.then((function(){return wl(n,cu(n.a,iu,{email:t,password:e}))}))},t.dc=function(t,e){var n=this;return this.h.then((function(){return wl(n,cu(n.a,Ds,{email:t,password:e}))}))},t.ab=function(t){var e=this;return this.h.then((function(){return wl(e,t.ka(e.a))}))},t.Sc=function(t){return Jr("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.ab(t)},t.Ab=function(){var t=this;return this.h.then((function(){var e=Tl(t);if(e&&e.isAnonymous){var n=ni({providerId:null,isNewUser:!1});return ni({user:e,credential:null,additionalUserInfo:n,operationType:"signIn"})}return wl(t,t.a.Ab()).then((function(e){var n=e.user;return Wh(n,"isAnonymous",!0),t.da(n),e}))}))},t.getUid=function(){return Tl(this)&&Tl(this).uid||null},t.cc=function(t){this.addAuthTokenListener(t),this.u++,0<this.u&&Tl(this)&&xh(Tl(this))},t.Pc=function(t){var e=this;G(this.s,(function(n){n==t&&e.u--})),0>this.u&&(this.u=0),0==this.u&&Tl(this)&&Oh(Tl(this)),this.removeAuthTokenListener(t)},t.addAuthTokenListener=function(t){var e=this;this.s.push(t),Cl(this,this.h.then((function(){e.l||X(e.s,t)&&t(El(e))})))},t.removeAuthTokenListener=function(t){J(this.s,(function(e){return e==t}))},t.delete=function(){this.l=!0;for(var t=0;t<this.P.length;t++)this.P[t].cancel("app-deleted");return this.P=[],this.i&&(t=this.i).b.removeListener(ul("local"),t.a,this.ja),this.b&&(Vc(this.b,this),Zc(this.b.b)),Promise.resolve()},t.hc=function(t){return Cl(this,function(t,e){return cu(t,xs,{identifier:e,continueUri:Fr()?pr():"http://localhost"}).then((function(t){return t.signinMethods||[]}))}(this.a,t))},t.Bc=function(t){return!!Fo(t)},t.xb=function(t,e){var n=this;return Cl(this,Pe().then((function(){var t=new Oi(e);if(!t.c)throw new A("argument-error",Fi+" must be true when sending sign in link to email");return Wi(t)})).then((function(e){return n.a.xb(t,e)})).then((function(){})))},t.jd=function(t){return this.Sa(t).then((function(t){return t.data.email}))},t.ob=function(t,e){return Cl(this,this.a.ob(t,e).then((function(){})))},t.Sa=function(t){return Cl(this,this.a.Sa(t).then((function(t){return new li(t)})))},t.kb=function(t){return Cl(this,this.a.kb(t).then((function(){})))},t.wb=function(t,e){var n=this;return Cl(this,Pe().then((function(){return"undefined"===typeof e||gt(e)?{}:Wi(new Oi(e))})).then((function(e){return n.a.wb(t,e)})).then((function(){})))},t.Wc=function(t,e){return Cl(this,oh(this,t,e,T(this.ab,this)))},t.Vc=function(t,e){var n=this;return Cl(this,Pe().then((function(){var r=e||pr(),i=Mo(t,r);if(!(r=Fo(r)))throw new A("argument-error","Invalid email link!");if(r.tenantId!==n.T())throw new A("tenant-id-mismatch");return n.ab(i)})))},kl.prototype.render=function(){},kl.prototype.reset=function(){},kl.prototype.getResponse=function(){},kl.prototype.execute=function(){};var Nl=null;function Pl(t,e){return(e=Rl(e))&&t.a[e]||null}function Rl(t){return(t="undefined"===typeof t?1e12:t)?t.toString():null}function Dl(t,e){this.g=!1,this.c=e,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=le(t);var n=this;this.i=function(){n.execute()},this.h?this.execute():fn(this.f,"click",this.i)}function xl(t){if(t.g)throw Error("reCAPTCHA mock was already deleted!")}function Ol(){}function Ll(){}Al.prototype.render=function(t,e){return this.a[this.b.toString()]=new Dl(t,e),this.b++},Al.prototype.reset=function(t){var e=Pl(this,t);t=Rl(t),e&&t&&(e.delete(),delete this.a[t])},Al.prototype.getResponse=function(t){return(t=Pl(this,t))?t.getResponse():null},Al.prototype.execute=function(t){(t=Pl(this,t))&&t.execute()},Dl.prototype.getResponse=function(){return xl(this),this.b},Dl.prototype.execute=function(){xl(this);var t=this;this.a||(this.a=setTimeout((function(){t.b=function(){for(var t=50,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}();var e=t.c.callback,n=t.c["expired-callback"];if(e)try{e(t.b)}catch(r){}t.a=setTimeout((function(){if(t.a=null,t.b=null,n)try{n()}catch(r){}t.h&&t.execute()}),6e4)}),500))},Dl.prototype.delete=function(){xl(this),this.g=!0,clearTimeout(this.a),this.a=null,vn(this.f,"click",this.i)},ti(Ol,"FACTOR_ID","phone"),Ll.prototype.g=function(){return Nl||(Nl=new Al),Pe(Nl)},Ll.prototype.c=function(){};var Ml=null;function Fl(){this.b=u.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var Ul=new wt(St,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),jl=new Gr(3e4,6e4);Fl.prototype.g=function(t){var e=this;return new Te((function(n,r){var i=setTimeout((function(){r(new A("network-request-failed"))}),jl.get());!u.grecaptcha||t!==e.f&&!e.b?(u[e.a]=function(){if(u.grecaptcha){e.f=t;var o=u.grecaptcha.render;u.grecaptcha.render=function(t,n){return t=o(t,n),e.b++,t},clearTimeout(i),n(u.grecaptcha)}else clearTimeout(i),r(new A("internal-error"));delete u[e.a]},Pe(Ya(Nt(Ul,{onload:e.a,hl:t||""}))).o((function(){clearTimeout(i),r(new A("internal-error","Unable to load external reCAPTCHA dependencies!"))}))):(clearTimeout(i),n(u.grecaptcha))}))},Fl.prototype.c=function(){this.b--};var ql=null;function Vl(t,e,n,r,i,o,a){if(ti(this,"type","recaptcha"),this.c=this.f=null,this.J=!1,this.v=e,this.g=null,a?(Ml||(Ml=new Ll),a=Ml):(ql||(ql=new Fl),a=ql),this.m=a,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[Wl])throw new A("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[Hl],!u.document)throw new A("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!le(e)||!this.i&&le(e).hasChildNodes())throw new A("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.s=new ns(t,o||null,i||null),this.u=r||function(){return null};var s=this;this.l=[];var c=this.a[Bl];this.a[Bl]=function(t){if(Gl(s,t),"function"===typeof c)c(t);else if("string"===typeof c){var e=Or(c,u);"function"===typeof e&&e(t)}};var h=this.a[Kl];this.a[Kl]=function(){if(Gl(s,null),"function"===typeof h)h();else if("string"===typeof h){var t=Or(h,u);"function"===typeof t&&t()}}}var Bl="callback",Kl="expired-callback",Wl="sitekey",Hl="size";function Gl(t,e){for(var n=0;n<t.l.length;n++)try{t.l[n](e)}catch(r){}}function zl(t,e){return t.h.push(e),e.oa((function(){$(t.h,e)})),e}function Ql(t){if(t.J)throw new A("internal-error","RecaptchaVerifier instance has been destroyed.")}function Yl(t,e,n){var i=!1;try{this.b=n||r.default.app()}catch(s){throw new A("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new A("invalid-api-key");n=this.b.options.apiKey;var o=this,a=null;try{a=this.b.auth().Ga()}catch(s){}try{i=this.b.auth().settings.appVerificationDisabledForTesting}catch(s){}a=r.default.SDK_VERSION?Dr(r.default.SDK_VERSION,a):null,Vl.call(this,n,t,e,(function(){try{var t=o.b.auth().la()}catch(e){t=null}return t}),a,O(P),i)}function Xl(t,e,n,r){t:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,a=0;a<e.length;a++)if(e[a].optional)o=!0;else{if(o)throw new A("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=e.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=e[i].optional&&void 0===n[i],!e[i].M(n[i])&&!o){if(e=e[i],0>i||i>=$l.length)throw new A("internal-error","Argument validator received an unsupported number of arguments.");n=$l[i],r=(r?"":n+" argument ")+(e.name?'"'+e.name+'" ':"")+"must be "+e.K+".";break t}r=null}}if(r)throw new A("argument-error",t+" failed: "+r)}(t=Vl.prototype).Ia=function(){var t=this;return this.f?this.f:this.f=zl(this,Pe().then((function(){if(Fr()&&!Sr())return Ir();throw new A("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")})).then((function(){return t.m.g(t.u())})).then((function(e){return t.g=e,cu(t.s,Gs,{})})).then((function(e){t.a[Wl]=e.recaptchaSiteKey})).o((function(e){throw t.f=null,e})))},t.render=function(){Ql(this);var t=this;return zl(this,this.Ia().then((function(){if(null===t.c){var e=t.v;if(!t.i){var n=le(e);e=function(t,e,n){var r=arguments,i=document,o=String(r[0]),a=r[1];if(!he&&a&&(a.name||a.type)){if(o=["<",o],a.name&&o.push(' name="',Gt(a.name),'"'),a.type){o.push(' type="',Gt(a.type),'"');var s={};_t(s,a),delete s.type,a=s}o.push(">"),o=o.join("")}return o=ye(i,o),a&&("string"===typeof a?o.className=a:Array.isArray(a)?o.className=a.join(" "):fe(o,a)),2<r.length&&ge(i,o,r),o}("DIV"),n.appendChild(e)}t.c=t.g.render(e,t.a)}return t.c})))},t.verify=function(){Ql(this);var t=this;return zl(this,this.render().then((function(e){return new Te((function(n){var r=t.g.getResponse(e);if(r)n(r);else{t.l.push((function e(r){r&&(function(t,e){J(t.l,(function(t){return t==e}))}(t,e),n(r))})),t.i&&t.g.execute(t.c)}}))})))},t.reset=function(){Ql(this),null!==this.c&&this.g.reset(this.c)},t.clear=function(){Ql(this),this.J=!0,this.m.c();for(var t=0;t<this.h.length;t++)this.h[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){t=le(this.v);for(var e;e=t.firstChild;)t.removeChild(e)}},C(Yl,Vl);var $l="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function Jl(t,e){return{name:t||"",K:"a valid string",optional:!!e,M:function(t){return"string"===typeof t}}}function Zl(t,e){return{name:t||"",K:"a boolean",optional:!!e,M:function(t){return"boolean"===typeof t}}}function tf(t,e){return{name:t||"",K:"a valid object",optional:!!e,M:y}}function ef(t,e){return{name:t||"",K:"a function",optional:!!e,M:function(t){return"function"===typeof t}}}function nf(t,e){return{name:t||"",K:"null",optional:!!e,M:function(t){return null===t}}}function rf(t){return{name:t?t+"Credential":"credential",K:t?"a valid "+t+" credential":"a valid credential",optional:!1,M:function(e){if(!e)return!1;var n=!t||e.providerId===t;return!(!e.ka||!n)}}}function of(t,e){return y(t)&&"string"===typeof t.type&&t.type===e&&"function"===typeof t.Ha}function af(t){return y(t)&&"string"===typeof t.uid}function sf(t,e,n,r){return{name:n||"",K:t.K+" or "+e.K,optional:!!r,M:function(n){return t.M(n)||e.M(n)}}}function uf(t,e){for(var n in e){var r=e[n].name;t[r]=lf(r,t[n],e[n].j)}}function cf(t,e){for(var n in e){var r=e[n].name;r!==n&&Object.defineProperty(t,r,{get:E((function(t){return this[t]}),n),set:E((function(t,e,n,r){Xl(t,[n],[r],!0),this[e]=r}),r,n,e[n].lb),enumerable:!0})}}function hf(t,e,n,r){t[e]=lf(e,n,r)}function lf(t,e,n){function r(){var t=Array.prototype.slice.call(arguments);return Xl(o,n,t),e.apply(this,t)}if(!n)return e;var i,o=function(t){return t=t.split("."),t[t.length-1]}(t);for(i in e)r[i]=e[i];for(i in e.prototype)r.prototype[i]=e.prototype[i];return r}uf(dl.prototype,{kb:{name:"applyActionCode",j:[Jl("code")]},Sa:{name:"checkActionCode",j:[Jl("code")]},ob:{name:"confirmPasswordReset",j:[Jl("code"),Jl("newPassword")]},dc:{name:"createUserWithEmailAndPassword",j:[Jl("email"),Jl("password")]},hc:{name:"fetchSignInMethodsForEmail",j:[Jl("email")]},ra:{name:"getRedirectResult",j:[]},Bc:{name:"isSignInWithEmailLink",j:[Jl("emailLink")]},Hc:{name:"onAuthStateChanged",j:[sf(tf(),ef(),"nextOrObserver"),ef("opt_error",!0),ef("opt_completed",!0)]},Ic:{name:"onIdTokenChanged",j:[sf(tf(),ef(),"nextOrObserver"),ef("opt_error",!0),ef("opt_completed",!0)]},wb:{name:"sendPasswordResetEmail",j:[Jl("email"),sf(tf("opt_actionCodeSettings",!0),nf(null,!0),"opt_actionCodeSettings",!0)]},xb:{name:"sendSignInLinkToEmail",j:[Jl("email"),tf("actionCodeSettings")]},yb:{name:"setPersistence",j:[Jl("persistence")]},Sc:{name:"signInAndRetrieveDataWithCredential",j:[rf()]},Ab:{name:"signInAnonymously",j:[]},ab:{name:"signInWithCredential",j:[rf()]},Tc:{name:"signInWithCustomToken",j:[Jl("token")]},Uc:{name:"signInWithEmailAndPassword",j:[Jl("email"),Jl("password")]},Vc:{name:"signInWithEmailLink",j:[Jl("email"),Jl("emailLink",!0)]},Wc:{name:"signInWithPhoneNumber",j:[Jl("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!==typeof t.type||"function"!==typeof t.verify)}}]},Xc:{name:"signInWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Yc:{name:"signInWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},dd:{name:"updateCurrentUser",j:[sf({name:"user",K:"an instance of Firebase User",optional:!1,M:function(t){return!!(t&&t instanceof Ch)}},nf(),"user")]},Bb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[Jl(null,!0)]},fd:{name:"useDeviceLanguage",j:[]},gd:{name:"useEmulator",j:[Jl("url"),tf("options",!0)]},jd:{name:"verifyPasswordResetCode",j:[Jl("code")]}}),cf(dl.prototype,{lc:{name:"languageCode",lb:sf(Jl(),nf(),"languageCode")},ti:{name:"tenantId",lb:sf(Jl(),nf(),"tenantId")}}),dl.Persistence=oc,dl.Persistence.LOCAL="local",dl.Persistence.SESSION="session",dl.Persistence.NONE="none",uf(Ch.prototype,{delete:{name:"delete",j:[]},oc:{name:"getIdTokenResult",j:[Zl("opt_forceRefresh",!0)]},I:{name:"getIdToken",j:[Zl("opt_forceRefresh",!0)]},Cc:{name:"linkAndRetrieveDataWithCredential",j:[rf()]},rb:{name:"linkWithCredential",j:[rf()]},Dc:{name:"linkWithPhoneNumber",j:[Jl("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!==typeof t.type||"function"!==typeof t.verify)}}]},Ec:{name:"linkWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Fc:{name:"linkWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Lc:{name:"reauthenticateAndRetrieveDataWithCredential",j:[rf()]},ub:{name:"reauthenticateWithCredential",j:[rf()]},Mc:{name:"reauthenticateWithPhoneNumber",j:[Jl("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!==typeof t.type||"function"!==typeof t.verify)}}]},Nc:{name:"reauthenticateWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Oc:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},vb:{name:"sendEmailVerification",j:[sf(tf("opt_actionCodeSettings",!0),nf(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[Jl(null,!0)]},cd:{name:"unlink",j:[Jl("provider")]},Cb:{name:"updateEmail",j:[Jl("email")]},Db:{name:"updatePassword",j:[Jl("password")]},ed:{name:"updatePhoneNumber",j:[rf("phone")]},Eb:{name:"updateProfile",j:[tf("profile")]},Fb:{name:"verifyBeforeUpdateEmail",j:[Jl("email"),sf(tf("opt_actionCodeSettings",!0),nf(null,!0),"opt_actionCodeSettings",!0)]}}),uf(Al.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),uf(kl.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),uf(Te.prototype,{oa:{name:"finally"},o:{name:"catch"},then:{name:"then"}}),cf(rh.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",lb:Zl("appVerificationDisabledForTesting")}}),uf(ih.prototype,{confirm:{name:"confirm",j:[Jl("verificationCode")]}}),hf(po,"fromJSON",(function(t){t="string"===typeof t?JSON.parse(t):t;for(var e,n=[wo,Oo,jo,mo],r=0;r<n.length;r++)if(e=n[r](t))return e;return null}),[sf(Jl(),tf(),"json")]),hf(Lo,"credential",(function(t,e){return new xo(t,e)}),[Jl("email"),Jl("password")]),uf(xo.prototype,{w:{name:"toJSON",j:[Jl(null,!0)]}}),uf(So.prototype,{Ca:{name:"addScope",j:[Jl("scope")]},Ka:{name:"setCustomParameters",j:[tf("customOAuthParameters")]}}),hf(So,"credential",Co,[sf(Jl(),tf(),"token")]),hf(Lo,"credentialWithLink",Mo,[Jl("email"),Jl("emailLink")]),uf(ko.prototype,{Ca:{name:"addScope",j:[Jl("scope")]},Ka:{name:"setCustomParameters",j:[tf("customOAuthParameters")]}}),hf(ko,"credential",Ao,[sf(Jl(),tf(),"token")]),uf(No.prototype,{Ca:{name:"addScope",j:[Jl("scope")]},Ka:{name:"setCustomParameters",j:[tf("customOAuthParameters")]}}),hf(No,"credential",Po,[sf(Jl(),sf(tf(),nf()),"idToken"),sf(Jl(),nf(),"accessToken",!0)]),uf(Ro.prototype,{Ka:{name:"setCustomParameters",j:[tf("customOAuthParameters")]}}),hf(Ro,"credential",Do,[sf(Jl(),tf(),"token"),Jl("secret",!0)]),uf(Eo.prototype,{Ca:{name:"addScope",j:[Jl("scope")]},credential:{name:"credential",j:[sf(Jl(),sf(tf(),nf()),"optionsOrIdToken"),sf(Jl(),nf(),"accessToken",!0)]},Ka:{name:"setCustomParameters",j:[tf("customOAuthParameters")]}}),uf(_o.prototype,{w:{name:"toJSON",j:[Jl(null,!0)]}}),uf(go.prototype,{w:{name:"toJSON",j:[Jl(null,!0)]}}),hf(Vo,"credential",Bo,[Jl("verificationId"),Jl("verificationCode")]),uf(Vo.prototype,{gb:{name:"verifyPhoneNumber",j:[sf(Jl(),{name:"phoneInfoOptions",K:"valid phone info options",optional:!1,M:function(t){return!!t&&(t.session&&t.phoneNumber?of(t.session,lo)&&"string"===typeof t.phoneNumber:t.session&&t.multiFactorHint?of(t.session,fo)&&af(t.multiFactorHint):t.session&&t.multiFactorUid?of(t.session,fo)&&"string"===typeof t.multiFactorUid:!!t.phoneNumber&&"string"===typeof t.phoneNumber)}},"phoneInfoOptions"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!==typeof t.type||"function"!==typeof t.verify)}}]}}),uf(Uo.prototype,{w:{name:"toJSON",j:[Jl(null,!0)]}}),uf(A.prototype,{toJSON:{name:"toJSON",j:[Jl(null,!0)]}}),uf($o.prototype,{toJSON:{name:"toJSON",j:[Jl(null,!0)]}}),uf(Xo.prototype,{toJSON:{name:"toJSON",j:[Jl(null,!0)]}}),uf(hh.prototype,{toJSON:{name:"toJSON",j:[Jl(null,!0)]}}),uf(sh.prototype,{Rc:{name:"resolveSignIn",j:[{name:"multiFactorAssertion",K:"a valid multiFactorAssertion",optional:!1,M:function(t){return!!t&&!!t.tb}}]}}),uf(gh.prototype,{Sb:{name:"getSession",j:[]},fc:{name:"enroll",j:[{name:"multiFactorAssertion",K:"a valid multiFactorAssertion",optional:!1,M:function(t){return!!t&&!!t.tb}},Jl("displayName",!0)]},bd:{name:"unenroll",j:[sf({name:"multiFactorInfo",K:"a valid multiFactorInfo",optional:!1,M:af},Jl(),"multiFactorInfoIdentifier")]}}),uf(Yl.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),hf(Si,"parseLink",xi,[Jl("link")]),hf(Ol,"assertion",(function(t){return new ph(t)}),[rf("phone")]),function(){if("undefined"===typeof r.default||!r.default.INTERNAL||!r.default.INTERNAL.registerComponent)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:di,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:fi,VERIFY_AND_CHANGE_EMAIL:pi,VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:dl,AuthCredential:po,Error:A};hf(t,"EmailAuthProvider",Lo,[]),hf(t,"FacebookAuthProvider",So,[]),hf(t,"GithubAuthProvider",ko,[]),hf(t,"GoogleAuthProvider",No,[]),hf(t,"TwitterAuthProvider",Ro,[]),hf(t,"OAuthProvider",Eo,[Jl("providerId")]),hf(t,"SAMLAuthProvider",To,[Jl("providerId")]),hf(t,"PhoneAuthProvider",Vo,[{name:"auth",K:"an instance of Firebase Auth",optional:!0,M:function(t){return!!(t&&t instanceof dl)}}]),hf(t,"RecaptchaVerifier",Yl,[sf(Jl(),{name:"",K:"an HTML element",optional:!1,M:function(t){return!!(t&&t instanceof Element)}},"recaptchaContainer"),tf("recaptchaParameters",!0),{name:"app",K:"an instance of Firebase App",optional:!0,M:function(t){return!!(t&&t instanceof r.default.app.App)}}]),hf(t,"ActionCodeURL",Si,[]),hf(t,"PhoneMultiFactorGenerator",Ol,[]),r.default.INTERNAL.registerComponent({name:"auth",instanceFactory:function(t){return new dl(t=t.getProvider("app").getImmediate())},multipleInstances:!1,serviceProps:t,instantiationMode:"LAZY",type:"PUBLIC",onInstanceCreated:function(t){t.getProvider("auth-internal").initialize()}}),r.default.INTERNAL.registerComponent({name:"auth-internal",instanceFactory:function(t){return{getUid:T((t=t.getProvider("auth").getImmediate()).getUid,t),getToken:T(t.nc,t),addAuthTokenListener:T(t.cc,t),removeAuthTokenListener:T(t.Pc,t)}},multipleInstances:!1,instantiationMode:"LAZY",type:"PRIVATE"}),r.default.registerVersion("@firebase/auth","0.16.8"),r.default.INTERNAL.extendNamespace({User:Ch})}()}).apply("undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});n(6895);var i=n(9388),o=n(9971),a=n(9386),s=function(t,e){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},s(t,e)};function u(t){var e="function"===typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"===typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var c,h="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{},l=l||{},f=h||self;function d(){}function p(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function v(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var g="closure_uid_"+(1e9*Math.random()>>>0),y=0;function m(t,e,n){return t.call.apply(t.bind,arguments)}function _(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function b(t,e,n){return(b=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?m:_).apply(null,arguments)}function w(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function I(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function T(){this.s=this.s,this.o=this.o}var E={};T.prototype.s=!1,T.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var t=function(t){return Object.prototype.hasOwnProperty.call(t,g)&&t[g]||(t[g]=++y)}(this);delete E[t]}},T.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var S=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"===typeof t)return"string"!==typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},C=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"===typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function k(t){return Array.prototype.concat.apply([],arguments)}function A(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function N(t){return/^[\s\xa0]*$/.test(t)}var P,R=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function D(t,e){return-1!=t.indexOf(e)}function x(t,e){return t<e?-1:t>e?1:0}t:{var O=f.navigator;if(O){var L=O.userAgent;if(L){P=L;break t}}P=""}function M(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function F(t){var e={};for(var n in t)e[n]=t[n];return e}var U="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function j(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<U.length;o++)n=U[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function q(t){return q[" "](t),t}q[" "]=d;var V,B=D(P,"Opera"),K=D(P,"Trident")||D(P,"MSIE"),W=D(P,"Edge"),H=W||K,G=D(P,"Gecko")&&!(D(P.toLowerCase(),"webkit")&&!D(P,"Edge"))&&!(D(P,"Trident")||D(P,"MSIE"))&&!D(P,"Edge"),z=D(P.toLowerCase(),"webkit")&&!D(P,"Edge");function Q(){var t=f.document;return t?t.documentMode:void 0}t:{var Y="",X=function(){var t=P;return G?/rv:([^\);]+)(\)|;)/.exec(t):W?/Edge\/([\d\.]+)/.exec(t):K?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):z?/WebKit\/(\S+)/.exec(t):B?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(X&&(Y=X?X[1]:""),K){var $=Q();if(null!=$&&$>parseFloat(Y)){V=String($);break t}}V=Y}var J,Z={};function tt(){return function(t){var e=Z;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}((function(){for(var t=0,e=R(String(V)).split("."),n=R("9").split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",a=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==o[0].length&&0==a[0].length)break;t=x(0==o[1].length?0:parseInt(o[1],10),0==a[1].length?0:parseInt(a[1],10))||x(0==o[2].length,0==a[2].length)||x(o[2],a[2]),o=o[3],a=a[3]}while(0==t)}return 0<=t}))}if(f.document&&K){var et=Q();J=et||(parseInt(V,10)||void 0)}else J=void 0;var nt=J,rt=function(){if(!f.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{f.addEventListener("test",d,e),f.removeEventListener("test",d,e)}catch(n){}return t}();function it(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}function ot(t,e){if(it.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(G){t:{try{q(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"===typeof t.pointerType?t.pointerType:at[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&ot.Z.h.call(this)}}it.prototype.h=function(){this.defaultPrevented=!0},I(ot,it);var at={2:"touch",3:"pen",4:"mouse"};ot.prototype.h=function(){ot.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var st="closure_listenable_"+(1e6*Math.random()|0),ut=0;function ct(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ia=i,this.key=++ut,this.ca=this.fa=!1}function ht(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function lt(t){this.src=t,this.g={},this.h=0}function ft(t,e){var n=e.type;if(n in t.g){var r,i=t.g[n],o=S(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(ht(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function dt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.ca&&o.listener==e&&o.capture==!!n&&o.ia==r)return i}return-1}lt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.g[o])||(t=this.g[o]=[],this.h++);var a=dt(t,e,r,i);return-1<a?(e=t[a],n||(e.fa=!1)):((e=new ct(e,this.src,o,!!r,i)).fa=n,t.push(e)),e};var pt="closure_lm_"+(1e6*Math.random()|0),vt={};function gt(t,e,n,r,i){if(r&&r.once)return mt(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)gt(t,e[o],n,r,i);return null}return n=St(n),t&&t[st]?t.N(e,n,v(r)?!!r.capture:!!r,i):yt(t,e,n,!1,r,i)}function yt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=v(i)?!!i.capture:!!i,s=Tt(t);if(s||(t[pt]=s=new lt(t)),(n=s.add(e,n,r,a,o)).proxy)return n;if(r=function(){function t(n){return e.call(t.src,t.listener,n)}var e=It;return t}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)rt||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(wt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function mt(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)mt(t,e[o],n,r,i);return null}return n=St(n),t&&t[st]?t.O(e,n,v(r)?!!r.capture:!!r,i):yt(t,e,n,!0,r,i)}function _t(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)_t(t,e[o],n,r,i);else r=v(r)?!!r.capture:!!r,n=St(n),t&&t[st]?(t=t.i,(e=String(e).toString())in t.g&&(-1<(n=dt(o=t.g[e],n,r,i))&&(ht(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.g[e],t.h--)))):t&&(t=Tt(t))&&(e=t.g[e.toString()],t=-1,e&&(t=dt(e,n,r,i)),(n=-1<t?e[t]:null)&&bt(n))}function bt(t){if("number"!==typeof t&&t&&!t.ca){var e=t.src;if(e&&e[st])ft(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(wt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Tt(e))?(ft(n,t),0==n.h&&(n.src=null,e[pt]=null)):ht(t)}}}function wt(t){return t in vt?vt[t]:vt[t]="on"+t}function It(t,e){if(t.ca)t=!0;else{e=new ot(e,this);var n=t.listener,r=t.ia||t.src;t.fa&&bt(t),t=n.call(r,e)}return t}function Tt(t){return(t=t[pt])instanceof lt?t:null}var Et="__closure_events_fn_"+(1e9*Math.random()>>>0);function St(t){return"function"===typeof t?t:(t[Et]||(t[Et]=function(e){return t.handleEvent(e)}),t[Et])}function Ct(){T.call(this),this.i=new lt(this),this.P=this,this.I=null}function kt(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,"string"===typeof e)e=new it(e,t);else if(e instanceof it)e.target=e.target||t;else{var i=e;j(e=new it(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var a=e.g=n[o];i=At(a,r,!0,e)&&i}if(i=At(a=e.g=t,r,!0,e)&&i,i=At(a,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=At(a=e.g=n[o],r,!1,e)&&i}function At(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.ca&&a.capture==n){var s=a.listener,u=a.ia||a.src;a.fa&&ft(t.i,a),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}I(Ct,T),Ct.prototype[st]=!0,Ct.prototype.removeEventListener=function(t,e,n,r){_t(this,t,e,n,r)},Ct.prototype.M=function(){if(Ct.Z.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)ht(n[r]);delete e.g[t],e.h--}}this.I=null},Ct.prototype.N=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},Ct.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};var Nt=f.JSON.stringify;function Pt(){var t=Ut,e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Rt,Dt=function(){function t(){this.h=this.g=null}return t.prototype.add=function(t,e){var n=xt.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n},t}(),xt=new(function(){function t(t,e){this.i=t,this.j=e,this.h=0,this.g=null}return t.prototype.get=function(){var t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t},t}())((function(){return new Ot}),(function(t){return t.reset()})),Ot=function(){function t(){this.next=this.g=this.h=null}return t.prototype.set=function(t,e){this.h=t,this.g=e,this.next=null},t.prototype.reset=function(){this.next=this.g=this.h=null},t}();function Lt(t){f.setTimeout((function(){throw t}),0)}function Mt(t,e){Rt||function(){var t=f.Promise.resolve(void 0);Rt=function(){t.then(jt)}}(),Ft||(Rt(),Ft=!0),Ut.add(t,e)}var Ft=!1,Ut=new Dt;function jt(){for(var t;t=Pt();){try{t.h.call(t.g)}catch(n){Lt(n)}var e=xt;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Ft=!1}function qt(t,e){Ct.call(this),this.h=t||1,this.g=e||f,this.j=b(this.kb,this),this.l=Date.now()}function Vt(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}function Bt(t,e,n){if("function"===typeof t)n&&(t=b(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=b(t.handleEvent,t)}return 2147483647<Number(e)?-1:f.setTimeout(t,e||0)}function Kt(t){t.g=Bt((function(){t.g=null,t.i&&(t.i=!1,Kt(t))}),t.j);var e=t.h;t.h=null,t.m.apply(null,e)}I(qt,Ct),(c=qt.prototype).da=!1,c.S=null,c.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),kt(this,"tick"),this.da&&(Vt(this),this.start()))}},c.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},c.M=function(){qt.Z.M.call(this),Vt(this),delete this.g};var Wt=function(t){function e(e,n){var r=t.call(this)||this;return r.m=e,r.j=n,r.h=null,r.i=!1,r.g=null,r}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.l=function(t){this.h=arguments,this.g?this.i=!0:Kt(this)},e.prototype.M=function(){t.prototype.M.call(this),this.g&&(f.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},e}(T);function Ht(t){T.call(this),this.h=t,this.g={}}I(Ht,T);var Gt=[];function zt(t,e,n,r){Array.isArray(n)||(n&&(Gt[0]=n.toString()),n=Gt);for(var i=0;i<n.length;i++){var o=gt(e,n[i],r||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}}function Qt(t){M(t.g,(function(t,e){this.g.hasOwnProperty(e)&&bt(t)}),t),t.g={}}function Yt(){this.g=!0}function Xt(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var a=1;a<i.length;a++)i[a]=""}}}return Nt(n)}catch(s){return e}}(t,n)+(r?" "+r:"")}))}Ht.prototype.M=function(){Ht.Z.M.call(this),Qt(this)},Ht.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Yt.prototype.Aa=function(){this.g=!1},Yt.prototype.info=function(){};var $t={},Jt=null;function Zt(){return Jt=Jt||new Ct}function te(t){it.call(this,$t.Ma,t)}function ee(t){var e=Zt();kt(e,new te(e,t))}function ne(t,e){it.call(this,$t.STAT_EVENT,t),this.stat=e}function re(t){var e=Zt();kt(e,new ne(e,t))}function ie(t,e){it.call(this,$t.Na,t),this.size=e}function oe(t,e){if("function"!==typeof t)throw Error("Fn must not be null and must be a function");return f.setTimeout((function(){t()}),e)}$t.Ma="serverreachability",I(te,it),$t.STAT_EVENT="statevent",I(ne,it),$t.Na="timingevent",I(ie,it);var ae={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},se={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function ue(){}function ce(t){return t.h||(t.h=t.i())}function he(){}ue.prototype.h=null;var le,fe={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function de(){it.call(this,"d")}function pe(){it.call(this,"c")}function ve(){}function ge(t,e,n,r){this.l=t,this.j=e,this.m=n,this.X=r||1,this.V=new Ht(this),this.P=me,t=H?125:void 0,this.W=new qt(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new ye}function ye(){this.i=null,this.g="",this.h=!1}I(de,it),I(pe,it),I(ve,ue),ve.prototype.g=function(){return new XMLHttpRequest},ve.prototype.i=function(){return{}},le=new ve;var me=45e3,_e={},be={};function we(t,e,n){t.K=1,t.v=We(Ue(e)),t.s=n,t.U=!0,Ie(t,null)}function Ie(t,e){t.F=Date.now(),Ce(t),t.A=Ue(t.v);var n=t.A,r=t.X;Array.isArray(r)||(r=[String(r)]),rn(n.h,"t",r),t.C=0,n=t.l.H,t.h=new ye,t.g=ar(t.l,n?e:null,!t.s),0<t.O&&(t.L=new Wt(b(t.Ia,t,t.g),t.O)),zt(t.V,t.g,"readystatechange",t.gb),e=t.H?F(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),ee(1),function(t,e,n,r,i,o){t.info((function(){if(t.g)if(o)for(var a="",s=o.split("&"),u=0;u<s.length;u++){var c=s[u].split("=");if(1<c.length){var h=c[0];c=c[1];var l=h.split("_");a=2<=l.length&&"type"==l[1]?a+(h+"=")+c+"&":a+(h+"=redacted&")}}else a=null;else a=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+a}))}(t.j,t.u,t.A,t.m,t.X,t.s)}function Te(t){return!!t.g&&("GET"==t.u&&2!=t.K&&t.l.Ba)}function Ee(t,e,n){for(var r,i=!0;!t.I&&t.C<n.length;){if((r=Se(t,n))==be){4==e&&(t.o=4,re(14),i=!1),Xt(t.j,t.m,null,"[Incomplete Response]");break}if(r==_e){t.o=4,re(15),Xt(t.j,t.m,n,"[Invalid Chunk]"),i=!1;break}Xt(t.j,t.m,r,null),Re(t,r)}Te(t)&&r!=be&&r!=_e&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,re(16),i=!1),t.i=t.i&&i,i?0<n.length&&!t.aa&&(t.aa=!0,(e=t.l).g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),Jn(e),e.L=!0,re(11))):(Xt(t.j,t.m,n,"[Invalid Chunked Response]"),Pe(t),Ne(t))}function Se(t,e){var n=t.C,r=e.indexOf("\n",n);return-1==r?be:(n=Number(e.substring(n,r)),isNaN(n)?_e:(r+=1)+n>e.length?be:(e=e.substr(r,n),t.C=r+n,e))}function Ce(t){t.Y=Date.now()+t.P,ke(t,t.P)}function ke(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=oe(b(t.eb,t),e)}function Ae(t){t.B&&(f.clearTimeout(t.B),t.B=null)}function Ne(t){0==t.l.G||t.I||er(t.l,t)}function Pe(t){Ae(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,Vt(t.W),Qt(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function Re(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||fn(n.i,t)))if(n.I=t.N,!t.J&&fn(n.i,t)&&3==n.G){try{var r=n.Ca.g.parse(e)}catch(o){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;tr(n),Kn(n)}$n(n),re(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=oe(b(n.ab,n),6e3));if(1>=ln(n.i)&&n.ka){try{n.ka()}catch(o){}n.ka=void 0}}else rr(n,11)}else if((t.J||n.g==t)&&tr(n),!N(e))for(i=n.Ca.g.parse(e),e=0;e<i.length;e++){var o=i[e];if(n.U=o[0],o=o[1],2==n.G)if("c"==o[0]){n.J=o[1],n.la=o[2];var a=o[3];null!=a&&(n.ma=a,n.h.info("VER="+n.ma));var s=o[4];null!=s&&(n.za=s,n.h.info("SVER="+n.za));var u=o[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=t.g;if(c){var h=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var l=r.i;!l.g&&(D(h,"spdy")||D(h,"quic")||D(h,"h2"))&&(l.j=l.l,l.g=new Set,l.h&&(dn(l,l.h),l.h=null))}if(r.D){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.sa=f,Ke(r.F,r.D,f))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms"));var d=t;if((r=n).oa=or(r,r.H?r.la:null,r.W),d.J){pn(r.i,d);var p=d,v=r.K;v&&p.setTimeout(v),p.B&&(Ae(p),Ce(p)),r.g=d}else Xn(r);0<n.l.length&&Gn(n)}else"stop"!=o[0]&&"close"!=o[0]||rr(n,7);else 3==n.G&&("stop"==o[0]||"close"==o[0]?"stop"==o[0]?rr(n,7):Bn(n):"noop"!=o[0]&&n.j&&n.j.wa(o),n.A=0)}ee(4)}catch(o){}}function De(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(p(t)||"string"===typeof t)C(t,e,void 0);else{if(t.T&&"function"==typeof t.T)var n=t.T();else if(t.R&&"function"==typeof t.R)n=void 0;else if(p(t)||"string"===typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;r=function(t){if(t.R&&"function"==typeof t.R)return t.R();if("string"===typeof t)return t.split("");if(p(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t),i=r.length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function xe(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof xe)for(n=t.T(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Oe(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var r=t.g[e];Le(t.h,r)&&(t.g[n++]=r),e++}t.g.length=n}if(t.i!=t.g.length){var i={};for(n=e=0;e<t.g.length;)Le(i,r=t.g[e])||(t.g[n++]=r,i[r]=1),e++;t.g.length=n}}function Le(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(c=ge.prototype).setTimeout=function(t){this.P=t},c.gb=function(t){t=t.target;var e=this.L;e&&3==Fn(t)?e.l():this.Ia(t)},c.Ia=function(t){try{if(t==this.g)t:{var e=Fn(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>e)&&(3!=e||H||this.g&&(this.h.h||this.g.ga()||Un(this.g)))){this.I||4!=e||7==n||ee(8==n||0>=r?3:2),Ae(this);var i=this.g.ba();this.N=i;e:if(Te(this)){var o=Un(this.g);t="";var a=o.length,s=4==Fn(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){Pe(this),Ne(this);var u="";break e}this.h.i=new f.TextDecoder}for(n=0;n<a;n++)this.h.h=!0,t+=this.h.i.decode(o[n],{stream:s&&n==a-1});o.splice(0,a),this.h.g+=t,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==i,function(t,e,n,r,i,o,a){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+a}))}(this.j,this.u,this.A,this.m,this.X,e,i),this.i){if(this.$&&!this.J){e:{if(this.g){var c,h=this.g;if((c=h.g?h.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!N(c)){var l=c;break e}}l=null}if(!(i=l)){this.i=!1,this.o=3,re(12),Pe(this),Ne(this);break t}Xt(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Re(this,i)}this.U?(Ee(this,e,u),H&&this.i&&3==e&&(zt(this.V,this.W,"tick",this.fb),this.W.start())):(Xt(this.j,this.m,u,null),Re(this,u)),4==e&&Pe(this),this.i&&!this.I&&(4==e?er(this.l,this):(this.i=!1,Ce(this)))}else 400==i&&0<u.indexOf("Unknown SID")?(this.o=3,re(12)):(this.o=0,re(13)),Pe(this),Ne(this)}}}catch(e){}},c.fb=function(){if(this.g){var t=Fn(this.g),e=this.g.ga();this.C<e.length&&(Ae(this),Ee(this,t,e),this.i&&4!=t&&Ce(this))}},c.cancel=function(){this.I=!0,Pe(this)},c.eb=function(){this.B=null;var t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.K&&(ee(3),re(17)),Pe(this),this.o=2,Ne(this)):ke(this,this.Y-t)},(c=xe.prototype).R=function(){Oe(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t},c.T=function(){return Oe(this),this.g.concat()},c.get=function(t,e){return Le(this.h,t)?this.h[t]:e},c.set=function(t,e){Le(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e},c.forEach=function(t,e){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Me=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Fe(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof Fe){this.g=void 0!==e?e:t.g,je(this,t.j),this.s=t.s,qe(this,t.i),Ve(this,t.m),this.l=t.l,e=t.h;var n=new Ze;n.i=e.i,e.g&&(n.g=new xe(e.g),n.h=e.h),Be(this,n),this.o=t.o}else t&&(n=String(t).match(Me))?(this.g=!!e,je(this,n[1]||"",!0),this.s=He(n[2]||""),qe(this,n[3]||"",!0),Ve(this,n[4]),this.l=He(n[5]||"",!0),Be(this,n[6]||"",!0),this.o=He(n[7]||"")):(this.g=!!e,this.h=new Ze(null,this.g))}function Ue(t){return new Fe(t)}function je(t,e,n){t.j=n?He(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function qe(t,e,n){t.i=n?He(e,!0):e}function Ve(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Be(t,e,n){e instanceof Ze?(t.h=e,function(t,e){e&&!t.j&&(tn(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(en(this,e),rn(this,n,t))}),t)),t.j=e}(t.h,t.g)):(n||(e=Ge(e,$e)),t.h=new Ze(e,t.g))}function Ke(t,e,n){t.h.set(e,n)}function We(t){return Ke(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function He(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ge(t,e,n){return"string"===typeof t?(t=encodeURI(t).replace(e,ze),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function ze(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Fe.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Ge(e,Qe,!0),":");var n=this.i;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(Ge(e,Qe,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&t.push("/"),t.push(Ge(n,"/"==n.charAt(0)?Xe:Ye,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Ge(n,Je)),t.join("")};var Qe=/[#\/\?@]/g,Ye=/[#\?:]/g,Xe=/[#\?]/g,$e=/[#\?@]/g,Je=/#/g;function Ze(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function tn(t){t.g||(t.g=new xe,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function en(t,e){tn(t),e=on(t,e),Le(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,Le((t=t.g).h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&Oe(t)))}function nn(t,e){return tn(t),e=on(t,e),Le(t.g.h,e)}function rn(t,e,n){en(t,e),0<n.length&&(t.i=null,t.g.set(on(t,e),A(n)),t.h+=n.length)}function on(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(c=Ze.prototype).add=function(t,e){tn(this),this.i=null,t=on(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},c.forEach=function(t,e){tn(this),this.g.forEach((function(n,r){C(n,(function(n){t.call(e,n,r,this)}),this)}),this)},c.T=function(){tn(this);for(var t=this.g.R(),e=this.g.T(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},c.R=function(t){tn(this);var e=[];if("string"===typeof t)nn(this,t)&&(e=k(e,this.g.get(on(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=k(e,t[n])}return e},c.set=function(t,e){return tn(this),this.i=null,nn(this,t=on(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},c.get=function(t,e){return t&&0<(t=this.R(t)).length?String(t[0]):e},c.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.R(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.i=t.join("&")};var an=function(t,e){this.h=t,this.g=e};function sn(t){this.l=t||cn,f.PerformanceNavigationTiming?t=0<(t=f.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(f.g&&f.g.Ea&&f.g.Ea()&&f.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var un,cn=10;function hn(t){return!!t.h||!!t.g&&t.g.size>=t.j}function ln(t){return t.h?1:t.g?t.g.size:0}function fn(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function dn(t,e){t.g?t.g.add(e):t.h=e}function pn(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function vn(t){var e,n;if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){var r=t.i;try{for(var i=u(t.g.values()),o=i.next();!o.done;o=i.next()){var a=o.value;r=r.concat(a.D)}}catch(s){e={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return A(t.i)}function gn(){}function yn(){this.g=new gn}function mn(t,e,n){var r=n||"";try{De(t,(function(t,n){var i=t;v(t)&&(i=Nt(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(Vd){throw e.push(r+"type="+encodeURIComponent("_badmap")),Vd}}function _n(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}function bn(t){this.l=t.$b||null,this.j=t.ib||!1}function wn(t,e){Ct.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=In,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}sn.prototype.cancel=function(){var t,e;if(this.i=vn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){try{for(var n=u(this.g.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(i){t={error:i}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.g.clear()}},gn.prototype.stringify=function(t){return f.JSON.stringify(t,void 0)},gn.prototype.parse=function(t){return f.JSON.parse(t,void 0)},I(bn,ue),bn.prototype.g=function(){return new wn(this.l,this.j)},bn.prototype.i=(un={},function(){return un}),I(wn,Ct);var In=0;function Tn(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}function En(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Sn(t)}function Sn(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(c=wn.prototype).open=function(t,e){if(this.readyState!=In)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Sn(this)},c.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||f).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},c.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,En(this)),this.readyState=In},c.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Sn(this)),this.g&&(this.readyState=3,Sn(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if("undefined"!==typeof f.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Tn(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))},c.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?En(this):Sn(this),3==this.readyState&&Tn(this)}},c.Ua=function(t){this.g&&(this.response=this.responseText=t,En(this))},c.Ta=function(t){this.g&&(this.response=t,En(this))},c.ha=function(){this.g&&En(this)},c.setRequestHeader=function(t,e){this.v.append(t,e)},c.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},c.getAllResponseHeaders=function(){if(!this.h)return"";for(var t=[],e=this.h.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(wn.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var Cn=f.JSON.parse;function kn(t){Ct.call(this),this.headers=new xe,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=An,this.K=this.L=!1}I(kn,Ct);var An="",Nn=/^https?$/i,Pn=["POST","PUT"];function Rn(t){return"content-type"==t.toLowerCase()}function Dn(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,xn(t),Ln(t)}function xn(t){t.D||(t.D=!0,kt(t,"complete"),kt(t,"error"))}function On(t){if(t.h&&"undefined"!=typeof l&&(!t.C[1]||4!=Fn(t)||2!=t.ba()))if(t.v&&4==Fn(t))Bt(t.Fa,0,t);else if(kt(t,"readystatechange"),4==Fn(t)){t.h=!1;try{var e,n=t.ba();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.H).match(Me)[1]||null;if(!o&&f.self&&f.self.location){var a=f.self.location.protocol;o=a.substr(0,a.length-1)}i=!Nn.test(o?o.toLowerCase():"")}e=i}if(e)kt(t,"complete"),kt(t,"success");else{t.m=6;try{var s=2<Fn(t)?t.g.statusText:""}catch(u){s=""}t.j=s+" ["+t.ba()+"]",xn(t)}}finally{Ln(t)}}}function Ln(t,e){if(t.g){Mn(t);var n=t.g,r=t.C[0]?d:null;t.g=null,t.C=null,e||kt(t,"ready");try{n.onreadystatechange=r}catch(Vd){}}}function Mn(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(f.clearTimeout(t.A),t.A=null)}function Fn(t){return t.g?t.g.readyState:0}function Un(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case An:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(e){return null}}function jn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return M(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"===typeof t?null!=n&&encodeURIComponent(String(n)):Ke(t,e,n))}function qn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Vn(t){this.za=0,this.l=[],this.h=new Yt,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=qn("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=qn("baseRetryDelayMs",5e3,t),this.$a=qn("retryDelaySeedMs",1e4,t),this.Ya=qn("forwardChannelMaxRetries",2,t),this.ra=qn("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new sn(t&&t.concurrentRequestLimit),this.Ca=new yn,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||!1!==t.Xb}function Bn(t){if(Wn(t),3==t.G){var e=t.V++,n=Ue(t.F);Ke(n,"SID",t.J),Ke(n,"RID",e),Ke(n,"TYPE","terminate"),Qn(t,n),(e=new ge(t,t.h,e,void 0)).K=2,e.v=We(Ue(n)),n=!1,f.navigator&&f.navigator.sendBeacon&&(n=f.navigator.sendBeacon(e.v.toString(),"")),!n&&f.Image&&((new Image).src=e.v,n=!0),n||(e.g=ar(e.l,null),e.g.ea(e.v)),e.F=Date.now(),Ce(e)}ir(t)}function Kn(t){t.g&&(Jn(t),t.g.cancel(),t.g=null)}function Wn(t){Kn(t),t.u&&(f.clearTimeout(t.u),t.u=null),tr(t),t.i.cancel(),t.m&&("number"===typeof t.m&&f.clearTimeout(t.m),t.m=null)}function Hn(t,e){t.l.push(new an(t.Za++,e)),3==t.G&&Gn(t)}function Gn(t){hn(t.i)||t.m||(t.m=!0,Mt(t.Ha,t),t.C=0)}function zn(t,e){var n;n=e?e.m:t.V++;var r=Ue(t.F);Ke(r,"SID",t.J),Ke(r,"RID",n),Ke(r,"AID",t.U),Qn(t,r),t.o&&t.s&&jn(r,t.o,t.s),n=new ge(t,t.h,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=Yn(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),dn(t.i,n),we(n,r,e)}function Qn(t,e){t.j&&De({},(function(t,n){Ke(e,n,t)}))}function Yn(t,e,n){n=Math.min(t.l.length,n);var r=t.j?b(t.j.Oa,t.j,t):null;t:for(var i=t.l,o=-1;;){var a=["count="+n];-1==o?0<n?(o=i[0].h,a.push("ofs="+o)):o=0:a.push("ofs="+o);for(var s=!0,u=0;u<n;u++){var c=i[u].h,h=i[u].g;if(0>(c-=o))o=Math.max(0,i[u].h-100),s=!1;else try{mn(h,a,"req"+c+"_")}catch(Vr){r&&r(h)}}if(s){r=a.join("&");break t}}return t=t.l.splice(0,n),e.D=t,r}function Xn(t){t.g||t.u||(t.Y=1,Mt(t.Ga,t),t.A=0)}function $n(t){return!(t.g||t.u||3<=t.A)&&(t.Y++,t.u=oe(b(t.Ga,t),nr(t,t.A)),t.A++,!0)}function Jn(t){null!=t.B&&(f.clearTimeout(t.B),t.B=null)}function Zn(t){t.g=new ge(t,t.h,"rpc",t.Y),null===t.o&&(t.g.H=t.s),t.g.O=0;var e=Ue(t.oa);Ke(e,"RID","rpc"),Ke(e,"SID",t.J),Ke(e,"CI",t.N?"0":"1"),Ke(e,"AID",t.U),Qn(t,e),Ke(e,"TYPE","xmlhttp"),t.o&&t.s&&jn(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=We(Ue(e)),n.s=null,n.U=!0,Ie(n,t)}function tr(t){null!=t.v&&(f.clearTimeout(t.v),t.v=null)}function er(t,e){var n=null;if(t.g==e){tr(t),Jn(t),t.g=null;var r=2}else{if(!fn(t.i,e))return;n=e.D,pn(t.i,e),r=1}if(t.I=e.N,0!=t.G)if(e.i)if(1==r){n=e.s?e.s.length:0,e=Date.now()-e.F;var i=t.C;kt(r=Zt(),new ie(r,n,e,i)),Gn(t)}else Xn(t);else if(3==(i=e.o)||0==i&&0<t.I||!(1==r&&function(t,e){return!(ln(t.i)>=t.i.j-(t.m?1:0))&&(t.m?(t.l=e.D.concat(t.l),!0):!(1==t.G||2==t.G||t.C>=(t.Xa?0:t.Ya))&&(t.m=oe(b(t.Ha,t,e),nr(t,t.C)),t.C++,!0))}(t,e)||2==r&&$n(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:rr(t,5);break;case 4:rr(t,10);break;case 3:rr(t,6);break;default:rr(t,2)}}function nr(t,e){var n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function rr(t,e){if(t.h.info("Error code "+e),2==e){var n=null;t.j&&(n=null);var r=b(t.jb,t);n||(n=new Fe("//www.google.com/images/cleardot.gif"),f.location&&"http"==f.location.protocol||je(n,"https"),We(n)),function(t,e){var n=new Yt;if(f.Image){var r=new Image;r.onload=w(_n,n,r,"TestLoadImage: loaded",!0,e),r.onerror=w(_n,n,r,"TestLoadImage: error",!1,e),r.onabort=w(_n,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=w(_n,n,r,"TestLoadImage: timeout",!1,e),f.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else re(2);t.G=0,t.j&&t.j.va(e),ir(t),Wn(t)}function ir(t){t.G=0,t.I=-1,t.j&&(0==vn(t.i).length&&0==t.l.length||(t.i.i.length=0,A(t.l),t.l.length=0),t.j.ua())}function or(t,e,n){var r=function(t){return t instanceof Fe?Ue(t):new Fe(t,void 0)}(n);if(""!=r.i)e&&qe(r,e+"."+r.i),Ve(r,r.m);else{var i=f.location;r=function(t,e,n,r){var i=new Fe(null,void 0);return t&&je(i,t),e&&qe(i,e),n&&Ve(i,n),r&&(i.l=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.aa&&M(t.aa,(function(t,e){Ke(r,e,t)})),e=t.D,n=t.sa,e&&n&&Ke(r,e,n),Ke(r,"VER",t.ma),Qn(t,r),r}function ar(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=n&&t.Ba&&!t.qa?new kn(new bn({ib:!0})):new kn(t.qa)).L=t.H,e}function sr(){}function ur(){if(K&&!(10<=Number(nt)))throw Error("Environmental error: no available transport.")}function cr(t,e){Ct.call(this),this.g=new Vn(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!N(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!N(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&(e in(t=this.h)&&delete t[e])),this.j=new fr(this)}function hr(t){de.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function lr(){pe.call(this),this.status=1}function fr(t){this.g=t}(c=kn.prototype).ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():le.g(),this.C=this.u?ce(this.u):ce(le),this.g.onreadystatechange=b(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(o){return void Dn(this,o)}t=n||"";var i=new xe(this.headers);r&&De(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=Rn,n=t.length,r="string"===typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"===typeof t?t.charAt(e):t[e]}(i.T()),n=f.FormData&&t instanceof f.FormData,!(0<=S(Pn,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.g.setRequestHeader(e,t)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Mn(this),0<this.B&&((this.K=function(t){return K&&tt()&&"number"===typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=b(this.pa,this)):this.A=Bt(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(o){Dn(this,o)}},c.pa=function(){"undefined"!=typeof l&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,kt(this,"timeout"),this.abort(8))},c.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,kt(this,"complete"),kt(this,"abort"),Ln(this))},c.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Ln(this,!0)),kn.Z.M.call(this)},c.Fa=function(){this.s||(this.F||this.v||this.l?On(this):this.cb())},c.cb=function(){On(this)},c.ba=function(){try{return 2<Fn(this)?this.g.status:-1}catch(un){return-1}},c.ga=function(){try{return this.g?this.g.responseText:""}catch(un){return""}},c.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Cn(e)}},c.Da=function(){return this.m},c.La=function(){return"string"===typeof this.j?this.j:String(this.j)},(c=Vn.prototype).ma=8,c.G=1,c.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch(e){}},c.Ha=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;var e=new ge(this,this.h,t,void 0),n=this.s;if(this.P&&(n?j(n=F(n),this.P):n=this.P),null===this.o&&(e.H=n),this.ja)t:{for(var r=0,i=0;i<this.l.length;i++){var o=this.l[i];if(void 0===(o="__data__"in o.g&&"string"===typeof(o=o.g.__data__)?o.length:void 0))break;if(4096<(r+=o)){r=i;break t}if(4096===r||i===this.l.length-1){r=i+1;break t}}r=1e3}else r=1e3;r=Yn(this,e,r),Ke(i=Ue(this.F),"RID",t),Ke(i,"CVER",22),this.D&&Ke(i,"X-HTTP-Session-Id",this.D),Qn(this,i),this.o&&n&&jn(i,this.o,n),dn(this.i,e),this.Ra&&Ke(i,"TYPE","init"),this.ja?(Ke(i,"$req",r),Ke(i,"SID","null"),e.$=!0,we(e,i,null)):we(e,i,r),this.G=2}}else 3==this.G&&(t?zn(this,t):0==this.l.length||hn(this.i)||zn(this))},c.Ga=function(){if(this.u=null,Zn(this),this.$&&!(this.L||null==this.g||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=oe(b(this.bb,this),t)}},c.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,re(10),Kn(this),Zn(this))},c.ab=function(){null!=this.v&&(this.v=null,Kn(this),$n(this),re(19))},c.jb=function(t){t?(this.h.info("Successfully pinged google.com"),re(2)):(this.h.info("Failed to ping google.com"),re(1))},(c=sr.prototype).xa=function(){},c.wa=function(){},c.va=function(){},c.ua=function(){},c.Oa=function(){},ur.prototype.g=function(t,e){return new cr(t,e)},I(cr,Ct),cr.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),Mt(b(t.hb,t,e))),re(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=or(t,null,t.W),Gn(t)},cr.prototype.close=function(){Bn(this.g)},cr.prototype.u=function(t){if("string"===typeof t){var e={};e.__data__=t,Hn(this.g,e)}else this.v?((e={}).__data__=Nt(t),Hn(this.g,e)):Hn(this.g,t)},cr.prototype.M=function(){this.g.j=null,delete this.j,Bn(this.g),delete this.g,cr.Z.M.call(this)},I(hr,de),I(lr,pe),I(fr,sr),fr.prototype.xa=function(){kt(this.g,"a")},fr.prototype.wa=function(t){kt(this.g,new hr(t))},fr.prototype.va=function(t){kt(this.g,new lr(t))},fr.prototype.ua=function(){kt(this.g,"b")},ur.prototype.createWebChannel=ur.prototype.g,cr.prototype.send=cr.prototype.u,cr.prototype.open=cr.prototype.m,cr.prototype.close=cr.prototype.close,ae.NO_ERROR=0,ae.TIMEOUT=8,ae.HTTP_ERROR=6,se.COMPLETE="complete",he.EventType=fe,fe.OPEN="a",fe.CLOSE="b",fe.ERROR="c",fe.MESSAGE="d",Ct.prototype.listen=Ct.prototype.N,kn.prototype.listenOnce=kn.prototype.O,kn.prototype.getLastError=kn.prototype.La,kn.prototype.getLastErrorCode=kn.prototype.Da,kn.prototype.getStatus=kn.prototype.ba,kn.prototype.getResponseJson=kn.prototype.Qa,kn.prototype.getResponseText=kn.prototype.ga,kn.prototype.send=kn.prototype.ea;var dr=function(){return new ur},pr=function(){return Zt()},vr=ae,gr=se,yr=$t,mr={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},_r=bn,br=he,wr=kn,Ir=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}return t.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},t}();Ir.o=-1;var Tr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Er=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return(0,i.__extends)(e,t),e}(Error),Sr=new a.Logger("@firebase/firestore");function Cr(){return Sr.logLevel}function kr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Sr.logLevel<=a.LogLevel.DEBUG){var r=e.map(Pr);Sr.debug.apply(Sr,(0,i.__spreadArray)(["Firestore (8.10.1): "+t],r))}}function Ar(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Sr.logLevel<=a.LogLevel.ERROR){var r=e.map(Pr);Sr.error.apply(Sr,(0,i.__spreadArray)(["Firestore (8.10.1): "+t],r))}}function Nr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Sr.logLevel<=a.LogLevel.WARN){var r=e.map(Pr);Sr.warn.apply(Sr,(0,i.__spreadArray)(["Firestore (8.10.1): "+t],r))}}function Pr(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function Rr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.10.1) INTERNAL ASSERTION FAILED: "+t;throw Ar(e),new Error(e)}function Dr(t,e){t||Rr()}function xr(t,e){return t}function Or(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Lr=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=Or(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function Mr(t,e){return t<e?-1:t>e?1:0}function Fr(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function Ur(t){return t+"\0"}var jr=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Er(Tr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Er(Tr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Er(Tr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Er(Tr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?Mr(this.nanoseconds,t.nanoseconds):Mr(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),qr=function(){function t(t){this.timestamp=t}return t.fromTimestamp=function(e){return new t(e)},t.min=function(){return new t(new jr(0,0))},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t}();function Vr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Br(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Kr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Wr=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&Rr(),void 0===n?n=t.length-e:n>t.length-e&&Rr(),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),Hr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,i.__extends)(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var a=o[i];if(a.indexOf("//")>=0)throw new Er(Tr.INVALID_ARGUMENT,"Invalid segment ("+a+"). Paths must not contain // in them.");r.push.apply(r,a.split("/").filter((function(t){return t.length>0})))}return new e(r)},e.emptyPath=function(){return new e([])},e}(Wr),Gr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,zr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,i.__extends)(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.isValidIdentifier=function(t){return Gr.test(t)},e.prototype.canonicalString=function(){return this.toArray().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new Er(Tr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},a=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new Er(Tr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Er(Tr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===s?(a=!a,i++):"."!==s||a?(r+=s,i++):(o(),i++)}if(o(),a)throw new Er(Tr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.emptyPath=function(){return new e([])},e}(Wr),Qr=function(){function t(t){this.fields=t,t.sort(zr.comparator)}return t.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},t.prototype.isEqual=function(t){return Fr(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),Yr=function(){function t(t){this.binaryString=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.binaryString,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},t.prototype.approximateByteSize=function(){return 2*this.binaryString.length},t.prototype.compareTo=function(t){return Mr(this.binaryString,t.binaryString)},t.prototype.isEqual=function(t){return this.binaryString===t.binaryString},t}();Yr.EMPTY_BYTE_STRING=new Yr("");var Xr=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function $r(t){if(Dr(!!t),"string"==typeof t){var e=0,n=Xr.exec(t);if(Dr(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Jr(t.seconds),nanos:Jr(t.nanos)}}function Jr(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Zr(t){return"string"==typeof t?Yr.fromBase64String(t):Yr.fromUint8Array(t)}function ti(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function ei(t){var e=t.mapValue.fields.__previous_value__;return ti(e)?ei(e):e}function ni(t){var e=$r(t.mapValue.fields.__local_write_time__.timestampValue);return new jr(e.seconds,e.nanos)}function ri(t){return null==t}function ii(t){return 0===t&&1/t==-1/0}function oi(t){return"number"==typeof t&&Number.isInteger(t)&&!ii(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var ai=function(){function t(t){this.path=t}return t.fromPath=function(e){return new t(Hr.fromString(e))},t.fromName=function(e){return new t(Hr.fromString(e).popFirst(5))},t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===Hr.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return Hr.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new Hr(e.slice()))},t}();function si(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ti(t)?4:10:Rr()}function ui(t,e){var n=si(t);if(n!==si(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ni(t).isEqual(ni(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=$r(t.timestampValue),r=$r(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Zr(t.bytesValue).isEqual(Zr(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Jr(t.geoPointValue.latitude)===Jr(e.geoPointValue.latitude)&&Jr(t.geoPointValue.longitude)===Jr(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Jr(t.integerValue)===Jr(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Jr(t.doubleValue),r=Jr(e.doubleValue);return n===r?ii(n)===ii(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Fr(t.arrayValue.values||[],e.arrayValue.values||[],ui);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(Vr(n)!==Vr(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!ui(n[i],r[i])))return!1;return!0}(t,e);default:return Rr()}}function ci(t,e){return void 0!==(t.values||[]).find((function(t){return ui(t,e)}))}function hi(t,e){var n=si(t),r=si(e);if(n!==r)return Mr(n,r);switch(n){case 0:return 0;case 1:return Mr(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=Jr(t.integerValue||t.doubleValue),r=Jr(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return li(t.timestampValue,e.timestampValue);case 4:return li(ni(t),ni(e));case 5:return Mr(t.stringValue,e.stringValue);case 6:return function(t,e){var n=Zr(t),r=Zr(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Mr(n[i],r[i]);if(0!==o)return o}return Mr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=Mr(Jr(t.latitude),Jr(e.latitude));return 0!==n?n:Mr(Jr(t.longitude),Jr(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=hi(n[i],r[i]);if(o)return o}return Mr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var a=0;a<r.length&&a<o.length;++a){var s=Mr(r[a],o[a]);if(0!==s)return s;var u=hi(n[r[a]],i[o[a]]);if(0!==u)return u}return Mr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Rr()}}function li(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Mr(t,e);var n=$r(t),r=$r(e),i=Mr(n.seconds,r.seconds);return 0!==i?i:Mr(n.nanos,r.nanos)}function fi(t){return di(t)}function di(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=$r(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Zr(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,ai.fromName(n).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=di(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+di(t.fields[o])}return e+"}"}(t.mapValue):Rr();var e,n}function pi(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function vi(t){return!!t&&"integerValue"in t}function gi(t){return!!t&&"arrayValue"in t}function yi(t){return!!t&&"nullValue"in t}function mi(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function _i(t){return!!t&&"mapValue"in t}function bi(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){var e={mapValue:{fields:{}}};return Br(t.mapValue.fields,(function(t,n){return e.mapValue.fields[t]=bi(n)})),e}if(t.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(t.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=bi(t.arrayValue.values[r]);return n}return Object.assign({},t)}var wi=function(){function t(t){this.value=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.isEmpty())return this.value;for(var e=this.value,n=0;n<t.length-1;++n)if(!_i(e=(e.mapValue.fields||{})[t.get(n)]))return null;return(e=(e.mapValue.fields||{})[t.lastSegment()])||null},t.prototype.set=function(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=bi(e)},t.prototype.setAll=function(t){var e=this,n=zr.emptyPath(),r={},i=[];t.forEach((function(t,o){if(!n.isImmediateParentOf(o)){var a=e.getFieldsMap(n);e.applyChanges(a,r,i),r={},i=[],n=o.popLast()}t?r[o.lastSegment()]=bi(t):i.push(o.lastSegment())}));var o=this.getFieldsMap(n);this.applyChanges(o,r,i)},t.prototype.delete=function(t){var e=this.field(t.popLast());_i(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]},t.prototype.isEqual=function(t){return ui(this.value,t.value)},t.prototype.getFieldsMap=function(t){var e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(var n=0;n<t.length;++n){var r=e.mapValue.fields[t.get(n)];_i(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields},t.prototype.applyChanges=function(t,e,n){Br(e,(function(e,n){return t[e]=n}));for(var r=0,i=n;r<i.length;r++){var o=i[r];delete t[o]}},t.prototype.clone=function(){return new t(bi(this.value))},t}();function Ii(t){var e=[];return Br(t.fields,(function(t,n){var r=new zr([t]);if(_i(n)){var i=Ii(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,a=i;o<a.length;o++){var s=a[o];e.push(r.child(s))}}else e.push(r)})),new Qr(e)}var Ti=function(){function t(t,e,n,r,i){this.key=t,this.documentType=e,this.version=n,this.data=r,this.documentState=i}return t.newInvalidDocument=function(e){return new t(e,0,qr.min(),wi.empty(),0)},t.newFoundDocument=function(e,n,r){return new t(e,1,n,r,0)},t.newNoDocument=function(e,n){return new t(e,2,n,wi.empty(),0)},t.newUnknownDocument=function(e,n){return new t(e,3,n,wi.empty(),2)},t.prototype.convertToFoundDocument=function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this},t.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=wi.empty(),this.documentState=0,this},t.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=wi.empty(),this.documentState=2,this},t.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},t.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(t.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),t.prototype.isValidDocument=function(){return 0!==this.documentType},t.prototype.isFoundDocument=function(){return 1===this.documentType},t.prototype.isNoDocument=function(){return 2===this.documentType},t.prototype.isUnknownDocument=function(){return 3===this.documentType},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)},t.prototype.clone=function(){return new t(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.value)+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},t}(),Ei=function(t,e,n,r,i,o,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.h=null};function Si(t,e,n,r,i,o,a){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),new Ei(t,e,n,r,i,o,a)}function Ci(t){var e=xr(t);if(null===e.h){var n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.canonicalString()+t.op.toString()+fi(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return function(t){return t.field.canonicalString()+t.dir}(t)})).join(","),ri(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=ji(e.startAt)),e.endAt&&(n+="|ub:",n+=ji(e.endAt)),e.h=n}return e.h}function ki(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!Vi(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!ui(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ki(t.startAt,e.startAt)&&Ki(t.endAt,e.endAt)}function Ai(t){return ai.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Ni=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return(0,i.__extends)(e,t),e.create=function(t,n,r){return t.isKeyField()?"in"===n||"not-in"===n?this.l(t,n,r):new Pi(t,n,r):"array-contains"===n?new Oi(t,r):"in"===n?new Li(t,r):"not-in"===n?new Mi(t,r):"array-contains-any"===n?new Fi(t,r):new e(t,n,r)},e.l=function(t,e,n){return"in"===e?new Ri(t,n):new Di(t,n)},e.prototype.matches=function(t){var e=t.data.field(this.field);return"!="===this.op?null!==e&&this.m(hi(e,this.value)):null!==e&&si(this.value)===si(e)&&this.m(hi(e,this.value))},e.prototype.m=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Rr()}},e.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),Pi=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=ai.fromName(r.referenceValue),i}return(0,i.__extends)(e,t),e.prototype.matches=function(t){var e=ai.comparator(t.key,this.key);return this.m(e)},e}(Ni),Ri=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=xi("in",n),r}return(0,i.__extends)(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Ni),Di=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=xi("not-in",n),r}return(0,i.__extends)(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Ni);function xi(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return ai.fromName(t.referenceValue)}))}var Oi=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return(0,i.__extends)(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return gi(e)&&ci(e.arrayValue,this.value)},e}(Ni),Li=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return(0,i.__extends)(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return null!==e&&ci(this.value.arrayValue,e)},e}(Ni),Mi=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return(0,i.__extends)(e,t),e.prototype.matches=function(t){if(ci(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.data.field(this.field);return null!==e&&!ci(this.value.arrayValue,e)},e}(Ni),Fi=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return(0,i.__extends)(e,t),e.prototype.matches=function(t){var e=this,n=t.data.field(this.field);return!(!gi(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return ci(e.value.arrayValue,t)}))},e}(Ni),Ui=function(t,e){this.position=t,this.before=e};function ji(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return fi(t)})).join(",")}var qi=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Vi(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function Bi(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],a=t.position[i];if(r=o.field.isKeyField()?ai.comparator(ai.fromName(a.referenceValue),n.key):hi(a,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Ki(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!ui(t.position[n],e.position[n]))return!1;return!0}var Wi=function(t,e,n,r,i,o,a,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===a&&(a=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=s,this.p=null,this.T=null,this.startAt,this.endAt};function Hi(t,e,n,r,i,o,a,s){return new Wi(t,e,n,r,i,o,a,s)}function Gi(t){return new Wi(t)}function zi(t){return!ri(t.limit)&&"F"===t.limitType}function Qi(t){return!ri(t.limit)&&"L"===t.limitType}function Yi(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function Xi(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function $i(t){return null!==t.collectionGroup}function Ji(t){var e=xr(t);if(null===e.p){e.p=[];var n=Xi(e),r=Yi(e);if(null!==n&&null===r)n.isKeyField()||e.p.push(new qi(n)),e.p.push(new qi(zr.keyField(),"asc"));else{for(var i=!1,o=0,a=e.explicitOrderBy;o<a.length;o++){var s=a[o];e.p.push(s),s.field.isKeyField()&&(i=!0)}if(!i){var u=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.p.push(new qi(zr.keyField(),u))}}}return e.p}function Zi(t){var e=xr(t);if(!e.T)if("F"===e.limitType)e.T=Si(e.path,e.collectionGroup,Ji(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Ji(e);r<i.length;r++){var o=i[r],a="desc"===o.dir?"asc":"desc";n.push(new qi(o.field,a))}var s=e.endAt?new Ui(e.endAt.position,!e.endAt.before):null,u=e.startAt?new Ui(e.startAt.position,!e.startAt.before):null;e.T=Si(e.path,e.collectionGroup,n,e.filters,e.limit,s,u)}return e.T}function to(t,e,n){return new Wi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function eo(t,e){return ki(Zi(t),Zi(e))&&t.limitType===e.limitType}function no(t){return Ci(Zi(t))+"|lt:"+t.limitType}function ro(t){return"Query(target="+function(t){var e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.canonicalString()+" "+e.op+" "+fi(e.value);var e})).join(", ")+"]"),ri(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return function(t){return t.field.canonicalString()+" ("+t.dir+")"}(t)})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+ji(t.startAt)),t.endAt&&(e+=", endAt: "+ji(t.endAt)),"Target("+e+")"}(Zi(t))+"; limitType="+t.limitType+")"}function io(t,e){return e.isFoundDocument()&&function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):ai.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(var n=0,r=t.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===e.data.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!Bi(t.startAt,Ji(t),e))&&(!t.endAt||!Bi(t.endAt,Ji(t),e))}(t,e)}function oo(t){return function(e,n){for(var r=!1,i=0,o=Ji(t);i<o.length;i++){var a=o[i],s=ao(a,e,n);if(0!==s)return s;r=r||a.field.isKeyField()}return 0}}function ao(t,e,n){var r=t.field.isKeyField()?ai.comparator(e.key,n.key):function(t,e,n){var r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?hi(r,i):Rr()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Rr()}}function so(t,e){if(t.I){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ii(e)?"-0":e}}function uo(t){return{integerValue:""+t}}function co(t,e){return oi(e)?uo(e):so(t,e)}var ho=function(){this._=void 0};function lo(t,e,n){return t instanceof vo?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof go?yo(t,e):t instanceof mo?_o(t,e):function(t,e){var n=po(t,e),r=wo(n)+wo(t.A);return vi(n)&&vi(t.A)?uo(r):so(t.R,r)}(t,e)}function fo(t,e,n){return t instanceof go?yo(t,e):t instanceof mo?_o(t,e):n}function po(t,e){return t instanceof bo?vi(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var vo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,i.__extends)(e,t),e}(ho),go=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return(0,i.__extends)(e,t),e}(ho);function yo(t,e){for(var n=Io(e),r=function(t){n.some((function(e){return ui(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var mo=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return(0,i.__extends)(e,t),e}(ho);function _o(t,e){for(var n=Io(e),r=function(t){n=n.filter((function(e){return!ui(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var bo=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).R=e,r.A=n,r}return(0,i.__extends)(e,t),e}(ho);function wo(t){return Jr(t.integerValue||t.doubleValue)}function Io(t){return gi(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var To=function(t,e){this.field=t,this.transform=e},Eo=function(t,e){this.version=t,this.transformResults=e},So=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.none=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function Co(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}var ko=function(){};function Ao(t,e,n){t instanceof xo?function(t,e,n){var r=t.value.clone(),i=Mo(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof Oo?function(t,e,n){if(Co(t.precondition,e)){var r=Mo(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(Lo(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else e.convertToUnknownDocument(n.version)}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function No(t,e,n){t instanceof xo?function(t,e,n){if(Co(t.precondition,e)){var r=t.value.clone(),i=Fo(t.fieldTransforms,n,e);r.setAll(i),e.convertToFoundDocument(Do(e),r).setHasLocalMutations()}}(t,e,n):t instanceof Oo?function(t,e,n){if(Co(t.precondition,e)){var r=Fo(t.fieldTransforms,n,e),i=e.data;i.setAll(Lo(t)),i.setAll(r),e.convertToFoundDocument(Do(e),i).setHasLocalMutations()}}(t,e,n):function(t,e){Co(t.precondition,e)&&e.convertToNoDocument(qr.min())}(t,e)}function Po(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],a=e.data.field(o.field),s=po(o.transform,a||null);null!=s&&(null==n&&(n=wi.empty()),n.set(o.field,s))}return n||null}function Ro(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Fr(t,e,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof go&&e instanceof go||t instanceof mo&&e instanceof mo?Fr(t.elements,e.elements,ui):t instanceof bo&&e instanceof bo?ui(t.A,e.A):t instanceof vo&&e instanceof vo}(t.transform,e.transform)}(t,e)}))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function Do(t){return t.isFoundDocument()?t.version:qr.min()}var xo=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return(0,i.__extends)(e,t),e}(ko),Oo=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var a=this;return(a=t.call(this)||this).key=e,a.data=n,a.fieldMask=r,a.precondition=i,a.fieldTransforms=o,a.type=1,a}return(0,i.__extends)(e,t),e}(ko);function Lo(t){var e=new Map;return t.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=t.data.field(n);e.set(n,r)}})),e}function Mo(t,e,n){var r=new Map;Dr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],a=o.transform,s=e.data.field(o.field);r.set(o.field,fo(a,s,n[i]))}return r}function Fo(t,e,n){for(var r=new Map,i=0,o=t;i<o.length;i++){var a=o[i],s=a.transform,u=n.data.field(a.field);r.set(a.field,lo(s,u,e))}return r}var Uo,jo,qo=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return(0,i.__extends)(e,t),e}(ko),Vo=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return(0,i.__extends)(e,t),e}(ko),Bo=function(t){this.count=t};function Ko(t){switch(t){case Tr.OK:return Rr();case Tr.CANCELLED:case Tr.UNKNOWN:case Tr.DEADLINE_EXCEEDED:case Tr.RESOURCE_EXHAUSTED:case Tr.INTERNAL:case Tr.UNAVAILABLE:case Tr.UNAUTHENTICATED:return!1;case Tr.INVALID_ARGUMENT:case Tr.NOT_FOUND:case Tr.ALREADY_EXISTS:case Tr.PERMISSION_DENIED:case Tr.FAILED_PRECONDITION:case Tr.ABORTED:case Tr.OUT_OF_RANGE:case Tr.UNIMPLEMENTED:case Tr.DATA_LOSS:return!0;default:return Rr()}}function Wo(t){if(void 0===t)return Ar("GRPC error has no .code"),Tr.UNKNOWN;switch(t){case Uo.OK:return Tr.OK;case Uo.CANCELLED:return Tr.CANCELLED;case Uo.UNKNOWN:return Tr.UNKNOWN;case Uo.DEADLINE_EXCEEDED:return Tr.DEADLINE_EXCEEDED;case Uo.RESOURCE_EXHAUSTED:return Tr.RESOURCE_EXHAUSTED;case Uo.INTERNAL:return Tr.INTERNAL;case Uo.UNAVAILABLE:return Tr.UNAVAILABLE;case Uo.UNAUTHENTICATED:return Tr.UNAUTHENTICATED;case Uo.INVALID_ARGUMENT:return Tr.INVALID_ARGUMENT;case Uo.NOT_FOUND:return Tr.NOT_FOUND;case Uo.ALREADY_EXISTS:return Tr.ALREADY_EXISTS;case Uo.PERMISSION_DENIED:return Tr.PERMISSION_DENIED;case Uo.FAILED_PRECONDITION:return Tr.FAILED_PRECONDITION;case Uo.ABORTED:return Tr.ABORTED;case Uo.OUT_OF_RANGE:return Tr.OUT_OF_RANGE;case Uo.UNIMPLEMENTED:return Tr.UNIMPLEMENTED;case Uo.DATA_LOSS:return Tr.DATA_LOSS;default:return Rr()}}(jo=Uo||(Uo={}))[jo.OK=0]="OK",jo[jo.CANCELLED=1]="CANCELLED",jo[jo.UNKNOWN=2]="UNKNOWN",jo[jo.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",jo[jo.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",jo[jo.NOT_FOUND=5]="NOT_FOUND",jo[jo.ALREADY_EXISTS=6]="ALREADY_EXISTS",jo[jo.PERMISSION_DENIED=7]="PERMISSION_DENIED",jo[jo.UNAUTHENTICATED=16]="UNAUTHENTICATED",jo[jo.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",jo[jo.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",jo[jo.ABORTED=10]="ABORTED",jo[jo.OUT_OF_RANGE=11]="OUT_OF_RANGE",jo[jo.UNIMPLEMENTED=12]="UNIMPLEMENTED",jo[jo.INTERNAL=13]="INTERNAL",jo[jo.UNAVAILABLE=14]="UNAVAILABLE",jo[jo.DATA_LOSS=15]="DATA_LOSS";var Ho=function(){function t(t,e){this.comparator=t,this.root=e||zo.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,zo.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,zo.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.inorderTraversal((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new Go(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new Go(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new Go(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new Go(this.root,t,this.comparator,!0)},t}(),Go=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),zo=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw Rr();if(this.right.isRed())throw Rr();var t=this.left.check();if(t!==this.right.check())throw Rr();return t+(this.isRed()?0:1)},t}();zo.EMPTY=null,zo.RED=!0,zo.BLACK=!1,zo.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new zo(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}());var Qo=function(){function t(t){this.comparator=t,this.data=new Ho(this.comparator)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new Yo(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new Yo(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),Yo=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),Xo=new Ho(ai.comparator);function $o(){return Xo}var Jo=new Ho(ai.comparator);function Zo(){return Jo}var ta=new Ho(ai.comparator);function ea(){return ta}var na=new Qo(ai.comparator);function ra(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=na,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var ia=new Qo(Mr);function oa(){return ia}var aa=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r=new Map;return r.set(e,sa.createSynthesizedTargetChangeForCurrentChange(e,n)),new t(qr.min(),r,oa(),$o(),ra())},t}(),sa=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(Yr.EMPTY_BYTE_STRING,n,ra(),ra(),ra())},t}(),ua=function(t,e,n,r){this.v=t,this.removedTargetIds=e,this.key=n,this.P=r},ca=function(t,e){this.targetId=t,this.V=e},ha=function(t,e,n,r){void 0===n&&(n=Yr.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},la=function(){function t(){this.S=0,this.D=pa(),this.C=Yr.EMPTY_BYTE_STRING,this.N=!1,this.k=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"F",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"$",{get:function(){return this.k},enumerable:!1,configurable:!0}),t.prototype.O=function(t){t.approximateByteSize()>0&&(this.k=!0,this.C=t)},t.prototype.M=function(){var t=ra(),e=ra(),n=ra();return this.D.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:Rr()}})),new sa(this.C,this.N,t,e,n)},t.prototype.L=function(){this.k=!1,this.D=pa()},t.prototype.B=function(t,e){this.k=!0,this.D=this.D.insert(t,e)},t.prototype.q=function(t){this.k=!0,this.D=this.D.remove(t)},t.prototype.U=function(){this.S+=1},t.prototype.K=function(){this.S-=1},t.prototype.j=function(){this.k=!0,this.N=!0},t}(),fa=function(){function t(t){this.W=t,this.G=new Map,this.H=$o(),this.J=da(),this.Y=new Qo(Mr)}return t.prototype.X=function(t){for(var e=0,n=t.v;e<n.length;e++){var r=n[e];t.P&&t.P.isFoundDocument()?this.Z(r,t.P):this.tt(r,t.key,t.P)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.tt(r,t.key,t.P)},t.prototype.et=function(t){var e=this;this.forEachTarget(t,(function(n){var r=e.nt(n);switch(t.state){case 0:e.st(n)&&r.O(t.resumeToken);break;case 1:r.K(),r.F||r.L(),r.O(t.resumeToken);break;case 2:r.K(),r.F||e.removeTarget(n);break;case 3:e.st(n)&&(r.j(),r.O(t.resumeToken));break;case 4:e.st(n)&&(e.it(n),r.O(t.resumeToken));break;default:Rr()}}))},t.prototype.forEachTarget=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.G.forEach((function(t,r){n.st(r)&&e(r)}))},t.prototype.rt=function(t){var e=t.targetId,n=t.V.count,r=this.ot(e);if(r){var i=r.target;if(Ai(i))if(0===n){var o=new ai(i.path);this.tt(e,o,Ti.newNoDocument(o,qr.min()))}else Dr(1===n);else this.ct(e)!==n&&(this.it(e),this.Y=this.Y.add(e))}},t.prototype.ut=function(t){var e=this,n=new Map;this.G.forEach((function(r,i){var o=e.ot(i);if(o){if(r.current&&Ai(o.target)){var a=new ai(o.target.path);null!==e.H.get(a)||e.at(i,a)||e.tt(i,a,Ti.newNoDocument(a,t))}r.$&&(n.set(i,r.M()),r.L())}}));var r=ra();this.J.forEach((function(t,n){var i=!0;n.forEachWhile((function(t){var n=e.ot(t);return!n||2===n.purpose||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new aa(t,n,this.Y,this.H,r);return this.H=$o(),this.J=da(),this.Y=new Qo(Mr),i},t.prototype.Z=function(t,e){if(this.st(t)){var n=this.at(t,e.key)?2:0;this.nt(t).B(e.key,n),this.H=this.H.insert(e.key,e),this.J=this.J.insert(e.key,this.ht(e.key).add(t))}},t.prototype.tt=function(t,e,n){if(this.st(t)){var r=this.nt(t);this.at(t,e)?r.B(e,1):r.q(e),this.J=this.J.insert(e,this.ht(e).delete(t)),n&&(this.H=this.H.insert(e,n))}},t.prototype.removeTarget=function(t){this.G.delete(t)},t.prototype.ct=function(t){var e=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.U=function(t){this.nt(t).U()},t.prototype.nt=function(t){var e=this.G.get(t);return e||(e=new la,this.G.set(t,e)),e},t.prototype.ht=function(t){var e=this.J.get(t);return e||(e=new Qo(Mr),this.J=this.J.insert(t,e)),e},t.prototype.st=function(t){var e=null!==this.ot(t);return e||kr("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.ot=function(t){var e=this.G.get(t);return e&&e.F?null:this.W.lt(t)},t.prototype.it=function(t){var e=this;this.G.set(t,new la),this.W.getRemoteKeysForTarget(t).forEach((function(n){e.tt(t,n,null)}))},t.prototype.at=function(t,e){return this.W.getRemoteKeysForTarget(t).has(e)},t}();function da(){return new Ho(ai.comparator)}function pa(){return new Ho(ai.comparator)}var va={asc:"ASCENDING",desc:"DESCENDING"},ga={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ya=function(t,e){this.databaseId=t,this.I=e};function ma(t,e){return t.I?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function _a(t,e){return t.I?e.toBase64():e.toUint8Array()}function ba(t,e){return ma(t,e.toTimestamp())}function wa(t){return Dr(!!t),qr.fromTimestamp(function(t){var e=$r(t);return new jr(e.seconds,e.nanos)}(t))}function Ia(t,e){return function(t){return new Hr(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function Ta(t){var e=Hr.fromString(t);return Dr(za(e)),e}function Ea(t,e){return Ia(t.databaseId,e.path)}function Sa(t,e){var n=Ta(e);if(n.get(1)!==t.databaseId.projectId)throw new Er(Tr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Er(Tr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ai(Na(n))}function Ca(t,e){return Ia(t.databaseId,e)}function ka(t){var e=Ta(t);return 4===e.length?Hr.emptyPath():Na(e)}function Aa(t){return new Hr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Na(t){return Dr(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function Pa(t,e,n){return{name:Ea(t,e),fields:n.value.mapValue.fields}}function Ra(t,e,n){var r=Sa(t,e.name),i=wa(e.updateTime),o=new wi({mapValue:{fields:e.fields}}),a=Ti.newFoundDocument(r,i,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function Da(t,e){var n;if(e instanceof xo)n={update:Pa(t,e.key,e.value)};else if(e instanceof qo)n={delete:Ea(t,e.key)};else if(e instanceof Oo)n={update:Pa(t,e.key,e.data),updateMask:Ga(e.fieldMask)};else{if(!(e instanceof Vo))return Rr();n={verify:Ea(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof vo)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof go)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof mo)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof bo)return{fieldPath:e.field.canonicalString(),increment:n.A};throw Rr()}(0,t)}))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:ba(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Rr()}(t,e.precondition)),n}function xa(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?So.updateTime(wa(t.updateTime)):void 0!==t.exists?So.exists(t.exists):So.none()}(e.currentDocument):So.none(),r=e.updateTransforms?e.updateTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)Dr("REQUEST_TIME"===e.setToServerValue),n=new vo;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new go(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new mo(i)}else"increment"in e?n=new bo(t,e.increment):Rr();var o=zr.fromServerFormat(e.fieldPath);return new To(o,n)}(t,e)})):[];if(e.update){e.update.name;var i=Sa(t,e.update.name),o=new wi({mapValue:{fields:e.update.fields}});if(e.updateMask){var a=function(t){var e=t.fieldPaths||[];return new Qr(e.map((function(t){return zr.fromServerFormat(t)})))}(e.updateMask);return new Oo(i,o,a,n,r)}return new xo(i,o,n,r)}if(e.delete){var s=Sa(t,e.delete);return new qo(s,n)}if(e.verify){var u=Sa(t,e.verify);return new Vo(u,n)}return Rr()}function Oa(t,e){return{documents:[Ca(t,e.path)]}}function La(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Ca(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Ca(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(mi(t.value))return{unaryFilter:{field:Ba(t.field),op:"IS_NAN"}};if(yi(t.value))return{unaryFilter:{field:Ba(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(mi(t.value))return{unaryFilter:{field:Ba(t.field),op:"IS_NOT_NAN"}};if(yi(t.value))return{unaryFilter:{field:Ba(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ba(t.field),op:Va(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:Ba(t.field),direction:qa(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var a=function(t,e){return t.I||ri(e)?e:{value:e}}(t,e.limit);return null!==a&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=Ua(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Ua(e.endAt)),n}function Ma(t){var e=ka(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Dr(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var a=[];n.where&&(a=Fa(n.where));var s=[];n.orderBy&&(s=n.orderBy.map((function(t){return function(t){return new qi(Ka(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var u=null;n.limit&&(u=function(t){var e;return ri(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=ja(n.startAt));var h=null;return n.endAt&&(h=ja(n.endAt)),Hi(e,i,s,a,u,"F",c,h)}function Fa(t){return t?void 0!==t.unaryFilter?[Ha(t)]:void 0!==t.fieldFilter?[Wa(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return Fa(t)})).reduce((function(t,e){return t.concat(e)})):Rr():[]}function Ua(t){return{before:t.before,values:t.position}}function ja(t){var e=!!t.before,n=t.values||[];return new Ui(n,e)}function qa(t){return va[t]}function Va(t){return ga[t]}function Ba(t){return{fieldPath:t.canonicalString()}}function Ka(t){return zr.fromServerFormat(t.fieldPath)}function Wa(t){return Ni.create(Ka(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Rr()}}(t.fieldFilter.op),t.fieldFilter.value)}function Ha(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Ka(t.unaryFilter.field);return Ni.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Ka(t.unaryFilter.field);return Ni.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Ka(t.unaryFilter.field);return Ni.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Ka(t.unaryFilter.field);return Ni.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Rr()}}function Ga(t){var e=[];return t.fields.forEach((function(t){return e.push(t.canonicalString())})),{fieldPaths:e}}function za(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}function Qa(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Xa(e)),e=Ya(t.get(n),e);return Xa(e)}function Ya(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}function Xa(t){return t+"\x01\x01"}function $a(t){var e=t.length;if(Dr(e>=2),2===e)return Dr("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),Hr.emptyPath();for(var n=e-2,r=[],i="",o=0;o<e;){var a=t.indexOf("\x01",o);switch((a<0||a>n)&&Rr(),t.charAt(a+1)){case"\x01":var s=t.substring(o,a),u=void 0;0===i.length?u=s:(u=i+=s,i=""),r.push(u);break;case"\x10":i+=t.substring(o,a),i+="\0";break;case"\x11":i+=t.substring(o,a+1);break;default:Rr()}o=a+2}return new Hr(r)}var Ja=function(t,e){this.seconds=t,this.nanoseconds=e},Za=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Za.store="owner",Za.key="owner";var ts=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};ts.store="mutationQueues",ts.keyPath="userId";var es=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};es.store="mutations",es.keyPath="batchId",es.userMutationsIndex="userMutationsIndex",es.userMutationsKeyPath=["userId","batchId"];var ns=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,Qa(e)]},t.key=function(t,e,n){return[t,Qa(e),n]},t}();ns.store="documentMutations",ns.PLACEHOLDER=new ns;var rs=function(t,e){this.path=t,this.readTime=e},is=function(t,e){this.path=t,this.version=e},os=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};os.store="remoteDocuments",os.readTimeIndex="readTimeIndex",os.readTimeIndexPath="readTime",os.collectionReadTimeIndex="collectionReadTimeIndex",os.collectionReadTimeIndexPath=["parentPath","readTime"];var as=function(t){this.byteSize=t};as.store="remoteDocumentGlobal",as.key="remoteDocumentGlobalKey";var ss=function(t,e,n,r,i,o,a){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=a};ss.store="targets",ss.keyPath="targetId",ss.queryTargetsIndexName="queryTargetsIndex",ss.queryTargetsKeyPath=["canonicalId","targetId"];var us=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};us.store="targetDocuments",us.keyPath=["targetId","path"],us.documentTargetsIndex="documentTargetsIndex",us.documentTargetsKeyPath=["path","targetId"];var cs=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};cs.key="targetGlobalKey",cs.store="targetGlobal";var hs=function(t,e){this.collectionId=t,this.parent=e};hs.store="collectionParents",hs.keyPath=["collectionId","parent"];var ls=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};ls.store="clientMetadata",ls.keyPath="clientId";var fs=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};fs.store="bundles",fs.keyPath="bundleId";var ds=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};ds.store="namedQueries",ds.keyPath="name";var ps=(0,i.__spreadArray)((0,i.__spreadArray)([],(0,i.__spreadArray)((0,i.__spreadArray)([],(0,i.__spreadArray)((0,i.__spreadArray)([],(0,i.__spreadArray)((0,i.__spreadArray)([],[ts.store,es.store,ns.store,os.store,ss.store,Za.store,cs.store,us.store]),[ls.store])),[as.store])),[hs.store])),[fs.store,ds.store]),vs="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",gs=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach((function(t){return t()}))},t}(),ys=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},ms=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)}),(function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&Rr(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}}))},t.prototype.toPromise=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.waitFor=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.waitFor(r)},t}(),_s=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ft=new ys,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){e.error?n.ft.reject(new Is(t,e.error)):n.ft.resolve()},this.transaction.onerror=function(e){var r=ks(e.target.error);n.ft.reject(new Is(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new Is(n,e)}},Object.defineProperty(t.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ft.reject(t),this.aborted||(kr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Es(e)},t}(),bs=function(){function t(e,n,r){this.name=e,this.version=n,this.wt=r,12.2===t._t((0,o.getUA)())&&Ar("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return kr("SimpleDb","Removing database:",t),Ss(window.indexedDB.deleteDatabase(t)).toPromise()},t.yt=function(){if("undefined"==typeof indexedDB)return!1;if(t.gt())return!0;var e=(0,o.getUA)(),n=t._t(e),r=0<n&&n<10,i=t.Et(e),a=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||a)},t.gt=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0})||void 0===t?void 0:t.Tt)},t.It=function(t,e){return t.store(e)},t._t=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Et=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.At=function(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,n=this;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(kr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new Is(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new Er(Tr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new Is(t,n))},i.onupgradeneeded=function(t){kr("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.wt.Rt(e,i.transaction,t.oldVersion,n.version).next((function(){kr("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(t){return n.bt(t)}),this.db)]}}))}))},t.prototype.vt=function(t){this.bt=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return(0,i.__awaiter)(this,void 0,void 0,(function(){var o,a,s,u,c;return(0,i.__generator)(this,(function(h){switch(h.label){case 0:o="readonly"===e,a=0,s=function(){var e,s,c,h,l;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:++a,i.label=1;case 1:return i.trys.push([1,4,,5]),[4,u.At(t)];case 2:return u.db=i.sent(),e=_s.open(u.db,t,o?"readonly":"readwrite",n),s=r(e).catch((function(t){return e.abort(t),ms.reject(t)})).toPromise(),c={},s.catch((function(){})),[4,e.dt];case 3:return[2,(c.value=(i.sent(),s),c)];case 4:return h=i.sent(),l="FirebaseError"!==h.name&&a<3,kr("SimpleDb","Transaction failed with error:",h.message,"Retrying:",l),u.close(),l?[3,5]:[2,{value:Promise.reject(h)}];case 5:return[2]}}))},u=this,h.label=1;case 1:return[5,s()];case 2:if("object"==typeof(c=h.sent()))return[2,c.value];h.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),ws=function(){function t(t){this.Pt=t,this.Vt=!1,this.St=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Pt=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Vt=!0},t.prototype.Ct=function(t){this.St=t},t.prototype.delete=function(){return Ss(this.Pt.delete())},t}(),Is=function(t){function e(e,n){var r=this;return(r=t.call(this,Tr.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return(0,i.__extends)(e,t),e}(Er);function Ts(t){return"IndexedDbTransactionError"===t.name}var Es=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(kr("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(kr("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Ss(n)},t.prototype.add=function(t){return kr("SimpleDb","ADD",this.store.name,t,t),Ss(this.store.add(t))},t.prototype.get=function(t){var e=this;return Ss(this.store.get(t)).next((function(n){return void 0===n&&(n=null),kr("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return kr("SimpleDb","DELETE",this.store.name,t),Ss(this.store.delete(t))},t.prototype.count=function(){return kr("SimpleDb","COUNT",this.store.name),Ss(this.store.count())},t.prototype.Nt=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.xt(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.kt=function(t,e){kr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.Ft=!1;var r=this.cursor(n);return this.xt(r,(function(t,e,n){return n.delete()}))},t.prototype.$t=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.xt(r,e)},t.prototype.Ot=function(t){var e=this.cursor({});return new ms((function(n,r){e.onerror=function(t){var e=ks(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.xt=function(t,e){var n=[];return new ms((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new ws(i),a=e(i.primaryKey,i.value,o);if(a instanceof ms){var s=a.catch((function(t){return o.done(),ms.reject(t)}));n.push(s)}o.isDone?r():null===o.Dt?i.continue():i.continue(o.Dt)}else r()}})).next((function(){return ms.waitFor(n)}))},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.Ft?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Ss(t){return new ms((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=ks(t.target.error);n(e)}}))}var Cs=!1;function ks(t){var e=bs._t((0,o.getUA)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new Er("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Cs||(Cs=!0,setTimeout((function(){throw r}),0)),r}}return t}var As=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Mt=e,r.currentSequenceNumber=n,r}return(0,i.__extends)(e,t),e}(gs);function Ns(t,e){var n=xr(t);return bs.It(n.Mt,e)}var Ps=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}return t.prototype.applyToRemoteDocument=function(t,e){for(var n=e.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t.key)&&Ao(i,t,n[r])}},t.prototype.applyToLocalView=function(t){for(var e=0,n=this.baseMutations;e<n.length;e++)(o=n[e]).key.isEqual(t.key)&&No(o,t,this.localWriteTime);for(var r=0,i=this.mutations;r<i.length;r++){var o;(o=i[r]).key.isEqual(t.key)&&No(o,t,this.localWriteTime)}},t.prototype.applyToLocalDocumentSet=function(t){var e=this;this.mutations.forEach((function(n){var r=t.get(n.key),i=r;e.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(qr.min())}))},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),ra())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&Fr(this.mutations,t.mutations,(function(t,e){return Ro(t,e)}))&&Fr(this.baseMutations,t.baseMutations,(function(t,e){return Ro(t,e)}))},t}(),Rs=function(){function t(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}return t.from=function(e,n,r){Dr(e.mutations.length===r.length);for(var i=ea(),o=e.mutations,a=0;a<o.length;a++)i=i.insert(o[a].key,r[a].version);return new t(e,n,r,i)},t}(),Ds=function(){function t(t,e,n,r,i,o,a){void 0===i&&(i=qr.min()),void 0===o&&(o=qr.min()),void 0===a&&(a=Yr.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t}(),xs=function(t){this.Lt=t};function Os(t,e){if(e.document)return Ra(t.Lt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=ai.fromSegments(e.noDocument.path),r=js(e.noDocument.readTime),i=Ti.newNoDocument(n,r);return e.hasCommittedMutations?i.setHasCommittedMutations():i}if(e.unknownDocument){var o=ai.fromSegments(e.unknownDocument.path);return r=js(e.unknownDocument.version),Ti.newUnknownDocument(o,r)}return Rr()}function Ls(t,e,n){var r=Ms(n),i=e.key.path.popLast().toArray();if(e.isFoundDocument()){var o=function(t,e){return{name:Ea(t,e.key),fields:e.data.value.mapValue.fields,updateTime:ma(t,e.version.toTimestamp())}}(t.Lt,e),a=e.hasCommittedMutations;return new os(null,null,o,a,r,i)}if(e.isNoDocument()){var s=e.key.path.toArray(),u=Us(e.version);return a=e.hasCommittedMutations,new os(null,new rs(s,u),null,a,r,i)}if(e.isUnknownDocument()){var c=e.key.path.toArray(),h=Us(e.version);return new os(new is(c,h),null,null,!0,r,i)}return Rr()}function Ms(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Fs(t){var e=new jr(t[0],t[1]);return qr.fromTimestamp(e)}function Us(t){var e=t.toTimestamp();return new Ja(e.seconds,e.nanoseconds)}function js(t){var e=new jr(t.seconds,t.nanoseconds);return qr.fromTimestamp(e)}function qs(t,e){for(var n=(e.baseMutations||[]).map((function(e){return xa(t.Lt,e)})),r=0;r<e.mutations.length-1;++r){var i=e.mutations[r];if(r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform){var o=e.mutations[r+1];i.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(r+1,1),++r}}var a=e.mutations.map((function(e){return xa(t.Lt,e)})),s=jr.fromMillis(e.localWriteTimeMs);return new Ps(e.batchId,s,n,a)}function Vs(t){var e,n,r=js(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?js(t.lastLimboFreeSnapshotVersion):qr.min();return void 0!==t.query.documents?(Dr(1===(n=t.query).documents.length),e=Zi(Gi(ka(n.documents[0])))):e=function(t){return Zi(Ma(t))}(t.query),new Ds(e,t.targetId,0,t.lastListenSequenceNumber,r,i,Yr.fromBase64String(t.resumeToken))}function Bs(t,e){var n,r=Us(e.snapshotVersion),i=Us(e.lastLimboFreeSnapshotVersion);n=Ai(e.target)?Oa(t.Lt,e.target):La(t.Lt,e.target);var o=e.resumeToken.toBase64();return new ss(e.targetId,Ci(e.target),r,o,e.sequenceNumber,i,n)}function Ks(t){var e=Ma({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?to(e,e.limit,"L"):e}var Ws=function(){function t(){}return t.prototype.getBundleMetadata=function(t,e){return Hs(t).get(e).next((function(t){if(t)return{id:(e=t).bundleId,createTime:js(e.createTime),version:e.version};var e}))},t.prototype.saveBundleMetadata=function(t,e){return Hs(t).put({bundleId:(n=e).id,createTime:Us(wa(n.createTime)),version:n.version});var n},t.prototype.getNamedQuery=function(t,e){return Gs(t).get(e).next((function(t){if(t)return{name:(e=t).name,query:Ks(e.bundledQuery),readTime:js(e.readTime)};var e}))},t.prototype.saveNamedQuery=function(t,e){return Gs(t).put(function(t){return{name:t.name,readTime:Us(wa(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function Hs(t){return Ns(t,fs.store)}function Gs(t){return Ns(t,ds.store)}var zs=function(){function t(){this.Bt=new Qs}return t.prototype.addToCollectionParentIndex=function(t,e){return this.Bt.add(e),ms.resolve()},t.prototype.getCollectionParents=function(t,e){return ms.resolve(this.Bt.getEntries(e))},t}(),Qs=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new Qo(Hr.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new Qo(Hr.comparator)).toArray()},t}(),Ys=function(){function t(){this.qt=new Qs}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(!this.qt.has(e)){var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener((function(){n.qt.add(e)}));var o={collectionId:r,parent:Qa(i)};return Xs(t).put(o)}return ms.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[Ur(e),""],!1,!0);return Xs(t).Nt(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push($a(o.parent))}return n}))},t}();function Xs(t){return Ns(t,hs.store)}var $s={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Js=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t}();function Zs(t,e,n){var r=t.store(es.store),i=t.store(ns.store),o=[],a=IDBKeyRange.only(n.batchId),s=0,u=r.$t({range:a},(function(t,e,n){return s++,n.delete()}));o.push(u.next((function(){Dr(1===s)})));for(var c=[],h=0,l=n.mutations;h<l.length;h++){var f=l[h],d=ns.key(e,f.key.path,n.batchId);o.push(i.delete(d)),c.push(f.key)}return ms.waitFor(o).next((function(){return c}))}function tu(t){if(!t)return 0;var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Rr();e=t.noDocument}return JSON.stringify(e).length}Js.DEFAULT_COLLECTION_PERCENTILE=10,Js.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Js.DEFAULT=new Js(41943040,Js.DEFAULT_COLLECTION_PERCENTILE,Js.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Js.DISABLED=new Js(-1,0,0);var eu=function(){function t(t,e,n,r){this.userId=t,this.R=e,this.Ut=n,this.referenceDelegate=r,this.Kt={}}return t.Qt=function(e,n,r,i){return Dr(""!==e.uid),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ru(t).$t({index:es.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=iu(t),a=ru(t);return a.add({}).next((function(s){Dr("number"==typeof s);for(var u=new Ps(s,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return Da(t.Lt,e)})),i=n.mutations.map((function(e){return Da(t.Lt,e)}));return new es(e,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.R,i.userId,u),h=[],l=new Qo((function(t,e){return Mr(t.canonicalString(),e.canonicalString())})),f=0,d=r;f<d.length;f++){var p=d[f],v=ns.key(i.userId,p.key.path,s);l=l.add(p.key.path.popLast()),h.push(a.put(c)),h.push(o.put(v,ns.PLACEHOLDER))}return l.forEach((function(e){h.push(i.Ut.addToCollectionParentIndex(t,e))})),t.addOnCommittedListener((function(){i.Kt[s]=u.keys()})),ms.waitFor(h).next((function(){return u}))}))},t.prototype.lookupMutationBatch=function(t,e){var n=this;return ru(t).get(e).next((function(t){return t?(Dr(t.userId===n.userId),qs(n.R,t)):null}))},t.prototype.jt=function(t,e){var n=this;return this.Kt[e]?ms.resolve(this.Kt[e]):this.lookupMutationBatch(t,e).next((function(t){if(t){var r=t.keys();return n.Kt[e]=r,r}return null}))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return ru(t).$t({index:es.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(Dr(e.batchId>=r),o=qs(n.R,e)),i.done()})).next((function(){return o}))},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return ru(t).$t({index:es.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ru(t).Nt(es.userMutationsIndex,n).next((function(t){return t.map((function(t){return qs(e.R,t)}))}))},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=ns.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return iu(t).$t({range:i},(function(r,i,a){var s=r[0],u=r[1],c=r[2],h=$a(u);if(s===n.userId&&e.path.isEqual(h))return ru(t).get(c).next((function(t){if(!t)throw Rr();Dr(t.userId===n.userId),o.push(qs(n.R,t))}));a.done()})).next((function(){return o}))},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Qo(Mr),i=[];return e.forEach((function(e){var o=ns.prefixForPath(n.userId,e.path),a=IDBKeyRange.lowerBound(o),s=iu(t).$t({range:a},(function(t,i,o){var a=t[0],s=t[1],u=t[2],c=$a(s);a===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()}));i.push(s)})),ms.waitFor(i).next((function(){return n.Wt(t,r)}))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=ns.prefixForPath(this.userId,r),a=IDBKeyRange.lowerBound(o),s=new Qo(Mr);return iu(t).$t({range:a},(function(t,e,o){var a=t[0],u=t[1],c=t[2],h=$a(u);a===n.userId&&r.isPrefixOf(h)?h.length===i&&(s=s.add(c)):o.done()})).next((function(){return n.Wt(t,s)}))},t.prototype.Wt=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(ru(t).get(e).next((function(t){if(null===t)throw Rr();Dr(t.userId===n.userId),r.push(qs(n.R,t))})))})),ms.waitFor(i).next((function(){return r}))},t.prototype.removeMutationBatch=function(t,e){var n=this;return Zs(t.Mt,this.userId,e).next((function(r){return t.addOnCommittedListener((function(){n.Gt(e.batchId)})),ms.forEach(r,(function(e){return n.referenceDelegate.markPotentiallyOrphaned(t,e)}))}))},t.prototype.Gt=function(t){delete this.Kt[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next((function(n){if(!n)return ms.resolve();var r=IDBKeyRange.lowerBound(ns.prefixForUser(e.userId)),i=[];return iu(t).$t({range:r},(function(t,n,r){if(t[0]===e.userId){var o=$a(t[1]);i.push(o)}else r.done()})).next((function(){Dr(0===i.length)}))}))},t.prototype.containsKey=function(t,e){return nu(t,this.userId,e)},t.prototype.zt=function(t){var e=this;return ou(t).get(this.userId).next((function(t){return t||new ts(e.userId,-1,"")}))},t}();function nu(t,e,n){var r=ns.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),a=!1;return iu(t).$t({range:o,Ft:!0},(function(t,n,r){var o=t[0],s=t[1];t[2],o===e&&s===i&&(a=!0),r.done()})).next((function(){return a}))}function ru(t){return Ns(t,es.store)}function iu(t){return Ns(t,ns.store)}function ou(t){return Ns(t,ts.store)}var au=function(){function t(t){this.Ht=t}return t.prototype.next=function(){return this.Ht+=2,this.Ht},t.Jt=function(){return new t(0)},t.Yt=function(){return new t(-1)},t}(),su=function(){function t(t,e){this.referenceDelegate=t,this.R=e}return t.prototype.allocateTargetId=function(t){var e=this;return this.Xt(t).next((function(n){var r=new au(n.highestTargetId);return n.highestTargetId=r.next(),e.Zt(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.Xt(t).next((function(t){return qr.fromTimestamp(new jr(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.getHighestSequenceNumber=function(t){return this.Xt(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.Xt(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Zt(t,i)}))},t.prototype.addTargetData=function(t,e){var n=this;return this.te(t,e).next((function(){return n.Xt(t).next((function(r){return r.targetCount+=1,n.ee(e,r),n.Zt(t,r)}))}))},t.prototype.updateTargetData=function(t,e){return this.te(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next((function(){return uu(t).delete(e.targetId)})).next((function(){return n.Xt(t)})).next((function(e){return Dr(e.targetCount>0),e.targetCount-=1,n.Zt(t,e)}))},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return uu(t).$t((function(a,s){var u=Vs(s);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))})).next((function(){return ms.waitFor(o)})).next((function(){return i}))},t.prototype.forEachTarget=function(t,e){return uu(t).$t((function(t,n){var r=Vs(n);e(r)}))},t.prototype.Xt=function(t){return cu(t).get(cs.key).next((function(t){return Dr(null!==t),t}))},t.prototype.Zt=function(t,e){return cu(t).put(cs.key,e)},t.prototype.te=function(t,e){return uu(t).put(Bs(this.R,e))},t.prototype.ee=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.Xt(t).next((function(t){return t.targetCount}))},t.prototype.getTargetData=function(t,e){var n=Ci(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return uu(t).$t({range:r,index:ss.queryTargetsIndexName},(function(t,n,r){var o=Vs(n);ki(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=hu(t);return e.forEach((function(e){var a=Qa(e.path);i.push(o.put(new us(n,a))),i.push(r.referenceDelegate.addReference(t,n,e))})),ms.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=hu(t);return ms.forEach(e,(function(e){var o=Qa(e.path);return ms.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,n,e)])}))},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=hu(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=hu(t),i=ra();return r.$t({range:n,Ft:!0},(function(t,e,n){var r=$a(t[1]),o=new ai(r);i=i.add(o)})).next((function(){return i}))},t.prototype.containsKey=function(t,e){var n=Qa(e.path),r=IDBKeyRange.bound([n],[Ur(n)],!1,!0),i=0;return hu(t).$t({index:us.documentTargetsIndex,Ft:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.lt=function(t,e){return uu(t).get(e).next((function(t){return t?Vs(t):null}))},t}();function uu(t){return Ns(t,ss.store)}function cu(t){return Ns(t,cs.store)}function hu(t){return Ns(t,us.store)}function lu(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){if(t.code!==Tr.FAILED_PRECONDITION||t.message!==vs)throw t;return kr("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}function fu(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],a=Mr(n,i);return 0===a?Mr(r,o):a}var du=function(){function t(t){this.ne=t,this.buffer=new Qo(fu),this.se=0}return t.prototype.ie=function(){return++this.se},t.prototype.re=function(t){var e=[t,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();fu(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),pu=function(){function t(t,e){this.garbageCollector=t,this.asyncQueue=e,this.oe=!1,this.ce=null}return t.prototype.start=function(t){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ue(t)},t.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),t.prototype.ue=function(t){var e=this,n=this.oe?3e5:6e4;kr("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,(function(){return(0,i.__awaiter)(e,void 0,void 0,(function(){var e;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:this.ce=null,this.oe=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return Ts(e=n.sent())?(kr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,lu(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.ue(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),vu=function(){function t(t,e){this.ae=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.ae.he(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return ms.resolve(Ir.o);var r=new du(e);return this.ae.forEachTarget(t,(function(t){return r.re(t.sequenceNumber)})).next((function(){return n.ae.le(t,(function(t){return r.re(t)}))})).next((function(){return r.maxValue}))},t.prototype.removeTargets=function(t,e,n){return this.ae.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.ae.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(kr("LruGarbageCollector","Garbage collection skipped; disabled"),ms.resolve($s)):this.getCacheSize(t).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(kr("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),$s):n.fe(t,e)}))},t.prototype.getCacheSize=function(t){return this.ae.getCacheSize(t)},t.prototype.fe=function(t,e){var n,r,i,o,s,u,c,h=this,l=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((function(e){return e>h.params.maximumSequenceNumbersToCollect?(kr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.maximumSequenceNumbersToCollect+" from "+e),r=h.params.maximumSequenceNumbersToCollect):r=e,o=Date.now(),h.nthSequenceNumber(t,r)})).next((function(r){return n=r,s=Date.now(),h.removeTargets(t,n,e)})).next((function(e){return i=e,u=Date.now(),h.removeOrphanedDocuments(t,n)})).next((function(t){return c=Date.now(),Cr()<=a.LogLevel.DEBUG&&kr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-l)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(u-s)+"ms\n\tRemoved "+t+" documents in "+(c-u)+"ms\nTotal Duration: "+(c-l)+"ms"),ms.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})}))},t}(),gu=function(){function t(t,e){this.db=t,this.garbageCollector=function(t,e){return new vu(t,e)}(this,e)}return t.prototype.he=function(t){var e=this.de(t);return this.db.getTargetCache().getTargetCount(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.de=function(t){var e=0;return this.le(t,(function(t){e++})).next((function(){return e}))},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.le=function(t,e){return this.we(t,(function(t,n){return e(n)}))},t.prototype.addReference=function(t,e,n){return yu(t,n)},t.prototype.removeReference=function(t,e,n){return yu(t,n)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.markPotentiallyOrphaned=function(t,e){return yu(t,e)},t.prototype._e=function(t,e){return function(t,e){var n=!1;return ou(t).Ot((function(r){return nu(t,r,e).next((function(t){return t&&(n=!0),ms.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.we(t,(function(a,s){if(s<=e){var u=n._e(t,a).next((function(e){if(!e)return o++,r.getEntry(t,a).next((function(){return r.removeEntry(a),hu(t).delete([0,Qa(a.path)])}))}));i.push(u)}})).next((function(){return ms.waitFor(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return yu(t,e)},t.prototype.we=function(t,e){var n,r=hu(t),i=Ir.o;return r.$t({index:us.documentTargetsIndex},(function(t,r){var o=t[0];t[1];var a=r.path,s=r.sequenceNumber;0===o?(i!==Ir.o&&e(new ai($a(n)),i),i=s,n=a):i=Ir.o})).next((function(){i!==Ir.o&&e(new ai($a(n)),i)}))},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function yu(t,e){return hu(t).put(function(t,e){return new us(0,Qa(t.path),e)}(e,t.currentSequenceNumber))}var mu=function(){function t(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];if(this.equalsFn(a,t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){Br(this.inner,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];t(a,s)}}))},t.prototype.isEmpty=function(){return Kr(this.inner)},t}(),_u=function(){function t(){this.changes=new mu((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.changesApplied=!1}return t.prototype.getReadTime=function(t){var e=this.changes.get(t);return e?e.readTime:qr.min()},t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})},t.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{document:Ti.newInvalidDocument(t),readTime:e})},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?ms.resolve(n.document):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){},t}(),bu=function(){function t(t,e){this.R=t,this.Ut=e}return t.prototype.addEntry=function(t,e,n){return Tu(t).put(Eu(e),n)},t.prototype.removeEntry=function(t,e){var n=Tu(t),r=Eu(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.me(t,r)}))},t.prototype.getEntry=function(t,e){var n=this;return Tu(t).get(Eu(e)).next((function(t){return n.ye(e,t)}))},t.prototype.ge=function(t,e){var n=this;return Tu(t).get(Eu(e)).next((function(t){return{document:n.ye(e,t),size:tu(t)}}))},t.prototype.getEntries=function(t,e){var n=this,r=$o();return this.pe(t,e,(function(t,e){var i=n.ye(t,e);r=r.insert(t,i)})).next((function(){return r}))},t.prototype.Ee=function(t,e){var n=this,r=$o(),i=new Ho(ai.comparator);return this.pe(t,e,(function(t,e){var o=n.ye(t,e);r=r.insert(t,o),i=i.insert(t,tu(e))})).next((function(){return{documents:r,Te:i}}))},t.prototype.pe=function(t,e,n){if(e.isEmpty())return ms.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return Tu(t).$t({range:r},(function(t,e,r){for(var a=ai.fromSegments(t);o&&ai.comparator(o,a)<0;)n(o,null),o=i.getNext();o&&o.isEqual(a)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.Ct(o.path.toArray()):r.done()})).next((function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this,i=$o(),o=e.path.length+1,a={};if(n.isEqual(qr.min())){var s=e.path.toArray();a.range=IDBKeyRange.lowerBound(s)}else{var u=e.path.toArray(),c=Ms(n);a.range=IDBKeyRange.lowerBound([u,c],!0),a.index=os.collectionReadTimeIndex}return Tu(t).$t(a,(function(t,n,a){if(t.length===o){var s=Os(r.R,n);e.path.isPrefixOf(s.key.path)?io(e,s)&&(i=i.insert(s.key,s)):a.done()}})).next((function(){return i}))},t.prototype.newChangeBuffer=function(t){return new wu(this,!!t&&t.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return Iu(t).get(as.key).next((function(t){return Dr(!!t),t}))},t.prototype.me=function(t,e){return Iu(t).put(as.key,e)},t.prototype.ye=function(t,e){if(e){var n=Os(this.R,e);if(!n.isNoDocument()||!n.version.isEqual(qr.min()))return n}return Ti.newInvalidDocument(t)},t}(),wu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Ie=e,r.trackRemovals=n,r.Ae=new mu((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return(0,i.__extends)(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new Qo((function(t,e){return Mr(t.canonicalString(),e.canonicalString())}));return this.changes.forEach((function(o,a){var s=e.Ae.get(o);if(a.document.isValidDocument()){var u=Ls(e.Ie.R,a.document,e.getReadTime(o));i=i.add(o.path.popLast());var c=tu(u);r+=c-s,n.push(e.Ie.addEntry(t,o,u))}else if(r-=s,e.trackRemovals){var h=Ls(e.Ie.R,Ti.newNoDocument(o,qr.min()),e.getReadTime(o));n.push(e.Ie.addEntry(t,o,h))}else n.push(e.Ie.removeEntry(t,o))})),i.forEach((function(r){n.push(e.Ie.Ut.addToCollectionParentIndex(t,r))})),n.push(this.Ie.updateMetadata(t,r)),ms.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.Ie.ge(t,e).next((function(t){return n.Ae.set(e,t.size),t.document}))},e.prototype.getAllFromCache=function(t,e){var n=this;return this.Ie.Ee(t,e).next((function(t){var e=t.documents;return t.Te.forEach((function(t,e){n.Ae.set(t,e)})),e}))},e}(_u);function Iu(t){return Ns(t,as.store)}function Tu(t){return Ns(t,os.store)}function Eu(t){return t.path.toArray()}var Su=function(){function t(t){this.R=t}return t.prototype.Rt=function(t,e,n,r){var i=this;Dr(n<r&&n>=0&&r<=11);var o=new _s("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(Za.store)}(t),function(t){t.createObjectStore(ts.store,{keyPath:ts.keyPath}),t.createObjectStore(es.store,{keyPath:es.keyPath,autoIncrement:!0}).createIndex(es.userMutationsIndex,es.userMutationsKeyPath,{unique:!0}),t.createObjectStore(ns.store)}(t),Cu(t),function(t){t.createObjectStore(os.store)}(t));var a=ms.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(us.store),t.deleteObjectStore(ss.store),t.deleteObjectStore(cs.store)}(t),Cu(t)),a=a.next((function(){return function(t){var e=t.store(cs.store),n=new cs(0,0,qr.min().toTimestamp(),0);return e.put(cs.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(a=a.next((function(){return function(t,e){return e.store(es.store).Nt().next((function(n){t.deleteObjectStore(es.store),t.createObjectStore(es.store,{keyPath:es.keyPath,autoIncrement:!0}).createIndex(es.userMutationsIndex,es.userMutationsKeyPath,{unique:!0});var r=e.store(es.store),i=n.map((function(t){return r.put(t)}));return ms.waitFor(i)}))}(t,o)}))),a=a.next((function(){!function(t){t.createObjectStore(ls.store,{keyPath:ls.keyPath})}(t)}))),n<5&&r>=5&&(a=a.next((function(){return i.Re(o)}))),n<6&&r>=6&&(a=a.next((function(){return function(t){t.createObjectStore(as.store)}(t),i.be(o)}))),n<7&&r>=7&&(a=a.next((function(){return i.ve(o)}))),n<8&&r>=8&&(a=a.next((function(){return i.Pe(t,o)}))),n<9&&r>=9&&(a=a.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(os.store);e.createIndex(os.readTimeIndex,os.readTimeIndexPath,{unique:!1}),e.createIndex(os.collectionReadTimeIndex,os.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(a=a.next((function(){return i.Ve(o)}))),n<11&&r>=11&&(a=a.next((function(){!function(t){t.createObjectStore(fs.store,{keyPath:fs.keyPath})}(t),function(t){t.createObjectStore(ds.store,{keyPath:ds.keyPath})}(t)}))),a},t.prototype.be=function(t){var e=0;return t.store(os.store).$t((function(t,n){e+=tu(n)})).next((function(){var n=new as(e);return t.store(as.store).put(as.key,n)}))},t.prototype.Re=function(t){var e=this,n=t.store(ts.store),r=t.store(es.store);return n.Nt().next((function(n){return ms.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Nt(es.userMutationsIndex,i).next((function(r){return ms.forEach(r,(function(r){Dr(r.userId===n.userId);var i=qs(e.R,r);return Zs(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ve=function(t){var e=t.store(us.store),n=t.store(os.store);return t.store(cs.store).get(cs.key).next((function(t){var r=[];return n.$t((function(n,i){var o=new Hr(n),a=function(t){return[0,Qa(t)]}(o);r.push(e.get(a).next((function(n){return n?ms.resolve():function(n){return e.put(new us(0,Qa(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return ms.waitFor(r)}))}))},t.prototype.Pe=function(t,e){t.createObjectStore(hs.store,{keyPath:hs.keyPath});var n=e.store(hs.store),r=new Qs,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:Qa(i)})}};return e.store(os.store).$t({Ft:!0},(function(t,e){var n=new Hr(t);return i(n.popLast())})).next((function(){return e.store(ns.store).$t({Ft:!0},(function(t,e){t[0];var n=t[1];t[2];var r=$a(n);return i(r.popLast())}))}))},t.prototype.Ve=function(t){var e=this,n=t.store(ss.store);return n.$t((function(t,r){var i=Vs(r),o=Bs(e.R,i);return n.put(o)}))},t}();function Cu(t){t.createObjectStore(us.store,{keyPath:us.keyPath}).createIndex(us.documentTargetsIndex,us.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(ss.store,{keyPath:ss.keyPath}).createIndex(ss.queryTargetsIndexName,ss.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(cs.store)}var ku="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Au=function(){function t(e,n,r,i,o,a,s,u,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=a,this.document=s,this.De=c,this.Ce=h,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ke=null,this.inForeground=!1,this.Fe=null,this.$e=null,this.Oe=Number.NEGATIVE_INFINITY,this.Me=function(t){return Promise.resolve()},!t.yt())throw new Er(Tr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new gu(this,i),this.Le=n+"main",this.R=new xs(u),this.Be=new bs(this.Le,11,new Su(this.R)),this.qe=new su(this.referenceDelegate,this.R),this.Ut=new Ys,this.Ue=function(t,e){return new bu(t,e)}(this.R,this.Ut),this.Ke=new Ws,this.window&&this.window.localStorage?this.Qe=this.window.localStorage:(this.Qe=null,!1===h&&Ar("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.je().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new Er(Tr.FAILED_PRECONDITION,ku);return t.We(),t.Ge(),t.ze(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.qe.getHighestSequenceNumber(e)}))})).then((function(e){t.Ne=new Ir(e,t.De)})).then((function(){t.xe=!0})).catch((function(e){return t.Be&&t.Be.close(),Promise.reject(e)}))},t.prototype.He=function(t){var e=this;return this.Me=function(n){return(0,i.__awaiter)(e,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){return this.started?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.Be.vt((function(n){return(0,i.__awaiter)(e,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Se.enqueueAndForget((function(){return(0,i.__awaiter)(e,void 0,void 0,(function(){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.je=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return Pu(e).put(new ls(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.Je(e).next((function(e){e||(t.isPrimary=!1,t.Se.enqueueRetryable((function(){return t.Me(!1)})))}))})).next((function(){return t.Ye(e)})).next((function(n){return t.isPrimary&&!n?t.Xe(e).next((function(){return!1})):!!n&&t.Ze(e).next((function(){return!0}))}))})).catch((function(e){if(Ts(e))return kr("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return kr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Se.enqueueRetryable((function(){return t.Me(e)})),t.isPrimary=e}))},t.prototype.Je=function(t){var e=this;return Nu(t).get(Za.key).next((function(t){return ms.resolve(e.tn(t))}))},t.prototype.en=function(t){return Pu(t).delete(this.clientId)},t.prototype.nn=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t,e,n,r,o=this;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return!this.isPrimary||this.sn(this.Oe,18e5)?[3,2]:(this.Oe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(t){var e=Ns(t,ls.store);return e.Nt().next((function(t){var n=o.rn(t,18e5),r=t.filter((function(t){return-1===n.indexOf(t)}));return ms.forEach(r,(function(t){return e.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(t=i.sent(),this.Qe)for(e=0,n=t;e<n.length;e++)r=n[e],this.Qe.removeItem(this.on(r.clientId));i.label=2;case 2:return[2]}}))}))},t.prototype.ze=function(){var t=this;this.$e=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,(function(){return t.je().then((function(){return t.nn()})).then((function(){return t.ze()}))}))},t.prototype.tn=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Ye=function(t){var e=this;return this.Ce?ms.resolve(!0):Nu(t).get(Za.key).next((function(n){if(null!==n&&e.sn(n.leaseTimestampMs,5e3)&&!e.cn(n.ownerId)){if(e.tn(n)&&e.networkEnabled)return!0;if(!e.tn(n)){if(!n.allowTabSynchronization)throw new Er(Tr.FAILED_PRECONDITION,ku);return!1}}return!(!e.networkEnabled||!e.inForeground)||Pu(t).Nt().next((function(t){return void 0===e.rn(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&kr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.shutdown=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t=this;return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return this.xe=!1,this.un(),this.$e&&(this.$e.cancel(),this.$e=null),this.an(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[Za.store,ls.store],(function(e){var n=new As(e,Ir.o);return t.Xe(n).next((function(){return t.en(n)}))}))];case 1:return e.sent(),this.Be.close(),this.ln(),[2]}}))}))},t.prototype.rn=function(t,e){var n=this;return t.filter((function(t){return n.sn(t.updateTimeMs,e)&&!n.cn(t.clientId)}))},t.prototype.fn=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return Pu(e).Nt().next((function(e){return t.rn(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.getMutationQueue=function(t){return eu.Qt(t,this.R,this.Ut,this.referenceDelegate)},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r=this;kr("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.Be.runTransaction(t,o,ps,(function(o){return i=new As(o,r.Ne?r.Ne.next():Ir.o),"readwrite-primary"===e?r.Je(i).next((function(t){return!!t||r.Ye(i)})).next((function(e){if(!e)throw Ar("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.Se.enqueueRetryable((function(){return r.Me(!1)})),new Er(Tr.FAILED_PRECONDITION,vs);return n(i)})).next((function(t){return r.Ze(i).next((function(){return t}))})):r.dn(i).next((function(){return n(i)}))})).then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.dn=function(t){var e=this;return Nu(t).get(Za.key).next((function(t){if(null!==t&&e.sn(t.leaseTimestampMs,5e3)&&!e.cn(t.ownerId)&&!e.tn(t)&&!(e.Ce||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Er(Tr.FAILED_PRECONDITION,ku)}))},t.prototype.Ze=function(t){var e=new Za(this.clientId,this.allowTabSynchronization,Date.now());return Nu(t).put(Za.key,e)},t.yt=function(){return bs.yt()},t.prototype.Xe=function(t){var e=this,n=Nu(t);return n.get(Za.key).next((function(t){return e.tn(t)?(kr("IndexedDbPersistence","Releasing primary lease."),n.delete(Za.key)):ms.resolve()}))},t.prototype.sn=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(Ar("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.We=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Fe=function(){t.Se.enqueueAndForget((function(){return t.inForeground="visible"===t.document.visibilityState,t.je()}))},this.document.addEventListener("visibilitychange",this.Fe),this.inForeground="visible"===this.document.visibilityState)},t.prototype.an=function(){this.Fe&&(this.document.removeEventListener("visibilitychange",this.Fe),this.Fe=null)},t.prototype.Ge=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.ke=function(){e.un(),(0,o.isSafari)()&&navigator.appVersion.match("Version/14")&&e.Se.enterRestrictedMode(!0),e.Se.enqueueAndForget((function(){return e.shutdown()}))},this.window.addEventListener("pagehide",this.ke))},t.prototype.hn=function(){this.ke&&(this.window.removeEventListener("pagehide",this.ke),this.ke=null)},t.prototype.cn=function(t){var e;try{var n=null!==(null===(e=this.Qe)||void 0===e?void 0:e.getItem(this.on(t)));return kr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Ar("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.un=function(){if(this.Qe)try{this.Qe.setItem(this.on(this.clientId),String(Date.now()))}catch(t){Ar("Failed to set zombie client id.",t)}},t.prototype.ln=function(){if(this.Qe)try{this.Qe.removeItem(this.on(this.clientId))}catch(t){}},t.prototype.on=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function Nu(t){return Ns(t,Za.store)}function Pu(t){return Ns(t,ls.store)}function Ru(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Du=function(t,e){this.progress=t,this.wn=e},xu=function(){function t(t,e,n){this.Ue=t,this._n=e,this.Ut=n}return t.prototype.mn=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKey(t,e).next((function(r){return n.yn(t,e,r)}))},t.prototype.yn=function(t,e,n){return this.Ue.getEntry(t,e).next((function(t){for(var e=0,r=n;e<r.length;e++)r[e].applyToLocalView(t);return t}))},t.prototype.gn=function(t,e){t.forEach((function(t,n){for(var r=0,i=e;r<i.length;r++)i[r].applyToLocalView(n)}))},t.prototype.pn=function(t,e){var n=this;return this.Ue.getEntries(t,e).next((function(e){return n.En(t,e).next((function(){return e}))}))},t.prototype.En=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,e).next((function(t){return n.gn(e,t)}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return function(t){return ai.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Tn(t,e.path):$i(e)?this.In(t,e,n):this.An(t,e,n)},t.prototype.Tn=function(t,e){return this.mn(t,new ai(e)).next((function(t){var e=Zo();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))},t.prototype.In=function(t,e,n){var r=this,i=e.collectionGroup,o=Zo();return this.Ut.getCollectionParents(t,i).next((function(a){return ms.forEach(a,(function(a){var s=function(t,e){return new Wi(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,a.child(i));return r.An(t,s,n).next((function(t){t.forEach((function(t,e){o=o.insert(t,e)}))}))})).next((function(){return o}))}))},t.prototype.An=function(t,e,n){var r,i,o=this;return this.Ue.getDocumentsMatchingQuery(t,e,n).next((function(n){return r=n,o._n.getAllMutationBatchesAffectingQuery(t,e)})).next((function(e){return i=e,o.Rn(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],a=0,s=o.mutations;a<s.length;a++){var u=s[a],c=u.key,h=r.get(c);null==h&&(h=Ti.newInvalidDocument(c),r=r.insert(c,h)),No(u,h,o.localWriteTime),h.isFoundDocument()||(r=r.remove(c))}}))})).next((function(){return r.forEach((function(t,n){io(e,n)||(r=r.remove(t))})),r}))},t.prototype.Rn=function(t,e,n){for(var r=ra(),i=0,o=e;i<o.length;i++)for(var a=0,s=o[i].mutations;a<s.length;a++){var u=s[a];u instanceof Oo&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Ue.getEntries(t,r).next((function(t){return t.forEach((function(t,e){e.isFoundDocument()&&(c=c.insert(t,e))})),c}))},t}(),Ou=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.bn=n,this.vn=r}return t.Pn=function(e,n){for(var r=ra(),i=ra(),o=0,a=n.docChanges;o<a.length;o++){var s=a[o];switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),Lu=function(){function t(){}return t.prototype.Vn=function(t){this.Sn=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(qr.min())?this.Dn(t,e):this.Sn.pn(t,r).next((function(o){var s=i.Cn(e,o);return(zi(e)||Qi(e))&&i.Nn(e.limitType,s,r,n)?i.Dn(t,e):(Cr()<=a.LogLevel.DEBUG&&kr("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),ro(e)),i.Sn.getDocumentsMatchingQuery(t,e,n).next((function(t){return s.forEach((function(e){t=t.insert(e.key,e)})),t})))}))},t.prototype.Cn=function(t,e){var n=new Qo(oo(t));return e.forEach((function(e,r){io(t,r)&&(n=n.add(r))})),n},t.prototype.Nn=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},t.prototype.Dn=function(t,e){return Cr()<=a.LogLevel.DEBUG&&kr("QueryEngine","Using full collection scan to execute query:",ro(e)),this.Sn.getDocumentsMatchingQuery(t,e,qr.min())},t}(),Mu=function(){function t(t,e,n,r){this.persistence=t,this.xn=e,this.R=r,this.kn=new Ho(Mr),this.Fn=new mu((function(t){return Ci(t)}),ki),this.$n=qr.min(),this._n=t.getMutationQueue(n),this.On=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new xu(this.On,this._n,this.persistence.getIndexManager()),this.Ke=t.getBundleCache(),this.xn.Vn(this.Mn)}return t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.collect(n,e.kn)}))},t}();function Fu(t,e,n,r){return new Mu(t,e,n,r)}function Uu(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r,o,a;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return n=xr(t),r=n._n,o=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var i;return n._n.getAllMutationBatches(t).next((function(a){return i=a,r=n.persistence.getMutationQueue(e),o=new xu(n.On,r,n.persistence.getIndexManager()),r.getAllMutationBatches(t)})).next((function(e){for(var n=[],r=[],a=ra(),s=0,u=i;s<u.length;s++){var c=u[s];n.push(c.batchId);for(var h=0,l=c.mutations;h<l.length;h++){var f=l[h];a=a.add(f.key)}}for(var d=0,p=e;d<p.length;d++){var v=p[d];r.push(v.batchId);for(var g=0,y=v.mutations;g<y.length;g++){var m=y[g];a=a.add(m.key)}}return o.pn(t,a).next((function(t){return{Ln:t,removedBatchIds:n,addedBatchIds:r}}))}))}))];case 1:return a=i.sent(),[2,(n._n=r,n.Mn=o,n.xn.Vn(n.Mn),a)]}}))}))}function ju(t,e){var n=xr(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.On.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),a=ms.resolve();return o.forEach((function(t){a=a.next((function(){return r.getEntry(e,t)})).next((function(e){var o=n.docVersions.get(t);Dr(null!==o),e.version.compareTo(o)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&r.addEntry(e,n.commitVersion))}))})),a.next((function(){return t._n.removeMutationBatch(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}function qu(t){var e=xr(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.qe.getLastRemoteSnapshotVersion(t)}))}function Vu(t,e){var n=xr(t),r=e.snapshotVersion,i=n.kn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.On.newChangeBuffer({trackRemovals:!0});i=n.kn;var a=[];e.targetChanges.forEach((function(e,o){var s=i.get(o);if(s){a.push(n.qe.removeMatchingKeys(t,e.removedDocuments,o).next((function(){return n.qe.addMatchingKeys(t,e.addedDocuments,o)})));var u=e.resumeToken;if(u.approximateByteSize()>0){var c=s.withResumeToken(u,r).withSequenceNumber(t.currentSequenceNumber);i=i.insert(o,c),function(t,e,n){return Dr(e.resumeToken.approximateByteSize()>0),0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(s,c,e)&&a.push(n.qe.updateTargetData(t,c))}}}));var s=$o();if(e.documentUpdates.forEach((function(r,i){e.resolvedLimboDocuments.has(r)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))})),a.push(Bu(t,o,e.documentUpdates,r,void 0).next((function(t){s=t}))),!r.isEqual(qr.min())){var u=n.qe.getLastRemoteSnapshotVersion(t).next((function(e){return n.qe.setTargetsMetadata(t,t.currentSequenceNumber,r)}));a.push(u)}return ms.waitFor(a).next((function(){return o.apply(t)})).next((function(){return n.Mn.En(t,s)})).next((function(){return s}))})).then((function(t){return n.kn=i,t}))}function Bu(t,e,n,r,i){var o=ra();return n.forEach((function(t){return o=o.add(t)})),e.getEntries(t,o).next((function(t){var o=$o();return n.forEach((function(n,a){var s=t.get(n),u=(null==i?void 0:i.get(n))||r;a.isNoDocument()&&a.version.isEqual(qr.min())?(e.removeEntry(n,u),o=o.insert(n,a)):!s.isValidDocument()||a.version.compareTo(s.version)>0||0===a.version.compareTo(s.version)&&s.hasPendingWrites?(e.addEntry(a,u),o=o.insert(n,a)):kr("LocalStore","Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",a.version)})),o}))}function Ku(t,e){var n=xr(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n._n.getNextMutationBatchAfterBatchId(t,e)}))}function Wu(t,e){var n=xr(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.qe.getTargetData(t,e).next((function(i){return i?(r=i,ms.resolve(r)):n.qe.allocateTargetId(t).next((function(i){return r=new Ds(e,i,0,t.currentSequenceNumber),n.qe.addTargetData(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.kn.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.kn=n.kn.insert(t.targetId,t),n.Fn.set(e,t.targetId)),t}))}function Hu(t,e,n){return(0,i.__awaiter)(this,void 0,void 0,(function(){var r,o,a,s;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:r=xr(t),o=r.kn.get(e),a=n?"readwrite":"readwrite-primary",i.label=1;case 1:return i.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",a,(function(t){return r.persistence.referenceDelegate.removeTarget(t,o)}))];case 2:i.sent(),i.label=3;case 3:return[3,5];case 4:if(!Ts(s=i.sent()))throw s;return kr("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.kn=r.kn.remove(e),r.Fn.delete(o.target),[2]}}))}))}function Gu(t,e,n){var r=xr(t),i=qr.min(),o=ra();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=xr(t),i=r.Fn.get(n);return void 0!==i?ms.resolve(r.kn.get(i)):r.qe.getTargetData(e,n)}(r,t,Zi(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.xn.getDocumentsMatchingQuery(t,e,n?i:qr.min(),n?o:ra())})).next((function(t){return{documents:t,Bn:o}}))}))}function zu(t,e){var n=xr(t),r=xr(n.qe),i=n.kn.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.lt(t,e).next((function(t){return t?t.target:null}))}))}function Qu(t){var e=xr(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return function(t,e,n){var r=xr(t),i=$o(),o=Ms(n),a=Tu(e),s=IDBKeyRange.lowerBound(o,!0);return a.$t({index:os.readTimeIndex,range:s},(function(t,e){var n=Os(r.R,e);i=i.insert(n.key,n),o=e.readTime})).next((function(){return{wn:i,readTime:Fs(o)}}))}(e.On,t,e.$n)})).then((function(t){var n=t.wn,r=t.readTime;return e.$n=r,n}))}function Yu(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e;return(0,i.__generator)(this,(function(n){return[2,(e=xr(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return function(t){var e=Tu(t),n=qr.min();return e.$t({index:os.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=Fs(e.readTime)),r.done()})).next((function(){return n}))}(t)})).then((function(t){e.$n=t}))]}))}))}function Xu(t,e,n,r){return(0,i.__awaiter)(this,void 0,void 0,(function(){var o,a,s,u,c,h,l,f,d,p;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:for(o=xr(t),a=ra(),s=$o(),u=ea(),c=0,h=n;c<h.length;c++)l=h[c],f=e.qn(l.metadata.name),l.document&&(a=a.add(f)),s=s.insert(f,e.Un(l)),u=u.insert(f,e.Kn(l.metadata.readTime));return d=o.On.newChangeBuffer({trackRemovals:!0}),[4,Wu(o,function(t){return Zi(Gi(Hr.fromString("__bundle__/docs/"+t)))}(r))];case 1:return p=i.sent(),[2,o.persistence.runTransaction("Apply bundle documents","readwrite",(function(t){return Bu(t,d,s,qr.min(),u).next((function(e){return d.apply(t),e})).next((function(e){return o.qe.removeMatchingKeysForTargetId(t,p.targetId).next((function(){return o.qe.addMatchingKeys(t,a,p.targetId)})).next((function(){return o.Mn.En(t,e)})).next((function(){return e}))}))}))]}}))}))}function $u(t,e,n){return void 0===n&&(n=ra()),(0,i.__awaiter)(this,void 0,void 0,(function(){var r,o;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return[4,Wu(t,Zi(Ks(e.bundledQuery)))];case 1:return r=i.sent(),[2,(o=xr(t)).persistence.runTransaction("Save named query","readwrite",(function(t){var i=wa(e.readTime);if(r.snapshotVersion.compareTo(i)>=0)return o.Ke.saveNamedQuery(t,e);var a=r.withResumeToken(Yr.EMPTY_BYTE_STRING,i);return o.kn=o.kn.insert(a.targetId,a),o.qe.updateTargetData(t,a).next((function(){return o.qe.removeMatchingKeysForTargetId(t,r.targetId)})).next((function(){return o.qe.addMatchingKeys(t,n,r.targetId)})).next((function(){return o.Ke.saveNamedQuery(t,e)}))}))]}}))}))}var Ju=function(){function t(t){this.R=t,this.Qn=new Map,this.jn=new Map}return t.prototype.getBundleMetadata=function(t,e){return ms.resolve(this.Qn.get(e))},t.prototype.saveBundleMetadata=function(t,e){var n;return this.Qn.set(e.id,{id:(n=e).id,version:n.version,createTime:wa(n.createTime)}),ms.resolve()},t.prototype.getNamedQuery=function(t,e){return ms.resolve(this.jn.get(e))},t.prototype.saveNamedQuery=function(t,e){return this.jn.set(e.name,function(t){return{name:t.name,query:Ks(t.bundledQuery),readTime:wa(t.readTime)}}(e)),ms.resolve()},t}(),Zu=function(){function t(){this.Wn=new Qo(tc.Gn),this.zn=new Qo(tc.Hn)}return t.prototype.isEmpty=function(){return this.Wn.isEmpty()},t.prototype.addReference=function(t,e){var n=new tc(t,e);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)},t.prototype.Jn=function(t,e){var n=this;t.forEach((function(t){return n.addReference(t,e)}))},t.prototype.removeReference=function(t,e){this.Yn(new tc(t,e))},t.prototype.Xn=function(t,e){var n=this;t.forEach((function(t){return n.removeReference(t,e)}))},t.prototype.Zn=function(t){var e=this,n=new ai(new Hr([])),r=new tc(n,t),i=new tc(n,t+1),o=[];return this.zn.forEachInRange([r,i],(function(t){e.Yn(t),o.push(t.key)})),o},t.prototype.ts=function(){var t=this;this.Wn.forEach((function(e){return t.Yn(e)}))},t.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},t.prototype.es=function(t){var e=new ai(new Hr([])),n=new tc(e,t),r=new tc(e,t+1),i=ra();return this.zn.forEachInRange([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.containsKey=function(t){var e=new tc(t,0),n=this.Wn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),tc=function(){function t(t,e){this.key=t,this.ns=e}return t.Gn=function(t,e){return ai.comparator(t.key,e.key)||Mr(t.ns,e.ns)},t.Hn=function(t,e){return Mr(t.ns,e.ns)||ai.comparator(t.key,e.key)},t}(),ec=function(){function t(t,e){this.Ut=t,this.referenceDelegate=e,this._n=[],this.ss=1,this.rs=new Qo(tc.Gn)}return t.prototype.checkEmpty=function(t){return ms.resolve(0===this._n.length)},t.prototype.addMutationBatch=function(t,e,n,r){var i=this.ss;this.ss++,this._n.length>0&&this._n[this._n.length-1];var o=new Ps(i,e,n,r);this._n.push(o);for(var a=0,s=r;a<s.length;a++){var u=s[a];this.rs=this.rs.add(new tc(u.key,i)),this.Ut.addToCollectionParentIndex(t,u.key.path.popLast())}return ms.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return ms.resolve(this.os(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=e+1,r=this.cs(n),i=r<0?0:r;return ms.resolve(this._n.length>i?this._n[i]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return ms.resolve(0===this._n.length?-1:this.ss-1)},t.prototype.getAllMutationBatches=function(t){return ms.resolve(this._n.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new tc(e,0),i=new tc(e,Number.POSITIVE_INFINITY),o=[];return this.rs.forEachInRange([r,i],(function(t){var e=n.os(t.ns);o.push(e)})),ms.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Qo(Mr);return e.forEach((function(t){var e=new tc(t,0),i=new tc(t,Number.POSITIVE_INFINITY);n.rs.forEachInRange([e,i],(function(t){r=r.add(t.ns)}))})),ms.resolve(this.us(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,i=n;ai.isDocumentKey(i)||(i=i.child(""));var o=new tc(new ai(i),0),a=new Qo(Mr);return this.rs.forEachWhile((function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(a=a.add(t.ns)),!0)}),o),ms.resolve(this.us(a))},t.prototype.us=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.os(t);null!==r&&n.push(r)})),n},t.prototype.removeMutationBatch=function(t,e){var n=this;Dr(0===this.hs(e.batchId,"removed")),this._n.shift();var r=this.rs;return ms.forEach(e.mutations,(function(i){var o=new tc(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((function(){n.rs=r}))},t.prototype.Gt=function(t){},t.prototype.containsKey=function(t,e){var n=new tc(e,0),r=this.rs.firstAfterOrEqual(n);return ms.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return this._n.length,ms.resolve()},t.prototype.hs=function(t,e){return this.cs(t)},t.prototype.cs=function(t){return 0===this._n.length?0:t-this._n[0].batchId},t.prototype.os=function(t){var e=this.cs(t);return e<0||e>=this._n.length?null:this._n[e]},t}(),nc=function(){function t(t,e){this.Ut=t,this.ls=e,this.docs=new Ho(ai.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,a=this.ls(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:a,readTime:n}),this.size+=a-o,this.Ut.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return ms.resolve(n?n.document.clone():Ti.newInvalidDocument(e))},t.prototype.getEntries=function(t,e){var n=this,r=$o();return e.forEach((function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.clone():Ti.newInvalidDocument(t))})),ms.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=$o(),i=new ai(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var a=o.getNext(),s=a.key,u=a.value,c=u.document,h=u.readTime;if(!e.path.isPrefixOf(s.path))break;h.compareTo(n)<=0||io(e,c)&&(r=r.insert(c.key,c.clone()))}return ms.resolve(r)},t.prototype.fs=function(t,e){return ms.forEach(this.docs,(function(t){return e(t)}))},t.prototype.newChangeBuffer=function(t){return new rc(this)},t.prototype.getSize=function(t){return ms.resolve(this.size)},t}(),rc=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ie=e,n}return(0,i.__extends)(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach((function(r,i){i.document.isValidDocument()?n.push(e.Ie.addEntry(t,i.document,e.getReadTime(r))):e.Ie.removeEntry(r)})),ms.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.Ie.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.Ie.getEntries(t,e)},e}(_u),ic=function(){function t(t){this.persistence=t,this.ds=new mu((function(t){return Ci(t)}),ki),this.lastRemoteSnapshotVersion=qr.min(),this.highestTargetId=0,this.ws=0,this._s=new Zu,this.targetCount=0,this.ys=au.Jt()}return t.prototype.forEachTarget=function(t,e){return this.ds.forEach((function(t,n){return e(n)})),ms.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return ms.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return ms.resolve(this.ws)},t.prototype.allocateTargetId=function(t){return this.highestTargetId=this.ys.next(),ms.resolve(this.highestTargetId)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ws&&(this.ws=e),ms.resolve()},t.prototype.te=function(t){this.ds.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ys=new au(e),this.highestTargetId=e),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return this.te(e),this.targetCount+=1,ms.resolve()},t.prototype.updateTargetData=function(t,e){return this.te(e),ms.resolve()},t.prototype.removeTargetData=function(t,e){return this.ds.delete(e.target),this._s.Zn(e.targetId),this.targetCount-=1,ms.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.ds.forEach((function(a,s){s.sequenceNumber<=e&&null===n.get(s.targetId)&&(r.ds.delete(a),o.push(r.removeMatchingKeysForTargetId(t,s.targetId)),i++)})),ms.waitFor(o).next((function(){return i}))},t.prototype.getTargetCount=function(t){return ms.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.ds.get(e)||null;return ms.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this._s.Jn(e,n),ms.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){this._s.Xn(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((function(e){i.push(r.markPotentiallyOrphaned(t,e))})),ms.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this._s.Zn(e),ms.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this._s.es(e);return ms.resolve(n)},t.prototype.containsKey=function(t,e){return ms.resolve(this._s.containsKey(e))},t}(),oc=function(){function t(t,e){var n=this;this.gs={},this.Ne=new Ir(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new ic(this),this.Ut=new zs,this.Ue=function(t,e){return new nc(t,(function(t){return n.referenceDelegate.ps(t)}))}(this.Ut),this.R=new xs(e),this.Ke=new Ju(this.R)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(){},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getMutationQueue=function(t){var e=this.gs[t.toKey()];return e||(e=new ec(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r=this;kr("MemoryPersistence","Starting transaction:",t);var i=new ac(this.Ne.next());return this.referenceDelegate.Es(),n(i).next((function(t){return r.referenceDelegate.Ts(i).next((function(){return t}))})).toPromise().then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.Is=function(t,e){return ms.or(Object.values(this.gs).map((function(n){return function(){return n.containsKey(t,e)}})))},t}(),ac=function(t){function e(e){var n=this;return(n=t.call(this)||this).currentSequenceNumber=e,n}return(0,i.__extends)(e,t),e}(gs),sc=function(){function t(t){this.persistence=t,this.As=new Zu,this.Rs=null}return t.bs=function(e){return new t(e)},Object.defineProperty(t.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw Rr()},enumerable:!1,configurable:!0}),t.prototype.addReference=function(t,e,n){return this.As.addReference(n,e),this.vs.delete(n.toString()),ms.resolve()},t.prototype.removeReference=function(t,e,n){return this.As.removeReference(n,e),this.vs.add(n.toString()),ms.resolve()},t.prototype.markPotentiallyOrphaned=function(t,e){return this.vs.add(e.toString()),ms.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.As.Zn(e.targetId).forEach((function(t){return n.vs.add(t.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next((function(t){t.forEach((function(t){return n.vs.add(t.toString())}))})).next((function(){return r.removeTargetData(t,e)}))},t.prototype.Es=function(){this.Rs=new Set},t.prototype.Ts=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ms.forEach(this.vs,(function(r){var i=ai.fromPath(r);return e.Ps(t,i).next((function(t){t||n.removeEntry(i)}))})).next((function(){return e.Rs=null,n.apply(t)}))},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ps(t,e).next((function(t){t?n.vs.delete(e.toString()):n.vs.add(e.toString())}))},t.prototype.ps=function(t){return 0},t.prototype.Ps=function(t,e){var n=this;return ms.or([function(){return ms.resolve(n.As.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Is(t,e)}])},t}(),uc=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();function cc(t,e){return"firestore_clients_"+t+"_"+e}function hc(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.isAuthenticated()&&(r+="_"+e.uid),r}function lc(t,e){return"firestore_targets_"+t+"_"+e}uc.UNAUTHENTICATED=new uc(null),uc.GOOGLE_CREDENTIALS=new uc("google-credentials-uid"),uc.FIRST_PARTY=new uc("first-party-uid"),uc.MOCK_USER=new uc("mock-user");var fc=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Vs=function(e,n,r){var i,o=JSON.parse(r),a="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return a&&o.error&&(a="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new Er(o.error.code,o.error.message)),a?new t(e,n,o.state,i):(Ar("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),dc=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Vs=function(e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new Er(i.error.code,i.error.message)),o?new t(e,i.state,r):(Ar("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),pc=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Vs=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=oa(),a=0;i&&a<r.activeTargetIds.length;++a)i=oi(r.activeTargetIds[a]),o=o.add(r.activeTargetIds[a]);return i?new t(e,o):(Ar("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),vc=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Vs=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(Ar("SharedClientState","Failed to parse online state: "+e),null)},t}(),gc=function(){function t(){this.activeTargetIds=oa()}return t.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Ss=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),yc=function(){function t(t,e,n,r,i){this.window=t,this.Se=e,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.ks.bind(this),this.Fs=new Ho(Mr),this.started=!1,this.$s=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Os=cc(this.persistenceKey,this.Ns),this.Ms=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Fs=this.Fs.insert(this.Ns,new gc),this.Ls=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Us=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Ks=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}return t.yt=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t,e,n,r,o,a,s,u,c,h,l,f=this;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.syncEngine.fn()];case 1:for(t=i.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Ns&&(o=this.getItem(cc(this.persistenceKey,r)))&&(a=pc.Vs(r,o))&&(this.Fs=this.Fs.insert(a.clientId,a));for(this.Qs(),(s=this.storage.getItem(this.Us))&&(u=this.js(s))&&this.Ws(u),c=0,h=this.$s;c<h.length;c++)l=h[c],this.ks(l);return this.$s=[],this.window.addEventListener("pagehide",(function(){return f.shutdown()})),this.started=!0,[2]}}))}))},t.prototype.writeSequenceNumber=function(t){this.setItem(this.Ms,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.Fs)},t.prototype.isActiveQueryTarget=function(t){var e=!1;return this.Fs.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.addPendingMutation=function(t){this.zs(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.zs(t,e,n),this.Hs(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(lc(this.persistenceKey,t));if(n){var r=dc.Vs(t,n);r&&(e=r.state)}}return this.Js.Ds(t),this.Qs(),e},t.prototype.removeLocalQueryTarget=function(t){this.Js.Cs(t),this.Qs()},t.prototype.isLocalQueryTarget=function(t){return this.Js.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(lc(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.Ys(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach((function(t){r.Hs(t)})),this.currentUser=t,n.forEach((function(t){r.addPendingMutation(t)}))},t.prototype.setOnlineState=function(t){this.Xs(t)},t.prototype.notifyBundleLoaded=function(){this.Zs()},t.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Os),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return kr("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){kr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){kr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.ks=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(kr("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Os)return void Ar("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable((function(){return(0,i.__awaiter)(e,void 0,void 0,(function(){var t,e,r,o,a,s;return(0,i.__generator)(this,(function(i){if(this.started){if(null!==n.key)if(this.Ls.test(n.key)){if(null==n.newValue)return t=this.ti(n.key),[2,this.ei(t,null)];if(e=this.ni(n.key,n.newValue))return[2,this.ei(e.clientId,e)]}else if(this.Bs.test(n.key)){if(null!==n.newValue&&(r=this.si(n.key,n.newValue)))return[2,this.ii(r)]}else if(this.qs.test(n.key)){if(null!==n.newValue&&(o=this.ri(n.key,n.newValue)))return[2,this.oi(o)]}else if(n.key===this.Us){if(null!==n.newValue&&(a=this.js(n.newValue)))return[2,this.Ws(a)]}else if(n.key===this.Ms)(s=function(t){var e=Ir.o;if(null!=t)try{var n=JSON.parse(t);Dr("number"==typeof n),e=n}catch(t){Ar("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==Ir.o&&this.sequenceNumberHandler(s);else if(n.key===this.Ks)return[2,this.syncEngine.ci()]}else this.$s.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Js",{get:function(){return this.Fs.get(this.Ns)},enumerable:!1,configurable:!0}),t.prototype.Qs=function(){this.setItem(this.Os,this.Js.Ss())},t.prototype.zs=function(t,e,n){var r=new fc(this.currentUser,t,e,n),i=hc(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Ss())},t.prototype.Hs=function(t){var e=hc(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Xs=function(t){var e={clientId:this.Ns,onlineState:t};this.storage.setItem(this.Us,JSON.stringify(e))},t.prototype.Ys=function(t,e,n){var r=lc(this.persistenceKey,t),i=new dc(t,e,n);this.setItem(r,i.Ss())},t.prototype.Zs=function(){this.setItem(this.Ks,"value-not-used")},t.prototype.ti=function(t){var e=this.Ls.exec(t);return e?e[1]:null},t.prototype.ni=function(t,e){var n=this.ti(t);return pc.Vs(n,e)},t.prototype.si=function(t,e){var n=this.Bs.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return fc.Vs(new uc(i),r,e)},t.prototype.ri=function(t,e){var n=this.qs.exec(t),r=Number(n[1]);return dc.Vs(r,e)},t.prototype.js=function(t){return vc.Vs(t)},t.prototype.ii=function(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(t.batchId,t.state,t.error)]:(kr("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.oi=function(t){return this.syncEngine.ai(t.targetId,t.state,t.error)},t.prototype.ei=function(t,e){var n=this,r=e?this.Fs.insert(t,e):this.Fs.remove(t),i=this.Gs(this.Fs),o=this.Gs(r),a=[],s=[];return o.forEach((function(t){i.has(t)||a.push(t)})),i.forEach((function(t){o.has(t)||s.push(t)})),this.syncEngine.hi(a,s).then((function(){n.Fs=r}))},t.prototype.Ws=function(t){this.Fs.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},t.prototype.Gs=function(t){var e=oa();return t.forEach((function(t,n){e=e.unionWith(n.activeTargetIds)})),e},t}(),mc=function(){function t(){this.li=new gc,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.fi[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},t.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.fi[t]},t.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.start=function(){return this.li=new gc,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t.prototype.notifyBundleLoaded=function(){},t}(),_c=function(){function t(){}return t.prototype.di=function(t){},t.prototype.shutdown=function(){},t}(),bc=function(){function t(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}return t.prototype.di=function(t){this.gi.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},t.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},t.prototype._i=function(){kr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(0)},t.prototype.yi=function(){kr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(1)},t.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),wc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Ic=function(){function t(t){this.Ei=t.Ei,this.Ti=t.Ti}return t.prototype.Ii=function(t){this.Ai=t},t.prototype.Ri=function(t){this.bi=t},t.prototype.onMessage=function(t){this.vi=t},t.prototype.close=function(){this.Ti()},t.prototype.send=function(t){this.Ei(t)},t.prototype.Pi=function(){this.Ai()},t.prototype.Vi=function(t){this.bi(t)},t.prototype.Si=function(t){this.vi(t)},t}(),Tc=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.autoDetectLongPolling=e.autoDetectLongPolling,n.useFetchStreams=e.useFetchStreams,n}return(0,i.__extends)(e,t),e.prototype.Fi=function(t,e,n,r){return new Promise((function(i,o){var a=new wr;a.listenOnce(gr.COMPLETE,(function(){try{switch(a.getLastErrorCode()){case vr.NO_ERROR:var e=a.getResponseJson();kr("Connection","XHR received:",JSON.stringify(e)),i(e);break;case vr.TIMEOUT:kr("Connection",'RPC "'+t+'" timed out'),o(new Er(Tr.DEADLINE_EXCEEDED,"Request time out"));break;case vr.HTTP_ERROR:var n=a.getStatus();if(kr("Connection",'RPC "'+t+'" failed with status:',n,"response text:",a.getResponseText()),n>0){var r=a.getResponseJson().error;if(r&&r.status&&r.message){var s=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(Tr).indexOf(e)>=0?e:Tr.UNKNOWN}(r.status);o(new Er(s,r.message))}else o(new Er(Tr.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new Er(Tr.UNAVAILABLE,"Connection failed."));break;default:Rr()}}finally{kr("Connection",'RPC "'+t+'" completed.')}}));var s=JSON.stringify(r);a.send(e,"POST",s,n,15)}))},e.prototype.Oi=function(t,e){var n=[this.Di,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=dr(),i=pr(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(a.xmlHttpFactory=new _r({})),this.ki(a.initMessageHeaders,e),(0,o.isMobileCordova)()||(0,o.isReactNative)()||(0,o.isElectron)()||(0,o.isIE)()||(0,o.isUWP)()||(0,o.isBrowserExtension)()||(a.httpHeadersOverwriteParam="$httpHeaders");var s=n.join("");kr("Connection","Creating WebChannel: "+s,a);var u=r.createWebChannel(s,a),c=!1,h=!1,l=new Ic({Ei:function(t){h?kr("Connection","Not sending because WebChannel is closed:",t):(c||(kr("Connection","Opening WebChannel transport."),u.open(),c=!0),kr("Connection","WebChannel sending:",t),u.send(t))},Ti:function(){return u.close()}}),f=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return f(u,br.EventType.OPEN,(function(){h||kr("Connection","WebChannel transport opened.")})),f(u,br.EventType.CLOSE,(function(){h||(h=!0,kr("Connection","WebChannel transport closed"),l.Vi())})),f(u,br.EventType.ERROR,(function(t){h||(h=!0,Nr("Connection","WebChannel transport errored:",t),l.Vi(new Er(Tr.UNAVAILABLE,"The operation could not be completed")))})),f(u,br.EventType.MESSAGE,(function(t){var e;if(!h){var n=t.data[0];Dr(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){kr("Connection","WebChannel received error:",i);var o=i.status,a=function(t){var e=Uo[t];if(void 0!==e)return Wo(e)}(o),s=i.message;void 0===a&&(a=Tr.INTERNAL,s="Unknown error status: "+o+" with message "+i.message),h=!0,l.Vi(new Er(a,s)),u.close()}else kr("Connection","WebChannel received:",n),l.Si(n)}})),f(i,yr.STAT_EVENT,(function(t){t.stat===mr.PROXY?kr("Connection","Detected buffering proxy"):t.stat===mr.NOPROXY&&kr("Connection","Detected no buffering proxy")})),setTimeout((function(){l.Pi()}),0),l},e}(function(){function t(t){this.databaseInfo=t,this.databaseId=t.databaseId;var e=t.ssl?"https":"http";this.Di=e+"://"+t.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return t.prototype.Ni=function(t,e,n,r){var i=this.xi(t,e);kr("RestConnection","Sending: ",i,n);var o={};return this.ki(o,r),this.Fi(t,i,o,n).then((function(t){return kr("RestConnection","Received: ",t),t}),(function(e){throw Nr("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.$i=function(t,e,n,r){return this.Ni(t,e,n,r)},t.prototype.ki=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.10.1",t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},t.prototype.xi=function(t,e){var n=wc[t];return this.Di+"/v1/"+e+":"+n},t}());function Ec(){return"undefined"!=typeof window?window:null}function Sc(){return"undefined"!=typeof document?document:null}function Cc(t){return new ya(t,!0)}var kc=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=t,this.timerId=e,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Ki=Date.now(),this.reset()}return t.prototype.reset=function(){this.qi=0},t.prototype.Qi=function(){this.qi=this.Bi},t.prototype.ji=function(t){var e=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Ki),i=Math.max(0,n-r);i>0&&kr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,(function(){return e.Ki=Date.now(),t()})),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},t.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},t.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},t.prototype.Wi=function(){return(Math.random()-.5)*this.qi},t}(),Ac=function(){function t(t,e,n,r,i,o){this.Se=t,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new kc(t,e)}return t.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.er=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.nr()},t.prototype.stop=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.sr=function(){this.state=0,this.Zi.reset()},t.prototype.ir=function(){var t=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,(function(){return t.rr()})))},t.prototype.cr=function(t){this.ur(),this.stream.send(t)},t.prototype.rr=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(t){return this.er()?[2,this.close(0)]:[2]}))}))},t.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},t.prototype.close=function(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,3!==t?this.Zi.reset():e&&e.code===Tr.RESOURCE_EXHAUSTED?(Ar(e.toString()),Ar("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Qi()):e&&e.code===Tr.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ri(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.ar=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.hr(this.Yi),n=this.Yi;this.Ji.getToken().then((function(e){t.Yi===n&&t.lr(e)}),(function(n){e((function(){var e=new Er(Tr.UNKNOWN,"Fetching auth token failed: "+n.message);return t.dr(e)}))}))},t.prototype.lr=function(t){var e=this,n=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii((function(){n((function(){return e.state=2,e.listener.Ii()}))})),this.stream.Ri((function(t){n((function(){return e.dr(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji((function(){return(0,i.__awaiter)(t,void 0,void 0,(function(){return(0,i.__generator)(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.dr=function(t){return kr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.hr=function(t){var e=this;return function(n){e.Se.enqueueAndForget((function(){return e.Yi===t?n():(kr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),Nc=function(t){function e(e,n,r,i,o){var a=this;return(a=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).R=i,a}return(0,i.__extends)(e,t),e.prototype.wr=function(t){return this.Hi.Oi("Listen",t)},e.prototype.onMessage=function(t){this.Zi.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Rr()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.I?(Dr(void 0===e||"string"==typeof e),Yr.fromBase64String(e||"")):(Dr(void 0===e||e instanceof Uint8Array),Yr.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),a=(s=e.targetChange.cause)&&function(t){var e=void 0===t.code?Tr.UNKNOWN:Wo(t.code);return new Er(e,t.message||"")}(s);n=new ha(r,i,o,a||null)}else if("documentChange"in e){e.documentChange,(r=e.documentChange).document,r.document.name,r.document.updateTime,i=Sa(t,r.document.name),o=wa(r.document.updateTime);var s=new wi({mapValue:{fields:r.document.fields}}),u=(a=Ti.newFoundDocument(i,o,s),r.targetIds||[]),c=r.removedTargetIds||[];n=new ua(u,c,a.key,a)}else if("documentDelete"in e)e.documentDelete,(r=e.documentDelete).document,i=Sa(t,r.document),o=r.readTime?wa(r.readTime):qr.min(),s=Ti.newNoDocument(i,o),a=r.removedTargetIds||[],n=new ua([],a,s.key,s);else if("documentRemove"in e)e.documentRemove,(r=e.documentRemove).document,i=Sa(t,r.document),o=r.removedTargetIds||[],n=new ua([],o,i,null);else{if(!("filter"in e))return Rr();e.filter;var h=e.filter;h.targetId,r=h.count||0,i=new Bo(r),o=h.targetId,n=new ca(o,i)}return n}(this.R,t),n=function(t){if(!("targetChange"in t))return qr.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?qr.min():e.readTime?wa(e.readTime):qr.min()}(t);return this.listener._r(e,n)},e.prototype.mr=function(t){var e={};e.database=Aa(this.R),e.addTarget=function(t,e){var n,r=e.target;return(n=Ai(r)?{documents:Oa(t,r)}:{query:La(t,r)}).targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=_a(t,e.resumeToken):e.snapshotVersion.compareTo(qr.min())>0&&(n.readTime=ma(t,e.snapshotVersion.toTimestamp())),n}(this.R,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Rr()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.R,t);n&&(e.labels=n),this.cr(e)},e.prototype.yr=function(t){var e={};e.database=Aa(this.R),e.removeTarget=t,this.cr(e)},e}(Ac),Pc=function(t){function e(e,n,r,i,o){var a=this;return(a=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).R=i,a.gr=!1,a}return(0,i.__extends)(e,t),Object.defineProperty(e.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.ar=function(){this.gr&&this.Er([])},e.prototype.wr=function(t){return this.Hi.Oi("Write",t)},e.prototype.onMessage=function(t){if(Dr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.gr){this.Zi.reset();var e=function(t,e){return t&&t.length>0?(Dr(void 0!==e),t.map((function(t){return function(t,e){var n=t.updateTime?wa(t.updateTime):wa(e);return n.isEqual(qr.min())&&(n=wa(e)),new Eo(n,t.transformResults||[])}(t,e)}))):[]}(t.writeResults,t.commitTime),n=wa(t.commitTime);return this.listener.Tr(n,e)}return Dr(!t.writeResults||0===t.writeResults.length),this.gr=!0,this.listener.Ir()},e.prototype.Ar=function(){var t={};t.database=Aa(this.R),this.cr(t)},e.prototype.Er=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return Da(e.R,t)}))};this.cr(n)},e}(Ac),Rc=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Hi=n,i.R=r,i.Rr=!1,i}return(0,i.__extends)(e,t),e.prototype.br=function(){if(this.Rr)throw new Er(Tr.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Ni=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.Ni(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===Tr.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new Er(Tr.UNKNOWN,t.toString())}))},e.prototype.$i=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.$i(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===Tr.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new Er(Tr.UNKNOWN,t.toString())}))},e.prototype.terminate=function(){this.Rr=!0},e}((function(){})),Dc=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return t.prototype.Sr=function(){var t=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return t.Pr=null,t.Cr("Backend didn't respond within 10 seconds."),t.Dr("Offline"),Promise.resolve()})))},t.prototype.Nr=function(t){"Online"===this.state?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.kr(),this.Cr("Connection failed 1 times. Most recent error: "+t.toString()),this.Dr("Offline")))},t.prototype.set=function(t){this.kr(),this.vr=0,"Online"===t&&(this.Vr=!1),this.Dr(t)},t.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.Cr=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(Ar(e),this.Vr=!1):kr("OnlineStateTracker",e)},t.prototype.kr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},t}(),xc=function(t,e,n,r,o){var a=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.Fr=[],this.$r=new Map,this.Or=new Set,this.Mr=[],this.Lr=o,this.Lr.di((function(t){n.enqueueAndForget((function(){return(0,i.__awaiter)(a,void 0,void 0,(function(){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return Bc(this)?(kr("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return(e=xr(t)).Or.add(4),[4,Lc(e)];case 1:return n.sent(),e.Br.set("Unknown"),e.Or.delete(4),[4,Oc(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Br=new Dc(n,r)};function Oc(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:if(!Bc(t))return[3,4];e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Lc(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Mc(t,e){var n=xr(t);n.$r.has(e.targetId)||(n.$r.set(e.targetId,e),Vc(n)?qc(n):rh(n).er()&&Uc(n,e))}function Fc(t,e){var n=xr(t),r=rh(n);n.$r.delete(e),r.er()&&jc(n,e),0===n.$r.size&&(r.er()?r.ir():Bc(n)&&n.Br.set("Unknown"))}function Uc(t,e){t.qr.U(e.targetId),rh(t).mr(e)}function jc(t,e){t.qr.U(e),rh(t).yr(e)}function qc(t){t.qr=new fa({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},lt:function(e){return t.$r.get(e)||null}}),rh(t).start(),t.Br.Sr()}function Vc(t){return Bc(t)&&!rh(t).tr()&&t.$r.size>0}function Bc(t){return 0===xr(t).Or.size}function Kc(t){t.qr=void 0}function Wc(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){return t.$r.forEach((function(e,n){Uc(t,e)})),[2]}))}))}function Hc(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(n){return Kc(t),Vc(t)?(t.Br.Nr(e),qc(t)):t.Br.set("Unknown"),[2]}))}))}function Gc(t,e,n){return(0,i.__awaiter)(this,void 0,void 0,(function(){var r,o,a;return(0,i.__generator)(this,(function(s){switch(s.label){case 0:if(t.Br.set("Online"),!(e instanceof ha&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r,o,a;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:n=e.cause,r=0,o=e.targetIds,i.label=1;case 1:return r<o.length?(a=o[r],t.$r.has(a)?[4,t.remoteSyncer.rejectListen(a,n)]:[3,3]):[3,5];case 2:i.sent(),t.$r.delete(a),t.qr.removeTarget(a),i.label=3;case 3:i.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),kr("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,zc(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof ua?t.qr.X(e):e instanceof ca?t.qr.rt(e):t.qr.et(e),n.isEqual(qr.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,qu(t.localStore)];case 8:return o=s.sent(),n.compareTo(o)>=0?[4,function(t,e){var n=t.qr.ut(e);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=t.$r.get(r);i&&t.$r.set(r,i.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach((function(e){var n=t.$r.get(e);if(n){t.$r.set(e,n.withResumeToken(Yr.EMPTY_BYTE_STRING,n.snapshotVersion)),jc(t,e);var r=new Ds(n.target,e,1,n.sequenceNumber);Uc(t,r)}})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return kr("RemoteStore","Failed to raise snapshot:",a=s.sent()),[4,zc(t,a)];case 12:return s.sent(),[3,13];case 13:return[2]}}))}))}function zc(t,e,n){return(0,i.__awaiter)(this,void 0,void 0,(function(){var r=this;return(0,i.__generator)(this,(function(o){switch(o.label){case 0:if(!Ts(e))throw e;return t.Or.add(1),[4,Lc(t)];case 1:return o.sent(),t.Br.set("Offline"),n||(n=function(){return qu(t.localStore)}),t.asyncQueue.enqueueRetryable((function(){return(0,i.__awaiter)(r,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return kr("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Or.delete(1),[4,Oc(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function Qc(t,e){return e().catch((function(n){return zc(t,n,e)}))}function Yc(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,n,r,o,a;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:e=xr(t),n=ih(e),r=e.Fr.length>0?e.Fr[e.Fr.length-1].batchId:-1,i.label=1;case 1:if(!function(t){return Bc(t)&&t.Fr.length<10}(e))return[3,7];i.label=2;case 2:return i.trys.push([2,4,,6]),[4,Ku(e.localStore,r)];case 3:return null===(o=i.sent())?(0===e.Fr.length&&n.ir(),[3,7]):(r=o.batchId,function(t,e){t.Fr.push(e);var n=ih(t);n.er()&&n.pr&&n.Er(e.mutations)}(e,o),[3,6]);case 4:return a=i.sent(),[4,zc(e,a)];case 5:return i.sent(),[3,6];case 6:return[3,1];case 7:return Xc(e)&&$c(e),[2]}}))}))}function Xc(t){return Bc(t)&&!ih(t).tr()&&t.Fr.length>0}function $c(t){ih(t).start()}function Jc(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){return ih(t).Ar(),[2]}))}))}function Zc(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,n,r,o;return(0,i.__generator)(this,(function(i){for(e=ih(t),n=0,r=t.Fr;n<r.length;n++)o=r[n],e.Er(o.mutations);return[2]}))}))}function th(t,e,n){return(0,i.__awaiter)(this,void 0,void 0,(function(){var r,o;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return r=t.Fr.shift(),o=Rs.from(r,e,n),[4,Qc(t,(function(){return t.remoteSyncer.applySuccessfulWrite(o)}))];case 1:return i.sent(),[4,Yc(t)];case 2:return i.sent(),[2]}}))}))}function eh(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return e&&ih(t).pr?[4,function(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return Ko(r=e.code)&&r!==Tr.ABORTED?(n=t.Fr.shift(),ih(t).sr(),[4,Qc(t,(function(){return t.remoteSyncer.rejectFailedWrite(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,Yc(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return Xc(t)&&$c(t),[2]}}))}))}function nh(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return n=xr(t),e?(n.Or.delete(2),[4,Oc(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Or.add(2),[4,Lc(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function rh(t){var e=this;return t.Ur||(t.Ur=function(t,e,n){var r=xr(t);return r.br(),new Nc(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:Wc.bind(null,t),Ri:Hc.bind(null,t),_r:Gc.bind(null,t)}),t.Mr.push((function(n){return(0,i.__awaiter)(e,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return n?(t.Ur.sr(),Vc(t)?qc(t):t.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Ur.stop()];case 2:e.sent(),Kc(t),e.label=3;case 3:return[2]}}))}))}))),t.Ur}function ih(t){var e=this;return t.Kr||(t.Kr=function(t,e,n){var r=xr(t);return r.br(),new Pc(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:Jc.bind(null,t),Ri:eh.bind(null,t),Ir:Zc.bind(null,t),Tr:th.bind(null,t)}),t.Mr.push((function(n){return(0,i.__awaiter)(e,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return n?(t.Kr.sr(),[4,Yc(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Kr.stop()];case 3:e.sent(),t.Fr.length>0&&(kr("RemoteStore","Stopping write stream with "+t.Fr.length+" pending writes"),t.Fr=[]),e.label=4;case 4:return[2]}}))}))}))),t.Kr}var oh=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new ys,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(t){}))}return t.createAndSchedule=function(e,n,r,i,o){var a=new t(e,n,Date.now()+r,i,o);return a.start(r),a},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout((function(){return e.handleDelayElapsed()}),t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Er(Tr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget((function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then((function(e){return t.deferred.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}();function ah(t,e){if(Ar("AsyncQueue",e+": "+t),Ts(t))return new Er(Tr.UNAVAILABLE,e+": "+t);throw t}var sh=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||ai.comparator(e.key,n.key)}:function(t,e){return ai.comparator(t.key,e.key)},this.keyedMap=Zo(),this.sortedSet=new Ho(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),uh=function(){function t(){this.Qr=new Ho(ai.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Qr.get(e);n?0!==t.type&&3===n.type?this.Qr=this.Qr.insert(e,t):3===t.type&&1!==n.type?this.Qr=this.Qr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Qr=this.Qr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Qr=this.Qr.remove(e):1===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):Rr():this.Qr=this.Qr.insert(e,t)},t.prototype.jr=function(){var t=[];return this.Qr.inorderTraversal((function(e,n){t.push(n)})),t},t}(),ch=function(){function t(t,e,n,r,i,o,a,s){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=s}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,sh.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&eo(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),hh=function(){this.Wr=void 0,this.listeners=[]},lh=function(){this.queries=new mu((function(t){return no(t)}),eo),this.onlineState="Unknown",this.Gr=new Set};function fh(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r,o,a,s,u,c;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:if(n=xr(t),r=e.query,o=!1,(a=n.queries.get(r))||(o=!0,a=new hh),!o)return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),s=a,[4,n.onListen(r)];case 2:return s.Wr=i.sent(),[3,4];case 3:return u=i.sent(),c=ah(u,"Initialization of query '"+ro(e.query)+"' failed"),[2,void e.onError(c)];case 4:return n.queries.set(r,a),a.listeners.push(e),e.zr(n.onlineState),a.Wr&&e.Hr(a.Wr)&&gh(n),[2]}}))}))}function dh(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r,o,a,s;return(0,i.__generator)(this,(function(i){return n=xr(t),r=e.query,o=!1,(a=n.queries.get(r))&&(s=a.listeners.indexOf(e))>=0&&(a.listeners.splice(s,1),o=0===a.listeners.length),o?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]}))}))}function ph(t,e){for(var n=xr(t),r=!1,i=0,o=e;i<o.length;i++){var a=o[i],s=a.query,u=n.queries.get(s);if(u){for(var c=0,h=u.listeners;c<h.length;c++)h[c].Hr(a)&&(r=!0);u.Wr=a}}r&&gh(n)}function vh(t,e,n){var r=xr(t),i=r.queries.get(e);if(i)for(var o=0,a=i.listeners;o<a.length;o++)a[o].onError(n);r.queries.delete(e)}function gh(t){t.Gr.forEach((function(t){t.next()}))}var yh=function(){function t(t,e,n){this.query=t,this.Jr=e,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new ch(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),o=!0):this.eo(t,this.onlineState)&&(this.no(t),o=!0),this.Xr=t,o},t.prototype.onError=function(t){this.Jr.error(t)},t.prototype.zr=function(t){this.onlineState=t;var e=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),e=!0),e},t.prototype.eo=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.so&&n||t.docs.isEmpty()&&"Offline"!==e)},t.prototype.Zr=function(t){if(t.docChanges.length>0)return!0;var e=this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.no=function(t){t=ch.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},t}(),mh=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.io=function(){return"metadata"in this.payload},t}(),_h=function(){function t(t){this.R=t}return t.prototype.qn=function(t){return Sa(this.R,t)},t.prototype.Un=function(t){return t.metadata.exists?Ra(this.R,t.document,!1):Ti.newNoDocument(this.qn(t.metadata.name),this.Kn(t.metadata.readTime))},t.prototype.Kn=function(t){return wa(t)},t}(),bh=function(){function t(t,e,n){this.ro=t,this.localStore=e,this.R=n,this.queries=[],this.documents=[],this.progress=wh(t)}return t.prototype.oo=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.co=function(t){for(var e=new Map,n=new _h(this.R),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var a=n.qn(o.metadata.name),s=0,u=o.metadata.queries;s<u.length;s++){var c=u[s],h=(e.get(c)||ra()).add(a);e.set(c,h)}}return e},t.prototype.complete=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t,e,n,r,o;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return[4,Xu(this.localStore,new _h(this.R),this.documents,this.ro.id)];case 1:t=i.sent(),e=this.co(this.documents),n=0,r=this.queries,i.label=2;case 2:return n<r.length?(o=r[n],[4,$u(this.localStore,o,e.get(o.name))]):[3,5];case 3:i.sent(),i.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new Du(Object.assign({},this.progress),t))]}}))}))},t}();function wh(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var Ih=function(t){this.key=t},Th=function(t){this.key=t},Eh=function(){function t(t,e){this.query=t,this.uo=e,this.ao=null,this.current=!1,this.ho=ra(),this.mutatedKeys=ra(),this.lo=oo(t),this.fo=new sh(this.lo)}return Object.defineProperty(t.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),t.prototype._o=function(t,e){var n=this,r=e?e.mo:new uh,i=e?e.fo:this.fo,o=e?e.mutatedKeys:this.mutatedKeys,a=i,s=!1,u=zi(this.query)&&i.size===this.query.limit?i.last():null,c=Qi(this.query)&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((function(t,e){var h=i.get(t),l=io(n.query,e)?e:null,f=!!h&&n.mutatedKeys.has(h.key),d=!!l&&(l.hasLocalMutations||n.mutatedKeys.has(l.key)&&l.hasCommittedMutations),p=!1;h&&l?h.data.isEqual(l.data)?f!==d&&(r.track({type:3,doc:l}),p=!0):n.yo(h,l)||(r.track({type:2,doc:l}),p=!0,(u&&n.lo(l,u)>0||c&&n.lo(l,c)<0)&&(s=!0)):!h&&l?(r.track({type:0,doc:l}),p=!0):h&&!l&&(r.track({type:1,doc:h}),p=!0,(u||c)&&(s=!0)),p&&(l?(a=a.add(l),o=d?o.add(t):o.delete(t)):(a=a.delete(t),o=o.delete(t)))})),zi(this.query)||Qi(this.query))for(;a.size>this.query.limit;){var h=zi(this.query)?a.last():a.first();a=a.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{fo:a,mo:r,Nn:s,mutatedKeys:o}},t.prototype.yo=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this,i=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var o=t.mo.jr();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Rr()}};return n(t)-n(e)}(t.type,e.type)||r.lo(t.doc,e.doc)})),this.po(n);var a=e?this.Eo():[],s=0===this.ho.size&&this.current?1:0,u=s!==this.ao;return this.ao=s,0!==o.length||u?{snapshot:new ch(this.query,t.fo,i,o,t.mutatedKeys,0===s,u,!1),To:a}:{To:a}},t.prototype.zr=function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({fo:this.fo,mo:new uh,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},t.prototype.Io=function(t){return!this.uo.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},t.prototype.po=function(t){var e=this;t&&(t.addedDocuments.forEach((function(t){return e.uo=e.uo.add(t)})),t.modifiedDocuments.forEach((function(t){})),t.removedDocuments.forEach((function(t){return e.uo=e.uo.delete(t)})),this.current=t.current)},t.prototype.Eo=function(){var t=this;if(!this.current)return[];var e=this.ho;this.ho=ra(),this.fo.forEach((function(e){t.Io(e.key)&&(t.ho=t.ho.add(e.key))}));var n=[];return e.forEach((function(e){t.ho.has(e)||n.push(new Th(e))})),this.ho.forEach((function(t){e.has(t)||n.push(new Ih(t))})),n},t.prototype.Ao=function(t){this.uo=t.Bn,this.ho=ra();var e=this._o(t.documents);return this.applyChanges(e,!0)},t.prototype.Ro=function(){return ch.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)},t}(),Sh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Ch=function(t){this.key=t,this.bo=!1},kh=function(){function t(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new mu((function(t){return no(t)}),eo),this.Vo=new Map,this.So=new Set,this.Do=new Ho(ai.comparator),this.Co=new Map,this.No=new Zu,this.xo={},this.ko=new Map,this.Fo=au.Yt(),this.onlineState="Unknown",this.$o=void 0}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.$o},enumerable:!1,configurable:!0}),t}();function Ah(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r,o,a,s,u;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return n=rl(t),(a=n.Po.get(e))?(r=a.targetId,n.sharedClientState.addLocalQueryTarget(r),o=a.view.Ro(),[3,4]):[3,1];case 1:return[4,Wu(n.localStore,Zi(e))];case 2:return s=i.sent(),u=n.sharedClientState.addLocalQueryTarget(s.targetId),r=s.targetId,[4,Nh(n,e,r,"current"===u)];case 3:o=i.sent(),n.isPrimaryClient&&Mc(n.remoteStore,s),i.label=4;case 4:return[2,o]}}))}))}function Nh(t,e,n,r){return(0,i.__awaiter)(this,void 0,void 0,(function(){var o,a,s,u,c,h;return(0,i.__generator)(this,(function(l){switch(l.label){case 0:return t.Oo=function(e,n,r){return function(t,e,n,r){return(0,i.__awaiter)(this,void 0,void 0,(function(){var o,a,s;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return(o=e.view._o(n)).Nn?[4,Gu(t.localStore,e.query,!1).then((function(t){var n=t.documents;return e.view._o(n,o)}))]:[3,2];case 1:o=i.sent(),i.label=2;case 2:return a=r&&r.targetChanges.get(e.targetId),s=e.view.applyChanges(o,t.isPrimaryClient,a),[2,(Bh(t,e.targetId,s.To),s.snapshot)]}}))}))}(t,e,n,r)},[4,Gu(t.localStore,e,!0)];case 1:return o=l.sent(),a=new Eh(e,o.Bn),s=a._o(o.documents),u=sa.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState),c=a.applyChanges(s,t.isPrimaryClient,u),Bh(t,n,c.To),h=new Sh(e,n,a),[2,(t.Po.set(e,h),t.Vo.has(n)?t.Vo.get(n).push(e):t.Vo.set(n,[e]),c.snapshot)]}}))}))}function Ph(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r,o;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return n=xr(t),r=n.Po.get(e),(o=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,o.filter((function(t){return!eo(t,e)}))),void n.Po.delete(e))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,Hu(n.localStore,r.targetId,!1).then((function(){n.sharedClientState.clearQueryState(r.targetId),Fc(n.remoteStore,r.targetId),qh(n,r.targetId)})).catch(lu)]):[3,3];case 1:i.sent(),i.label=2;case 2:return[3,5];case 3:return qh(n,r.targetId),[4,Hu(n.localStore,r.targetId,!0)];case 4:i.sent(),i.label=5;case 5:return[2]}}))}))}function Rh(t,e,n){return(0,i.__awaiter)(this,void 0,void 0,(function(){var r,o,a,s;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:r=il(t),i.label=1;case 1:return i.trys.push([1,5,,6]),[4,function(t,e){var n,r=xr(t),i=jr.now(),o=e.reduce((function(t,e){return t.add(e.key)}),ra());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Mn.pn(t,o).next((function(o){n=o;for(var a=[],s=0,u=e;s<u.length;s++){var c=u[s],h=Po(c,n.get(c.key));null!=h&&a.push(new Oo(c.key,h,Ii(h.value.mapValue),So.exists(!0)))}return r._n.addMutationBatch(t,i,a,e)}))})).then((function(t){return t.applyToLocalDocumentSet(n),{batchId:t.batchId,changes:n}}))}(r.localStore,e)];case 2:return o=i.sent(),r.sharedClientState.addPendingMutation(o.batchId),function(t,e,n){var r=t.xo[t.currentUser.toKey()];r||(r=new Ho(Mr)),r=r.insert(e,n),t.xo[t.currentUser.toKey()]=r}(r,o.batchId,n),[4,Hh(r,o.changes)];case 3:return i.sent(),[4,Yc(r.remoteStore)];case 4:return i.sent(),[3,6];case 5:return a=i.sent(),s=ah(a,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}}))}))}function Dh(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:n=xr(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Vu(n.localStore,e)];case 2:return r=i.sent(),e.targetChanges.forEach((function(t,e){var r=n.Co.get(e);r&&(Dr(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?r.bo=!0:t.modifiedDocuments.size>0?Dr(r.bo):t.removedDocuments.size>0&&(Dr(r.bo),r.bo=!1))})),[4,Hh(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,lu(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function xh(t,e,n){var r=xr(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Po.forEach((function(t,n){var r=n.view.zr(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=xr(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zr(e)&&(r=!0)})),r&&gh(n)}(r.eventManager,e),i.length&&r.vo._r(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Oh(t,e,n){return(0,i.__awaiter)(this,void 0,void 0,(function(){var r,o,a,s,u,c;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return(r=xr(t)).sharedClientState.updateQueryState(e,"rejected",n),o=r.Co.get(e),(a=o&&o.key)?(s=(s=new Ho(ai.comparator)).insert(a,Ti.newNoDocument(a,qr.min())),u=ra().add(a),c=new aa(qr.min(),new Map,new Qo(Mr),s,u),[4,Dh(r,c)]):[3,2];case 1:return i.sent(),r.Do=r.Do.remove(a),r.Co.delete(e),Wh(r),[3,4];case 2:return[4,Hu(r.localStore,e,!1).then((function(){return qh(r,e,n)})).catch(lu)];case 3:i.sent(),i.label=4;case 4:return[2]}}))}))}function Lh(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r,o;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:n=xr(t),r=e.batch.batchId,i.label=1;case 1:return i.trys.push([1,4,,6]),[4,ju(n.localStore,e)];case 2:return o=i.sent(),jh(n,r,null),Uh(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,Hh(n,o)];case 3:return i.sent(),[3,6];case 4:return[4,lu(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function Mh(t,e,n){return(0,i.__awaiter)(this,void 0,void 0,(function(){var r,o;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:r=xr(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,function(t,e){var n=xr(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n._n.lookupMutationBatch(t,e).next((function(e){return Dr(null!==e),r=e.keys(),n._n.removeMutationBatch(t,e)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}(r.localStore,e)];case 2:return o=i.sent(),jh(r,e,n),Uh(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),[4,Hh(r,o)];case 3:return i.sent(),[3,6];case 4:return[4,lu(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function Fh(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r,o,a,s;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:Bc((n=xr(t)).remoteStore)||kr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,function(t){var e=xr(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e._n.getHighestUnacknowledgedBatchId(t)}))}(n.localStore)];case 2:return-1===(r=i.sent())?[2,void e.resolve()]:((o=n.ko.get(r)||[]).push(e),n.ko.set(r,o),[3,4]);case 3:return a=i.sent(),s=ah(a,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}}))}))}function Uh(t,e){(t.ko.get(e)||[]).forEach((function(t){t.resolve()})),t.ko.delete(e)}function jh(t,e,n){var r=xr(t),i=r.xo[r.currentUser.toKey()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.xo[r.currentUser.toKey()]=i}}function qh(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e);for(var r=0,i=t.Vo.get(e);r<i.length;r++){var o=i[r];t.Po.delete(o),n&&t.vo.Mo(o,n)}t.Vo.delete(e),t.isPrimaryClient&&t.No.Zn(e).forEach((function(e){t.No.containsKey(e)||Vh(t,e)}))}function Vh(t,e){t.So.delete(e.path.canonicalString());var n=t.Do.get(e);null!==n&&(Fc(t.remoteStore,n),t.Do=t.Do.remove(e),t.Co.delete(n),Wh(t))}function Bh(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Ih?(t.No.addReference(o.key,e),Kh(t,o)):o instanceof Th?(kr("SyncEngine","Document no longer in limbo: "+o.key),t.No.removeReference(o.key,e),t.No.containsKey(o.key)||Vh(t,o.key)):Rr()}}function Kh(t,e){var n=e.key,r=n.path.canonicalString();t.Do.get(n)||t.So.has(r)||(kr("SyncEngine","New document in limbo: "+n),t.So.add(r),Wh(t))}function Wh(t){for(;t.So.size>0&&t.Do.size<t.maxConcurrentLimboResolutions;){var e=t.So.values().next().value;t.So.delete(e);var n=new ai(Hr.fromString(e)),r=t.Fo.next();t.Co.set(r,new Ch(n)),t.Do=t.Do.insert(n,r),Mc(t.remoteStore,new Ds(Zi(Gi(n.path)),r,2,Ir.o))}}function Hh(t,e,n){return(0,i.__awaiter)(this,void 0,void 0,(function(){var r,o,a,s;return(0,i.__generator)(this,(function(u){switch(u.label){case 0:return r=xr(t),o=[],a=[],s=[],r.Po.isEmpty()?[3,3]:(r.Po.forEach((function(t,i){s.push(r.Oo(i,e,n).then((function(t){if(t){r.isPrimaryClient&&r.sharedClientState.updateQueryState(i.targetId,t.fromCache?"not-current":"current"),o.push(t);var e=Ou.Pn(i.targetId,t);a.push(e)}})))})),[4,Promise.all(s)]);case 1:return u.sent(),r.vo._r(o),[4,function(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r,o,a,s,u,c,h,l;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:n=xr(t),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return ms.forEach(e,(function(e){return ms.forEach(e.bn,(function(r){return n.persistence.referenceDelegate.addReference(t,e.targetId,r)})).next((function(){return ms.forEach(e.vn,(function(r){return n.persistence.referenceDelegate.removeReference(t,e.targetId,r)}))}))}))}))];case 2:return i.sent(),[3,4];case 3:if(!Ts(r=i.sent()))throw r;return kr("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(o=0,a=e;o<a.length;o++)s=a[o],u=s.targetId,s.fromCache||(c=n.kn.get(u),h=c.snapshotVersion,l=c.withLastLimboFreeSnapshotVersion(h),n.kn=n.kn.insert(u,l));return[2]}}))}))}(r.localStore,a)];case 2:u.sent(),u.label=3;case 3:return[2]}}))}))}function Gh(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return(n=xr(t)).currentUser.isEqual(e)?[3,3]:(kr("SyncEngine","User change. New user:",e.toKey()),[4,Uu(n.localStore,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.ko.forEach((function(t){t.forEach((function(t){t.reject(new Er(Tr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.ko.clear()}(n),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),[4,Hh(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function zh(t,e){var n=xr(t),r=n.Co.get(e);if(r&&r.bo)return ra().add(r.key);var i=ra(),o=n.Vo.get(e);if(!o)return i;for(var a=0,s=o;a<s.length;a++){var u=s[a],c=n.Po.get(u);i=i.unionWith(c.view.wo)}return i}function Qh(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r,o;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return[4,Gu((n=xr(t)).localStore,e.query,!0)];case 1:return r=i.sent(),o=e.view.Ao(r),[2,(n.isPrimaryClient&&Bh(n,e.targetId,o.To),o)]}}))}))}function Yh(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e;return(0,i.__generator)(this,(function(n){return[2,Qu((e=xr(t)).localStore).then((function(t){return Hh(e,t)}))]}))}))}function Xh(t,e,n,r){return(0,i.__awaiter)(this,void 0,void 0,(function(){var o,a;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return[4,function(t,e){var n=xr(t),r=xr(n._n);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.jt(t,e).next((function(e){return e?n.Mn.pn(t,e):ms.resolve(null)}))}))}((o=xr(t)).localStore,e)];case 1:return null===(a=i.sent())?[3,6]:"pending"!==n?[3,3]:[4,Yc(o.remoteStore)];case 2:return i.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(jh(o,e,r||null),Uh(o,e),function(t,e){xr(xr(t)._n).Gt(e)}(o.localStore,e)):Rr(),i.label=4;case 4:return[4,Hh(o,a)];case 5:return i.sent(),[3,7];case 6:kr("SyncEngine","Cannot apply mutation batch with id: "+e),i.label=7;case 7:return[2]}}))}))}function $h(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r,o,a,s,u,c,h;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return rl(n=xr(t)),il(n),!0!==e||!0===n.$o?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,Jh(n,r.toArray())]);case 1:return o=i.sent(),n.$o=!0,[4,nh(n.remoteStore,!0)];case 2:for(i.sent(),a=0,s=o;a<s.length;a++)u=s[a],Mc(n.remoteStore,u);return[3,7];case 3:return!1!==e||!1===n.$o?[3,7]:(c=[],h=Promise.resolve(),n.Vo.forEach((function(t,e){n.sharedClientState.isLocalQueryTarget(e)?c.push(e):h=h.then((function(){return qh(n,e),Hu(n.localStore,e,!0)})),Fc(n.remoteStore,e)})),[4,h]);case 4:return i.sent(),[4,Jh(n,c)];case 5:return i.sent(),function(t){var e=xr(t);e.Co.forEach((function(t,n){Fc(e.remoteStore,n)})),e.No.ts(),e.Co=new Map,e.Do=new Ho(ai.comparator)}(n),n.$o=!1,[4,nh(n.remoteStore,!1)];case 6:i.sent(),i.label=7;case 7:return[2]}}))}))}function Jh(t,e,n){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r,o,a,s,u,c,h,l,f,d,p,v,g;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:n=xr(t),r=[],o=[],a=0,s=e,i.label=1;case 1:return a<s.length?(u=s[a],c=void 0,(h=n.Vo.get(u))&&0!==h.length?[4,Wu(n.localStore,Zi(h[0]))]:[3,7]):[3,13];case 2:c=i.sent(),l=0,f=h,i.label=3;case 3:return l<f.length?(d=f[l],p=n.Po.get(d),[4,Qh(n,p)]):[3,6];case 4:(v=i.sent()).snapshot&&o.push(v.snapshot),i.label=5;case 5:return l++,[3,3];case 6:return[3,11];case 7:return[4,zu(n.localStore,u)];case 8:return g=i.sent(),[4,Wu(n.localStore,g)];case 9:return c=i.sent(),[4,Nh(n,Zh(g),u,!1)];case 10:i.sent(),i.label=11;case 11:r.push(c),i.label=12;case 12:return a++,[3,1];case 13:return[2,(n.vo._r(o),r)]}}))}))}function Zh(t){return Hi(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function tl(t){var e=xr(t);return xr(xr(e.localStore).persistence).fn()}function el(t,e,n,r){return(0,i.__awaiter)(this,void 0,void 0,(function(){var o,a,s;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return(o=xr(t)).$o?(kr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!o.Vo.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Qu(o.localStore)];case 3:return a=i.sent(),s=aa.createSynthesizedRemoteEventForCurrentChange(e,"current"===n),[4,Hh(o,a,s)];case 4:return i.sent(),[3,8];case 5:return[4,Hu(o.localStore,e,!0)];case 6:return i.sent(),qh(o,e,r),[3,8];case 7:Rr(),i.label=8;case 8:return[2]}}))}))}function nl(t,e,n){return(0,i.__awaiter)(this,void 0,void 0,(function(){var r,o,a,s,u,c,h,l,f,d;return(0,i.__generator)(this,(function(p){switch(p.label){case 0:if(!(r=rl(t)).$o)return[3,10];o=0,a=e,p.label=1;case 1:return o<a.length?(s=a[o],r.Vo.has(s)?(kr("SyncEngine","Adding an already active target "+s),[3,5]):[4,zu(r.localStore,s)]):[3,6];case 2:return u=p.sent(),[4,Wu(r.localStore,u)];case 3:return c=p.sent(),[4,Nh(r,Zh(u),c.targetId,!1)];case 4:p.sent(),Mc(r.remoteStore,c),p.label=5;case 5:return o++,[3,1];case 6:h=function(t){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return r.Vo.has(t)?[4,Hu(r.localStore,t,!1).then((function(){Fc(r.remoteStore,t),qh(r,t)})).catch(lu)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},l=0,f=n,p.label=7;case 7:return l<f.length?(d=f[l],[5,h(d)]):[3,10];case 8:p.sent(),p.label=9;case 9:return l++,[3,7];case 10:return[2]}}))}))}function rl(t){var e=xr(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Dh.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=zh.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Oh.bind(null,e),e.vo._r=ph.bind(null,e.eventManager),e.vo.Mo=vh.bind(null,e.eventManager),e}function il(t){var e=xr(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Lh.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Mh.bind(null,e),e}function ol(t,e,n){var r=xr(t);(function(t,e,n){return(0,i.__awaiter)(this,void 0,void 0,(function(){var r,o,a,s,u,c;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,14,,15]),[4,e.getMetadata()];case 1:return r=i.sent(),[4,function(t,e){var n=xr(t),r=wa(e.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",(function(t){return n.Ke.getBundleMetadata(t,e.id)})).then((function(t){return!!t&&t.createTime.compareTo(r)>=0}))}(t.localStore,r)];case 2:return i.sent()?[4,e.close()]:[3,4];case 3:return[2,(i.sent(),void n._completeWith(function(t){return{taskState:"Success",documentsLoaded:t.totalDocuments,bytesLoaded:t.totalBytes,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}(r)))];case 4:return n._updateProgress(wh(r)),o=new bh(r,t.localStore,e.R),[4,e.Lo()];case 5:a=i.sent(),i.label=6;case 6:return a?[4,o.oo(a)]:[3,10];case 7:return(s=i.sent())&&n._updateProgress(s),[4,e.Lo()];case 8:a=i.sent(),i.label=9;case 9:return[3,6];case 10:return[4,o.complete()];case 11:return u=i.sent(),[4,Hh(t,u.wn,void 0)];case 12:return i.sent(),[4,function(t,e){var n=xr(t);return n.persistence.runTransaction("Save bundle","readwrite",(function(t){return n.Ke.saveBundleMetadata(t,e)}))}(t.localStore,r)];case 13:return i.sent(),n._completeWith(u.progress),[3,15];case 14:return Nr("SyncEngine","Loading bundle failed with "+(c=i.sent())),n._failWith(c),[3,15];case 15:return[2]}}))}))})(r,e,n).then((function(){r.sharedClientState.notifyBundleLoaded()}))}var al=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return this.R=Cc(t.databaseInfo.databaseId),this.sharedClientState=this.Bo(t),this.persistence=this.qo(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.Uo(t),this.localStore=this.Ko(t),[2]}}))}))},t.prototype.Uo=function(t){return null},t.prototype.Ko=function(t){return Fu(this.persistence,new Lu,t.initialUser,this.R)},t.prototype.qo=function(t){return new oc(sc.bs,this.R)},t.prototype.Bo=function(t){return new mc},t.prototype.terminate=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}}))}))},t}(),sl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Qo=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return(0,i.__extends)(e,t),e.prototype.initialize=function(e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n=this;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return r.sent(),[4,Yu(this.localStore)];case 2:return r.sent(),[4,this.Qo.initialize(this,e)];case 3:return r.sent(),[4,il(this.Qo.syncEngine)];case 4:return r.sent(),[4,Yc(this.Qo.remoteStore)];case 5:return r.sent(),[4,this.persistence.He((function(){return n.gcScheduler&&!n.gcScheduler.started&&n.gcScheduler.start(n.localStore),Promise.resolve()}))];case 6:return r.sent(),[2]}}))}))},e.prototype.Ko=function(t){return Fu(this.persistence,new Lu,t.initialUser,this.R)},e.prototype.Uo=function(t){var e=this.persistence.referenceDelegate.garbageCollector;return new pu(e,t.asyncQueue)},e.prototype.qo=function(t){var e=Ru(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?Js.withCacheSize(this.cacheSizeBytes):Js.DEFAULT;return new Au(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,Ec(),Sc(),this.R,this.sharedClientState,!!this.forceOwnership)},e.prototype.Bo=function(t){return new mc},e}(al),ul=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Qo=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return(0,i.__extends)(e,t),e.prototype.initialize=function(e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r=this;return(0,i.__generator)(this,(function(o){switch(o.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return o.sent(),n=this.Qo.syncEngine,this.sharedClientState instanceof yc?(this.sharedClientState.syncEngine={ui:Xh.bind(null,n),ai:el.bind(null,n),hi:nl.bind(null,n),fn:tl.bind(null,n),ci:Yh.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:o.sent(),o.label=3;case 3:return[4,this.persistence.He((function(t){return(0,i.__awaiter)(r,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return[4,$h(this.Qo.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}}))}))}))];case 4:return o.sent(),[2]}}))}))},e.prototype.Bo=function(t){var e=Ec();if(!yc.yt(e))throw new Er(Tr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Ru(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new yc(e,t.asyncQueue,n,t.clientId,t.initialUser)},e}(sl),cl=function(){function t(){}return t.prototype.initialize=function(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n=this;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return xh(n.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=Gh.bind(null,this.syncEngine),[4,nh(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.createEventManager=function(t){return new lh},t.prototype.createDatastore=function(t){var e,n=Cc(t.databaseInfo.databaseId),r=(e=t.databaseInfo,new Tc(e));return function(t,e,n){return new Rc(t,e,n)}(t.credentials,r,n)},t.prototype.createRemoteStore=function(t){var e,n,r,i,o,a=this;return e=this.localStore,n=this.datastore,r=t.asyncQueue,i=function(t){return xh(a.syncEngine,t,0)},o=bc.yt()?new bc:new _c,new xc(e,n,r,i,o)},t.prototype.createSyncEngine=function(t,e){return function(t,e,n,r,i,o,a){var s=new kh(t,e,n,r,i,o);return a&&(s.$o=!0),s}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)},t.prototype.terminate=function(){return function(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return e=xr(t),kr("RemoteStore","RemoteStore shutting down."),e.Or.add(5),[4,Lc(e)];case 1:return n.sent(),e.Lr.shutdown(),e.Br.set("Unknown"),[2]}}))}))}(this.remoteStore)},t}();function hl(t,e){void 0===e&&(e=10240);var n=0;return{read:function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var r;return(0,i.__generator)(this,(function(i){return n<t.byteLength?(r={value:t.slice(n,n+e),done:!1},[2,(n+=e,r)]):[2,{done:!0}]}))}))},cancel:function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(t){return[2]}))}))},releaseLock:function(){},closed:Promise.reject("unimplemented")}}var ll=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Wo=function(){this.muted=!0},t.prototype.jo=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),fl=function(){function t(t,e){var n=this;this.Go=t,this.R=e,this.metadata=new ys,this.buffer=new Uint8Array,this.zo=new TextDecoder("utf-8"),this.Ho().then((function(t){t&&t.io()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))}),(function(t){return n.metadata.reject(t)}))}return t.prototype.close=function(){return this.Go.cancel()},t.prototype.getMetadata=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(t){return[2,this.metadata.promise]}))}))},t.prototype.Lo=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.Ho())]}}))}))},t.prototype.Ho=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t,e,n,r;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.Jo()];case 1:return null===(t=i.sent())?[2,null]:(e=this.zo.decode(t),n=Number(e),isNaN(n)&&this.Yo("length string ("+e+") is not valid number"),[4,this.Xo(n)]);case 2:return r=i.sent(),[2,new mh(JSON.parse(r),t.length+n)]}}))}))},t.prototype.Zo=function(){return this.buffer.findIndex((function(t){return t==="{".charCodeAt(0)}))},t.prototype.Jo=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t,e;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return this.Zo()<0?[4,this.tc()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.Zo())<0&&this.Yo("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}}))}))},t.prototype.Xo=function(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.tc()]:[3,3];case 1:n.sent()&&this.Yo("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.zo.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}}))}))},t.prototype.Yo=function(t){throw this.Go.cancel(),new Error("Invalid bundle format: "+t)},t.prototype.tc=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t,e;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.Go.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}}))}))},t}(),dl=function(){function t(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,n=this;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new Er(Tr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r,o,a,s,u;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return n=xr(t),r=Aa(n.R)+"/documents",o={documents:e.map((function(t){return Ea(n.R,t)}))},[4,n.$i("BatchGetDocuments",r,o)];case 1:return a=i.sent(),s=new Map,a.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){Dr(!!e.found),e.found.name,e.found.updateTime;var n=Sa(t,e.found.name),r=wa(e.found.updateTime),i=new wi({mapValue:{fields:e.found.fields}});return Ti.newFoundDocument(n,r,i)}(t,e):"missing"in e?function(t,e){Dr(!!e.missing),Dr(!!e.readTime);var n=Sa(t,e.missing),r=wa(e.readTime);return Ti.newNoDocument(n,r)}(t,e):Rr()}(n.R,t);s.set(e.key.toString(),e)})),u=[],[2,(e.forEach((function(t){var e=s.get(t.toString());Dr(!!e),u.push(e)})),u)]}}))}))}(this.datastore,t)];case 1:return[2,((e=r.sent()).forEach((function(t){return n.recordVersion(t)})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())},t.prototype.delete=function(t){this.write(new qo(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.commit=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t,e=this;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=ai.fromPath(n);e.mutations.push(new Vo(r,e.precondition(r)))})),[4,function(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r,o;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return n=xr(t),r=Aa(n.R)+"/documents",o={writes:e.map((function(t){return Da(n.R,t)}))},[4,n.Ni("Commit",r,o)];case 1:return i.sent(),[2]}}))}))}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}}))}))},t.prototype.recordVersion=function(t){var e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw Rr();e=qr.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Er(Tr.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?So.updateTime(e):So.none()},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(qr.min()))throw new Er(Tr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return So.updateTime(e)}return So.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},t.prototype.ensureCommitNotCalled=function(){},t}(),pl=function(){function t(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new kc(this.asyncQueue,"transaction_retry")}return t.prototype.run=function(){this.ec-=1,this.nc()},t.prototype.nc=function(){var t=this;this.Zi.ji((function(){return(0,i.__awaiter)(t,void 0,void 0,(function(){var t,e,n=this;return(0,i.__generator)(this,(function(r){return t=new dl(this.datastore),(e=this.sc(t))&&e.then((function(e){n.asyncQueue.enqueueAndForget((function(){return t.commit().then((function(){n.deferred.resolve(e)})).catch((function(t){n.ic(t)}))}))})).catch((function(t){n.ic(t)})),[2]}))}))}))},t.prototype.sc=function(t){try{var e=this.updateFunction(t);return!ri(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}},t.prototype.ic=function(t){var e=this;this.ec>0&&this.rc(t)?(this.ec-=1,this.asyncQueue.enqueueAndForget((function(){return e.nc(),Promise.resolve()}))):this.deferred.reject(t)},t.prototype.rc=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!Ko(e)}return!1},t}(),vl=function(){function t(t,e,n){var r=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=uc.UNAUTHENTICATED,this.clientId=Lr.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(e,(function(t){return(0,i.__awaiter)(r,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return kr("FirestoreClient","Received user=",t.uid),[4,this.credentialListener(t)];case 1:return e.sent(),this.user=t,[2]}}))}))}))}return t.prototype.getConfiguration=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(t){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]}))}))},t.prototype.setCredentialChangeListener=function(t){this.credentialListener=t},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new Er(Tr.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new ys;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((function(){return(0,i.__awaiter)(t,void 0,void 0,(function(){var t,n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.removeChangeListener(),e.resolve(),[3,6];case 5:return t=r.sent(),n=ah(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}}))}))})),e.promise},t}();function gl(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r,o=this;return(0,i.__generator)(this,(function(a){switch(a.label){case 0:return t.asyncQueue.verifyOperationInProgress(),kr("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=a.sent(),[4,e.initialize(n)];case 2:return a.sent(),r=n.initialUser,t.setCredentialChangeListener((function(t){return(0,i.__awaiter)(o,void 0,void 0,(function(){return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return r.isEqual(t)?[3,2]:[4,Uu(e.localStore,t)];case 1:n.sent(),r=t,n.label=2;case 2:return[2]}}))}))})),e.persistence.setDatabaseDeletedListener((function(){return t.terminate()})),t.offlineComponents=e,[2]}}))}))}function yl(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,i.__generator)(this,(function(o){switch(o.label){case 0:return t.asyncQueue.verifyOperationInProgress(),[4,ml(t)];case 1:return n=o.sent(),kr("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=o.sent(),[4,e.initialize(n,r)];case 3:return o.sent(),t.setCredentialChangeListener((function(t){return function(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return(n=xr(t)).asyncQueue.verifyOperationInProgress(),kr("RemoteStore","RemoteStore received new credentials"),r=Bc(n),n.Or.add(3),[4,Lc(n)];case 1:return i.sent(),r&&n.Br.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(e)];case 2:return i.sent(),n.Or.delete(3),[4,Oc(n)];case 3:return i.sent(),[2]}}))}))}(e.remoteStore,t)})),t.onlineComponents=e,[2]}}))}))}function ml(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:(kr("FirestoreClient","Using default OfflineComponentProvider"),[4,gl(t,new al)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}}))}))}function _l(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:(kr("FirestoreClient","Using default OnlineComponentProvider"),[4,yl(t,new cl)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}}))}))}function bl(t){return ml(t).then((function(t){return t.persistence}))}function wl(t){return ml(t).then((function(t){return t.localStore}))}function Il(t){return _l(t).then((function(t){return t.remoteStore}))}function Tl(t){return _l(t).then((function(t){return t.syncEngine}))}function El(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return[4,_l(t)];case 1:return e=r.sent(),[2,((n=e.eventManager).onListen=Ah.bind(null,e.syncEngine),n.onUnlisten=Ph.bind(null,e.syncEngine),n)]}}))}))}function Sl(t,e,n){var r=this;void 0===n&&(n={});var o=new ys;return t.asyncQueue.enqueueAndForget((function(){return(0,i.__awaiter)(r,void 0,void 0,(function(){var r;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return r=function(t,e,n,r,i){var o=new ll({next:function(o){e.enqueueAndForget((function(){return dh(t,a)}));var s=o.docs.has(n);!s&&o.fromCache?i.reject(new Er(Tr.UNAVAILABLE,"Failed to get document because the client is offline.")):s&&o.fromCache&&r&&"server"===r.source?i.reject(new Er(Tr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),a=new yh(Gi(n.path),o,{includeMetadataChanges:!0,so:!0});return fh(t,a)},[4,El(t)];case 1:return[2,r.apply(void 0,[i.sent(),t.asyncQueue,e,n,o])]}}))}))})),o.promise}function Cl(t,e,n){var r=this;void 0===n&&(n={});var o=new ys;return t.asyncQueue.enqueueAndForget((function(){return(0,i.__awaiter)(r,void 0,void 0,(function(){var r;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return r=function(t,e,n,r,i){var o=new ll({next:function(n){e.enqueueAndForget((function(){return dh(t,a)})),n.fromCache&&"server"===r.source?i.reject(new Er(Tr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),a=new yh(n,o,{includeMetadataChanges:!0,so:!0});return fh(t,a)},[4,El(t)];case 1:return[2,r.apply(void 0,[i.sent(),t.asyncQueue,e,n,o])]}}))}))})),o.promise}var kl=function(t,e,n,r,i,o,a,s){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.useFetchStreams=s},Al=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),Nl=new Map,Pl=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t},Rl=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){this.changeListener=e,t.enqueueRetryable((function(){return e(uc.UNAUTHENTICATED)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Dl=function(){function t(t){this.token=t,this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(this.token)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){var n=this;this.changeListener=e,t.enqueueRetryable((function(){return e(n.token.user)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),xl=function(){function t(t){var e=this;this.currentUser=uc.UNAUTHENTICATED,this.oc=new ys,this.cc=0,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=function(){e.cc++,e.currentUser=e.ac(),e.oc.resolve(),e.changeListener&&e.asyncQueue.enqueueRetryable((function(){return e.changeListener(e.currentUser)}))};var n=function(t){kr("FirebaseCredentialsProvider","Auth detected"),e.auth=t,e.auth.addAuthTokenListener(e.uc)};t.onInit((function(t){return n(t)})),setTimeout((function(){if(!e.auth){var r=t.getImmediate({optional:!0});r?n(r):(kr("FirebaseCredentialsProvider","Auth not yet detected"),e.oc.resolve())}}),0)}return t.prototype.getToken=function(){var t=this,e=this.cc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.cc!==e?(kr("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(Dr("string"==typeof n.accessToken),new Pl(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t,e){var n=this;this.asyncQueue=t,this.asyncQueue.enqueueRetryable((function(){return(0,i.__awaiter)(n,void 0,void 0,(function(){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.oc.promise];case 1:return t.sent(),[4,e(this.currentUser)];case 2:return t.sent(),this.changeListener=e,[2]}}))}))}))},t.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=function(){return Promise.resolve()}},t.prototype.ac=function(){var t=this.auth&&this.auth.getUid();return Dr(null===t||"string"==typeof t),new uc(t)},t}(),Ol=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n,this.type="FirstParty",this.user=uc.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.lc},e=this.hc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.fc&&(t["X-Goog-Iam-Authorization-Token"]=this.fc),t},enumerable:!1,configurable:!0}),t}(),Ll=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n}return t.prototype.getToken=function(){return Promise.resolve(new Ol(this.hc,this.lc,this.fc))},t.prototype.setChangeListener=function(t,e){t.enqueueRetryable((function(){return e(uc.FIRST_PARTY)}))},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();function Ml(t,e,n){if(!n)throw new Er(Tr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Fl(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Er(Tr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Ul(t,e,n,r){if(!0===e&&!0===r)throw new Er(Tr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function jl(t){if(!ai.isDocumentKey(t))throw new Er(Tr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function ql(t){if(ai.isDocumentKey(t))throw new Er(Tr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Vl(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":Rr()}function Bl(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Er(Tr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Vl(t);throw new Er(Tr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function Kl(t,e){if(e<=0)throw new Er(Tr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Wl=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Er(Tr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Er(Tr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,Ul("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams},t}(),Hl=function(){function t(t,e){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Wl({}),this._settingsFrozen=!1,t instanceof Al?(this._databaseId=t,this._credentials=new Rl):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Er(Tr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Al(t.options.projectId)}(t),this._credentials=new xl(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this._app)throw new Er(Tr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),t.prototype._setSettings=function(t){if(this._settingsFrozen)throw new Er(Tr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Wl(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new Rl;switch(t.type){case"gapi":var e=t.client;return Dr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Ll(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new Er(Tr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype._getSettings=function(){return this._settings},t.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},t.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},t.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},t.prototype._terminate=function(){return this,(t=Nl.get(this))&&(kr("ComponentProvider","Removing Datastore"),Nl.delete(this),t.terminate()),Promise.resolve();var t},t}(),Gl=function(){function t(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Ql(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._key)},t}(),zl=function(){function t(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this._query)},t}(),Ql=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,Gi(r))||this)._path=r,i.type="collection",i}return(0,i.__extends)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new Gl(this.firestore,null,new ai(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._path)},e}(zl);function Yl(t,e){for(var n,r=[],a=2;a<arguments.length;a++)r[a-2]=arguments[a];if(t=(0,o.getModularInstance)(t),Ml("collection","path",e),t instanceof Hl)return ql(n=Hr.fromString.apply(Hr,(0,i.__spreadArray)([e],r))),new Ql(t,null,n);if(!(t instanceof Gl||t instanceof Ql))throw new Er(Tr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return ql(n=Hr.fromString.apply(Hr,(0,i.__spreadArray)([t.path],r)).child(Hr.fromString(e))),new Ql(t.firestore,null,n)}function Xl(t,e){for(var n,r=[],a=2;a<arguments.length;a++)r[a-2]=arguments[a];if(t=(0,o.getModularInstance)(t),1===arguments.length&&(e=Lr.u()),Ml("doc","path",e),t instanceof Hl)return jl(n=Hr.fromString.apply(Hr,(0,i.__spreadArray)([e],r))),new Gl(t,null,new ai(n));if(!(t instanceof Gl||t instanceof Ql))throw new Er(Tr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return jl(n=t._path.child(Hr.fromString.apply(Hr,(0,i.__spreadArray)([e],r)))),new Gl(t.firestore,t instanceof Ql?t.converter:null,new ai(n))}function $l(t,e){return t=(0,o.getModularInstance)(t),e=(0,o.getModularInstance)(e),(t instanceof Gl||t instanceof Ql)&&(e instanceof Gl||e instanceof Ql)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function Jl(t,e){return t=(0,o.getModularInstance)(t),e=(0,o.getModularInstance)(e),t instanceof zl&&e instanceof zl&&t.firestore===e.firestore&&eo(t._query,e._query)&&t.converter===e.converter}var Zl=function(){function t(){var t=this;this.dc=Promise.resolve(),this.wc=[],this._c=!1,this.mc=[],this.yc=null,this.gc=!1,this.Ec=!1,this.Tc=[],this.Zi=new kc(this,"async_queue_retry"),this.Ic=function(){var e=Sc();e&&kr("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Zi.Gi()};var e=Sc();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Ic)}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this._c},enumerable:!1,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Ac(),this.Rc(t)},t.prototype.enterRestrictedMode=function(t){if(!this._c){this._c=!0,this.Ec=t||!1;var e=Sc();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Ic)}},t.prototype.enqueue=function(t){var e=this;if(this.Ac(),this._c)return new Promise((function(){}));var n=new ys;return this.Rc((function(){return e._c&&e.Ec?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)})).then((function(){return n.promise}))},t.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget((function(){return e.wc.push(t),e.bc()}))},t.prototype.bc=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t,e=this;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:if(0===this.wc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.wc[0]()];case 2:return n.sent(),this.wc.shift(),this.Zi.reset(),[3,4];case 3:if(!Ts(t=n.sent()))throw t;return kr("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.wc.length>0&&this.Zi.ji((function(){return e.bc()})),n.label=5;case 5:return[2]}}))}))},t.prototype.Rc=function(t){var e=this,n=this.dc.then((function(){return e.gc=!0,t().catch((function(t){throw e.yc=t,e.gc=!1,Ar("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.gc=!1,t}))}));return this.dc=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.Ac(),this.Tc.indexOf(t)>-1&&(e=0);var i=oh.createAndSchedule(this,t,e,n,(function(t){return r.vc(t)}));return this.mc.push(i),i},t.prototype.Ac=function(){this.yc&&Rr()},t.prototype.verifyOperationInProgress=function(){},t.prototype.Pc=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t;return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return[4,t=this.dc];case 1:e.sent(),e.label=2;case 2:if(t!==this.dc)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.Vc=function(t){for(var e=0,n=this.mc;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.Sc=function(t){var e=this;return this.Pc().then((function(){e.mc.sort((function(t,e){return t.targetTimeMs-e.targetTimeMs}));for(var n=0,r=e.mc;n<r.length;n++){var i=r[n];if(i.skipDelay(),"all"!==t&&i.timerId===t)break}return e.Pc()}))},t.prototype.Dc=function(t){this.Tc.push(t)},t.prototype.vc=function(t){var e=this.mc.indexOf(t);this.mc.splice(e,1)},t}();function tf(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var ef=function(){function t(){this._progressObserver={},this._taskCompletionResolver=new ys,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}return t.prototype.onProgress=function(t,e,n){this._progressObserver={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this._taskCompletionResolver.promise.catch(t)},t.prototype.then=function(t,e){return this._taskCompletionResolver.promise.then(t,e)},t.prototype._completeWith=function(t){this._updateProgress(t),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(t)},t.prototype._failWith=function(t){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(t),this._taskCompletionResolver.reject(t)},t.prototype._updateProgress=function(t){this._lastProgress=t,this._progressObserver.next&&this._progressObserver.next(t)},t}(),nf=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).type="firestore",r._queue=new Zl,r._persistenceKey="name"in e?e.name:"[DEFAULT]",r}return(0,i.__extends)(e,t),e.prototype._terminate=function(){return this._firestoreClient||of(this),this._firestoreClient.terminate()},e}(Hl);function rf(t){return t._firestoreClient||of(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function of(t){var e,n=t._freezeSettings(),r=function(t,e,n,r){return new kl(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new vl(t._credentials,t._queue,r)}function af(t,e,n){var r=this,o=new ys;return t.asyncQueue.enqueue((function(){return(0,i.__awaiter)(r,void 0,void 0,(function(){var r;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),[4,gl(t,n)];case 1:return i.sent(),[4,yl(t,e)];case 2:return i.sent(),o.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===Tr.FAILED_PRECONDITION||t.code===Tr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=i.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),o.reject(r),[3,4];case 4:return[2]}}))}))})).then((function(){return o.promise}))}function sf(t){if(t._initialized||t._terminated)throw new Er(Tr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var uf=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Er(Tr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new zr(t)}return t.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},t}(),cf=function(){function t(t){this._byteString=t}return t.fromBase64String=function(e){try{return new t(Yr.fromBase64String(e))}catch(e){throw new Er(Tr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(Yr.fromUint8Array(e))},t.prototype.toBase64=function(){return this._byteString.toBase64()},t.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},t}(),hf=function(t){this._methodName=t},lf=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new Er(Tr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Er(Tr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},t.prototype._compareTo=function(t){return Mr(this._lat,t._lat)||Mr(this._long,t._long)},t}(),ff=/^__.*__$/,df=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return null!==this.fieldMask?new Oo(t,this.data,this.fieldMask,e,this.fieldTransforms):new xo(t,this.data,e,this.fieldTransforms)},t}(),pf=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return new Oo(t,this.data,this.fieldMask,e,this.fieldTransforms)},t}();function vf(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Rr()}}var gf=function(){function t(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Cc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Nc",{get:function(){return this.settings.Nc},enumerable:!1,configurable:!0}),t.prototype.xc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},t.prototype.kc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.xc({path:n,Fc:!1});return r.$c(t),r},t.prototype.Oc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.xc({path:n,Fc:!1});return r.Cc(),r},t.prototype.Mc=function(t){return this.xc({path:void 0,Fc:!0})},t.prototype.Lc=function(t){return Mf(t,this.settings.methodName,this.settings.Bc||!1,this.path,this.settings.qc)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find((function(e){return t.isPrefixOf(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.isPrefixOf(e.field)}))},t.prototype.Cc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.$c(this.path.get(t))},t.prototype.$c=function(t){if(0===t.length)throw this.Lc("Document fields must not be empty");if(vf(this.Nc)&&ff.test(t))throw this.Lc('Document fields cannot begin and end with "__"')},t}(),yf=function(){function t(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.R=n||Cc(t)}return t.prototype.Uc=function(t,e,n,r){return void 0===r&&(r=!1),new gf({Nc:t,methodName:e,qc:n,path:zr.emptyPath(),Fc:!1,Bc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},t}();function mf(t){var e=t._freezeSettings(),n=Cc(t._databaseId);return new yf(t._databaseId,!!e.ignoreUndefinedProperties,n)}function _f(t,e,n,r,i,o){void 0===o&&(o={});var a=t.Uc(o.merge||o.mergeFields?2:0,e,n,i);Df("Data must be an object, but it was:",a,r);var s,u,c=Pf(r,a);if(o.merge)s=new Qr(a.fieldMask),u=a.fieldTransforms;else if(o.mergeFields){for(var h=[],l=0,f=o.mergeFields;l<f.length;l++){var d=xf(e,f[l],n);if(!a.contains(d))throw new Er(Tr.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");Ff(h,d)||h.push(d)}s=new Qr(h),u=a.fieldTransforms.filter((function(t){return s.covers(t.field)}))}else s=null,u=a.fieldTransforms;return new df(new wi(c),s,u)}var bf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,i.__extends)(e,t),e.prototype._toFieldTransform=function(t){if(2!==t.Nc)throw 1===t.Nc?t.Lc(this._methodName+"() can only appear at the top level of your update data"):t.Lc(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.fieldMask.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(hf);function wf(t,e,n){return new gf({Nc:3,qc:e.settings.qc,methodName:t._methodName,Fc:n},e.databaseId,e.R,e.ignoreUndefinedProperties)}var If=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,i.__extends)(e,t),e.prototype._toFieldTransform=function(t){return new To(t.path,new vo)},e.prototype.isEqual=function(t){return t instanceof e},e}(hf),Tf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return(0,i.__extends)(e,t),e.prototype._toFieldTransform=function(t){var e=wf(this,t,!0),n=this.Kc.map((function(t){return Nf(t,e)})),r=new go(n);return new To(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(hf),Ef=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return(0,i.__extends)(e,t),e.prototype._toFieldTransform=function(t){var e=wf(this,t,!0),n=this.Kc.map((function(t){return Nf(t,e)})),r=new mo(n);return new To(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(hf),Sf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Qc=n,r}return(0,i.__extends)(e,t),e.prototype._toFieldTransform=function(t){var e=new bo(t.R,co(t.R,this.Qc));return new To(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(hf);function Cf(t,e,n,r){var i=t.Uc(1,e,n);Df("Data must be an object, but it was:",i,r);var a=[],s=wi.empty();Br(r,(function(t,r){var u=Lf(e,t,n);r=(0,o.getModularInstance)(r);var c=i.Oc(u);if(r instanceof bf)a.push(u);else{var h=Nf(r,c);null!=h&&(a.push(u),s.set(u,h))}}));var u=new Qr(a);return new pf(s,u,i.fieldTransforms)}function kf(t,e,n,r,i,a){var s=t.Uc(1,e,n),u=[xf(e,r,n)],c=[i];if(a.length%2!=0)throw new Er(Tr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<a.length;h+=2)u.push(xf(e,a[h])),c.push(a[h+1]);for(var l=[],f=wi.empty(),d=u.length-1;d>=0;--d)if(!Ff(l,u[d])){var p=u[d],v=c[d];v=(0,o.getModularInstance)(v);var g=s.Oc(p);if(v instanceof bf)l.push(p);else{var y=Nf(v,g);null!=y&&(l.push(p),f.set(p,y))}}var m=new Qr(l);return new pf(f,m,s.fieldTransforms)}function Af(t,e,n,r){return void 0===r&&(r=!1),Nf(n,t.Uc(r?4:3,e))}function Nf(t,e){if(Rf(t=(0,o.getModularInstance)(t)))return Df("Unsupported field value:",e,t),Pf(t,e);if(t instanceof hf)return function(t,e){if(!vf(e.Nc))throw e.Lc(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Lc(t._methodName+"() is not currently supported inside arrays");var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Fc&&4!==e.Nc)throw e.Lc("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var a=Nf(o[i],e.Mc(r));null==a&&(a={nullValue:"NULL_VALUE"}),n.push(a),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=(0,o.getModularInstance)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return co(e.R,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=jr.fromDate(t);return{timestampValue:ma(e.R,n)}}if(t instanceof jr)return n=new jr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:ma(e.R,n)};if(t instanceof lf)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof cf)return{bytesValue:_a(e.R,t._byteString)};if(t instanceof Gl){n=e.databaseId;var r=t.firestore._databaseId;if(!r.isEqual(n))throw e.Lc("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Ia(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Lc("Unsupported field value: "+Vl(t))}(t,e)}function Pf(t,e){var n={};return Kr(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Br(t,(function(t,r){var i=Nf(r,e.kc(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function Rf(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof jr||t instanceof lf||t instanceof cf||t instanceof Gl||t instanceof hf)}function Df(t,e,n){if(!Rf(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=Vl(n);throw"an object"===r?e.Lc(t+" a custom object"):e.Lc(t+" "+r)}}function xf(t,e,n){if((e=(0,o.getModularInstance)(e))instanceof uf)return e._internalPath;if("string"==typeof e)return Lf(t,e);throw Mf("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Of=new RegExp("[~\\*/\\[\\]]");function Lf(t,e,n){if(e.search(Of)>=0)throw Mf("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(uf.bind.apply(uf,(0,i.__spreadArray)([void 0],e.split(".")))))._internalPath}catch(Vd){throw Mf("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function Mf(t,e,n,r,i){var o=r&&!r.isEmpty(),a=void 0!==i,s="Function "+e+"() called with invalid data";n&&(s+=" (via `toFirestore()`)");var u="";return(o||a)&&(u+=" (found",o&&(u+=" in field "+r),a&&(u+=" in document "+i),u+=")"),new Er(Tr.INVALID_ARGUMENT,(s+=". ")+t+u)}function Ff(t,e){return t.some((function(t){return t.isEqual(e)}))}var Uf=function(){function t(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Gl(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this._document},t.prototype.data=function(){if(this._document){if(this._converter){var t=new jf(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}},t.prototype.get=function(t){if(this._document){var e=this._document.data.field(qf("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}},t}(),jf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,i.__extends)(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(Uf);function qf(t,e){return"string"==typeof e?Lf(t,e):e instanceof uf?e._internalPath:e._delegate._internalPath}var Vf=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Bf=function(t){function e(e,n,r,i,o,a){var s=this;return(s=t.call(this,e,n,r,i,a)||this)._firestore=e,s._firestoreImpl=e,s.metadata=o,s}return(0,i.__extends)(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new Kf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){var n=this._document.data.field(qf("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}},e}(Uf),Kf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,i.__extends)(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(Bf),Wf=function(){function t(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new Vf(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._snapshot.docs.forEach((function(r){t.call(e,new Kf(n._firestore,n._userDataWriter,r.key,r,new Vf(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Er(Tr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map((function(e){return{type:"added",doc:new Kf(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Vf(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),oldIndex:-1,newIndex:n++}}))}var r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new Kf(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Vf(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:Hf(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t}();function Hf(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Rr()}}function Gf(t,e){return t instanceof Bf&&e instanceof Bf?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Wf&&e instanceof Wf&&t._firestore===e._firestore&&Jl(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function zf(t){if(Qi(t)&&0===t.explicitOrderBy.length)throw new Er(Tr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Qf=function(){};function Yf(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o._apply(t)}return t}var Xf=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).jc=e,i.Wc=n,i.Gc=r,i.type="where",i}return(0,i.__extends)(e,t),e.prototype._apply=function(t){var e=mf(t.firestore),n=function(t,e,n,r,i,o,a){var s;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new Er(Tr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){rd(a,o);for(var u=[],c=0,h=a;c<h.length;c++){var l=h[c];u.push(nd(r,t,l))}s={arrayValue:{values:u}}}else s=nd(r,t,a)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||rd(a,o),s=Af(n,"where",a,"in"===o||"not-in"===o);var f=Ni.create(i,o,s);return function(t,e){if(e.g()){var n=Xi(t);if(null!==n&&!n.isEqual(e.field))throw new Er(Tr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=Yi(t);null!==r&&id(t,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw i===e.op?new Er(Tr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Er(Tr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(t._query,0,e,t.firestore._databaseId,this.jc,this.Wc,this.Gc);return new zl(t.firestore,t.converter,function(t,e){var n=t.filters.concat([e]);return new Wi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t._query,n))},e}(Qf),$f=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).jc=e,r.zc=n,r.type="orderBy",r}return(0,i.__extends)(e,t),e.prototype._apply=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Er(Tr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Er(Tr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new qi(e,n);return function(t,e){if(null===Yi(t)){var n=Xi(t);null!==n&&id(t,n,e.field)}}(t,r),r}(t._query,this.jc,this.zc);return new zl(t.firestore,t.converter,function(t,e){var n=t.explicitOrderBy.concat([e]);return new Wi(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))},e}(Qf),Jf=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Hc=n,i.Jc=r,i}return(0,i.__extends)(e,t),e.prototype._apply=function(t){return new zl(t.firestore,t.converter,to(t._query,this.Hc,this.Jc))},e}(Qf),Zf=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Yc=n,i.Xc=r,i}return(0,i.__extends)(e,t),e.prototype._apply=function(t){var e=ed(t,this.type,this.Yc,this.Xc);return new zl(t.firestore,t.converter,function(t,e){return new Wi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t._query,e))},e}(Qf),td=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Yc=n,i.Xc=r,i}return(0,i.__extends)(e,t),e.prototype._apply=function(t){var e=ed(t,this.type,this.Yc,this.Xc);return new zl(t.firestore,t.converter,function(t,e){return new Wi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t._query,e))},e}(Qf);function ed(t,e,n,r){if(n[0]=(0,o.getModularInstance)(n[0]),n[0]instanceof Uf)return function(t,e,n,r,i){if(!r)throw new Er(Tr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],a=0,s=Ji(t);a<s.length;a++){var u=s[a];if(u.field.isKeyField())o.push(pi(e,r.key));else{var c=r.data.field(u.field);if(ti(c))throw new Er(Tr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=u.field.canonicalString();throw new Er(Tr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new Ui(o,i)}(t._query,t.firestore._databaseId,e,n[0]._document,r);var i=mf(t.firestore);return function(t,e,n,r,i,o){var a=t.explicitOrderBy;if(i.length>a.length)throw new Er(Tr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var s=[],u=0;u<i.length;u++){var c=i[u];if(a[u].field.isKeyField()){if("string"!=typeof c)throw new Er(Tr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!$i(t)&&-1!==c.indexOf("/"))throw new Er(Tr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(Hr.fromString(c));if(!ai.isDocumentKey(h))throw new Er(Tr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var l=new ai(h);s.push(pi(e,l))}else{var f=Af(n,r,c);s.push(f)}}return new Ui(s,o)}(t._query,t.firestore._databaseId,i,e,n,r)}function nd(t,e,n){if("string"==typeof(n=(0,o.getModularInstance)(n))){if(""===n)throw new Er(Tr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!$i(e)&&-1!==n.indexOf("/"))throw new Er(Tr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(Hr.fromString(n));if(!ai.isDocumentKey(r))throw new Er(Tr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return pi(t,new ai(r))}if(n instanceof Gl)return pi(t,n._key);throw new Er(Tr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Vl(n)+".")}function rd(t,e){if(!Array.isArray(t)||0===t.length)throw new Er(Tr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new Er(Tr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function id(t,e,n){if(!n.isEqual(e))throw new Er(Tr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}var od=function(){function t(){}return t.prototype.convertValue=function(t,e){switch(void 0===e&&(e="none"),si(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Jr(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Zr(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw Rr()}},t.prototype.convertObject=function(t,e){var n=this,r={};return Br(t.fields,(function(t,i){r[t]=n.convertValue(i,e)})),r},t.prototype.convertGeoPoint=function(t){return new lf(Jr(t.latitude),Jr(t.longitude))},t.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.convertValue(t,e)}))},t.prototype.convertServerTimestamp=function(t,e){switch(e){case"previous":var n=ei(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(ni(t));default:return null}},t.prototype.convertTimestamp=function(t){var e=$r(t);return new jr(e.seconds,e.nanos)},t.prototype.convertDocumentKey=function(t,e){var n=Hr.fromString(t);Dr(za(n));var r=new Al(n.get(1),n.get(3)),i=new ai(n.popFirst(5));return r.isEqual(e)||Ar("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}();function ad(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var sd=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return(0,i.__extends)(e,t),e.prototype.convertBytes=function(t){return new cf(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Gl(this.firestore,null,e)},e}(od),ud=function(){function t(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=mf(t)}return t.prototype.set=function(t,e,n){this._verifyNotCommitted();var r=cd(t,this._firestore),i=ad(r.converter,e,n),o=_f(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,So.none())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this._verifyNotCommitted();var a,s=cd(t,this._firestore);return a="string"==typeof(e=(0,o.getModularInstance)(e))||e instanceof uf?kf(this._dataReader,"WriteBatch.update",s._key,e,n,r):Cf(this._dataReader,"WriteBatch.update",s._key,e),this._mutations.push(a.toMutation(s._key,So.exists(!0))),this},t.prototype.delete=function(t){this._verifyNotCommitted();var e=cd(t,this._firestore);return this._mutations=this._mutations.concat(new qo(e._key,So.none())),this},t.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},t.prototype._verifyNotCommitted=function(){if(this._committed)throw new Er(Tr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function cd(t,e){if((t=(0,o.getModularInstance)(t)).firestore!==e)throw new Er(Tr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var hd=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return(0,i.__extends)(e,t),e.prototype.convertBytes=function(t){return new cf(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Gl(this.firestore,null,e)},e}(od);function ld(t,e,n){t=Bl(t,Gl);var r=Bl(t.firestore,nf),i=ad(t.converter,e,n);return pd(r,[_f(mf(r),"setDoc",t._key,i,null!==t.converter,n).toMutation(t._key,So.none())])}function fd(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Bl(t,Gl);var a=Bl(t.firestore,nf),s=mf(a);return pd(a,[("string"==typeof(e=(0,o.getModularInstance)(e))||e instanceof uf?kf(s,"updateDoc",t._key,e,n,r):Cf(s,"updateDoc",t._key,e)).toMutation(t._key,So.exists(!0))])}function dd(t){for(var e,n,r,a=[],s=1;s<arguments.length;s++)a[s-1]=arguments[s];t=(0,o.getModularInstance)(t);var u={includeMetadataChanges:!1},c=0;"object"!=typeof a[c]||tf(a[c])||(u=a[c],c++);var h,l,f,d={includeMetadataChanges:u.includeMetadataChanges};if(tf(a[c])){var p=a[c];a[c]=null===(e=p.next)||void 0===e?void 0:e.bind(p),a[c+1]=null===(n=p.error)||void 0===n?void 0:n.bind(p),a[c+2]=null===(r=p.complete)||void 0===r?void 0:r.bind(p)}if(t instanceof Gl)l=Bl(t.firestore,nf),f=Gi(t._key.path),h={next:function(e){a[c]&&a[c](vd(l,t,e))},error:a[c+1],complete:a[c+2]};else{var v=Bl(t,zl);l=Bl(v.firestore,nf),f=v._query;var g=new hd(l);h={next:function(t){a[c]&&a[c](new Wf(l,g,v,t))},error:a[c+1],complete:a[c+2]},zf(t._query)}return function(t,e,n,r){var o=this,a=new ll(r),s=new yh(e,a,n);return t.asyncQueue.enqueueAndForget((function(){return(0,i.__awaiter)(o,void 0,void 0,(function(){var e;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return e=fh,[4,El(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}}))}))})),function(){a.Wo(),t.asyncQueue.enqueueAndForget((function(){return(0,i.__awaiter)(o,void 0,void 0,(function(){var e;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return e=dh,[4,El(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}}))}))}))}}(rf(l),f,d,h)}function pd(t,e){return function(t,e){var n=this,r=new ys;return t.asyncQueue.enqueueAndForget((function(){return(0,i.__awaiter)(n,void 0,void 0,(function(){var n;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return n=Rh,[4,Tl(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(rf(t),e)}function vd(t,e,n){var r=n.docs.get(e._key),i=new hd(t);return new Bf(t,i,e._key,r,new Vf(n.hasPendingWrites,n.fromCache),e.converter)}var gd=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this)._firestore=e,r}return(0,i.__extends)(e,t),e.prototype.get=function(e){var n=this,r=cd(e,this._firestore),i=new hd(this._firestore);return t.prototype.get.call(this,e).then((function(t){return new Bf(n._firestore,i,r._key,t._document,new Vf(!1,!1),r.converter)}))},e}(function(){function t(t,e){this._firestore=t,this._transaction=e,this._dataReader=mf(t)}return t.prototype.get=function(t){var e=this,n=cd(t,this._firestore),r=new sd(this._firestore);return this._transaction.lookup([n._key]).then((function(t){if(!t||1!==t.length)return Rr();var i=t[0];if(i.isFoundDocument())return new Uf(e._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new Uf(e._firestore,r,n._key,null,n.converter);throw Rr()}))},t.prototype.set=function(t,e,n){var r=cd(t,this._firestore),i=ad(r.converter,e,n),o=_f(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var a,s=cd(t,this._firestore);return a="string"==typeof(e=(0,o.getModularInstance)(e))||e instanceof uf?kf(this._dataReader,"Transaction.update",s._key,e,n,r):Cf(this._dataReader,"Transaction.update",s._key,e),this._transaction.update(s._key,a),this},t.prototype.delete=function(t){var e=cd(t,this._firestore);return this._transaction.delete(e._key),this},t}());function yd(){if("undefined"==typeof Uint8Array)throw new Er(Tr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function md(){if("undefined"==typeof atob)throw new Er(Tr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var _d=function(){function t(t){this._delegate=t}return t.fromBase64String=function(e){return md(),new t(cf.fromBase64String(e))},t.fromUint8Array=function(e){return yd(),new t(cf.fromUint8Array(e))},t.prototype.toBase64=function(){return md(),this._delegate.toBase64()},t.prototype.toUint8Array=function(){return yd(),this._delegate.toUint8Array()},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t}(),bd=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){sf(t=Bl(t,nf));var n=rf(t),r=t._freezeSettings(),i=new cl;return af(n,i,new sl(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._delegate,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){sf(t=Bl(t,nf));var e=rf(t),n=t._freezeSettings(),r=new cl;return af(e,r,new ul(r,n.cacheSizeBytes))}(t._delegate)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t._initialized&&!t._terminated)throw new Er(Tr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new ys;return t._queue.enqueueAndForgetEvenWhileRestricted((function(){return(0,i.__awaiter)(e,void 0,void 0,(function(){var e;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return bs.yt()?(e=t+"main",[4,bs.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(Ru(t._databaseId,t._persistenceKey))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t._delegate)},t}(),wd=function(){function t(t,e,n){var r=this;this._delegate=e,this.Zc=n,this.INTERNAL={delete:function(){return r.terminate()}},t instanceof Al||(this.tu=t)}return Object.defineProperty(t.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){var e=this._delegate._getSettings();t.merge||e.host===t.host||Nr("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&delete(t=Object.assign(Object.assign({},e),t)).merge,this._delegate._setSettings(t)},t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),function(t,e,n,r){var i;void 0===r&&(r={});var a=(t=Bl(t,Hl))._getSettings();if("firestore.googleapis.com"!==a.host&&a.host!==e&&Nr("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},a),{host:e+":"+n,ssl:!1})),r.mockUserToken){var s,u;if("string"==typeof r.mockUserToken)s=r.mockUserToken,u=uc.MOCK_USER;else{s=(0,o.createMockUserToken)(r.mockUserToken,null===(i=t._app)||void 0===i?void 0:i.options.projectId);var c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new Er(Tr.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new uc(c)}t._credentials=new Dl(new Pl(s,u))}}(this._delegate,t,e,n)},t.prototype.enableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return(0,i.__awaiter)(e,void 0,void 0,(function(){var e,n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return[4,bl(t)];case 1:return e=r.sent(),[4,Il(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!0),function(t){var e=xr(t);return e.Or.delete(0),Oc(e)}(n))]}}))}))}))}(rf(Bl(this._delegate,nf)))},t.prototype.disableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return(0,i.__awaiter)(e,void 0,void 0,(function(){var e,n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return[4,bl(t)];case 1:return e=r.sent(),[4,Il(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!1),function(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return(e=xr(t)).Or.add(0),[4,Lc(e)];case 1:return n.sent(),e.Br.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(rf(Bl(this._delegate,nf)))},t.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Ul("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Zc.enableMultiTabIndexedDbPersistence(this):this.Zc.enableIndexedDbPersistence(this,n)},t.prototype.clearPersistence=function(){return this.Zc.clearIndexedDbPersistence(this)},t.prototype.terminate=function(){return this.tu&&(this.tu._removeServiceInstance("firestore"),this.tu._removeServiceInstance("firestore-exp")),this._delegate._delete()},t.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new ys;return t.asyncQueue.enqueueAndForget((function(){return(0,i.__awaiter)(e,void 0,void 0,(function(){var e;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return e=Fh,[4,Tl(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(rf(Bl(this._delegate,nf)))},t.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new ll(e);return t.asyncQueue.enqueueAndForget((function(){return(0,i.__awaiter)(n,void 0,void 0,(function(){var e;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return e=function(t,e){xr(t).Gr.add(e),e.next()},[4,El(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))})),function(){r.Wo(),t.asyncQueue.enqueueAndForget((function(){return(0,i.__awaiter)(n,void 0,void 0,(function(){var e;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return e=function(t,e){xr(t).Gr.delete(e)},[4,El(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))}))}}(rf(t=Bl(t,nf)),tf(e)?e:{next:e})}(this._delegate,t)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.tu)throw new Er(Tr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.tu},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new Ld(this,Yl(this._delegate,t))}catch(t){throw kd(t,"collection()","Firestore.collection()")}},t.prototype.doc=function(t){try{return new Cd(this,Xl(this._delegate,t))}catch(t){throw kd(t,"doc()","Firestore.doc()")}},t.prototype.collectionGroup=function(t){try{return new Dd(this,function(t,e){if(t=Bl(t,Hl),Ml("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Er(Tr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new zl(t,null,function(t){return new Wi(Hr.emptyPath(),t)}(e))}(this._delegate,t))}catch(t){throw kd(t,"collectionGroup()","Firestore.collectionGroup()")}},t.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new ys;return t.asyncQueue.enqueueAndForget((function(){return(0,i.__awaiter)(n,void 0,void 0,(function(){var n;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return[4,function(t){return _l(t).then((function(t){return t.datastore}))}(t)];case 1:return n=i.sent(),new pl(t.asyncQueue,n,e,r).run(),[2]}}))}))})),r.promise}(rf(t),(function(n){return e(new gd(t,n))}))}(this._delegate,(function(n){return t(new Td(e,n))}))},t.prototype.batch=function(){var t=this;return rf(this._delegate),new Ed(new ud(this._delegate,(function(e){return pd(t._delegate,e)})))},t.prototype.loadBundle=function(t){throw new Er(Tr.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},t.prototype.namedQuery=function(t){throw new Er(Tr.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},t}(),Id=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return(0,i.__extends)(e,t),e.prototype.convertBytes=function(t){return new _d(new cf(t))},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return Cd.eu(e,this.firestore,null)},e}(od);var Td=function(){function t(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new Id(t)}return t.prototype.get=function(t){var e=this,n=Md(t);return this._delegate.get(n).then((function(t){return new Pd(e._firestore,new Bf(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n.converter))}))},t.prototype.set=function(t,e,n){var r=Md(t);return n?(Fl("Transaction.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];var s=Md(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,(0,i.__spreadArray)([s,e,n],o)),this},t.prototype.delete=function(t){var e=Md(t);return this._delegate.delete(e),this},t}(),Ed=function(){function t(t){this._delegate=t}return t.prototype.set=function(t,e,n){var r=Md(t);return n?(Fl("WriteBatch.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];var s=Md(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,(0,i.__spreadArray)([s,e,n],o)),this},t.prototype.delete=function(t){var e=Md(t);return this._delegate.delete(e),this},t.prototype.commit=function(){return this._delegate.commit()},t}(),Sd=function(){function t(t,e,n){this._firestore=t,this._userDataWriter=e,this._delegate=n}return t.prototype.fromFirestore=function(t,e){var n=new Kf(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new Rd(this._firestore,n),null!=e?e:{})},t.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},t.nu=function(e,n){var r=t.su,i=r.get(e);i||(i=new WeakMap,r.set(e,i));var o=i.get(n);return o||(o=new t(e,new Id(e),n),i.set(n,o)),o},t}();Sd.su=new WeakMap;var Cd=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Id(t)}return t.iu=function(e,n,r){if(e.length%2!=0)throw new Er(Tr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(n,new Gl(n._delegate,r,new ai(e)))},t.eu=function(e,n,r){return new t(n,new Gl(n._delegate,r,e))},Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Ld(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new Ld(this.firestore,Yl(this._delegate,t))}catch(t){throw kd(t,"collection()","DocumentReference.collection()")}},t.prototype.isEqual=function(t){return(t=(0,o.getModularInstance)(t))instanceof Gl&&$l(this._delegate,t)},t.prototype.set=function(t,e){e=Fl("DocumentReference.set",e);try{return e?ld(this._delegate,t,e):ld(this._delegate,t)}catch(t){throw kd(t,"setDoc()","DocumentReference.set()")}},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?fd(this._delegate,t):fd.apply(void 0,(0,i.__spreadArray)([this._delegate,t,e],n))}catch(t){throw kd(t,"updateDoc()","DocumentReference.update()")}},t.prototype.delete=function(){return pd(Bl((t=this._delegate).firestore,nf),[new qo(t._key,So.none())]);var t},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Ad(e),i=Nd(e,(function(e){return new Pd(t.firestore,new Bf(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))}));return dd(this._delegate,r,i)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Bl(t,Gl);var e=Bl(t.firestore,nf),n=rf(e),r=new hd(e);return function(t,e){var n=this,r=new ys;return t.asyncQueue.enqueueAndForget((function(){return(0,i.__awaiter)(n,void 0,void 0,(function(){var n;return(0,i.__generator)(this,(function(o){switch(o.label){case 0:return n=function(t,e,n){return(0,i.__awaiter)(this,void 0,void 0,(function(){var r,o;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,function(t,e){var n=xr(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Mn.mn(t,e)}))}(t,e)];case 1:return(o=i.sent()).isFoundDocument()?n.resolve(o):o.isNoDocument()?n.resolve(null):n.reject(new Er(Tr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=i.sent(),o=ah(r,"Failed to get document '"+e+" from cache"),n.reject(o),[3,3];case 3:return[2]}}))}))},[4,wl(t)];case 1:return[2,n.apply(void 0,[o.sent(),e,r])]}}))}))})),r.promise}(n,t._key).then((function(n){return new Bf(e,r,t._key,n,new Vf(null!==n&&n.hasLocalMutations,!0),t.converter)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=Bl(t,Gl);var e=Bl(t.firestore,nf);return Sl(rf(e),t._key,{source:"server"}).then((function(n){return vd(e,t,n)}))}(this._delegate):function(t){t=Bl(t,Gl);var e=Bl(t.firestore,nf);return Sl(rf(e),t._key).then((function(n){return vd(e,t,n)}))}(this._delegate)).then((function(t){return new Pd(e.firestore,new Bf(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))}))},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(Sd.nu(this.firestore,e)):this._delegate.withConverter(null))},t}();function kd(t,e,n){return t.message=t.message.replace(e,n),t}function Ad(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!tf(r))return r}return{}}function Nd(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=tf(t[0])?t[0]:tf(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var Pd=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"ref",{get:function(){return new Cd(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),t.prototype.data=function(t){return this._delegate.data(t)},t.prototype.get=function(t,e){return this._delegate.get(t,e)},t.prototype.isEqual=function(t){return Gf(this._delegate,t._delegate)},t}(),Rd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,i.__extends)(e,t),e.prototype.data=function(t){return this._delegate.data(t)},e}(Pd),Dd=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Id(t)}return t.prototype.where=function(e,n,r){try{return new t(this.firestore,Yf(this._delegate,function(t,e,n){var r=e,i=qf("where",t);return new Xf(i,r,n)}(e,n,r)))}catch(e){throw kd(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.orderBy=function(e,n){try{return new t(this.firestore,Yf(this._delegate,function(t,e){void 0===e&&(e="asc");var n=e,r=qf("orderBy",t);return new $f(r,n)}(e,n)))}catch(e){throw kd(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.limit=function(e){try{return new t(this.firestore,Yf(this._delegate,function(t){return Kl("limit",t),new Jf("limit",t,"F")}(e)))}catch(e){throw kd(e,"limit()","Query.limit()")}},t.prototype.limitToLast=function(e){try{return new t(this.firestore,Yf(this._delegate,function(t){return Kl("limitToLast",t),new Jf("limitToLast",t,"L")}(e)))}catch(e){throw kd(e,"limitToLast()","Query.limitToLast()")}},t.prototype.startAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Yf(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Zf("startAt",t,!0)}.apply(void 0,e)))}catch(e){throw kd(e,"startAt()","Query.startAt()")}},t.prototype.startAfter=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Yf(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Zf("startAfter",t,!1)}.apply(void 0,e)))}catch(e){throw kd(e,"startAfter()","Query.startAfter()")}},t.prototype.endBefore=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Yf(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new td("endBefore",t,!0)}.apply(void 0,e)))}catch(e){throw kd(e,"endBefore()","Query.endBefore()")}},t.prototype.endAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Yf(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new td("endAt",t,!1)}.apply(void 0,e)))}catch(e){throw kd(e,"endAt()","Query.endAt()")}},t.prototype.isEqual=function(t){return Jl(this._delegate,t._delegate)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Bl(t,zl);var e=Bl(t.firestore,nf),n=rf(e),r=new hd(e);return function(t,e){var n=this,r=new ys;return t.asyncQueue.enqueueAndForget((function(){return(0,i.__awaiter)(n,void 0,void 0,(function(){var n;return(0,i.__generator)(this,(function(o){switch(o.label){case 0:return n=function(t,e,n){return(0,i.__awaiter)(this,void 0,void 0,(function(){var r,o,a,s,u;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,Gu(t,e,!0)];case 1:return u=i.sent(),r=new Eh(e,u.Bn),o=r._o(u.documents),a=r.applyChanges(o,!1),n.resolve(a.snapshot),[3,3];case 2:return s=i.sent(),u=ah(s,"Failed to execute query '"+e+" against cache"),n.reject(u),[3,3];case 3:return[2]}}))}))},[4,wl(t)];case 1:return[2,n.apply(void 0,[o.sent(),e,r])]}}))}))})),r.promise}(n,t._query).then((function(n){return new Wf(e,r,t,n)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=Bl(t,zl);var e=Bl(t.firestore,nf),n=rf(e),r=new hd(e);return Cl(n,t._query,{source:"server"}).then((function(n){return new Wf(e,r,t,n)}))}(this._delegate):function(t){t=Bl(t,zl);var e=Bl(t.firestore,nf),n=rf(e),r=new hd(e);return zf(t._query),Cl(n,t._query).then((function(n){return new Wf(e,r,t,n)}))}(this._delegate)).then((function(t){return new Od(e.firestore,new Wf(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))}))},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Ad(e),i=Nd(e,(function(e){return new Od(t.firestore,new Wf(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))}));return dd(this._delegate,r,i)},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(Sd.nu(this.firestore,e)):this._delegate.withConverter(null))},t}(),xd=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"doc",{get:function(){return new Rd(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),t}(),Od=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"query",{get:function(){return new Dd(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map((function(e){return new Rd(t._firestore,e)}))},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map((function(t){return new xd(e._firestore,t)}))},t.prototype.forEach=function(t,e){var n=this;this._delegate.forEach((function(r){t.call(e,new Rd(n._firestore,r))}))},t.prototype.isEqual=function(t){return Gf(this._delegate,t._delegate)},t}(),Ld=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._delegate=n,r}return(0,i.__extends)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._delegate.parent;return t?new Cd(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new Cd(this.firestore,void 0===t?Xl(this._delegate):Xl(this._delegate,t))}catch(t){throw kd(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=Bl(t.firestore,nf),r=Xl(t),i=ad(t.converter,e);return pd(n,[_f(mf(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,So.exists(!1))]).then((function(){return r}))}(this._delegate,t).then((function(t){return new Cd(e.firestore,t)}))},e.prototype.isEqual=function(t){return $l(this._delegate,t._delegate)},e.prototype.withConverter=function(t){return new e(this.firestore,t?this._delegate.withConverter(Sd.nu(this.firestore,t)):this._delegate.withConverter(null))},e}(Dd);function Md(t){return Bl(t,Gl)}var Fd=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._delegate=new(uf.bind.apply(uf,(0,i.__spreadArray)([void 0],t)))}return t.documentId=function(){return new t(zr.keyField().canonicalString())},t.prototype.isEqual=function(t){return(t=(0,o.getModularInstance)(t))instanceof uf&&this._delegate._internalPath.isEqual(t._internalPath)},t}(),Ud=function(){function t(t){this._delegate=t}return t.serverTimestamp=function(){var e=new If("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new t(e)},t.delete=function(){var e=new bf("deleteField");return e._methodName="FieldValue.delete",new t(e)},t.arrayUnion=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Tf("arrayUnion",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayUnion",new t(r)},t.arrayRemove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Ef("arrayRemove",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayRemove",new t(r)},t.increment=function(e){var n=function(t){return new Sf("increment",t)}(e);return n._methodName="FieldValue.increment",new t(n)},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t}();function jd(t){return function(t,e){var n=rf(t=Bl(t,nf)),r=new ef;return function(t,e,n,r){var o=this,a=function(t,e){return function(t,e){return new fl(t,e)}(function(t,e){if(t instanceof Uint8Array)return hl(t,e);if(t instanceof ArrayBuffer)return hl(new Uint8Array(t),e);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof t?(new TextEncoder).encode(t):t),e)}(n,Cc(e));t.asyncQueue.enqueueAndForget((function(){return(0,i.__awaiter)(o,void 0,void 0,(function(){var e;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return e=ol,[4,Tl(t)];case 1:return e.apply(void 0,[n.sent(),a,r]),[2]}}))}))}))}(n,t._databaseId,e,r),r}(this._delegate,t)}function qd(t){var e,n,r=this;return(e=this._delegate,n=t,function(t,e){var n=this;return t.asyncQueue.enqueue((function(){return(0,i.__awaiter)(n,void 0,void 0,(function(){var n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return n=function(t,e){var n=xr(t);return n.persistence.runTransaction("Get named query","readonly",(function(t){return n.Ke.getNamedQuery(t,e)}))},[4,wl(t)];case 1:return[2,n.apply(void 0,[r.sent(),e])]}}))}))}))}(rf(e=Bl(e,nf)),n).then((function(t){return t?new zl(e,null,t.query):null}))).then((function(t){return t?new Dd(r,t):null}))}var Vd,Bd,Kd=n(826),Wd={Firestore:wd,GeoPoint:lf,Timestamp:jr,Blob:_d,Transaction:Td,WriteBatch:Ed,DocumentReference:Cd,DocumentSnapshot:Pd,Query:Dd,QueryDocumentSnapshot:Rd,QuerySnapshot:Od,CollectionReference:Ld,FieldPath:Fd,FieldValue:Ud,setLogLevel:function(t){var e;e=t,Sr.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new Kd.Component("firestore",(function(t){return function(t,e){return new wd(t,new nf(t,e),new bd)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},Wd)))})(Vd=r.default),Vd.registerVersion("@firebase/firestore","2.4.1"),(Bd=wd).prototype.loadBundle=jd,Bd.prototype.namedQuery=qd;var Hd={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Gd=function(t){function e(n,r,i){var o=t.call(this,r)||this;return Object.setPrototypeOf(o,e.prototype),o.code=n,o.details=i,o}return(0,i.__extends)(e,t),e}(Error);var zd=function(){function t(t,e){var n=this;this.auth=null,this.messaging=null,this.auth=t.getImmediate({optional:!0}),this.messaging=e.getImmediate({optional:!0}),this.auth||t.get().then((function(t){return n.auth=t}),(function(){})),this.messaging||e.get().then((function(t){return n.messaging=t}),(function(){}))}return t.prototype.getAuthToken=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t;return(0,i.__generator)(this,(function(e){switch(e.label){case 0:if(!this.auth)return[2,void 0];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.auth.getToken()];case 2:return(t=e.sent())?[2,t.accessToken]:[2,void 0];case 3:return e.sent(),[2,void 0];case 4:return[2]}}))}))},t.prototype.getInstanceIdToken=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:if(!this.messaging||!("Notification"in self)||"granted"!==Notification.permission)return[2,void 0];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.messaging.getToken()];case 2:return[2,t.sent()];case 3:return t.sent(),[2,void 0];case 4:return[2]}}))}))},t.prototype.getContext=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t,e;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.getAuthToken()];case 1:return t=n.sent(),[4,this.getInstanceIdToken()];case 2:return e=n.sent(),[2,{authToken:t,instanceIdToken:e}]}}))}))},t}();function Qd(t,e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}var Yd=function(){function t(){}return t.prototype.encode=function(t){var e=this;if(null==t)return null;if(t instanceof Number&&(t=t.valueOf()),"number"===typeof t&&isFinite(t))return t;if(!0===t||!1===t)return t;if("[object String]"===Object.prototype.toString.call(t))return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map((function(t){return e.encode(t)}));if("function"===typeof t||"object"===typeof t)return Qd(t,(function(t){return e.encode(t)}));throw new Error("Data cannot be encoded in JSON: "+t)},t.prototype.decode=function(t){var e=this;if(null==t)return t;if(t["@type"])switch(t["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":var n=Number(t.value);if(isNaN(n))throw new Error("Data cannot be decoded from JSON: "+t);return n;default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map((function(t){return e.decode(t)})):"function"===typeof t||"object"===typeof t?Qd(t,(function(t){return e.decode(t)})):t},t}();var Xd=function(){function t(t,e,n,r,i,o){var a=this;void 0===i&&(i="us-central1"),this.app_=t,this.appCheckProvider=r,this.fetchImpl=o,this.serializer=new Yd,this.emulatorOrigin=null,this.INTERNAL={delete:function(){return Promise.resolve(a.deleteService())}},this.contextProvider=new zd(e,n),this.cancelAllRequests=new Promise((function(t){a.deleteService=function(){return t()}}));try{var s=new URL(i);this.customDomain=s.origin,this.region="us-central1"}catch(Vd){this.customDomain=null,this.region=i}}return Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!1,configurable:!0}),t.prototype._url=function(t){var e=this.app_.options.projectId;return null!==this.emulatorOrigin?this.emulatorOrigin+"/"+e+"/"+this.region+"/"+t:null!==this.customDomain?this.customDomain+"/"+t:"https://"+this.region+"-"+e+".cloudfunctions.net/"+t},t.prototype.useEmulator=function(t,e){this.emulatorOrigin="http://"+t+":"+e},t.prototype.useFunctionsEmulator=function(t){this.emulatorOrigin=t},t.prototype.httpsCallable=function(t,e){var n=this;return function(r){return n.call(t,r,e||{})}},t.prototype.postJSON=function(t,e,n){return(0,i.__awaiter)(this,void 0,void 0,(function(){var r,o,a;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return n["Content-Type"]="application/json",[4,this.getAppCheckToken()];case 1:null!==(r=i.sent())&&(n["X-Firebase-AppCheck"]=r),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,this.fetchImpl(t,{method:"POST",body:JSON.stringify(e),headers:n})];case 3:return o=i.sent(),[3,5];case 4:return i.sent(),[2,{status:0,json:null}];case 5:a=null,i.label=6;case 6:return i.trys.push([6,8,,9]),[4,o.json()];case 7:return a=i.sent(),[3,9];case 8:return i.sent(),[3,9];case 9:return[2,{status:o.status,json:a}]}}))}))},t.prototype.getAppCheckToken=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t;return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return(t=this.appCheckProvider.getImmediate({optional:!0}))?[4,t.getToken()]:[3,2];case 1:return[2,e.sent().token];case 2:return[2,null]}}))}))},t.prototype.call=function(t,e,n){return(0,i.__awaiter)(this,void 0,void 0,(function(){var r,o,a,s,u,c,h,l,f,d,p;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return r=this._url(t),e=this.serializer.encode(e),o={data:e},a={},[4,this.contextProvider.getContext()];case 1:return(s=i.sent()).authToken&&(a.Authorization="Bearer "+s.authToken),s.instanceIdToken&&(a["Firebase-Instance-ID-Token"]=s.instanceIdToken),u=n.timeout||7e4,c=function(t){var e,n=new Promise((function(n,r){e=setTimeout((function(){r(new Gd("deadline-exceeded","deadline-exceeded"))}),t)}));return{timer:e,promise:n}}(u),h=c.timer,l=c.promise,[4,Promise.race([$d(h,this.postJSON(r,o,a)),l,$d(h,this.cancelAllRequests)])];case 2:if(!(f=i.sent()))throw new Gd("cancelled","Firebase Functions instance was deleted.");if(d=function(t,e,n){var r=function(t){if(t>=200&&t<300)return"ok";switch(t){case 0:case 500:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(t),i=r,o=void 0;try{var a=e&&e.error;if(a){var s=a.status;if("string"===typeof s){if(!Hd[s])return new Gd("internal","internal");r=Hd[s],i=s}var u=a.message;"string"===typeof u&&(i=u),void 0!==(o=a.details)&&(o=n.decode(o))}}catch(Vd){}return"ok"===r?null:new Gd(r,i,o)}(f.status,f.json,this.serializer),d)throw d;if(!f.json)throw new Gd("internal","Response is not valid JSON object.");if("undefined"===typeof(p=f.json.data)&&(p=f.json.result),"undefined"===typeof p)throw new Gd("internal","Response is missing data field.");return[2,{data:this.serializer.decode(p)}]}}))}))},t}();function $d(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return[4,e];case 1:return n=r.sent(),clearTimeout(t),[2,n]}}))}))}!function(t,e){var n={Functions:Xd};t.INTERNAL.registerComponent(new Kd.Component("functions",(function(t,n){var r=n.instanceIdentifier,i=t.getProvider("app").getImmediate(),o=t.getProvider("auth-internal"),a=t.getProvider("app-check-internal"),s=t.getProvider("messaging");return new Xd(i,o,s,a,r,e)}),"PUBLIC").setServiceProps(n).setMultipleInstances(!0))}(r.default,fetch.bind(self)),r.default.registerVersion("@firebase/functions","0.6.16");var Jd,Zd=n(348),tp="0.4.32",ep=1e4,np="w:"+tp,rp="FIS_v2",ip=36e5,op=((Jd={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',Jd["not-registered"]="Firebase Installation is not registered.",Jd["installation-not-found"]="Firebase Installation not found.",Jd["request-failed"]='{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',Jd["app-offline"]="Could not process request. Application offline.",Jd["delete-pending-registration"]="Can't delete installation while there is a pending registration request.",Jd),ap=new o.ErrorFactory("installations","Installations",op);function sp(t){return t instanceof o.FirebaseError&&t.code.includes("request-failed")}function up(t){return"https://firebaseinstallations.googleapis.com/v1/projects/"+t.projectId+"/installations"}function cp(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}function hp(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return[4,e.json()];case 1:return n=i.sent(),r=n.error,[2,ap.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})]}}))}))}function lp(t){var e=t.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function fp(t,e){var n=e.refreshToken,r=lp(t);return r.append("Authorization",function(t){return rp+" "+t}(n)),r}function dp(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return[4,t()];case 1:return(e=n.sent()).status>=500&&e.status<600?[2,t()]:[2,e]}}))}))}function pp(t,e){var n=e.fid;return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,r,o,a,s,u;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return e=up(t),r=lp(t),o={fid:n,authVersion:rp,appId:t.appId,sdkVersion:np},a={method:"POST",headers:r,body:JSON.stringify(o)},[4,dp((function(){return fetch(e,a)}))];case 1:return(s=i.sent()).ok?[4,s.json()]:[3,3];case 2:return u=i.sent(),[2,{fid:u.fid||n,registrationStatus:2,refreshToken:u.refreshToken,authToken:cp(u.authToken)}];case 3:return[4,hp("Create Installation",s)];case 4:throw i.sent()}}))}))}function vp(t){return new Promise((function(e){setTimeout(e,t)}))}var gp=/^[cdef][\w-]{21}$/;function yp(){try{var t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;var e=function(t){var e=(n=t,btoa(String.fromCharCode.apply(String,(0,i.__spreadArray)([],(0,i.__read)(n)))).replace(/\+/g,"-").replace(/\//g,"_"));var n;return e.substr(0,22)}(t);return gp.test(e)?e:""}catch(_f){return""}}function mp(t){return t.appName+"!"+t.appId}var _p=new Map;function bp(t,e){var n=mp(t);wp(n,e),function(t,e){var n=Tp();n&&n.postMessage({key:t,fid:e});Ep()}(n,e)}function wp(t,e){var n,r,o=_p.get(t);if(o)try{for(var a=(0,i.__values)(o),s=a.next();!s.done;s=a.next()){(0,s.value)(e)}}catch(u){n={error:u}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}}var Ip=null;function Tp(){return!Ip&&"BroadcastChannel"in self&&((Ip=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(t){wp(t.data.key,t.data.fid)}),Ip}function Ep(){0===_p.size&&Ip&&(Ip.close(),Ip=null)}var Sp,Cp,kp="firebase-installations-store",Ap=null;function Np(){return Ap||(Ap=(0,Zd.openDb)("firebase-installations-database",1,(function(t){if(0===t.oldVersion)t.createObjectStore(kp)}))),Ap}function Pp(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r,o,a,s;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return n=mp(t),[4,Np()];case 1:return r=i.sent(),o=r.transaction(kp,"readwrite"),[4,(a=o.objectStore(kp)).get(n)];case 2:return s=i.sent(),[4,a.put(e,n)];case 3:return i.sent(),[4,o.complete];case 4:return i.sent(),s&&s.fid===e.fid||bp(t,e.fid),[2,e]}}))}))}function Rp(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,n,r;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return e=mp(t),[4,Np()];case 1:return n=i.sent(),[4,(r=n.transaction(kp,"readwrite")).objectStore(kp).delete(e)];case 2:return i.sent(),[4,r.complete];case 3:return i.sent(),[2]}}))}))}function Dp(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r,o,a,s,u;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return n=mp(t),[4,Np()];case 1:return r=i.sent(),o=r.transaction(kp,"readwrite"),[4,(a=o.objectStore(kp)).get(n)];case 2:return s=i.sent(),void 0!==(u=e(s))?[3,4]:[4,a.delete(n)];case 3:return i.sent(),[3,6];case 4:return[4,a.put(u,n)];case 5:i.sent(),i.label=6;case 6:return[4,o.complete];case 7:return i.sent(),!u||s&&s.fid===u.fid||bp(t,u.fid),[2,u]}}))}))}function xp(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,n,r;return(0,i.__generator)(this,(function(o){switch(o.label){case 0:return[4,Dp(t,(function(n){var r=function(t){var e=t||{fid:yp(),registrationStatus:0};return Mp(e)}(n),o=function(t,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(ap.create("app-offline"))};var n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=function(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,7]),[4,pp(t,e)];case 1:return n=i.sent(),[2,Pp(t,n)];case 2:return sp(r=i.sent())&&409===r.customData.serverCode?[4,Rp(t)]:[3,4];case 3:return i.sent(),[3,6];case 4:return[4,Pp(t,{fid:e.fid,registrationStatus:0})];case 5:i.sent(),i.label=6;case 6:throw r;case 7:return[2]}}))}))}(t,n);return{installationEntry:n,registrationPromise:r}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:Op(t)}:{installationEntry:e}}(t,r);return e=o.registrationPromise,o.installationEntry}))];case 1:return""!==(n=o.sent()).fid?[3,3]:(r={},[4,e]);case 2:return[2,(r.installationEntry=o.sent(),r)];case 3:return[2,{installationEntry:n,registrationPromise:e}]}}))}))}function Op(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,n,r,o;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return[4,Lp(t)];case 1:e=i.sent(),i.label=2;case 2:return 1!==e.registrationStatus?[3,5]:[4,vp(100)];case 3:return i.sent(),[4,Lp(t)];case 4:return e=i.sent(),[3,2];case 5:return 0!==e.registrationStatus?[3,7]:[4,xp(t)];case 6:return n=i.sent(),r=n.installationEntry,(o=n.registrationPromise)?[2,o]:[2,r];case 7:return[2,e]}}))}))}function Lp(t){return Dp(t,(function(t){if(!t)throw ap.create("installation-not-found");return Mp(t)}))}function Mp(t){return 1===(e=t).registrationStatus&&e.registrationTime+ep<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e}function Fp(t,e){var n=t.appConfig,r=t.platformLoggerProvider;return(0,i.__awaiter)(this,void 0,void 0,(function(){var t,o,a,s,u,c,h;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return t=function(t,e){var n=e.fid;return up(t)+"/"+n+"/authTokens:generate"}(n,e),o=fp(n,e),(a=r.getImmediate({optional:!0}))&&o.append("x-firebase-client",a.getPlatformInfoString()),s={installation:{sdkVersion:np}},u={method:"POST",headers:o,body:JSON.stringify(s)},[4,dp((function(){return fetch(t,u)}))];case 1:return(c=i.sent()).ok?[4,c.json()]:[3,3];case 2:return h=i.sent(),[2,cp(h)];case 3:return[4,hp("Generate Auth Token",c)];case 4:throw i.sent()}}))}))}function Up(t,e){return void 0===e&&(e=!1),(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r,o;return(0,i.__generator)(this,(function(a){switch(a.label){case 0:return[4,Dp(t.appConfig,(function(r){if(!qp(r))throw ap.create("not-registered");var o=r.authToken;if(!e&&function(t){return 2===t.requestStatus&&!function(t){var e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+ip}(t)}(o))return r;if(1===o.requestStatus)return n=function(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return[4,jp(t.appConfig)];case 1:n=i.sent(),i.label=2;case 2:return 1!==n.authToken.requestStatus?[3,5]:[4,vp(100)];case 3:return i.sent(),[4,jp(t.appConfig)];case 4:return n=i.sent(),[3,2];case 5:return 0===(r=n.authToken).requestStatus?[2,Up(t,e)]:[2,r]}}))}))}(t,e),r;if(!navigator.onLine)throw ap.create("app-offline");var a=function(t){var e={requestStatus:1,requestTime:Date.now()};return(0,i.__assign)((0,i.__assign)({},t),{authToken:e})}(r);return n=function(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r,o;return(0,i.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,8]),[4,Fp(t,e)];case 1:return n=a.sent(),o=(0,i.__assign)((0,i.__assign)({},e),{authToken:n}),[4,Pp(t.appConfig,o)];case 2:return a.sent(),[2,n];case 3:return!sp(r=a.sent())||401!==r.customData.serverCode&&404!==r.customData.serverCode?[3,5]:[4,Rp(t.appConfig)];case 4:return a.sent(),[3,7];case 5:return o=(0,i.__assign)((0,i.__assign)({},e),{authToken:{requestStatus:0}}),[4,Pp(t.appConfig,o)];case 6:a.sent(),a.label=7;case 7:throw r;case 8:return[2]}}))}))}(t,a),a}))];case 1:return r=a.sent(),n?[4,n]:[3,3];case 2:return o=a.sent(),[3,4];case 3:o=r.authToken,a.label=4;case 4:return[2,o]}}))}))}function jp(t){return Dp(t,(function(t){if(!qp(t))throw ap.create("not-registered");var e,n=t.authToken;return 1===(e=n).requestStatus&&e.requestTime+ep<Date.now()?(0,i.__assign)((0,i.__assign)({},t),{authToken:{requestStatus:0}}):t}))}function qp(t){return void 0!==t&&2===t.registrationStatus}function Vp(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return[4,xp(t)];case 1:return(e=n.sent().registrationPromise)?[4,e]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))}function Bp(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r,o,a;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return n=function(t,e){var n=e.fid;return up(t)+"/"+n}(t,e),r=fp(t,e),o={method:"DELETE",headers:r},[4,dp((function(){return fetch(n,o)}))];case 1:return(a=i.sent()).ok?[3,3]:[4,hp("Delete Installation",a)];case 2:throw i.sent();case 3:return[2]}}))}))}function Kp(t,e){var n=t.appConfig;return function(t,e){Tp();var n=mp(t),r=_p.get(n);r||(r=new Set,_p.set(n,r)),r.add(e)}(n,e),function(){!function(t,e){var n=mp(t),r=_p.get(n);r&&(r.delete(e),0===r.size&&_p.delete(n),Ep())}(n,e)}}function Wp(t){return ap.create("missing-app-config-values",{valueName:t})}(Sp=r.default).INTERNAL.registerComponent(new Kd.Component("installations",(function(t){var e=t.getProvider("app").getImmediate(),n=function(t){var e,n;if(!t||!t.options)throw Wp("App Configuration");if(!t.name)throw Wp("App Name");try{for(var r=(0,i.__values)(["projectId","apiKey","appId"]),o=r.next();!o.done;o=r.next()){var a=o.value;if(!t.options[a])throw Wp(a)}}catch(s){e={error:s}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e),r={appConfig:n,platformLoggerProvider:t.getProvider("platform-logger")},o={app:e,getId:function(){return function(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,n,r;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return[4,xp(t.appConfig)];case 1:return e=i.sent(),n=e.installationEntry,(r=e.registrationPromise)?r.catch(console.error):Up(t).catch(console.error),[2,n.fid]}}))}))}(r)},getToken:function(t){return function(t,e){return void 0===e&&(e=!1),(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return[4,Vp(t.appConfig)];case 1:return n.sent(),[4,Up(t,e)];case 2:return[2,n.sent().token]}}))}))}(r,t)},delete:function(){return function(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return[4,Dp(e=t.appConfig,(function(t){if(!t||0!==t.registrationStatus)return t}))];case 1:if(!(n=r.sent()))return[3,6];if(1!==n.registrationStatus)return[3,2];throw ap.create("delete-pending-registration");case 2:if(2!==n.registrationStatus)return[3,6];if(navigator.onLine)return[3,3];throw ap.create("app-offline");case 3:return[4,Bp(e,n)];case 4:return r.sent(),[4,Rp(e)];case 5:r.sent(),r.label=6;case 6:return[2]}}))}))}(r)},onIdChange:function(t){return Kp(r,t)}};return o}),"PUBLIC")),Sp.registerVersion("@firebase/installations",tp);var Hp,Gp=((Cp={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',Cp["only-available-in-window"]="This method is available in a Window context.",Cp["only-available-in-sw"]="This method is available in a service worker context.",Cp["permission-default"]="The notification permission was not granted and dismissed instead.",Cp["permission-blocked"]="The notification permission was not granted and blocked instead.",Cp["unsupported-browser"]="This browser doesn't support the API's required to use the firebase SDK.",Cp["failed-service-worker-registration"]="We are unable to register the default service worker. {$browserErrorMessage}",Cp["token-subscribe-failed"]="A problem occurred while subscribing the user to FCM: {$errorInfo}",Cp["token-subscribe-no-token"]="FCM returned no token when subscribing the user to push.",Cp["token-unsubscribe-failed"]="A problem occurred while unsubscribing the user from FCM: {$errorInfo}",Cp["token-update-failed"]="A problem occurred while updating the user from FCM: {$errorInfo}",Cp["token-update-no-token"]="FCM returned no token when updating the user to push.",Cp["use-sw-after-get-token"]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",Cp["invalid-sw-registration"]="The input to useServiceWorker() must be a ServiceWorkerRegistration.",Cp["invalid-bg-handler"]="The input to setBackgroundMessageHandler() must be a function.",Cp["invalid-vapid-key"]="The public VAPID key must be a string.",Cp["use-vapid-key-after-get-token"]="The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used.",Cp),zp=new o.ErrorFactory("messaging","Messaging",Gp),Qp="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",Yp="FCM_MSG",Xp="google.c.a.c_id";function $p(t){var e=new Uint8Array(t);return btoa(String.fromCharCode.apply(String,(0,i.__spreadArray)([],(0,i.__read)(e)))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Jp(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(e),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}!function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"}(Hp||(Hp={}));var Zp="fcm_token_details_db",tv="fcm_token_object_Store";function ev(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,n,r,o=this;return(0,i.__generator)(this,(function(a){switch(a.label){case 0:return"databases"in indexedDB?[4,indexedDB.databases()]:[3,2];case 1:if(e=a.sent(),n=e.map((function(t){return t.name})),!n.includes(Zp))return[2,null];a.label=2;case 2:return r=null,[4,(0,Zd.openDb)(Zp,5,(function(e){return(0,i.__awaiter)(o,void 0,void 0,(function(){var n,o,a,s;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return e.oldVersion<2?[2]:e.objectStoreNames.contains(tv)?[4,(n=e.transaction.objectStore(tv)).index("fcmSenderId").get(t)]:[2];case 1:return o=i.sent(),[4,n.clear()];case 2:if(i.sent(),!o)return[2];if(2===e.oldVersion){if(!(a=o).auth||!a.p256dh||!a.endpoint)return[2];r={token:a.fcmToken,createTime:null!==(s=a.createTime)&&void 0!==s?s:Date.now(),subscriptionOptions:{auth:a.auth,p256dh:a.p256dh,endpoint:a.endpoint,swScope:a.swScope,vapidKey:"string"===typeof a.vapidKey?a.vapidKey:$p(a.vapidKey)}}}else(3===e.oldVersion||4===e.oldVersion)&&(r={token:(a=o).fcmToken,createTime:a.createTime,subscriptionOptions:{auth:$p(a.auth),p256dh:$p(a.p256dh),endpoint:a.endpoint,swScope:a.swScope,vapidKey:$p(a.vapidKey)}});return[2]}}))}))}))];case 3:return a.sent().close(),[4,(0,Zd.deleteDb)(Zp)];case 4:return a.sent(),[4,(0,Zd.deleteDb)("fcm_vapid_details_db")];case 5:return a.sent(),[4,(0,Zd.deleteDb)("undefined")];case 6:return a.sent(),[2,nv(r)?r:null]}}))}))}function nv(t){if(!t||!t.subscriptionOptions)return!1;var e=t.subscriptionOptions;return"number"===typeof t.createTime&&t.createTime>0&&"string"===typeof t.token&&t.token.length>0&&"string"===typeof e.auth&&e.auth.length>0&&"string"===typeof e.p256dh&&e.p256dh.length>0&&"string"===typeof e.endpoint&&e.endpoint.length>0&&"string"===typeof e.swScope&&e.swScope.length>0&&"string"===typeof e.vapidKey&&e.vapidKey.length>0}var rv="firebase-messaging-store",iv=null;function ov(){return iv||(iv=(0,Zd.openDb)("firebase-messaging-database",1,(function(t){if(0===t.oldVersion)t.createObjectStore(rv)}))),iv}function av(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,n,r;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return e=cv(t),[4,ov()];case 1:return[4,i.sent().transaction(rv).objectStore(rv).get(e)];case 2:return(n=i.sent())?[2,n]:[3,3];case 3:return[4,ev(t.appConfig.senderId)];case 4:return(r=i.sent())?[4,sv(t,r)]:[3,6];case 5:return i.sent(),[2,r];case 6:return[2]}}))}))}function sv(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r,o;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return n=cv(t),[4,ov()];case 1:return r=i.sent(),[4,(o=r.transaction(rv,"readwrite")).objectStore(rv).put(e,n)];case 2:return i.sent(),[4,o.complete];case 3:return i.sent(),[2,e]}}))}))}function uv(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,n,r;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return e=cv(t),[4,ov()];case 1:return n=i.sent(),[4,(r=n.transaction(rv,"readwrite")).objectStore(rv).delete(e)];case 2:return i.sent(),[4,r.complete];case 3:return i.sent(),[2]}}))}))}function cv(t){return t.appConfig.appId}function hv(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r,o,a,s,u;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return[4,pv(t)];case 1:n=i.sent(),r=vv(e),o={method:"POST",headers:n,body:JSON.stringify(r)},i.label=2;case 2:return i.trys.push([2,5,,6]),[4,fetch(dv(t.appConfig),o)];case 3:return[4,i.sent().json()];case 4:return a=i.sent(),[3,6];case 5:throw s=i.sent(),zp.create("token-subscribe-failed",{errorInfo:s});case 6:if(a.error)throw u=a.error.message,zp.create("token-subscribe-failed",{errorInfo:u});if(!a.token)throw zp.create("token-subscribe-no-token");return[2,a.token]}}))}))}function lv(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r,o,a,s,u;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return[4,pv(t)];case 1:n=i.sent(),r=vv(e.subscriptionOptions),o={method:"PATCH",headers:n,body:JSON.stringify(r)},i.label=2;case 2:return i.trys.push([2,5,,6]),[4,fetch(dv(t.appConfig)+"/"+e.token,o)];case 3:return[4,i.sent().json()];case 4:return a=i.sent(),[3,6];case 5:throw s=i.sent(),zp.create("token-update-failed",{errorInfo:s});case 6:if(a.error)throw u=a.error.message,zp.create("token-update-failed",{errorInfo:u});if(!a.token)throw zp.create("token-update-no-token");return[2,a.token]}}))}))}function fv(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r,o,a,s;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return[4,pv(t)];case 1:n=i.sent(),r={method:"DELETE",headers:n},i.label=2;case 2:return i.trys.push([2,5,,6]),[4,fetch(dv(t.appConfig)+"/"+e,r)];case 3:return[4,i.sent().json()];case 4:if((o=i.sent()).error)throw a=o.error.message,zp.create("token-unsubscribe-failed",{errorInfo:a});return[3,6];case 5:throw s=i.sent(),zp.create("token-unsubscribe-failed",{errorInfo:s});case 6:return[2]}}))}))}function dv(t){return"https://fcmregistrations.googleapis.com/v1/projects/"+t.projectId+"/registrations"}function pv(t){var e=t.appConfig,n=t.installations;return(0,i.__awaiter)(this,void 0,void 0,(function(){var t;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return[4,n.getToken()];case 1:return t=r.sent(),[2,new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e.apiKey,"x-goog-firebase-installations-auth":"FIS "+t})]}}))}))}function vv(t){var e=t.p256dh,n=t.auth,r=t.endpoint,i=t.vapidKey,o={web:{endpoint:r,auth:n,p256dh:e}};return i!==Qp&&(o.web.applicationPubKey=i),o}function gv(t,e,n){return(0,i.__awaiter)(this,void 0,void 0,(function(){var r,o,a,s;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:if("granted"!==Notification.permission)throw zp.create("permission-blocked");return[4,bv(e,n)];case 1:return r=i.sent(),[4,av(t)];case 2:return o=i.sent(),a={vapidKey:n,swScope:e.scope,endpoint:r.endpoint,auth:$p(r.getKey("auth")),p256dh:$p(r.getKey("p256dh"))},o?[3,3]:[2,_v(t,a)];case 3:if(function(t,e){var n=e.vapidKey===t.vapidKey,r=e.endpoint===t.endpoint,i=e.auth===t.auth,o=e.p256dh===t.p256dh;return n&&r&&i&&o}(o.subscriptionOptions,a))return[3,8];i.label=4;case 4:return i.trys.push([4,6,,7]),[4,fv(t,o.token)];case 5:return i.sent(),[3,7];case 6:return s=i.sent(),console.warn(s),[3,7];case 7:return[2,_v(t,a)];case 8:return Date.now()>=o.createTime+6048e5?[2,mv({token:o.token,createTime:Date.now(),subscriptionOptions:a},t,e)]:[2,o.token];case 9:return[2]}}))}))}function yv(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return[4,av(t)];case 1:return(n=i.sent())?[4,fv(t,n.token)]:[3,4];case 2:return i.sent(),[4,uv(t)];case 3:i.sent(),i.label=4;case 4:return[4,e.pushManager.getSubscription()];case 5:return(r=i.sent())?[2,r.unsubscribe()]:[2,!0]}}))}))}function mv(t,e,n){return(0,i.__awaiter)(this,void 0,void 0,(function(){var r,o,a;return(0,i.__generator)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,3,,5]),[4,lv(e,t)];case 1:return r=s.sent(),o=(0,i.__assign)((0,i.__assign)({},t),{token:r,createTime:Date.now()}),[4,sv(e,o)];case 2:return s.sent(),[2,r];case 3:return a=s.sent(),[4,yv(e,n)];case 4:throw s.sent(),a;case 5:return[2]}}))}))}function _v(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return[4,hv(t,e)];case 1:return n=i.sent(),r={token:n,createTime:Date.now(),subscriptionOptions:e},[4,sv(t,r)];case 2:return i.sent(),[2,r.token]}}))}))}function bv(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return[4,t.pushManager.getSubscription()];case 1:return(n=r.sent())?[2,n]:[2,t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Jp(e)})]}}))}))}function wv(t){return"object"===typeof t&&!!t&&Xp in t}function Iv(t){return new Promise((function(e){setTimeout(e,t)}))}var Tv=function(){function t(t){var e=this;this.firebaseDependencies=t,this.isOnBackgroundMessageUsed=null,this.vapidKey=null,this.bgMessageHandler=null,self.addEventListener("push",(function(t){t.waitUntil(e.onPush(t))})),self.addEventListener("pushsubscriptionchange",(function(t){t.waitUntil(e.onSubChange(t))})),self.addEventListener("notificationclick",(function(t){t.waitUntil(e.onNotificationClick(t))}))}return Object.defineProperty(t.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),t.prototype.setBackgroundMessageHandler=function(t){if(this.isOnBackgroundMessageUsed=!1,!t||"function"!==typeof t)throw zp.create("invalid-bg-handler");this.bgMessageHandler=t},t.prototype.onBackgroundMessage=function(t){var e=this;return this.isOnBackgroundMessageUsed=!0,this.bgMessageHandler=t,function(){e.bgMessageHandler=null}},t.prototype.getToken=function(){var t,e;return(0,i.__awaiter)(this,void 0,void 0,(function(){var n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return this.vapidKey?[3,2]:[4,av(this.firebaseDependencies)];case 1:n=r.sent(),this.vapidKey=null!==(e=null===(t=null===n||void 0===n?void 0:n.subscriptionOptions)||void 0===t?void 0:t.vapidKey)&&void 0!==e?e:Qp,r.label=2;case 2:return[2,gv(this.firebaseDependencies,self.registration,this.vapidKey)]}}))}))},t.prototype.deleteToken=function(){return yv(this.firebaseDependencies,self.registration)},t.prototype.requestPermission=function(){throw zp.create("only-available-in-window")},t.prototype.usePublicVapidKey=function(t){if(null!==this.vapidKey)throw zp.create("use-vapid-key-after-get-token");if("string"!==typeof t||0===t.length)throw zp.create("invalid-vapid-key");this.vapidKey=t},t.prototype.useServiceWorker=function(){throw zp.create("only-available-in-window")},t.prototype.onMessage=function(){throw zp.create("only-available-in-window")},t.prototype.onTokenRefresh=function(){throw zp.create("only-available-in-window")},t.prototype.onPush=function(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,n,r,o;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return e=function(t){var e=t.data;if(!e)return null;try{return e.json()}catch(n){return null}}(t),e?[4,kv()]:(console.debug("FirebaseMessaging: failed to get parsed MessagePayload from the PushEvent. Skip handling the push."),[2]);case 1:return function(t){return t.some((function(t){return"visible"===t.visibilityState&&!t.url.startsWith("chrome-extension://")}))}(n=i.sent())?[2,Cv(n,e)]:(r=!1,e.notification?[4,Av(Ev(e))]:[3,3]);case 2:i.sent(),r=!0,i.label=3;case 3:return!0===r&&!1===this.isOnBackgroundMessageUsed?[2]:(this.bgMessageHandler&&(o=function(t){var e={from:t.from,collapseKey:t.collapse_key,messageId:t.fcm_message_id};return function(t,e){if(e.notification){t.notification={};var n=e.notification.title;n&&(t.notification.title=n);var r=e.notification.body;r&&(t.notification.body=r);var i=e.notification.image;i&&(t.notification.image=i)}}(e,t),function(t,e){e.data&&(t.data=e.data)}(e,t),function(t,e){if(e.fcmOptions){t.fcmOptions={};var n=e.fcmOptions.link;n&&(t.fcmOptions.link=n);var r=e.fcmOptions.analytics_label;r&&(t.fcmOptions.analyticsLabel=r)}}(e,t),e}(e),"function"===typeof this.bgMessageHandler?this.bgMessageHandler(o):this.bgMessageHandler.next(o)),[4,Iv(1e3)]);case 4:return i.sent(),[2]}}))}))},t.prototype.onSubChange=function(t){var e,n;return(0,i.__awaiter)(this,void 0,void 0,(function(){var r;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return t.newSubscription?[3,2]:[4,yv(this.firebaseDependencies,self.registration)];case 1:case 5:return i.sent(),[2];case 2:return[4,av(this.firebaseDependencies)];case 3:return r=i.sent(),[4,yv(this.firebaseDependencies,self.registration)];case 4:return i.sent(),[4,gv(this.firebaseDependencies,self.registration,null!==(n=null===(e=null===r||void 0===r?void 0:r.subscriptionOptions)||void 0===e?void 0:e.vapidKey)&&void 0!==n?n:Qp)]}}))}))},t.prototype.onNotificationClick=function(t){var e,n;return(0,i.__awaiter)(this,void 0,void 0,(function(){var r,o,a,s,u;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return(r=null===(n=null===(e=t.notification)||void 0===e?void 0:e.data)||void 0===n?void 0:n[Yp])?t.action?[2]:(t.stopImmediatePropagation(),t.notification.close(),o=function(t){var e,n,r,i=null!==(n=null===(e=t.fcmOptions)||void 0===e?void 0:e.link)&&void 0!==n?n:null===(r=t.notification)||void 0===r?void 0:r.click_action;if(i)return i;return wv(t.data)?self.location.origin:null}(r),o?(a=new URL(o,self.location.href),s=new URL(self.location.origin),a.host!==s.host?[2]:[4,Sv(a)]):[2]):[2];case 1:return(u=i.sent())?[3,4]:[4,self.clients.openWindow(o)];case 2:return u=i.sent(),[4,Iv(3e3)];case 3:return i.sent(),[3,6];case 4:return[4,u.focus()];case 5:u=i.sent(),i.label=6;case 6:return u?(r.messageType=Hp.NOTIFICATION_CLICKED,r.isFirebaseMessaging=!0,[2,u.postMessage(r)]):[2]}}))}))},t}();function Ev(t){var e,n=(0,i.__assign)({},t.notification);return n.data=((e={})[Yp]=t,e),n}function Sv(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,n,r,o,a,s,u;return(0,i.__generator)(this,(function(c){switch(c.label){case 0:return[4,kv()];case 1:e=c.sent();try{for(n=(0,i.__values)(e),r=n.next();!r.done;r=n.next())if(o=r.value,a=new URL(o.url,self.location.href),t.host===a.host)return[2,o]}catch(h){s={error:h}}finally{try{r&&!r.done&&(u=n.return)&&u.call(n)}finally{if(s)throw s.error}}return[2,null]}}))}))}function Cv(t,e){var n,r;e.isFirebaseMessaging=!0,e.messageType=Hp.PUSH_RECEIVED;try{for(var o=(0,i.__values)(t),a=o.next();!a.done;a=o.next()){a.value.postMessage(e)}}catch(s){n={error:s}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}function kv(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function Av(t){var e,n=t.actions,r=Notification.maxActions;return n&&r&&n.length>r&&console.warn("This browser only supports "+r+" actions. The remaining actions will not be displayed."),self.registration.showNotification(null!==(e=t.title)&&void 0!==e?e:"",t)}var Nv=function(){function t(t){var e=this;this.firebaseDependencies=t,this.vapidKey=null,this.onMessageCallback=null,navigator.serviceWorker.addEventListener("message",(function(t){return e.messageEventListener(t)}))}return Object.defineProperty(t.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),t.prototype.messageEventListener=function(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return(e=t.data).isFirebaseMessaging?(this.onMessageCallback&&e.messageType===Hp.PUSH_RECEIVED&&("function"===typeof this.onMessageCallback?this.onMessageCallback(function(t){return delete t.messageType,delete t.isFirebaseMessaging,t}(Object.assign({},e))):this.onMessageCallback.next(Object.assign({},e))),wv(n=e.data)&&"1"===n["google.c.a.e"]?[4,this.logEvent(e.messageType,n)]:[3,2]):[2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.getVapidKey=function(){return this.vapidKey},t.prototype.getSwReg=function(){return this.swRegistration},t.prototype.getToken=function(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return"default"!==Notification.permission?[3,2]:[4,Notification.requestPermission()];case 1:e.sent(),e.label=2;case 2:if("granted"!==Notification.permission)throw zp.create("permission-blocked");return[4,this.updateVapidKey(null===t||void 0===t?void 0:t.vapidKey)];case 3:return e.sent(),[4,this.updateSwReg(null===t||void 0===t?void 0:t.serviceWorkerRegistration)];case 4:return e.sent(),[2,gv(this.firebaseDependencies,this.swRegistration,this.vapidKey)]}}))}))},t.prototype.updateVapidKey=function(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){return t?this.vapidKey=t:this.vapidKey||(this.vapidKey=Qp),[2]}))}))},t.prototype.updateSwReg=function(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return t||this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:e.sent(),e.label=2;case 2:if(!t&&this.swRegistration)return[2];if(!(t instanceof ServiceWorkerRegistration))throw zp.create("invalid-sw-registration");return this.swRegistration=t,[2]}}))}))},t.prototype.registerDefaultSw=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t,e;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t=this,[4,navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"})];case 1:return t.swRegistration=n.sent(),this.swRegistration.update().catch((function(){})),[3,3];case 2:throw e=n.sent(),zp.create("failed-service-worker-registration",{browserErrorMessage:e.message});case 3:return[2]}}))}))},t.prototype.deleteToken=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:t.sent(),t.label=2;case 2:return[2,yv(this.firebaseDependencies,this.swRegistration)]}}))}))},t.prototype.requestPermission=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t;return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return"granted"===Notification.permission?[2]:[4,Notification.requestPermission()];case 1:if("granted"===(t=e.sent()))return[2];throw"denied"===t?zp.create("permission-blocked"):zp.create("permission-default")}}))}))},t.prototype.usePublicVapidKey=function(t){if(null!==this.vapidKey)throw zp.create("use-vapid-key-after-get-token");if("string"!==typeof t||0===t.length)throw zp.create("invalid-vapid-key");this.vapidKey=t},t.prototype.useServiceWorker=function(t){if(!(t instanceof ServiceWorkerRegistration))throw zp.create("invalid-sw-registration");if(this.swRegistration)throw zp.create("use-sw-after-get-token");this.swRegistration=t},t.prototype.onMessage=function(t){var e=this;return this.onMessageCallback=t,function(){e.onMessageCallback=null}},t.prototype.setBackgroundMessageHandler=function(){throw zp.create("only-available-in-sw")},t.prototype.onBackgroundMessage=function(){throw zp.create("only-available-in-sw")},t.prototype.onTokenRefresh=function(){return function(){}},t.prototype.logEvent=function(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return n=function(t){switch(t){case Hp.NOTIFICATION_CLICKED:return"notification_open";case Hp.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(t),[4,this.firebaseDependencies.analyticsProvider.get()];case 1:return r.sent().logEvent(n,{message_id:e[Xp],message_name:e["google.c.a.c_l"],message_time:e["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)}),[2]}}))}))},t}();function Pv(t){return zp.create("missing-app-config-values",{valueName:t})}var Rv={isSupported:Dv};function Dv(){return self&&"ServiceWorkerGlobalScope"in self?"indexedDB"in self&&null!==indexedDB&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"):"indexedDB"in window&&null!==indexedDB&&navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}r.default.INTERNAL.registerComponent(new Kd.Component("messaging",(function(t){var e=t.getProvider("app").getImmediate(),n=function(t){var e,n;if(!t||!t.options)throw Pv("App Configuration Object");if(!t.name)throw Pv("App Name");var r=t.options;try{for(var o=(0,i.__values)(["projectId","apiKey","appId","messagingSenderId"]),a=o.next();!a.done;a=o.next()){var s=a.value;if(!r[s])throw Pv(s)}}catch(u){e={error:u}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return{appName:t.name,projectId:r.projectId,apiKey:r.apiKey,appId:r.appId,senderId:r.messagingSenderId}}(e),r={app:e,appConfig:n,installations:t.getProvider("installations").getImmediate(),analyticsProvider:t.getProvider("analytics-internal")};if(!Dv())throw zp.create("unsupported-browser");return self&&"ServiceWorkerGlobalScope"in self?new Tv(r):new Nv(r)}),"PUBLIC").setServiceProps(Rv));var xv="firebasestorage.googleapis.com",Ov="storageBucket",Lv=function(t){function e(n,r){var i=t.call(this,Mv(n),"Firebase Storage: "+r+" ("+Mv(n)+")")||this;return i.customData={serverResponse:null},i._baseMessage=i.message,Object.setPrototypeOf(i,e.prototype),i}return(0,i.__extends)(e,t),e.prototype._codeEquals=function(t){return Mv(t)===this.code},Object.defineProperty(e.prototype,"serverResponse",{get:function(){return this.customData.serverResponse},set:function(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=this._baseMessage+"\n"+this.customData.serverResponse:this.message=this._baseMessage},enumerable:!1,configurable:!0}),e}(o.FirebaseError);function Mv(t){return"storage/"+t}function Fv(){return new Lv("unknown","An unknown error occurred, please check the error payload for server response.")}function Uv(){return new Lv("canceled","User canceled the upload/download.")}function jv(){return new Lv("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function qv(t){return new Lv("invalid-argument",t)}function Vv(){return new Lv("app-deleted","The Firebase app was deleted.")}function Bv(t){return new Lv("invalid-root-operation","The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Kv(t,e){return new Lv("invalid-format","String does not match format '"+t+"': "+e)}function Wv(t){throw new Lv("internal-error","Internal error: "+t)}var Hv={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},Gv=function(t,e){this.data=t,this.contentType=e||null};function zv(t,e){switch(t){case Hv.RAW:return new Gv(Qv(e));case Hv.BASE64:case Hv.BASE64URL:return new Gv(Yv(t,e));case Hv.DATA_URL:return new Gv(function(t){var e=new Xv(t);return e.base64?Yv(Hv.BASE64,e.rest):function(t){var e;try{e=decodeURIComponent(t)}catch(Vd){throw Kv(Hv.DATA_URL,"Malformed data URL.")}return Qv(e)}(e.rest)}(e),new Xv(e).contentType)}throw Fv()}function Qv(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|63&r);else if(55296===(64512&r))if(n<t.length-1&&56320===(64512&t.charCodeAt(n+1)))r=65536|(1023&r)<<10|1023&t.charCodeAt(++n),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r);else e.push(239,191,189);else 56320===(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function Yv(t,e){switch(t){case Hv.BASE64:var n=-1!==e.indexOf("-"),r=-1!==e.indexOf("_");if(n||r)throw Kv(t,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break;case Hv.BASE64URL:var i=-1!==e.indexOf("+"),o=-1!==e.indexOf("/");if(i||o)throw Kv(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/")}var a;try{a=atob(e)}catch(Vd){throw Kv(t,"Invalid character found")}for(var s=new Uint8Array(a.length),u=0;u<a.length;u++)s[u]=a.charCodeAt(u);return s}var Xv=function(t){this.base64=!1,this.contentType=null;var e=t.match(/^data:([^,]+)?,/);if(null===e)throw Kv(Hv.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var n=e[1]||null;null!=n&&(this.base64=(r=n,i=";base64",r.length>=i.length&&r.substring(r.length-i.length)===i),this.contentType=this.base64?n.substring(0,n.length-";base64".length):n),this.rest=t.substring(t.indexOf(",")+1);var r,i};var $v,Jv={STATE_CHANGED:"state_changed"},Zv={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function tg(t){switch(t){case"running":case"pausing":case"canceling":return Zv.RUNNING;case"paused":return Zv.PAUSED;case"success":return Zv.SUCCESS;case"canceled":return Zv.CANCELED;default:return Zv.ERROR}}!function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"}($v||($v={}));var eg=function(){function t(){var t=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=$v.NO_ERROR,this.sendPromise_=new Promise((function(e){t.xhr_.addEventListener("abort",(function(){t.errorCode_=$v.ABORT,e()})),t.xhr_.addEventListener("error",(function(){t.errorCode_=$v.NETWORK_ERROR,e()})),t.xhr_.addEventListener("load",(function(){e()}))}))}return t.prototype.send=function(t,e,n,r){if(this.sent_)throw Wv("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(e,t,!0),void 0!==r)for(var i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_},t.prototype.getErrorCode=function(){if(!this.sent_)throw Wv("cannot .getErrorCode() before sending");return this.errorCode_},t.prototype.getStatus=function(){if(!this.sent_)throw Wv("cannot .getStatus() before sending");try{return this.xhr_.status}catch(Vd){return-1}},t.prototype.getResponseText=function(){if(!this.sent_)throw Wv("cannot .getResponseText() before sending");return this.xhr_.responseText},t.prototype.abort=function(){this.xhr_.abort()},t.prototype.getResponseHeader=function(t){return this.xhr_.getResponseHeader(t)},t.prototype.addUploadProgressListener=function(t){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",t)},t.prototype.removeUploadProgressListener=function(t){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",t)},t}();var ng=function(){function t(){}return t.prototype.createConnection=function(){return new eg},t}(),rg=function(){function t(t,e){this.bucket=t,this.path_=e}return Object.defineProperty(t.prototype,"path",{get:function(){return this.path_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRoot",{get:function(){return 0===this.path.length},enumerable:!1,configurable:!0}),t.prototype.fullServerUrl=function(){var t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)},t.prototype.bucketOnlyServerUrl=function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"},t.makeFromBucketSpec=function(e,n){var r;try{r=t.makeFromUrl(e,n)}catch(Vd){return new t(e,"")}if(""===r.path)return r;throw new Lv("invalid-default-bucket","Invalid default bucket '"+e+"'.")},t.makeFromUrl=function(e,n){var r=null,i="([A-Za-z0-9.\\-_]+)";var o=new RegExp("^gs://"+i+"(/(.*))?$","i");function a(t){t.path_=decodeURIComponent(t.path)}for(var s=n.replace(/[.]/g,"\\."),u=[{regex:o,indices:{bucket:1,path:3},postModify:function(t){"/"===t.path.charAt(t.path.length-1)&&(t.path_=t.path_.slice(0,-1))}},{regex:new RegExp("^https?://"+s+"/v[A-Za-z0-9_]+/b/"+i+"/o(/([^?#]*).*)?$","i"),indices:{bucket:1,path:3},postModify:a},{regex:new RegExp("^https?://"+(n===xv?"(?:storage.googleapis.com|storage.cloud.google.com)":n)+"/"+i+"/([^?#]*)","i"),indices:{bucket:1,path:2},postModify:a}],c=0;c<u.length;c++){var h=u[c],l=h.regex.exec(e);if(l){var f=l[h.indices.bucket],d=l[h.indices.path];d||(d=""),r=new t(f,d),h.postModify(r);break}}if(null==r)throw function(t){return new Lv("invalid-url","Invalid URL '"+t+"'.")}(e);return r},t}(),ig=function(){function t(t){this.promise_=Promise.reject(t)}return t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){},t}();function og(t){return"string"===typeof t||t instanceof String}function ag(t){return sg()&&t instanceof Blob}function sg(){return"undefined"!==typeof Blob}function ug(t,e,n,r){if(r<e)throw qv("Invalid value for '"+t+"'. Expected "+e+" or greater.");if(r>n)throw qv("Invalid value for '"+t+"'. Expected "+n+" or less.")}function cg(t,e){var n=e.match(/^(\w+):\/\/.+/),r=e;return null==(null===n||void 0===n?void 0:n[1])&&(r="https://"+e),r+"/v0"+t}function hg(t){var e=encodeURIComponent,n="?";for(var r in t){if(t.hasOwnProperty(r))n=n+(e(r)+"="+e(t[r]))+"&"}return n=n.slice(0,-1)}var lg=function(){function t(t,e,n,r,i,o,a,s,u,c,h){var l=this;this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=t,this.method_=e,this.headers_=n,this.body_=r,this.successCodes_=i.slice(),this.additionalRetryCodes_=o.slice(),this.callback_=a,this.errorCallback_=s,this.progressCallback_=c,this.timeout_=u,this.pool_=h,this.promise_=new Promise((function(t,e){l.resolve_=t,l.reject_=e,l.start_()}))}return t.prototype.start_=function(){var t=this;function e(e,n){var r,i=t.resolve_,o=t.reject_,a=n.connection;if(n.wasSuccessCode)try{var s=t.callback_(a,a.getResponseText());!function(t){return void 0!==t}(s)?i():i(s)}catch(Vd){o(Vd)}else null!==a?((r=Fv()).serverResponse=a.getResponseText(),t.errorCallback_?o(t.errorCallback_(a,r)):o(r)):n.canceled?o(r=t.appDelete_?Vv():Uv()):o(r=new Lv("retry-limit-exceeded","Max retry time for operation exceeded, please try again."))}this.canceled_?e(0,new fg(!1,null,!0)):this.backoffId_=function(t,e,n){var r=1,o=null,a=!1,s=0;function u(){return 2===s}var c=!1;function h(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];c||(c=!0,e.apply(null,t))}function l(e){o=setTimeout((function(){o=null,t(f,u())}),e)}function f(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(!c)if(t)h.call.apply(h,(0,i.__spreadArray)([null,t],e));else{var o;u()||a?h.call.apply(h,(0,i.__spreadArray)([null,t],e)):(r<64&&(r*=2),1===s?(s=2,o=0):o=1e3*(r+Math.random()),l(o))}}var d=!1;function p(t){d||(d=!0,c||(null!==o?(t||(s=2),clearTimeout(o),l(0)):t||(s=1)))}return l(0),setTimeout((function(){a=!0,p(!0)}),n),p}((function(e,n){if(n)e(!1,new fg(!1,null,!0));else{var r=t.pool_.createConnection();t.pendingConnection_=r,null!==t.progressCallback_&&r.addUploadProgressListener(i),r.send(t.url_,t.method_,t.body_,t.headers_).then((function(){null!==t.progressCallback_&&r.removeUploadProgressListener(i),t.pendingConnection_=null;var n=r.getErrorCode()===$v.NO_ERROR,o=r.getStatus();if(n&&!t.isRetryStatusCode_(o)){var a=-1!==t.successCodes_.indexOf(o);e(!0,new fg(a,r))}else{var s=r.getErrorCode()===$v.ABORT;e(!1,new fg(!1,null,s))}}))}function i(e){var n=e.loaded,r=e.lengthComputable?e.total:-1;null!==t.progressCallback_&&t.progressCallback_(n,r)}}),e,this.timeout_)},t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&function(t){t(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()},t.prototype.isRetryStatusCode_=function(t){var e=t>=500&&t<600,n=-1!==[408,429].indexOf(t),r=-1!==this.additionalRetryCodes_.indexOf(t);return e||n||r},t}(),fg=function(t,e,n){this.wasSuccessCode=t,this.connection=e,this.canceled=!!n};function dg(){return"undefined"!==typeof BlobBuilder?BlobBuilder:"undefined"!==typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function pg(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=dg();if(void 0!==n){for(var r=new n,i=0;i<t.length;i++)r.append(t[i]);return r.getBlob()}if(sg())return new Blob(t);throw new Lv("unsupported-environment","This browser doesn't seem to support creating Blobs")}var vg=function(){function t(t,e){var n=0,r="";ag(t)?(this.data_=t,n=t.size,r=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=r}return t.prototype.size=function(){return this.size_},t.prototype.type=function(){return this.type_},t.prototype.slice=function(e,n){if(ag(this.data_)){var r=function(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}(this.data_,e,n);return null===r?null:new t(r)}return new t(new Uint8Array(this.data_.buffer,e,n-e),!0)},t.getBlob=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(sg()){var r=e.map((function(e){return e instanceof t?e.data_:e}));return new t(pg.apply(null,r))}var i=e.map((function(t){return og(t)?zv(Hv.RAW,t).data:t.data_})),o=0;i.forEach((function(t){o+=t.byteLength}));var a=new Uint8Array(o),s=0;return i.forEach((function(t){for(var e=0;e<t.length;e++)a[s++]=t[e]})),new t(a,!0)},t.prototype.uploadData=function(){return this.data_},t}();function gg(t){var e;try{e=JSON.parse(t)}catch(Vd){return null}return function(t){return"object"===typeof t&&!Array.isArray(t)}(e)?e:null}function yg(t){var e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}function mg(t,e){return e}var _g=function(t,e,n,r){this.server=t,this.local=e||t,this.writable=!!n,this.xform=r||mg},bg=null;function wg(){if(bg)return bg;var t=[];t.push(new _g("bucket")),t.push(new _g("generation")),t.push(new _g("metageneration")),t.push(new _g("name","fullPath",!0));var e=new _g("name");e.xform=function(t,e){return function(t){return!og(t)||t.length<2?t:yg(t)}(e)},t.push(e);var n=new _g("size");return n.xform=function(t,e){return void 0!==e?Number(e):e},t.push(n),t.push(new _g("timeCreated")),t.push(new _g("updated")),t.push(new _g("md5Hash",null,!0)),t.push(new _g("cacheControl",null,!0)),t.push(new _g("contentDisposition",null,!0)),t.push(new _g("contentEncoding",null,!0)),t.push(new _g("contentLanguage",null,!0)),t.push(new _g("contentType",null,!0)),t.push(new _g("metadata","customMetadata",!0)),bg=t}function Ig(t,e,n){for(var r={type:"file"},i=n.length,o=0;o<i;o++){var a=n[o];r[a.local]=a.xform(r,e[a.server])}return function(t,e){Object.defineProperty(t,"ref",{get:function(){var n=t.bucket,r=t.fullPath,i=new rg(n,r);return e._makeStorageReference(i)}})}(r,t),r}function Tg(t,e,n){var r=gg(e);return null===r?null:Ig(t,r,n)}function Eg(t,e){for(var n={},r=e.length,i=0;i<r;i++){var o=e[i];o.writable&&(n[o.server]=t[o.local])}return JSON.stringify(n)}var Sg="prefixes",Cg="items";function kg(t,e,n){var r=gg(n);return null===r?null:function(t,e,n){var r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[Sg])for(var i=0,o=n[Sg];i<o.length;i++){var a=o[i].replace(/\/$/,""),s=t._makeStorageReference(new rg(e,a));r.prefixes.push(s)}if(n[Cg])for(var u=0,c=n[Cg];u<c.length;u++){var h=c[u];s=t._makeStorageReference(new rg(e,h.name)),r.items.push(s)}return r}(t,e,r)}var Ag=function(t,e,n,r){this.url=t,this.method=e,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]};function Ng(t){if(!t)throw Fv()}function Pg(t,e){return function(n,r){var i=Tg(t,r,e);return Ng(null!==i),i}}function Rg(t,e){return function(n,r){var i=Tg(t,r,e);return Ng(null!==i),function(t,e,n){var r=gg(e);if(null===r)return null;if(!og(r.downloadTokens))return null;var i=r.downloadTokens;if(0===i.length)return null;var o=encodeURIComponent;return i.split(",").map((function(e){var r=t.bucket,i=t.fullPath;return cg("/b/"+o(r)+"/o/"+o(i),n)+hg({alt:"media",token:e})}))[0]}(i,r,t.host)}}function Dg(t){return function(e,n){var r,i,o;return 401===e.getStatus()?r=e.getResponseText().includes("Firebase App Check token is invalid")?new Lv("unauthorized-app","This app does not have permission to access Firebase Storage on this project."):new Lv("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again."):402===e.getStatus()?(o=t.bucket,r=new Lv("quota-exceeded","Quota for bucket '"+o+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===e.getStatus()?(i=t.path,r=new Lv("unauthorized","User does not have permission to access '"+i+"'.")):r=n,r.serverResponse=n.serverResponse,r}}function xg(t){var e=Dg(t);return function(n,r){var i,o=e(n,r);return 404===n.getStatus()&&(i=t.path,o=new Lv("object-not-found","Object '"+i+"' does not exist.")),o.serverResponse=r.serverResponse,o}}function Og(t,e,n){var r=cg(e.fullServerUrl(),t.host),i=t.maxOperationRetryTime,o=new Ag(r,"GET",Pg(t,n),i);return o.errorHandler=xg(e),o}function Lg(t,e,n,r,i){var o={};e.isRoot?o.prefix="":o.prefix=e.path+"/",n&&n.length>0&&(o.delimiter=n),r&&(o.pageToken=r),i&&(o.maxResults=i);var a=cg(e.bucketOnlyServerUrl(),t.host),s=t.maxOperationRetryTime,u=new Ag(a,"GET",function(t,e){return function(n,r){var i=kg(t,e,r);return Ng(null!==i),i}}(t,e.bucket),s);return u.urlParams=o,u.errorHandler=Dg(e),u}function Mg(t,e,n){var r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=function(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}(null,e)),r}var Fg=function(t,e,n,r){this.current=t,this.total=e,this.finalized=!!n,this.metadata=r||null};function Ug(t,e){var n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch(Vd){Ng(!1)}return Ng(!!n&&-1!==(e||["active"]).indexOf(n)),n}var jg=262144;function qg(t,e,n,r,i,o,a,s){var u=new Fg(0,0);if(a?(u.current=a.current,u.total=a.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw new Lv("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.");var c=u.total-u.current,h=c;i>0&&(h=Math.min(h,i));var l=u.current,f=l+h,d={"X-Goog-Upload-Command":h===c?"upload, finalize":"upload","X-Goog-Upload-Offset":""+u.current},p=r.slice(l,f);if(null===p)throw jv();var v=e.maxUploadRetryTime,g=new Ag(n,"POST",(function(t,n){var i,a=Ug(t,["active","final"]),s=u.current+h,c=r.size();return i="final"===a?Pg(e,o)(t,n):null,new Fg(s,c,"final"===a,i)}),v);return g.headers=d,g.body=p.uploadData(),g.progressCallback=s||null,g.errorHandler=Dg(t),g}var Vg=function(t,e,n){var r=function(t){return"function"===typeof t}(t)||null!=e||null!=n;if(r)this.next=t,this.error=e,this.complete=n;else{var i=t;this.next=i.next,this.error=i.error,this.complete=i.complete}};function Bg(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];Promise.resolve().then((function(){return t.apply(void 0,e)}))}}var Kg=function(){function t(t,e,n){var r=this;void 0===n&&(n=null),this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=t,this._blob=e,this._metadata=n,this._mappings=wg(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=function(t){r._request=void 0,r._chunkMultiplier=1,t._codeEquals("canceled")?(r._needToFetchStatus=!0,r.completeTransitions_()):(r._error=t,r._transition("error"))},this._metadataErrorHandler=function(t){r._request=void 0,t._codeEquals("canceled")?r.completeTransitions_():(r._error=t,r._transition("error"))},this._promise=new Promise((function(t,e){r._resolve=t,r._reject=e,r._start()})),this._promise.then(null,(function(){}))}return t.prototype._makeProgressCallback=function(){var t=this,e=this._transferred;return function(n){return t._updateProgress(e+n)}},t.prototype._shouldDoResumable=function(t){return t.size()>262144},t.prototype._start=function(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())},t.prototype._resolveToken=function(t){var e=this;Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then((function(n){var r=n[0],i=n[1];switch(e._state){case"running":t(r,i);break;case"canceling":e._transition("canceled");break;case"pausing":e._transition("paused")}}))},t.prototype._createResumable=function(){var t=this;this._resolveToken((function(e,n){var r=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),a=Mg(e,r,i),s={name:a.fullPath},u=cg(o,t.host),c={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":""+r.size(),"X-Goog-Upload-Header-Content-Type":a.contentType,"Content-Type":"application/json; charset=utf-8"},h=Eg(a,n),l=t.maxUploadRetryTime,f=new Ag(u,"POST",(function(t){var e;Ug(t);try{e=t.getResponseHeader("X-Goog-Upload-URL")}catch(Vd){Ng(!1)}return Ng(og(e)),e}),l);return f.urlParams=s,f.headers=c,f.body=h,f.errorHandler=Dg(e),f}(t._ref.storage,t._ref._location,t._mappings,t._blob,t._metadata),i=t._ref.storage._makeRequest(r,e,n);t._request=i,i.getPromise().then((function(e){t._request=void 0,t._uploadUrl=e,t._needToFetchStatus=!1,t.completeTransitions_()}),t._errorHandler)}))},t.prototype._fetchStatus=function(){var t=this,e=this._uploadUrl;this._resolveToken((function(n,r){var i=function(t,e,n,r){var i=t.maxUploadRetryTime,o=new Ag(n,"POST",(function(t){var e=Ug(t,["active","final"]),n=null;try{n=t.getResponseHeader("X-Goog-Upload-Size-Received")}catch(Vd){Ng(!1)}n||Ng(!1);var i=Number(n);return Ng(!isNaN(i)),new Fg(i,r.size(),"final"===e)}),i);return o.headers={"X-Goog-Upload-Command":"query"},o.errorHandler=Dg(e),o}(t._ref.storage,t._ref._location,e,t._blob),o=t._ref.storage._makeRequest(i,n,r);t._request=o,o.getPromise().then((function(e){t._request=void 0,t._updateProgress(e.current),t._needToFetchStatus=!1,e.finalized&&(t._needToFetchMetadata=!0),t.completeTransitions_()}),t._errorHandler)}))},t.prototype._continueUpload=function(){var t=this,e=jg*this._chunkMultiplier,n=new Fg(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((function(i,o){var a;try{a=qg(t._ref._location,t._ref.storage,r,t._blob,e,t._mappings,n,t._makeProgressCallback())}catch(Vd){return t._error=Vd,void t._transition("error")}var s=t._ref.storage._makeRequest(a,i,o);t._request=s,s.getPromise().then((function(e){t._increaseMultiplier(),t._request=void 0,t._updateProgress(e.current),e.finalized?(t._metadata=e.metadata,t._transition("success")):t.completeTransitions_()}),t._errorHandler)}))},t.prototype._increaseMultiplier=function(){jg*this._chunkMultiplier<33554432&&(this._chunkMultiplier*=2)},t.prototype._fetchMetadata=function(){var t=this;this._resolveToken((function(e,n){var r=Og(t._ref.storage,t._ref._location,t._mappings),i=t._ref.storage._makeRequest(r,e,n);t._request=i,i.getPromise().then((function(e){t._request=void 0,t._metadata=e,t._transition("success")}),t._metadataErrorHandler)}))},t.prototype._oneShotUpload=function(){var t=this;this._resolveToken((function(e,n){var r=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"},s=function(){for(var t="",e=0;e<2;e++)t+=Math.random().toString().slice(2);return t}();a["Content-Type"]="multipart/related; boundary="+s;var u=Mg(e,r,i),c="--"+s+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+Eg(u,n)+"\r\n--"+s+"\r\nContent-Type: "+u.contentType+"\r\n\r\n",h="\r\n--"+s+"--",l=vg.getBlob(c,r,h);if(null===l)throw jv();var f={name:u.fullPath},d=cg(o,t.host),p=t.maxUploadRetryTime,v=new Ag(d,"POST",Pg(t,n),p);return v.urlParams=f,v.headers=a,v.body=l.uploadData(),v.errorHandler=Dg(e),v}(t._ref.storage,t._ref._location,t._mappings,t._blob,t._metadata),i=t._ref.storage._makeRequest(r,e,n);t._request=i,i.getPromise().then((function(e){t._request=void 0,t._metadata=e,t._updateProgress(t._blob.size()),t._transition("success")}),t._errorHandler)}))},t.prototype._updateProgress=function(t){var e=this._transferred;this._transferred=t,this._transferred!==e&&this._notifyObservers()},t.prototype._transition=function(t){if(this._state!==t)switch(t){case"canceling":case"pausing":this._state=t,void 0!==this._request&&this._request.cancel();break;case"running":var e="paused"===this._state;this._state=t,e&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=t,this._notifyObservers();break;case"canceled":this._error=Uv(),this._state=t,this._notifyObservers()}},t.prototype.completeTransitions_=function(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}},Object.defineProperty(t.prototype,"snapshot",{get:function(){var t=tg(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:t,metadata:this._metadata,task:this,ref:this._ref}},enumerable:!1,configurable:!0}),t.prototype.on=function(t,e,n,r){var i=this,o=new Vg(e,n,r);return this._addObserver(o),function(){i._removeObserver(o)}},t.prototype.then=function(t,e){return this._promise.then(t,e)},t.prototype.catch=function(t){return this.then(null,t)},t.prototype._addObserver=function(t){this._observers.push(t),this._notifyObserver(t)},t.prototype._removeObserver=function(t){var e=this._observers.indexOf(t);-1!==e&&this._observers.splice(e,1)},t.prototype._notifyObservers=function(){var t=this;this._finishPromise(),this._observers.slice().forEach((function(e){t._notifyObserver(e)}))},t.prototype._finishPromise=function(){if(void 0!==this._resolve){var t=!0;switch(tg(this._state)){case Zv.SUCCESS:Bg(this._resolve.bind(null,this.snapshot))();break;case Zv.CANCELED:case Zv.ERROR:Bg(this._reject.bind(null,this._error))();break;default:t=!1}t&&(this._resolve=void 0,this._reject=void 0)}},t.prototype._notifyObserver=function(t){switch(tg(this._state)){case Zv.RUNNING:case Zv.PAUSED:t.next&&Bg(t.next.bind(t,this.snapshot))();break;case Zv.SUCCESS:t.complete&&Bg(t.complete.bind(t))();break;default:t.error&&Bg(t.error.bind(t,this._error))()}},t.prototype.resume=function(){var t="paused"===this._state||"pausing"===this._state;return t&&this._transition("running"),t},t.prototype.pause=function(){var t="running"===this._state;return t&&this._transition("pausing"),t},t.prototype.cancel=function(){var t="running"===this._state||"pausing"===this._state;return t&&this._transition("canceling"),t},t}(),Wg=function(){function t(t,e){this._service=t,this._location=e instanceof rg?e:rg.makeFromUrl(e,t.host)}return t.prototype.toString=function(){return"gs://"+this._location.bucket+"/"+this._location.path},t.prototype._newRef=function(e,n){return new t(e,n)},Object.defineProperty(t.prototype,"root",{get:function(){var t=new rg(this._location.bucket,"");return this._newRef(this._service,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this._location.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this._location.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return yg(this._location.path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"storage",{get:function(){return this._service},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=function(t){if(0===t.length)return null;var e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}(this._location.path);if(null===e)return null;var n=new rg(this._location.bucket,e);return new t(this._service,n)},enumerable:!1,configurable:!0}),t.prototype._throwIfRoot=function(t){if(""===this._location.path)throw Bv(t)},t}();function Hg(t){var e={prefixes:[],items:[]};return Gg(t,e).then((function(){return e}))}function Gg(t,e,n){return(0,i.__awaiter)(this,void 0,void 0,(function(){var r,o,a;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return[4,zg(t,{pageToken:n})];case 1:return r=i.sent(),(o=e.prefixes).push.apply(o,r.prefixes),(a=e.items).push.apply(a,r.items),null==r.nextPageToken?[3,3]:[4,Gg(t,e,r.nextPageToken)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function zg(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return null!=e&&"number"===typeof e.maxResults&&ug("options.maxResults",1,1e3,e.maxResults),n=e||{},r=Lg(t.storage,t._location,"/",n.pageToken,n.maxResults),[4,t.storage.makeRequestWithTokens(r)];case 1:return[2,i.sent().getPromise()]}}))}))}function Qg(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return t._throwIfRoot("updateMetadata"),n=function(t,e,n,r){var i=cg(e.fullServerUrl(),t.host),o=Eg(n,r),a=t.maxOperationRetryTime,s=new Ag(i,"PATCH",Pg(t,r),a);return s.headers={"Content-Type":"application/json; charset=utf-8"},s.body=o,s.errorHandler=xg(e),s}(t.storage,t._location,e,wg()),[4,t.storage.makeRequestWithTokens(n)];case 1:return[2,r.sent().getPromise()]}}))}))}function Yg(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return t._throwIfRoot("getDownloadURL"),e=function(t,e,n){var r=cg(e.fullServerUrl(),t.host),i=t.maxOperationRetryTime,o=new Ag(r,"GET",Rg(t,n),i);return o.errorHandler=xg(e),o}(t.storage,t._location,wg()),[4,t.storage.makeRequestWithTokens(e)];case 1:return[2,n.sent().getPromise().then((function(t){if(null===t)throw new Lv("no-download-url","The given file does not have any download URLs.");return t}))]}}))}))}function Xg(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return t._throwIfRoot("deleteObject"),e=function(t,e){var n=cg(e.fullServerUrl(),t.host),r=t.maxOperationRetryTime,i=new Ag(n,"DELETE",(function(t,e){}),r);return i.successCodes=[200,204],i.errorHandler=xg(e),i}(t.storage,t._location),[4,t.storage.makeRequestWithTokens(e)];case 1:return[2,n.sent().getPromise()]}}))}))}function $g(t,e){var n=function(t,e){var n=e.split("/").filter((function(t){return t.length>0})).join("/");return 0===t.length?n:t+"/"+n}(t._location.path,e),r=new rg(t._location.bucket,n);return new Wg(t.storage,r)}function Jg(t){return/^[A-Za-z]+:\/\//.test(t)}function Zg(t,e){if(t instanceof ny){var n=t;if(null==n._bucket)throw new Lv("no-default-bucket","No default bucket found. Did you set the '"+Ov+"' property when initializing the app?");var r=new Wg(n,n._bucket);return null!=e?Zg(r,e):r}return void 0!==e?$g(t,e):t}function ty(t,e){if(e&&Jg(e)){if(t instanceof ny)return new Wg(t,e);throw qv("To use ref(service, url), the first argument must be a Storage instance.")}return Zg(t,e)}function ey(t,e){var n=null===e||void 0===e?void 0:e[Ov];return null==n?null:rg.makeFromBucketSpec(n,t)}var ny=function(){function t(t,e,n,r,i,o){this.app=t,this._authProvider=e,this._appCheckProvider=n,this._pool=r,this._url=i,this._firebaseVersion=o,this._bucket=null,this._host=xv,this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?rg.makeFromBucketSpec(i,this._host):ey(this._host,this.app.options)}return Object.defineProperty(t.prototype,"host",{get:function(){return this._host},set:function(t){this._host=t,null!=this._url?this._bucket=rg.makeFromBucketSpec(this._url,t):this._bucket=ey(t,this.app.options)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this._maxUploadRetryTime},set:function(t){ug("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this._maxOperationRetryTime},set:function(t){ug("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t},enumerable:!1,configurable:!0}),t.prototype._getAuthToken=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t,e;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return this._overrideAuthToken?[2,this._overrideAuthToken]:(t=this._authProvider.getImmediate({optional:!0}))?[4,t.getToken()]:[3,2];case 1:if(null!==(e=n.sent()))return[2,e.accessToken];n.label=2;case 2:return[2,null]}}))}))},t.prototype._getAppCheckToken=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t;return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return(t=this._appCheckProvider.getImmediate({optional:!0}))?[4,t.getToken()]:[3,2];case 1:return[2,e.sent().token];case 2:return[2,null]}}))}))},t.prototype._delete=function(){return this._deleted||(this._deleted=!0,this._requests.forEach((function(t){return t.cancel()})),this._requests.clear()),Promise.resolve()},t.prototype._makeStorageReference=function(t){return new Wg(this,t)},t.prototype._makeRequest=function(t,e,n){var r=this;if(this._deleted)return new ig(Vv());var i=function(t,e,n,r,i,o){var a=hg(t.urlParams),s=t.url+a,u=Object.assign({},t.headers);return function(t,e){e&&(t["X-Firebase-GMPID"]=e)}(u,e),function(t,e){null!==e&&e.length>0&&(t.Authorization="Firebase "+e)}(u,n),function(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(null!==e&&void 0!==e?e:"AppManager")}(u,o),function(t,e){null!==e&&(t["X-Firebase-AppCheck"]=e)}(u,r),new lg(s,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i)}(t,this._appId,e,n,this._pool,this._firebaseVersion);return this._requests.add(i),i.getPromise().then((function(){return r._requests.delete(i)}),(function(){return r._requests.delete(i)})),i},t.prototype.makeRequestWithTokens=function(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,n,r;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return[4,Promise.all([this._getAuthToken(),this._getAppCheckToken()])];case 1:return e=i.sent(),n=e[0],r=e[1],[2,this._makeRequest(t,n,r)]}}))}))},t}();function ry(t,e,n){return function(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new Kg(t,new vg(e),n)}(t=(0,o.getModularInstance)(t),e,n)}function iy(t){return function(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return t._throwIfRoot("getMetadata"),e=Og(t.storage,t._location,wg()),[4,t.storage.makeRequestWithTokens(e)];case 1:return[2,n.sent().getPromise()]}}))}))}(t=(0,o.getModularInstance)(t))}function oy(t,e){return ty(t=(0,o.getModularInstance)(t),e)}function ay(t,e,n,r){void 0===r&&(r={}),function(t,e,n,r){void 0===r&&(r={}),t.host="http://"+e+":"+n;var i=r.mockUserToken;i&&(t._overrideAuthToken="string"===typeof i?i:(0,o.createMockUserToken)(i,t.app.options.projectId))}(t,e,n,r)}var sy=function(){function t(t,e,n){this._delegate=t,this.task=e,this.ref=n}return Object.defineProperty(t.prototype,"bytesTransferred",{get:function(){return this._delegate.bytesTransferred},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._delegate.state},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalBytes",{get:function(){return this._delegate.totalBytes},enumerable:!1,configurable:!0}),t}(),uy=function(){function t(t,e){this._delegate=t,this._ref=e,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}return Object.defineProperty(t.prototype,"snapshot",{get:function(){return new sy(this._delegate.snapshot,this,this._ref)},enumerable:!1,configurable:!0}),t.prototype.then=function(t,e){var n=this;return this._delegate.then((function(e){if(t)return t(new sy(e,n,n._ref))}),e)},t.prototype.on=function(t,e,n,r){var i=this,o=void 0;return e&&(o="function"===typeof e?function(t){return e(new sy(t,i,i._ref))}:{next:e.next?function(t){return e.next(new sy(t,i,i._ref))}:void 0,complete:e.complete||void 0,error:e.error||void 0}),this._delegate.on(t,o,n||void 0,r||void 0)},t}(),cy=function(){function t(t,e){this._delegate=t,this._service=e}return Object.defineProperty(t.prototype,"prefixes",{get:function(){var t=this;return this._delegate.prefixes.map((function(e){return new hy(e,t._service)}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){var t=this;return this._delegate.items.map((function(e){return new hy(e,t._service)}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nextPageToken",{get:function(){return this._delegate.nextPageToken||null},enumerable:!1,configurable:!0}),t}(),hy=function(){function t(t,e){this._delegate=t,this.storage=e}return Object.defineProperty(t.prototype,"name",{get:function(){return this._delegate.name},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this._delegate.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this._delegate.fullPath},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return this._delegate.toString()},t.prototype.child=function(e){var n=function(t,e){return $g(t,e)}(this._delegate,e);return new t(n,this.storage)},Object.defineProperty(t.prototype,"root",{get:function(){return new t(this._delegate.root,this.storage)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=this._delegate.parent;return null==e?null:new t(e,this.storage)},enumerable:!1,configurable:!0}),t.prototype.put=function(t,e){return this._throwIfRoot("put"),new uy(ry(this._delegate,t,e),this)},t.prototype.putString=function(t,e,n){void 0===e&&(e=Hv.RAW),this._throwIfRoot("putString");var r=zv(e,t),o=(0,i.__assign)({},n);return null==o.contentType&&null!=r.contentType&&(o.contentType=r.contentType),new uy(new Kg(this._delegate,new vg(r.data,!0),o),this)},t.prototype.listAll=function(){var t=this;return function(t){return Hg(t=(0,o.getModularInstance)(t))}(this._delegate).then((function(e){return new cy(e,t.storage)}))},t.prototype.list=function(t){var e=this;return function(t,e){return zg(t=(0,o.getModularInstance)(t),e)}(this._delegate,t||void 0).then((function(t){return new cy(t,e.storage)}))},t.prototype.getMetadata=function(){return iy(this._delegate)},t.prototype.updateMetadata=function(t){return function(t,e){return Qg(t=(0,o.getModularInstance)(t),e)}(this._delegate,t)},t.prototype.getDownloadURL=function(){return function(t){return Yg(t=(0,o.getModularInstance)(t))}(this._delegate)},t.prototype.delete=function(){return this._throwIfRoot("delete"),function(t){return Xg(t=(0,o.getModularInstance)(t))}(this._delegate)},t.prototype._throwIfRoot=function(t){if(""===this._delegate._location.path)throw Bv(t)},t}(),ly=function(){function t(t,e){this.app=t,this._delegate=e}return Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this._delegate.maxOperationRetryTime},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this._delegate.maxUploadRetryTime},enumerable:!1,configurable:!0}),t.prototype.ref=function(t){if(Jg(t))throw qv("ref() expected a child path but got a URL, use refFromURL instead.");return new hy(oy(this._delegate,t),this)},t.prototype.refFromURL=function(t){if(!Jg(t))throw qv("refFromURL() expected a full URL but got a child path, use ref() instead.");try{rg.makeFromUrl(t,this._delegate.host)}catch(Vd){throw qv("refFromUrl() expected a valid full URL but got an invalid one.")}return new hy(oy(this._delegate,t),this)},t.prototype.setMaxUploadRetryTime=function(t){this._delegate.maxUploadRetryTime=t},t.prototype.setMaxOperationRetryTime=function(t){this._delegate.maxOperationRetryTime=t},t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),ay(this._delegate,t,e,n)},t}();function fy(t,e){var n=e.instanceIdentifier,i=t.getProvider("app").getImmediate(),o=t.getProvider("auth-internal"),a=t.getProvider("app-check-internal");return new ly(i,new ny(i,o,a,new ng,n,r.default.SDK_VERSION))}!function(t){var e={TaskState:Zv,TaskEvent:Jv,StringFormat:Hv,Storage:ny,Reference:hy};t.INTERNAL.registerComponent(new Kd.Component("storage",fy,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),t.registerVersion("@firebase/storage","0.7.1")}(r.default);var dy,py,vy,gy="0.4.18",yy=gy,my="FB-PERF-TRACE-MEASURE",_y="_wt_",by="_fcp",wy="_fid",Iy="@firebase/performance/config",Ty="@firebase/performance/configexpire",Ey="Performance",Sy=((dy={})["trace started"]="Trace {$traceName} was started before.",dy["trace stopped"]="Trace {$traceName} is not running.",dy["nonpositive trace startTime"]="Trace {$traceName} startTime should be positive.",dy["nonpositive trace duration"]="Trace {$traceName} duration should be positive.",dy["no window"]="Window is not available.",dy["no app id"]="App id is not available.",dy["no project id"]="Project id is not available.",dy["no api key"]="Api key is not available.",dy["invalid cc log"]="Attempted to queue invalid cc event",dy["FB not default"]="Performance can only start when Firebase app instance is the default one.",dy["RC response not ok"]="RC response is not ok",dy["invalid attribute name"]="Attribute name {$attributeName} is invalid.",dy["invalid attribute value"]="Attribute value {$attributeValue} is invalid.",dy["invalid custom metric name"]="Custom metric name {$customMetricName} is invalid",dy["invalid String merger input"]="Input for String merger is invalid, contact support team to resolve.",dy),Cy=new o.ErrorFactory("performance",Ey,Sy),ky=new a.Logger(Ey);ky.logLevel=a.LogLevel.INFO;var Ay,Ny=function(){function t(t){if(this.window=t,!t)throw Cy.create("no window");this.performance=t.performance,this.PerformanceObserver=t.PerformanceObserver,this.windowLocation=t.location,this.navigator=t.navigator,this.document=t.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=t.localStorage),t.perfMetrics&&t.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=t.perfMetrics.onFirstInputDelay)}return t.prototype.getUrl=function(){return this.windowLocation.href.split("?")[0]},t.prototype.mark=function(t){this.performance&&this.performance.mark&&this.performance.mark(t)},t.prototype.measure=function(t,e,n){this.performance&&this.performance.measure&&this.performance.measure(t,e,n)},t.prototype.getEntriesByType=function(t){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(t):[]},t.prototype.getEntriesByName=function(t){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(t):[]},t.prototype.getTimeOrigin=function(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)},t.prototype.requiredApisAvailable=function(){return fetch&&Promise&&this.navigator&&this.navigator.cookieEnabled?!!(0,o.isIndexedDBAvailable)()||(ky.info("IndexedDB is not supported by current browswer"),!1):(ky.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1)},t.prototype.setupObserver=function(t,e){if(this.PerformanceObserver){var n=new this.PerformanceObserver((function(t){for(var n=0,r=t.getEntries();n<r.length;n++){var i=r[n];e(i)}}));n.observe({entryTypes:[t]})}},t.getInstance=function(){return void 0===py&&(py=new t(vy)),py},t}();function Py(t,e){var n=t.length-e.length;if(n<0||n>1)throw Cy.create("invalid String merger input");for(var r=[],i=0;i<t.length;i++)r.push(t.charAt(i)),e.length>i&&r.push(e.charAt(i));return r.join("")}var Ry,Dy,xy=function(){function t(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=Py("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=Py("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}return t.prototype.getAppId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.appId;if(!t)throw Cy.create("no app id");return t},t.prototype.getProjectId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.projectId;if(!t)throw Cy.create("no project id");return t},t.prototype.getApiKey=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.apiKey;if(!t)throw Cy.create("no api key");return t},t.prototype.getFlTransportFullUrl=function(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)},t.getInstance=function(){return void 0===Ay&&(Ay=new t),Ay},t}();function Oy(){return Ry}!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.VISIBLE=1]="VISIBLE",t[t.HIDDEN=2]="HIDDEN"}(Dy||(Dy={}));var Ly=["firebase_","google_","ga_"],My=new RegExp("^[a-zA-Z]\\w*$");function Fy(){var t=Ny.getInstance().navigator;return"serviceWorker"in t?t.serviceWorker.controller?2:3:1}function Uy(){switch(Ny.getInstance().document.visibilityState){case"visible":return Dy.VISIBLE;case"hidden":return Dy.HIDDEN;default:return Dy.UNKNOWN}}function jy(){var t=Ny.getInstance().navigator.connection;switch(t&&t.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}var qy="0.0.1",Vy=!0,By="FIREBASE_INSTALLATIONS_AUTH";function Ky(t){var e=function(){var t=Ny.getInstance().localStorage;if(!t)return;var e=t.getItem(Ty);if(!e||(n=e,!(Number(n)>Date.now())))return;var n;var r=t.getItem(Iy);if(!r)return;try{return JSON.parse(r)}catch(_f){return}}();return e?(Hy(e),Promise.resolve()):function(t){return function(){var t=xy.getInstance().installationsService.getToken();return t.then((function(t){})),t}().then((function(e){var n="https://firebaseremoteconfig.googleapis.com/v1/projects/"+xy.getInstance().getProjectId()+"/namespaces/fireperf:fetch?key="+xy.getInstance().getApiKey(),r=new Request(n,{method:"POST",headers:{Authorization:By+" "+e},body:JSON.stringify({app_instance_id:t,app_instance_id_token:e,app_id:xy.getInstance().getAppId(),app_version:yy,sdk_version:qy})});return fetch(r).then((function(t){if(t.ok)return t.json();throw Cy.create("RC response not ok")}))})).catch((function(){ky.info(Wy)}))}(t).then(Hy).then((function(t){return function(t){var e=Ny.getInstance().localStorage;if(!t||!e)return;e.setItem(Iy,JSON.stringify(t)),e.setItem(Ty,String(Date.now()+60*xy.getInstance().configTimeToLive*60*1e3))}(t)}),(function(){}))}var Wy="Could not fetch config, will use default configs";function Hy(t){if(!t)return t;var e=xy.getInstance(),n=t.entries||{};return void 0!==n.fpr_enabled?e.loggingEnabled="true"===String(n.fpr_enabled):e.loggingEnabled=Vy,n.fpr_log_source&&(e.logSource=Number(n.fpr_log_source)),n.fpr_log_endpoint_url&&(e.logEndPointUrl=n.fpr_log_endpoint_url),n.fpr_log_transport_key&&(e.transportKey=n.fpr_log_transport_key),void 0!==n.fpr_vc_network_request_sampling_rate&&(e.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate)),void 0!==n.fpr_vc_trace_sampling_rate&&(e.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate)),e.logTraceAfterSampling=Gy(e.tracesSamplingRate),e.logNetworkAfterSampling=Gy(e.networkRequestsSamplingRate),t}function Gy(t){return Math.random()<=t}var zy,Qy=1;function Yy(){return Qy=2,zy=zy||function(){var t=Ny.getInstance().document;return new Promise((function(e){if(t&&"complete"!==t.readyState){var n=function n(){"complete"===t.readyState&&(t.removeEventListener("readystatechange",n),e())};t.addEventListener("readystatechange",n)}else e()}))}().then((function(){return function(){var t=xy.getInstance().installationsService.getId();return t.then((function(t){Ry=t})),t}()})).then((function(t){return Ky(t)})).then((function(){return Xy()}),(function(){return Xy()}))}function Xy(){Qy=3}var $y,Jy=1e4,Zy=3,tm=[],em=!1;function nm(t){setTimeout((function(){if(0!==Zy)return tm.length?void function(){var t=tm.splice(0,1e3),e=t.map((function(t){return{source_extension_json_proto3:t.message,event_time_ms:String(t.eventTime)}}));(function(t,e){return function(t){var e=xy.getInstance().getFlTransportFullUrl();return fetch(e,{method:"POST",body:JSON.stringify(t)})}(t).then((function(t){return t.ok||ky.info("Call to Firebase backend failed."),t.json()})).then((function(t){var n=Number(t.nextRequestWaitMillis),r=Jy;isNaN(n)||(r=Math.max(n,r));var o=t.logResponseDetails;Array.isArray(o)&&o.length>0&&"RETRY_REQUEST_LATER"===o[0].responseAction&&(tm=(0,i.__spreadArray)((0,i.__spreadArray)([],e),tm),ky.info("Retry transport request later.")),Zy=3,nm(r)}))})({request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:xy.getInstance().logSource,log_event:e},t).catch((function(){tm=(0,i.__spreadArray)((0,i.__spreadArray)([],t),tm),Zy--,ky.info("Tries left: "+Zy+"."),nm(Jy)}))}():nm(Jy)}),t)}function rm(t){if(!t.eventTime||!t.message)throw Cy.create("invalid cc log");tm=(0,i.__spreadArray)((0,i.__spreadArray)([],tm),[t])}function im(t,e){$y||($y=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];rm({message:t.apply(void 0,e),eventTime:Date.now()})}}(sm)),$y(t,e)}function om(t){var e=xy.getInstance();!e.instrumentationEnabled&&t.isAuto||(e.dataCollectionEnabled||t.isAuto)&&Ny.getInstance().requiredApisAvailable()&&(t.isAuto&&Uy()!==Dy.VISIBLE||(3===Qy?am(t):Yy().then((function(){return am(t)}),(function(){return am(t)}))))}function am(t){if(Oy()){var e=xy.getInstance();e.loggingEnabled&&e.logTraceAfterSampling&&setTimeout((function(){return im(t,1)}),0)}}function sm(t,e){return 0===e?function(t){var e={url:t.url,http_method:t.httpMethod||0,http_response_code:200,response_payload_bytes:t.responsePayloadBytes,client_start_time_us:t.startTimeUs,time_to_response_initiated_us:t.timeToResponseInitiatedUs,time_to_response_completed_us:t.timeToResponseCompletedUs},n={application_info:um(),network_request_metric:e};return JSON.stringify(n)}(t):function(t){var e={name:t.name,is_auto:t.isAuto,client_start_time_us:t.startTimeUs,duration_us:t.durationUs};0!==Object.keys(t.counters).length&&(e.counters=t.counters);var n=t.getAttributes();0!==Object.keys(n).length&&(e.custom_attributes=n);var r={application_info:um(),trace_metric:e};return JSON.stringify(r)}(t)}function um(){return{google_app_id:xy.getInstance().getAppId(),app_instance_id:Oy(),web_app_info:{sdk_version:yy,page_url:Ny.getInstance().getUrl(),service_worker_status:Fy(),visibility_state:Uy(),effective_connection_type:jy()},application_process_state:0}}var cm=["_fp",by,wy];var hm=function(){function t(t,e,n){void 0===e&&(e=!1),this.name=t,this.isAuto=e,this.state=1,this.customAttributes={},this.counters={},this.api=Ny.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark="FB-PERF-TRACE-START-"+this.randomId+"-"+this.name,this.traceStopMark="FB-PERF-TRACE-STOP-"+this.randomId+"-"+this.name,this.traceMeasure=n||my+"-"+this.randomId+"-"+this.name,n&&this.calculateTraceMetrics())}return t.prototype.start=function(){if(1!==this.state)throw Cy.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2},t.prototype.stop=function(){if(2!==this.state)throw Cy.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),om(this)},t.prototype.record=function(t,e,n){if(t<=0)throw Cy.create("nonpositive trace startTime",{traceName:this.name});if(e<=0)throw Cy.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(1e3*e),this.startTimeUs=Math.floor(1e3*t),n&&n.attributes&&(this.customAttributes=(0,i.__assign)({},n.attributes)),n&&n.metrics)for(var r=0,o=Object.keys(n.metrics);r<o.length;r++){var a=o[r];isNaN(Number(n.metrics[a]))||(this.counters[a]=Number(Math.floor(n.metrics[a])))}om(this)},t.prototype.incrementMetric=function(t,e){void 0===e&&(e=1),void 0===this.counters[t]?this.putMetric(t,e):this.putMetric(t,this.counters[t]+e)},t.prototype.putMetric=function(t,e){if(n=t,r=this.name,0===n.length||n.length>100||!(r&&r.startsWith(_y)&&cm.indexOf(n)>-1)&&n.startsWith("_"))throw Cy.create("invalid custom metric name",{customMetricName:t});var n,r;this.counters[t]=function(t){var e=Math.floor(t);return e<t&&ky.info("Metric value should be an Integer, setting the value as : "+e+"."),e}(e)},t.prototype.getMetric=function(t){return this.counters[t]||0},t.prototype.putAttribute=function(t,e){var n,r=!(0===(n=t).length||n.length>40)&&!Ly.some((function(t){return n.startsWith(t)}))&&!!n.match(My),i=function(t){return 0!==t.length&&t.length<=100}(e);if(r&&i)this.customAttributes[t]=e;else{if(!r)throw Cy.create("invalid attribute name",{attributeName:t});if(!i)throw Cy.create("invalid attribute value",{attributeValue:e})}},t.prototype.getAttribute=function(t){return this.customAttributes[t]},t.prototype.removeAttribute=function(t){void 0!==this.customAttributes[t]&&delete this.customAttributes[t]},t.prototype.getAttributes=function(){return(0,i.__assign)({},this.customAttributes)},t.prototype.setStartTime=function(t){this.startTimeUs=t},t.prototype.setDuration=function(t){this.durationUs=t},t.prototype.calculateTraceMetrics=function(){var t=this.api.getEntriesByName(this.traceMeasure),e=t&&t[0];e&&(this.durationUs=Math.floor(1e3*e.duration),this.startTimeUs=Math.floor(1e3*(e.startTime+this.api.getTimeOrigin())))},t.createOobTrace=function(e,n,r){var i=Ny.getInstance().getUrl();if(i){var o=new t(_y+i,!0),a=Math.floor(1e3*Ny.getInstance().getTimeOrigin());o.setStartTime(a),e&&e[0]&&(o.setDuration(Math.floor(1e3*e[0].duration)),o.putMetric("domInteractive",Math.floor(1e3*e[0].domInteractive)),o.putMetric("domContentLoadedEventEnd",Math.floor(1e3*e[0].domContentLoadedEventEnd)),o.putMetric("loadEventEnd",Math.floor(1e3*e[0].loadEventEnd)));if(n){var s=n.find((function(t){return"first-paint"===t.name}));s&&s.startTime&&o.putMetric("_fp",Math.floor(1e3*s.startTime));var u=n.find((function(t){return"first-contentful-paint"===t.name}));u&&u.startTime&&o.putMetric(by,Math.floor(1e3*u.startTime)),r&&o.putMetric(wy,Math.floor(1e3*r))}om(o)}},t.createUserTimingTrace=function(e){om(new t(e,!1,e))},t}();function lm(t){var e=t;if(e&&void 0!==e.responseStart){var n=Ny.getInstance().getTimeOrigin(),r=Math.floor(1e3*(e.startTime+n)),i=e.responseStart?Math.floor(1e3*(e.responseStart-e.startTime)):void 0,o=Math.floor(1e3*(e.responseEnd-e.startTime));!function(t){var e=xy.getInstance();if(e.instrumentationEnabled){var n=t.url,r=e.logEndPointUrl.split("?")[0],i=e.flTransportEndpointUrl.split("?")[0];n!==r&&n!==i&&e.loggingEnabled&&e.logNetworkAfterSampling&&setTimeout((function(){return im(t,0)}),0)}}({url:e.name&&e.name.split("?")[0],responsePayloadBytes:e.transferSize,startTimeUs:r,timeToResponseInitiatedUs:i,timeToResponseCompletedUs:o})}}function fm(){Oy()&&(setTimeout((function(){return function(){var t=Ny.getInstance(),e=t.getEntriesByType("navigation"),n=t.getEntriesByType("paint");if(t.onFirstInputDelay){var r=setTimeout((function(){hm.createOobTrace(e,n),r=void 0}),5e3);t.onFirstInputDelay((function(t){r&&(clearTimeout(r),hm.createOobTrace(e,n,t))}))}else hm.createOobTrace(e,n)}()}),0),setTimeout((function(){return function(){for(var t=Ny.getInstance(),e=t.getEntriesByType("resource"),n=0,r=e;n<r.length;n++){lm(r[n])}t.setupObserver("resource",lm)}()}),0),setTimeout((function(){return function(){for(var t=Ny.getInstance(),e=t.getEntriesByType("measure"),n=0,r=e;n<r.length;n++){dm(r[n])}t.setupObserver("measure",dm)}()}),0))}function dm(t){var e=t.name;e.substring(0,my.length)!==my&&hm.createUserTimingTrace(e)}var pm=function(){function t(t){this.app=t,Ny.getInstance().requiredApisAvailable()&&(0,o.validateIndexedDBOpenable)().then((function(t){t&&(em||(nm(5500),em=!0),Yy().then(fm,fm))})).catch((function(t){ky.info("Environment doesn't support IndexedDB: "+t)}))}return t.prototype.trace=function(t){return new hm(t)},Object.defineProperty(t.prototype,"instrumentationEnabled",{get:function(){return xy.getInstance().instrumentationEnabled},set:function(t){xy.getInstance().instrumentationEnabled=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataCollectionEnabled",{get:function(){return xy.getInstance().dataCollectionEnabled},set:function(t){xy.getInstance().dataCollectionEnabled=t},enumerable:!1,configurable:!0}),t}();!function(t){var e=function(t,e){if("[DEFAULT]"!==t.name)throw Cy.create("FB not default");if("undefined"===typeof window)throw Cy.create("no window");return function(t){vy=t}(window),xy.getInstance().firebaseAppInstance=t,xy.getInstance().installationsService=e,new pm(t)};t.INTERNAL.registerComponent(new Kd.Component("performance",(function(t){var n=t.getProvider("app").getImmediate(),r=t.getProvider("installations").getImmediate();return e(n,r)}),"PUBLIC")),t.registerVersion("@firebase/performance",gy)}(r.default);var vm,gm,ym="https://www.googletagmanager.com/gtag/js";!function(t){t.EVENT="event",t.SET="set",t.CONFIG="config"}(vm||(vm={})),function(t){t.ADD_SHIPPING_INFO="add_shipping_info",t.ADD_PAYMENT_INFO="add_payment_info",t.ADD_TO_CART="add_to_cart",t.ADD_TO_WISHLIST="add_to_wishlist",t.BEGIN_CHECKOUT="begin_checkout",t.CHECKOUT_PROGRESS="checkout_progress",t.EXCEPTION="exception",t.GENERATE_LEAD="generate_lead",t.LOGIN="login",t.PAGE_VIEW="page_view",t.PURCHASE="purchase",t.REFUND="refund",t.REMOVE_FROM_CART="remove_from_cart",t.SCREEN_VIEW="screen_view",t.SEARCH="search",t.SELECT_CONTENT="select_content",t.SELECT_ITEM="select_item",t.SELECT_PROMOTION="select_promotion",t.SET_CHECKOUT_OPTION="set_checkout_option",t.SHARE="share",t.SIGN_UP="sign_up",t.TIMING_COMPLETE="timing_complete",t.VIEW_CART="view_cart",t.VIEW_ITEM="view_item",t.VIEW_ITEM_LIST="view_item_list",t.VIEW_PROMOTION="view_promotion",t.VIEW_SEARCH_RESULTS="view_search_results"}(gm||(gm={}));var mm,_m=new a.Logger("@firebase/analytics");function bm(t,e,n,r,o,a){return(0,i.__awaiter)(this,void 0,void 0,(function(){var s,u,c,h;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:s=r[o],i.label=1;case 1:return i.trys.push([1,7,,8]),s?[4,e[s]]:[3,3];case 2:return i.sent(),[3,6];case 3:return[4,Promise.all(n)];case 4:return u=i.sent(),(c=u.find((function(t){return t.measurementId===o})))?[4,e[c.appId]]:[3,6];case 5:i.sent(),i.label=6;case 6:return[3,8];case 7:return h=i.sent(),_m.error(h),[3,8];case 8:return t(vm.CONFIG,o,a),[2]}}))}))}function wm(t,e,n,r,o){return(0,i.__awaiter)(this,void 0,void 0,(function(){var a,s,u,c,h,l,f,d;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,4,,5]),a=[],o&&o.send_to?(s=o.send_to,Array.isArray(s)||(s=[s]),[4,Promise.all(n)]):[3,2];case 1:for(u=i.sent(),c=function(t){var n=u.find((function(e){return e.measurementId===t})),r=n&&e[n.appId];if(!r)return a=[],"break";a.push(r)},h=0,l=s;h<l.length&&(f=l[h],"break"!==c(f));h++);i.label=2;case 2:return 0===a.length&&(a=Object.values(e)),[4,Promise.all(a)];case 3:return i.sent(),t(vm.EVENT,r,o||{}),[3,5];case 4:return d=i.sent(),_m.error(d),[3,5];case 5:return[2]}}))}))}function Im(t,e,n,r,o){var a=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];window[r].push(arguments)};return window[o]&&"function"===typeof window[o]&&(a=window[o]),window[o]=function(t,e,n,r){return function(o,a,s){return(0,i.__awaiter)(this,void 0,void 0,(function(){var u;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,6,,7]),o!==vm.EVENT?[3,2]:[4,wm(t,e,n,a,s)];case 1:return i.sent(),[3,5];case 2:return o!==vm.CONFIG?[3,4]:[4,bm(t,e,n,r,a,s)];case 3:return i.sent(),[3,5];case 4:t(vm.SET,a),i.label=5;case 5:return[3,7];case 6:return u=i.sent(),_m.error(u),[3,7];case 7:return[2]}}))}))}}(a,t,e,n),{gtagCore:a,wrappedGtag:window[o]}}var Tm=((mm={})["already-exists"]="A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.",mm["already-initialized"]="Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",mm["interop-component-reg-failed"]="Firebase Analytics Interop Component failed to instantiate: {$reason}",mm["invalid-analytics-context"]="Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",mm["indexeddb-unavailable"]="IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",mm["fetch-throttle"]="The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",mm["config-fetch-failed"]="Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}",mm["no-api-key"]='The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',mm["no-app-id"]='The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',mm),Em=new o.ErrorFactory("analytics","Analytics",Tm),Sm=new(function(){function t(t,e){void 0===t&&(t={}),void 0===e&&(e=1e3),this.throttleMetadata=t,this.intervalMillis=e}return t.prototype.getThrottleMetadata=function(t){return this.throttleMetadata[t]},t.prototype.setThrottleMetadata=function(t,e){this.throttleMetadata[t]=e},t.prototype.deleteThrottleMetadata=function(t){delete this.throttleMetadata[t]},t}());function Cm(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}function km(t){var e;return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r,o,a,s,u,c;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return n=t.appId,r=t.apiKey,o={method:"GET",headers:Cm(r)},a="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),[4,fetch(a,o)];case 1:if(200===(s=i.sent()).status||304===s.status)return[3,6];u="",i.label=2;case 2:return i.trys.push([2,4,,5]),[4,s.json()];case 3:return c=i.sent(),(null===(e=c.error)||void 0===e?void 0:e.message)&&(u=c.error.message),[3,5];case 4:return i.sent(),[3,5];case 5:throw Em.create("config-fetch-failed",{httpStatus:s.status,responseMessage:u});case 6:return[2,s.json()]}}))}))}function Am(t,e,n,r){var a=e.throttleEndTimeMillis,s=e.backoffCount;return void 0===r&&(r=Sm),(0,i.__awaiter)(this,void 0,void 0,(function(){var e,u,c,h,l,f,d;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:e=t.appId,u=t.measurementId,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,Nm(n,a)];case 2:return i.sent(),[3,4];case 3:if(c=i.sent(),u)return _m.warn("Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID "+u+' provided in the "measurementId" field in the local Firebase config. ['+c.message+"]"),[2,{appId:e,measurementId:u}];throw c;case 4:return i.trys.push([4,6,,7]),[4,km(t)];case 5:return h=i.sent(),r.deleteThrottleMetadata(e),[2,h];case 6:if(!function(t){if(!(t instanceof o.FirebaseError)||!t.customData)return!1;var e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(l=i.sent())){if(r.deleteThrottleMetadata(e),u)return _m.warn("Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID "+u+' provided in the "measurementId" field in the local Firebase config. ['+l.message+"]"),[2,{appId:e,measurementId:u}];throw l}return f=503===Number(l.customData.httpStatus)?(0,o.calculateBackoffMillis)(s,r.intervalMillis,30):(0,o.calculateBackoffMillis)(s,r.intervalMillis),d={throttleEndTimeMillis:Date.now()+f,backoffCount:s+1},r.setThrottleMetadata(e,d),_m.debug("Calling attemptFetch again in "+f+" millis"),[2,Am(t,d,n,r)];case 7:return[2]}}))}))}function Nm(t,e){return new Promise((function(n,r){var i=Math.max(e-Date.now(),0),o=setTimeout(n,i);t.addEventListener((function(){clearTimeout(o),r(Em.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}var Pm=function(){function t(){this.listeners=[]}return t.prototype.addEventListener=function(t){this.listeners.push(t)},t.prototype.abort=function(){this.listeners.forEach((function(t){return t()}))},t}();function Rm(t,e,n,r,a,s){return(0,i.__awaiter)(this,void 0,void 0,(function(){var u,c,h,l,f,d,p;return(0,i.__generator)(this,(function(v){switch(v.label){case 0:return u=function(t,e,n){return void 0===e&&(e=Sm),(0,i.__awaiter)(this,void 0,void 0,(function(){var r,o,a,s,u,c,h=this;return(0,i.__generator)(this,(function(l){if(r=t.options,o=r.appId,a=r.apiKey,s=r.measurementId,!o)throw Em.create("no-app-id");if(!a){if(s)return[2,{measurementId:s,appId:o}];throw Em.create("no-api-key")}return u=e.getThrottleMetadata(o)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new Pm,setTimeout((function(){return(0,i.__awaiter)(h,void 0,void 0,(function(){return(0,i.__generator)(this,(function(t){return c.abort(),[2]}))}))}),void 0!==n?n:6e4),[2,Am({appId:o,apiKey:a,measurementId:s},u,c,e)]}))}))}(t),u.then((function(e){n[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&_m.warn("The measurement ID in the local Firebase config ("+t.options.measurementId+") does not match the measurement ID fetched from the server ("+e.measurementId+"). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.")})).catch((function(t){return _m.error(t)})),e.push(u),c=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t;return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return(0,o.isIndexedDBAvailable)()?[3,1]:(_m.warn(Em.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),[2,!1]);case 1:return e.trys.push([1,3,,4]),[4,(0,o.validateIndexedDBOpenable)()];case 2:return e.sent(),[3,4];case 3:return t=e.sent(),_m.warn(Em.create("indexeddb-unavailable",{errorInfo:t}).message),[2,!1];case 4:return[2,!0]}}))}))}().then((function(t){return t?r.getId():void 0})),[4,Promise.all([u,c])];case 1:return h=v.sent(),l=h[0],f=h[1],function(){for(var t=window.document.getElementsByTagName("script"),e=0,n=Object.values(t);e<n.length;e++){var r=n[e];if(r.src&&r.src.includes(ym))return r}return null}()||function(t,e){var n=document.createElement("script");n.src=ym+"?l="+t+"&id="+e,n.async=!0,document.head.appendChild(n)}(s,l.measurementId),a("js",new Date),(p={}).origin="firebase",p.update=!0,d=p,null!=f&&(d.firebase_id=f),a(vm.CONFIG,l.measurementId,d),[2,l.measurementId]}}))}))}var Dm,xm,Om={},Lm=[],Mm={},Fm="dataLayer",Um="gtag",jm=!1;function qm(t){if(jm)throw Em.create("already-initialized");t.dataLayerName&&(Fm=t.dataLayerName),t.gtagName&&(Um=t.gtagName)}function Vm(t,e){!function(){var t=[];if((0,o.isBrowserExtension)()&&t.push("This is a browser extension environment."),(0,o.areCookiesEnabled)()||t.push("Cookies are not available."),t.length>0){var e=t.map((function(t,e){return"("+(e+1)+") "+t})).join(" "),n=Em.create("invalid-analytics-context",{errorInfo:e});_m.warn(n.message)}}();var n=t.options.appId;if(!n)throw Em.create("no-app-id");if(!t.options.apiKey){if(!t.options.measurementId)throw Em.create("no-api-key");_m.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID '+t.options.measurementId+' provided in the "measurementId" field in the local Firebase config.')}if(null!=Om[n])throw Em.create("already-exists",{id:n});if(!jm){!function(t){var e=[];Array.isArray(window[t])?e=window[t]:window[t]=e}(Fm);var r=Im(Om,Lm,Mm,Fm,Um),a=r.wrappedGtag,s=r.gtagCore;xm=a,Dm=s,jm=!0}Om[n]=Rm(t,Lm,Mm,e,Dm,Fm);var u={app:t,logEvent:function(t,e,r){(function(t,e,n,r,o){return(0,i.__awaiter)(this,void 0,void 0,(function(){var a,s;return(0,i.__generator)(this,(function(u){switch(u.label){case 0:return o&&o.global?(t(vm.EVENT,n,r),[2]):[3,1];case 1:return[4,e];case 2:a=u.sent(),s=(0,i.__assign)((0,i.__assign)({},r),{send_to:a}),t(vm.EVENT,n,s),u.label=3;case 3:return[2]}}))}))})(xm,Om[n],t,e,r).catch((function(t){return _m.error(t)}))},setCurrentScreen:function(t,e){(function(t,e,n,r){return(0,i.__awaiter)(this,void 0,void 0,(function(){var o;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return r&&r.global?(t(vm.SET,{screen_name:n}),[2,Promise.resolve()]):[3,1];case 1:return[4,e];case 2:o=i.sent(),t(vm.CONFIG,o,{update:!0,screen_name:n}),i.label=3;case 3:return[2]}}))}))})(xm,Om[n],t,e).catch((function(t){return _m.error(t)}))},setUserId:function(t,e){(function(t,e,n,r){return(0,i.__awaiter)(this,void 0,void 0,(function(){var o;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return r&&r.global?(t(vm.SET,{user_id:n}),[2,Promise.resolve()]):[3,1];case 1:return[4,e];case 2:o=i.sent(),t(vm.CONFIG,o,{update:!0,user_id:n}),i.label=3;case 3:return[2]}}))}))})(xm,Om[n],t,e).catch((function(t){return _m.error(t)}))},setUserProperties:function(t,e){(function(t,e,n,r){return(0,i.__awaiter)(this,void 0,void 0,(function(){var o,a,s,u,c;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:if(!r||!r.global)return[3,1];for(o={},a=0,s=Object.keys(n);a<s.length;a++)u=s[a],o["user_properties."+u]=n[u];return t(vm.SET,o),[2,Promise.resolve()];case 1:return[4,e];case 2:c=i.sent(),t(vm.CONFIG,c,{update:!0,user_properties:n}),i.label=3;case 3:return[2]}}))}))})(xm,Om[n],t,e).catch((function(t){return _m.error(t)}))},setAnalyticsCollectionEnabled:function(t){(function(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return[4,t];case 1:return n=r.sent(),window["ga-disable-"+n]=!e,[2]}}))}))})(Om[n],t).catch((function(t){return _m.error(t)}))},INTERNAL:{delete:function(){return delete Om[n],Promise.resolve()}}};return u}var Bm="analytics";function Km(){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:if((0,o.isBrowserExtension)())return[2,!1];if(!(0,o.areCookiesEnabled)())return[2,!1];if(!(0,o.isIndexedDBAvailable)())return[2,!1];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(0,o.validateIndexedDBOpenable)()];case 2:return[2,t.sent()];case 3:return t.sent(),[2,!1];case 4:return[2]}}))}))}!function(t){t.INTERNAL.registerComponent(new Kd.Component(Bm,(function(t){return Vm(t.getProvider("app").getImmediate(),t.getProvider("installations").getImmediate())}),"PUBLIC").setServiceProps({settings:qm,EventName:gm,isSupported:Km})),t.INTERNAL.registerComponent(new Kd.Component("analytics-internal",(function(t){try{return{logEvent:t.getProvider(Bm).getImmediate().logEvent}}catch(Vd){throw Em.create("interop-component-reg-failed",{reason:Vd})}}),"PRIVATE")),t.registerVersion("@firebase/analytics","0.6.18")}(r.default);var Wm,Hm=function(){function t(t,e,n,r){this.client=t,this.storage=e,this.storageCache=n,this.logger=r}return t.prototype.isCachedDataFresh=function(t,e){if(!e)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;var n=Date.now()-e,r=n<=t;return this.logger.debug("Config fetch cache check. Cache age millis: "+n+". Cache max age millis (minimumFetchIntervalMillis setting): "+t+". Is cache hit: "+r+"."),r},t.prototype.fetch=function(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,n,r,o,a;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return[4,Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()])];case 1:return e=i.sent(),n=e[0],(r=e[1])&&this.isCachedDataFresh(t.cacheMaxAgeMillis,n)?[2,r]:(t.eTag=r&&r.eTag,[4,this.client.fetch(t)]);case 2:return o=i.sent(),a=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())],200===o.status&&a.push(this.storage.setLastSuccessfulFetchResponse(o)),[4,Promise.all(a)];case 3:return i.sent(),[2,o]}}))}))},t}(),Gm=((Wm={})["registration-window"]="Undefined window object. This SDK only supports usage in a browser environment.",Wm["registration-project-id"]="Undefined project identifier. Check Firebase app initialization.",Wm["registration-api-key"]="Undefined API key. Check Firebase app initialization.",Wm["registration-app-id"]="Undefined app identifier. Check Firebase app initialization.",Wm["storage-open"]="Error thrown when opening storage. Original error: {$originalErrorMessage}.",Wm["storage-get"]="Error thrown when reading from storage. Original error: {$originalErrorMessage}.",Wm["storage-set"]="Error thrown when writing to storage. Original error: {$originalErrorMessage}.",Wm["storage-delete"]="Error thrown when deleting from storage. Original error: {$originalErrorMessage}.",Wm["fetch-client-network"]="Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",Wm["fetch-timeout"]='The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',Wm["fetch-throttle"]='The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',Wm["fetch-client-parse"]="Fetch client could not parse response. Original error: {$originalErrorMessage}.",Wm["fetch-status"]="Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",Wm),zm=new o.ErrorFactory("remoteconfig","Remote Config",Gm);var Qm=function(){function t(t,e,n,r,i,o){this.firebaseInstallations=t,this.sdkVersion=e,this.namespace=n,this.projectId=r,this.apiKey=i,this.appId=o}return t.prototype.fetch=function(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,n,r,o,a,s,u,c,h,l,f,d,p,v,g,y,m,_,b;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return[4,Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()])];case 1:e=i.sent(),n=e[0],r=e[1],o=window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com",a=o+"/v1/projects/"+this.projectId+"/namespaces/"+this.namespace+":fetch?key="+this.apiKey,s={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":t.eTag||"*"},u={sdk_version:this.sdkVersion,app_instance_id:n,app_instance_id_token:r,app_id:this.appId,language_code:(void 0===w&&(w=navigator),w.languages&&w.languages[0]||w.language)},c={method:"POST",headers:s,body:JSON.stringify(u)},h=fetch(a,c),l=new Promise((function(e,n){t.signal.addEventListener((function(){var t=new Error("The operation was aborted.");t.name="AbortError",n(t)}))})),i.label=2;case 2:return i.trys.push([2,5,,6]),[4,Promise.race([h,l])];case 3:return i.sent(),[4,h];case 4:return f=i.sent(),[3,6];case 5:throw d=i.sent(),p="fetch-client-network","AbortError"===d.name&&(p="fetch-timeout"),zm.create(p,{originalErrorMessage:d.message});case 6:if(v=f.status,g=f.headers.get("ETag")||void 0,200!==f.status)return[3,11];_=void 0,i.label=7;case 7:return i.trys.push([7,9,,10]),[4,f.json()];case 8:return _=i.sent(),[3,10];case 9:throw b=i.sent(),zm.create("fetch-client-parse",{originalErrorMessage:b.message});case 10:y=_.entries,m=_.state,i.label=11;case 11:if("INSTANCE_STATE_UNSPECIFIED"===m?v=500:"NO_CHANGE"===m?v=304:"NO_TEMPLATE"!==m&&"EMPTY_CONFIG"!==m||(y={}),304!==v&&200!==v)throw zm.create("fetch-status",{httpStatus:v});return[2,{status:v,eTag:g,config:y}]}var w}))}))},t}(),Ym=function(){function t(){this.listeners=[]}return t.prototype.addEventListener=function(t){this.listeners.push(t)},t.prototype.abort=function(){this.listeners.forEach((function(t){return t()}))},t}(),Xm=["1","true","t","yes","y","on"],$m=function(){function t(t,e){void 0===e&&(e=""),this._source=t,this._value=e}return t.prototype.asString=function(){return this._value},t.prototype.asBoolean=function(){return"static"!==this._source&&Xm.indexOf(this._value.toLowerCase())>=0},t.prototype.asNumber=function(){if("static"===this._source)return 0;var t=Number(this._value);return isNaN(t)&&(t=0),t},t.prototype.getSource=function(){return this._source},t}(),Jm=function(){function t(t,e,n,r,i){this.app=t,this._client=e,this._storageCache=n,this._storage=r,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}return t.prototype.setLogLevel=function(t){switch(t){case"debug":this._logger.logLevel=a.LogLevel.DEBUG;break;case"silent":this._logger.logLevel=a.LogLevel.SILENT;break;default:this._logger.logLevel=a.LogLevel.ERROR}},Object.defineProperty(t.prototype,"fetchTimeMillis",{get:function(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastFetchStatus",{get:function(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"},enumerable:!1,configurable:!0}),t.prototype.activate=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t,e,n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return[4,Promise.all([this._storage.getLastSuccessfulFetchResponse(),this._storage.getActiveConfigEtag()])];case 1:return t=r.sent(),e=t[0],n=t[1],e&&e.config&&e.eTag&&e.eTag!==n?[4,Promise.all([this._storageCache.setActiveConfig(e.config),this._storage.setActiveConfigEtag(e.eTag)])]:[2,!1];case 2:return r.sent(),[2,!0]}}))}))},t.prototype.ensureInitialized=function(){var t=this;return this._initializePromise||(this._initializePromise=this._storageCache.loadFromStorage().then((function(){t._isInitializationComplete=!0}))),this._initializePromise},t.prototype.fetch=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t,e,n,r=this;return(0,i.__generator)(this,(function(a){switch(a.label){case 0:t=new Ym,setTimeout((function(){return(0,i.__awaiter)(r,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){return t.abort(),[2]}))}))}),this.settings.fetchTimeoutMillis),a.label=1;case 1:return a.trys.push([1,4,,6]),[4,this._client.fetch({cacheMaxAgeMillis:this.settings.minimumFetchIntervalMillis,signal:t})];case 2:return a.sent(),[4,this._storageCache.setLastFetchStatus("success")];case 3:return a.sent(),[3,6];case 4:return e=a.sent(),n=function(t,e){return t instanceof o.FirebaseError&&-1!==t.code.indexOf(e)}(e,"fetch-throttle")?"throttle":"failure",[4,this._storageCache.setLastFetchStatus(n)];case 5:throw a.sent(),e;case 6:return[2]}}))}))},t.prototype.fetchAndActivate=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.fetch()];case 1:return t.sent(),[2,this.activate()]}}))}))},t.prototype.getAll=function(){var t=this;return function(t,e){void 0===t&&(t={});void 0===e&&(e={});return Object.keys((0,i.__assign)((0,i.__assign)({},t),e))}(this._storageCache.getActiveConfig(),this.defaultConfig).reduce((function(e,n){return e[n]=t.getValue(n),e}),{})},t.prototype.getBoolean=function(t){return this.getValue(t).asBoolean()},t.prototype.getNumber=function(t){return this.getValue(t).asNumber()},t.prototype.getString=function(t){return this.getValue(t).asString()},t.prototype.getValue=function(t){this._isInitializationComplete||this._logger.debug('A value was requested for key "'+t+'" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.');var e=this._storageCache.getActiveConfig();return e&&void 0!==e[t]?new $m("remote",e[t]):this.defaultConfig&&void 0!==this.defaultConfig[t]?new $m("default",String(this.defaultConfig[t])):(this._logger.debug('Returning static value for key "'+t+'". Define a default or remote value if this is unintentional.'),new $m("static"))},t}();function Zm(t,e){var n=t.target.error||void 0;return zm.create(e,{originalErrorMessage:n&&n.message})}var t_="app_namespace_store";var e_=function(){function t(t,e,n,r){void 0===r&&(r=new Promise((function(t,e){var n=indexedDB.open("firebase_remote_config",1);n.onerror=function(t){e(Zm(t,"storage-open"))},n.onsuccess=function(e){t(e.target.result)},n.onupgradeneeded=function(t){var e=t.target.result;0===t.oldVersion&&e.createObjectStore(t_,{keyPath:"compositeKey"})}}))),this.appId=t,this.appName=e,this.namespace=n,this.openDbPromise=r}return t.prototype.getLastFetchStatus=function(){return this.get("last_fetch_status")},t.prototype.setLastFetchStatus=function(t){return this.set("last_fetch_status",t)},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.get("last_successful_fetch_timestamp_millis")},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.set("last_successful_fetch_timestamp_millis",t)},t.prototype.getLastSuccessfulFetchResponse=function(){return this.get("last_successful_fetch_response")},t.prototype.setLastSuccessfulFetchResponse=function(t){return this.set("last_successful_fetch_response",t)},t.prototype.getActiveConfig=function(){return this.get("active_config")},t.prototype.setActiveConfig=function(t){return this.set("active_config",t)},t.prototype.getActiveConfigEtag=function(){return this.get("active_config_etag")},t.prototype.setActiveConfigEtag=function(t){return this.set("active_config_etag",t)},t.prototype.getThrottleMetadata=function(){return this.get("throttle_metadata")},t.prototype.setThrottleMetadata=function(t){return this.set("throttle_metadata",t)},t.prototype.deleteThrottleMetadata=function(){return this.delete("throttle_metadata")},t.prototype.get=function(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,n=this;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:return e=r.sent(),[2,new Promise((function(r,i){var o=e.transaction([t_],"readonly").objectStore(t_),a=n.createCompositeKey(t);try{var s=o.get(a);s.onerror=function(t){i(Zm(t,"storage-get"))},s.onsuccess=function(t){var e=t.target.result;r(e?e.value:void 0)}}catch(Vd){i(zm.create("storage-get",{originalErrorMessage:Vd&&Vd.message}))}}))]}}))}))},t.prototype.set=function(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r=this;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.openDbPromise];case 1:return n=i.sent(),[2,new Promise((function(i,o){var a=n.transaction([t_],"readwrite").objectStore(t_),s=r.createCompositeKey(t);try{var u=a.put({compositeKey:s,value:e});u.onerror=function(t){o(Zm(t,"storage-set"))},u.onsuccess=function(){i()}}catch(Vd){o(zm.create("storage-set",{originalErrorMessage:Vd&&Vd.message}))}}))]}}))}))},t.prototype.delete=function(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,n=this;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:return e=r.sent(),[2,new Promise((function(r,i){var o=e.transaction([t_],"readwrite").objectStore(t_),a=n.createCompositeKey(t);try{var s=o.delete(a);s.onerror=function(t){i(Zm(t,"storage-delete"))},s.onsuccess=function(){r()}}catch(Vd){i(zm.create("storage-delete",{originalErrorMessage:Vd&&Vd.message}))}}))]}}))}))},t.prototype.createCompositeKey=function(t){return[this.appId,this.appName,this.namespace,t].join()},t}(),n_=function(){function t(t){this.storage=t}return t.prototype.getLastFetchStatus=function(){return this.lastFetchStatus},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.lastSuccessfulFetchTimestampMillis},t.prototype.getActiveConfig=function(){return this.activeConfig},t.prototype.loadFromStorage=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t,e,n,r,o,a;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return t=this.storage.getLastFetchStatus(),e=this.storage.getLastSuccessfulFetchTimestampMillis(),n=this.storage.getActiveConfig(),[4,t];case 1:return(r=i.sent())&&(this.lastFetchStatus=r),[4,e];case 2:return(o=i.sent())&&(this.lastSuccessfulFetchTimestampMillis=o),[4,n];case 3:return(a=i.sent())&&(this.activeConfig=a),[2]}}))}))},t.prototype.setLastFetchStatus=function(t){return this.lastFetchStatus=t,this.storage.setLastFetchStatus(t)},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.lastSuccessfulFetchTimestampMillis=t,this.storage.setLastSuccessfulFetchTimestampMillis(t)},t.prototype.setActiveConfig=function(t){return this.activeConfig=t,this.storage.setActiveConfig(t)},t}();function r_(t,e){return new Promise((function(n,r){var i=Math.max(e-Date.now(),0),o=setTimeout(n,i);t.addEventListener((function(){clearTimeout(o),r(zm.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}var i_,o_=function(){function t(t,e){this.client=t,this.storage=e}return t.prototype.fetch=function(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.storage.getThrottleMetadata()];case 1:return e=n.sent()||{backoffCount:0,throttleEndTimeMillis:Date.now()},[2,this.attemptFetch(t,e)]}}))}))},t.prototype.attemptFetch=function(t,e){var n=e.throttleEndTimeMillis,r=e.backoffCount;return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,a,s;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return[4,r_(t.signal,n)];case 1:i.sent(),i.label=2;case 2:return i.trys.push([2,5,,7]),[4,this.client.fetch(t)];case 3:return e=i.sent(),[4,this.storage.deleteThrottleMetadata()];case 4:return i.sent(),[2,e];case 5:if(!function(t){if(!(t instanceof o.FirebaseError)||!t.customData)return!1;var e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(a=i.sent()))throw a;return s={throttleEndTimeMillis:Date.now()+(0,o.calculateBackoffMillis)(r),backoffCount:r+1},[4,this.storage.setThrottleMetadata(s)];case 6:return i.sent(),[2,this.attemptFetch(t,s)];case 7:return[2]}}))}))},t}(),a_="@firebase/remote-config";(i_=r.default).INTERNAL.registerComponent(new Kd.Component("remoteConfig",(function(t,e){var n=e.instanceIdentifier,r=t.getProvider("app").getImmediate(),i=t.getProvider("installations").getImmediate();if("undefined"===typeof window)throw zm.create("registration-window");var o=r.options,s=o.projectId,u=o.apiKey,c=o.appId;if(!s)throw zm.create("registration-project-id");if(!u)throw zm.create("registration-api-key");if(!c)throw zm.create("registration-app-id");n=n||"firebase";var h=new e_(c,r.name,n),l=new n_(h),f=new a.Logger(a_);f.logLevel=a.LogLevel.ERROR;var d=new Qm(i,i_.SDK_VERSION,n,s,u,c),p=new o_(d,h),v=new Hm(p,h,l,f),g=new Jm(r,v,l,h,f);return g.ensureInitialized(),g}),"PUBLIC").setMultipleInstances(!0)),i_.registerVersion(a_,"0.1.43");n(8446);var s_="8.10.1";r.default.registerVersion("firebase",s_,"app"),r.default.SDK_VERSION=s_;console.warn("\nIt looks like you're using the development build of the Firebase JS SDK.\nWhen deploying Firebase apps to production, it is advisable to only import\nthe individual SDK components you intend to use.\n\nFor the module builds, these are available in the following manner\n(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):\n\nCommonJS Modules:\nconst firebase = require('firebase/app');\nrequire('firebase/<PACKAGE>');\n\nES Modules:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n\nTypescript:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n"),r.default.registerVersion("firebase","8.10.1")},348:function(t,e){!function(t){"use strict";function e(t){return Array.prototype.slice.call(t)}function n(t){return new Promise((function(e,n){t.onsuccess=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}function r(t,e,r){var i,o=new Promise((function(o,a){n(i=t[e].apply(t,r)).then(o,a)}));return o.request=i,o}function i(t,e,n){var i=r(t,e,n);return i.then((function(t){if(t)return new h(t,i.request)}))}function o(t,e,n){n.forEach((function(n){Object.defineProperty(t.prototype,n,{get:function(){return this[e][n]},set:function(t){this[e][n]=t}})}))}function a(t,e,n,i){i.forEach((function(i){i in n.prototype&&(t.prototype[i]=function(){return r(this[e],i,arguments)})}))}function s(t,e,n,r){r.forEach((function(r){r in n.prototype&&(t.prototype[r]=function(){return this[e][r].apply(this[e],arguments)})}))}function u(t,e,n,r){r.forEach((function(r){r in n.prototype&&(t.prototype[r]=function(){return i(this[e],r,arguments)})}))}function c(t){this._index=t}function h(t,e){this._cursor=t,this._request=e}function l(t){this._store=t}function f(t){this._tx=t,this.complete=new Promise((function(e,n){t.oncomplete=function(){e()},t.onerror=function(){n(t.error)},t.onabort=function(){n(t.error)}}))}function d(t,e,n){this._db=t,this.oldVersion=e,this.transaction=new f(n)}function p(t){this._db=t}function v(t,e,n){var i=r(indexedDB,"open",[t,e]),o=i.request;return o&&(o.onupgradeneeded=function(t){n&&n(new d(o.result,t.oldVersion,o.transaction))}),i.then((function(t){return new p(t)}))}function g(t){return r(indexedDB,"deleteDatabase",[t])}o(c,"_index",["name","keyPath","multiEntry","unique"]),a(c,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),u(c,"_index",IDBIndex,["openCursor","openKeyCursor"]),o(h,"_cursor",["direction","key","primaryKey","value"]),a(h,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach((function(t){t in IDBCursor.prototype&&(h.prototype[t]=function(){var e=this,r=arguments;return Promise.resolve().then((function(){return e._cursor[t].apply(e._cursor,r),n(e._request).then((function(t){if(t)return new h(t,e._request)}))}))})})),l.prototype.createIndex=function(){return new c(this._store.createIndex.apply(this._store,arguments))},l.prototype.index=function(){return new c(this._store.index.apply(this._store,arguments))},o(l,"_store",["name","keyPath","indexNames","autoIncrement"]),a(l,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),u(l,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),s(l,"_store",IDBObjectStore,["deleteIndex"]),f.prototype.objectStore=function(){return new l(this._tx.objectStore.apply(this._tx,arguments))},o(f,"_tx",["objectStoreNames","mode"]),s(f,"_tx",IDBTransaction,["abort"]),d.prototype.createObjectStore=function(){return new l(this._db.createObjectStore.apply(this._db,arguments))},o(d,"_db",["name","version","objectStoreNames"]),s(d,"_db",IDBDatabase,["deleteObjectStore","close"]),p.prototype.transaction=function(){return new f(this._db.transaction.apply(this._db,arguments))},o(p,"_db",["name","version","objectStoreNames"]),s(p,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach((function(t){[l,c].forEach((function(n){t in n.prototype&&(n.prototype[t.replace("open","iterate")]=function(){var n=e(arguments),r=n[n.length-1],i=this._store||this._index,o=i[t].apply(i,n.slice(0,-1));o.onsuccess=function(){r(o.result)}})}))})),[c,l].forEach((function(t){t.prototype.getAll||(t.prototype.getAll=function(t,e){var n=this,r=[];return new Promise((function(i){n.iterateCursor(t,(function(t){t?(r.push(t.value),void 0===e||r.length!=e?t.continue():i(r)):i(r)}))}))})})),t.openDb=v,t.deleteDb=g,Object.defineProperty(t,"__esModule",{value:!0})}(e)}}]);
//# sourceMappingURL=209.ecf837f0.chunk.js.map